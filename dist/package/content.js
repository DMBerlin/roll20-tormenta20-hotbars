!function(){"use strict";const e="tormenta-20-hotbars-favorite-skills",a="tormenta-20-hotbars-favorite-spells",o="tormenta-20-hotbars-spell-custom-images",t="tormenta-20-hotbars-avatar",s="tormenta-20-hotbars-charname",r="tormenta-20-hotbars-hunter-abilities",n="tormenta-20-hotbars-destiny-powers",i="tormenta-20-hotbars-selected-race",c="tormenta-20-hotbars-selected-race-type",d="tormenta-20-hotbars-learned-spells",l="tormenta-20-hotbars-image-cache",m="1.0",u="https://gitlab.com/vizael/Tormenta20/-/raw/master/icons/magias/",p="https://wow.zamimg.com/images/wow/icons/large/spell_magic_magearmor.jpg",g=window.console;function f(){const e=document.getElementById("textchat-notifier");return!!e&&"none"!==window.getComputedStyle(e).display}function v(e=f()){const a=document.getElementById("ttm-toggle-switch"),o=document.getElementById("ttm-toggle-knob"),t=document.getElementById("ttm-toggle-label");a&&o&&t&&(e?(a.style.background="#6ec6ff",a.style.borderColor="#6ec6ff",o.style.left="13px",t.style.color="#6ec6ff"):(a.style.background="#444",a.style.borderColor="#666",o.style.left="1px",t.style.color="#ecf0f1"))}function y(e){const a=function(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}(e);return`${u}${a}.webp`}function b(e){return new Promise(a=>{const o=new Image;o.onload=()=>a(!0),o.onerror=()=>a(!1),o.src=e,setTimeout(()=>a(!1),5e3)})}function h(e){const{icon:a,label:o,onClick:t,theme:s="blue",badge:r=null,dataLabel:n=null}=e,i={blue:{background:"rgba(60,80,120,0.95)",border:"#6ec6ff",hoverBackground:"#6ec6ff",hoverColor:"#222"},red:{background:"rgba(120,60,60,0.95)",border:"#ff6e6e",hoverBackground:"#ff6e6e",hoverColor:"#222"}},c=i[s]||i.blue,d=document.createElement("button");d.style.display="flex",d.style.flexDirection="column",d.style.alignItems="center",d.style.justifyContent="center",d.style.padding="0",d.style.background=c.background,d.style.color="#fff",d.style.border=`2px solid ${c.border}`,d.style.borderRadius="8px",d.style.cursor="pointer",d.style.fontSize="13px",d.style.fontWeight="bold",d.style.width="64px",d.style.height="64px",d.style.transition="all 0.2s",d.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)",d.style.textAlign="center",d.style.lineHeight="1.1",d.style.position="relative",d.onmouseover=()=>{d.style.background=c.hoverBackground,d.style.color=c.hoverColor,d.style.transform="scale(1.08)"},d.onmouseout=()=>{d.style.background=c.background,d.style.color="#fff",d.style.transform="scale(1)"};const l=document.createElement("span");l.textContent=a,l.style.fontSize="26px",l.style.marginBottom="2px",d.appendChild(l);const m=document.createElement("span");if(m.textContent=o,m.style.fontSize="12px",m.style.marginTop="2px",d.appendChild(m),t&&(d.onclick=t),n&&d.setAttribute("data-label",n),r){const e=document.createElement("div");e.className="hotbar-button-badge",e.style.position="absolute",e.style.top="-2px",e.style.right="-2px",e.style.background=r.color||"#4caf50",e.style.color="#fff",e.style.borderRadius="50%",e.style.width="16px",e.style.height="16px",e.style.fontSize="10px",e.style.fontWeight="bold",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.border="2px solid #23243a",e.style.zIndex="1000",e.textContent=r.text,d.appendChild(e)}return d}function x(e){const{placeholder:a="Filtrar...",onInput:o=null,onClear:t=null,theme:s="blue",width:r="100%",marginBottom:n="10px",fontSize:i="15px",showClearButton:c=!0,autoFocus:d=!1}=e,l={blue:{border:"#6ec6ff",color:"#6ec6ff",background:"#23243a"},orange:{border:"#ffb86c",color:"#ffb86c",background:"#23243a"},purple:{border:"#9c27b0",color:"#9c27b0",background:"#23243a"},green:{border:"#4caf50",color:"#4caf50",background:"#23243a"},red:{border:"#f44336",color:"#f44336",background:"#23243a"}},m=l[s]||l.blue,u=document.createElement("div");u.style.position="relative",u.style.marginBottom=n,u.style.width=r;const p=document.createElement("input");p.type="text",p.placeholder=a,p.style.width="100%",p.style.padding="10px 28px 10px 12px",p.style.borderRadius="8px",p.style.border=`1px solid ${m.border}`,p.style.background=m.background,p.style.color="#fff",p.style.fontSize=i,p.style.outline="none",p.style.boxSizing="border-box",p.style.transition="border-color 0.2s ease",p.onmouseover=()=>{p.style.borderColor=m.color},p.onmouseout=()=>{document.activeElement!==p&&(p.style.borderColor=m.border)},p.onfocus=()=>{p.style.borderColor=m.color,p.style.boxShadow=`0 0 0 2px ${m.color}20`},p.onblur=()=>{p.style.borderColor=m.border,p.style.boxShadow="none"};let g=null;return c&&(g=document.createElement("span"),g.textContent="×",g.style.position="absolute",g.style.right="8px",g.style.top="50%",g.style.transform="translateY(-50%)",g.style.cursor="pointer",g.style.color=m.color,g.style.fontSize="18px",g.style.display="none",g.style.transition="all 0.2s ease",g.style.width="20px",g.style.height="20px",g.style.display="flex",g.style.alignItems="center",g.style.justifyContent="center",g.style.borderRadius="50%",g.onmouseover=()=>{g.style.background=`${m.color}20`,g.style.color=m.color},g.onmouseout=()=>{g.style.background="transparent",g.style.color=m.color},g.onclick=()=>{p.value="",p.dispatchEvent(new Event("input")),p.focus(),t&&t()}),p.oninput=()=>{c&&g&&(p.value.length>0?g.style.display="flex":g.style.display="none"),o&&o(p.value)},u.appendChild(p),c&&g&&u.appendChild(g),d&&setTimeout(()=>{p.focus()},100),{container:u,input:p,clearButton:g,clear:()=>{p.value="",p.dispatchEvent(new Event("input")),t&&t()},focus:()=>p.focus(),blur:()=>p.blur(),getValue:()=>p.value,setValue:e=>{p.value=e,p.dispatchEvent(new Event("input"))},setPlaceholder:e=>{p.placeholder=e},setTheme:e=>{const a=l[e]||l.blue;p.style.borderColor=a.border,g&&(g.style.color=a.color)}}}function C(e){const{title:a,description:o,tags:t=[],theme:s="blue",position:r="right",maxWidth:n=320,minWidth:i=280}=e,c={blue:{border:"#6ec6ff",titleColor:"#6ec6ff",background:"rgba(20,20,30,0.98)"},red:{border:"#ff6e6e",titleColor:"#ff6e6e",background:"rgba(20,20,30,0.98)"},green:{border:"#4caf50",titleColor:"#4caf50",background:"rgba(20,20,30,0.98)"},purple:{border:"#9c27b0",titleColor:"#9c27b0",background:"rgba(20,20,30,0.98)"}},d=c[s]||c.blue,l=document.createElement("div");l.className="roll20-tooltip",l.style.position="fixed",l.style.background=d.background,l.style.border=`2px solid ${d.border}`,l.style.borderRadius="8px",l.style.padding="12px",l.style.minWidth=`${i}px`,l.style.maxWidth=`${n}px`,l.style.zIndex="10004",l.style.boxShadow="0 4px 16px rgba(0,0,0,0.8)",l.style.pointerEvents="none",l.style.opacity="0",l.style.transition="opacity 0.2s ease";const m=document.createElement("div");if(m.style.display="flex",m.style.flexDirection="column",m.style.gap="8px",a){const e=document.createElement("div");e.textContent=a,e.style.color=d.titleColor,e.style.fontSize="16px",e.style.fontWeight="bold",e.style.marginBottom="4px",m.appendChild(e)}if(t.forEach(e=>{const a=document.createElement("div");a.textContent=e.text,a.style.background=e.bgColor||d.titleColor,a.style.color=e.color||"#23243a",a.style.fontSize="11px",a.style.fontWeight="bold",a.style.borderRadius="4px",a.style.padding="2px 8px",a.style.display="inline-block",a.style.width="fit-content",a.style.marginTop="2px",m.appendChild(a)}),o){const e=document.createElement("div");e.textContent=o,e.style.color="#ecf0f1",e.style.fontSize="13px",e.style.lineHeight="1.4",e.style.marginTop="6px",m.appendChild(e)}function u(e){const a=e.getBoundingClientRect(),o=l.getBoundingClientRect();let t,s;switch(r){case"right":default:t=a.right+10,s=a.top;break;case"left":t=a.left-o.width-10,s=a.top;break;case"top":t=a.left+a.width/2-o.width/2,s=a.top-o.height-10;break;case"bottom":t=a.left+a.width/2-o.width/2,s=a.bottom+10}t<10&&(t=10),t+o.width>window.innerWidth-10&&(t=window.innerWidth-o.width-10),s<10&&(s=a.bottom+10),s+o.height>window.innerHeight-10&&(s=a.top-o.height-10),l.style.left=t+"px",l.style.top=s+"px"}return l.appendChild(m),{element:l,show:function(e){document.body.appendChild(l),u(e),setTimeout(()=>{l.style.opacity="1"},10)},hide:function(){l.style.opacity="0",setTimeout(()=>{l.parentNode&&l.parentNode.removeChild(l)},200)},position:u}}function w(e){const a=document.getElementById("condition-details-popup");a&&a.remove();const o=document.getElementById("condition-details-overlay");o&&o.remove();const t=document.createElement("div");t.id="condition-details-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10000",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="condition-details-popup",s.className="roll20-popup roll20-popup-orange",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ffb86c",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10001",s.style.maxWidth="500px",s.style.maxHeight="600px",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px";const n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.gap="12px";const i=document.createElement("div");i.style.width="32px",i.style.height="32px",i.style.borderRadius="6px",i.style.border="2px solid #ff6e6e",i.style.background="#23243a",i.style.overflow="hidden",i.style.flexShrink="0";const c=ua(e.iconeUrl||"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg",e.nome,e.icone||"⚠️",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!0});i.appendChild(c);const d=document.createElement("h3");d.textContent=e.nome,d.style.color="#ffb86c",d.style.margin="0",d.style.fontSize="20px",d.style.fontWeight="bold",n.appendChild(i),n.appendChild(d);const l=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{s.remove();const e=document.getElementById("condition-details-overlay");e&&e.remove()}});r.appendChild(n),r.appendChild(l.render()),s.appendChild(r);const m=document.createElement("div");if(m.style.display="flex",m.style.flexDirection="column",m.style.gap="16px",e.categoria){const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.gap="8px";const o=document.createElement("span");o.textContent="Categoria:",o.style.color="#ffb86c",o.style.fontWeight="bold",o.style.fontSize="14px";const t=document.createElement("span");t.textContent=e.categoria,t.style.color="#ecf0f1",t.style.fontSize="14px",a.appendChild(o),a.appendChild(t),m.appendChild(a)}if(e.descricaoCompleta){const a=document.createElement("div"),o=document.createElement("div");o.textContent="Descrição Completa:",o.style.color="#ffb86c",o.style.fontWeight="bold",o.style.fontSize="14px",o.style.marginBottom="8px";const t=document.createElement("div"),s=e.descricaoCompleta.split("\n\n").map(e=>`<p>${e.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<em>$1</em>")}</p>`).join("");t.innerHTML=s,t.style.color="#ecf0f1",t.style.fontSize="14px",t.style.lineHeight="1.5",t.style.padding="12px",t.style.background="rgba(255,184,108,0.1)",t.style.borderRadius="6px",t.style.border="1px solid rgba(255,184,108,0.3)",t.querySelectorAll("p").forEach(e=>{e.style.margin="0 0 8px 0",e.style.padding="0"}),a.appendChild(o),a.appendChild(t),m.appendChild(a)}if(e.efeitos){const a=document.createElement("div"),o=document.createElement("div");o.textContent="Efeitos:",o.style.color="#ffb86c",o.style.fontWeight="bold",o.style.fontSize="14px",o.style.marginBottom="8px";const t=document.createElement("div");t.textContent=e.efeitos,t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.lineHeight="1.4",a.appendChild(o),a.appendChild(t),m.appendChild(a)}const u=document.createElement("div");u.style.marginTop="16px",u.style.padding="12px",u.style.background="rgba(255,184,108,0.05)",u.style.borderRadius="6px",u.style.border="1px solid rgba(255,184,108,0.2)";const p=document.createElement("div");p.textContent="Regras Gerais das Condições:",p.style.color="#ffb86c",p.style.fontWeight="bold",p.style.fontSize="13px",p.style.marginBottom="8px";const g=document.createElement("div");g.innerHTML='\n            <div style="color: #ecf0f1; font-size: 12px; line-height: 1.4; margin-bottom: 6px;">\n                • <strong>Condições com os mesmos efeitos não se acumulam;</strong> aplique apenas os mais severos.\n            </div>\n            <div style="color: #ecf0f1; font-size: 12px; line-height: 1.4; margin-bottom: 6px;">\n                • <strong>A menos que especificado o contrário, condições terminam no fim da cena.</strong>\n            </div>\n            <div style="color: #ecf0f1; font-size: 12px; line-height: 1.4;">\n                • Algumas condições possuem um tipo de efeito (em <em>itálico</em>).\n            </div>\n        ',u.appendChild(p),u.appendChild(g),m.appendChild(u);const f=document.createElement("div");f.style.display="flex",f.style.gap="10px",f.style.marginTop="20px";const v=document.createElement("button");v.textContent="Compartilhar",v.style.flex="1",v.style.padding="10px 15px",v.style.background="#2c3e50",v.style.border="1px solid #34495e",v.style.borderRadius="6px",v.style.color="#ecf0f1",v.style.cursor="pointer",v.style.fontSize="14px",v.onclick=()=>{oa(e.nome),A(`Condição "${e.nome}" compartilhada no chat!`),Ce()},f.appendChild(v);const y=document.createElement("button");y.textContent="Aplicar Condição",y.style.flex="1",y.style.padding="10px 15px",y.style.background="#27ae60",y.style.border="1px solid #2ecc71",y.style.borderRadius="6px",y.style.color="#ecf0f1",y.style.cursor="pointer",y.style.fontSize="14px",y.onclick=()=>{ea(e.nome),Ce()},f.appendChild(y),m.appendChild(f),s.appendChild(m),document.body.appendChild(s),S(s,"orange")}function q(e,a,o){E();const t=document.createElement("div");let s,r;t.id="effect-hover-tooltip",t.style.position="fixed",t.style.background="rgba(30,30,40,0.95)",t.style.border="1px solid #6ec6ff",t.style.borderRadius="6px",t.style.padding="8px 12px",t.style.color="#ecf0f1",t.style.fontSize="12px",t.style.maxWidth="250px",t.style.zIndex="10004",t.style.boxShadow="0 4px 12px rgba(0,0,0,0.5)",t.style.pointerEvents="none","food"===o?(s=a.nome,r=a.descricao||"Efeito de comida ativo."):"drink"===o?(s=a.nome,r=a.descricao||"Efeito de bebida ativo."):"condition"===o?(s=a.nome,r=a.descricao||"Condição ativa."):"item"===o?(s=a.name,r=a.description||"Efeito de item ativo."):"potion"===o&&(s=a.nome,r=a.descricao||"Efeito de poção ativo."),t.innerHTML=`\n                <div style="font-weight: bold; color: #6ec6ff; margin-bottom: 4px;">${s}</div>\n                <div style="color: #ecf0f1;">${r}</div>\n            `,document.body.appendChild(t);const n=e.getBoundingClientRect();t.style.left=n.right+10+"px",t.style.top=n.top-5+"px"}function E(){const e=document.getElementById("effect-hover-tooltip");e&&e.remove()}function z(e="item"){const a={skill:"💡 Segure CTRL + Clique para ver detalhes da perícia",spell:"💡 Clique para lançar magia • CTRL + Clique para ver detalhes",power:"💡 Segure CTRL + Clique para ver detalhes do poder",item:"💡 Segure CTRL + Clique para ver detalhes do item"},o=document.createElement("div");return o.textContent=a[e]||a.item,o.style.fontSize="11px",o.style.color="#6ec6ff",o.style.marginBottom="10px",o.style.fontStyle="italic",o.style.textAlign="center",o.style.width="100%",o}function S(e,a="blue"){const o={blue:{thumb:"rgba(110, 198, 255, 0.6)",thumbHover:"rgba(110, 198, 255, 0.8)",thumbActive:"rgba(110, 198, 255, 1)",border:"rgba(110, 198, 255, 0.2)",borderHover:"rgba(110, 198, 255, 0.4)",borderActive:"rgba(110, 198, 255, 0.6)",track:"rgba(35, 36, 58, 0.3)"},orange:{thumb:"rgba(255, 184, 108, 0.6)",thumbHover:"rgba(255, 184, 108, 0.8)",thumbActive:"rgba(255, 184, 108, 1)",border:"rgba(255, 184, 108, 0.2)",borderHover:"rgba(255, 184, 108, 0.4)",borderActive:"rgba(255, 184, 108, 0.6)",track:"rgba(35, 36, 58, 0.3)"},purple:{thumb:"rgba(156, 39, 176, 0.6)",thumbHover:"rgba(156, 39, 176, 0.8)",thumbActive:"rgba(156, 39, 176, 1)",border:"rgba(156, 39, 176, 0.2)",borderHover:"rgba(156, 39, 176, 0.4)",borderActive:"rgba(156, 39, 176, 0.6)",track:"rgba(35, 36, 58, 0.3)"},green:{thumb:"rgba(76, 175, 80, 0.6)",thumbHover:"rgba(76, 175, 80, 0.8)",thumbActive:"rgba(76, 175, 80, 1)",border:"rgba(76, 175, 80, 0.2)",borderHover:"rgba(76, 175, 80, 0.4)",borderActive:"rgba(76, 175, 80, 0.6)",track:"rgba(35, 36, 58, 0.3)"},red:{thumb:"rgba(244, 67, 54, 0.6)",thumbHover:"rgba(244, 67, 54, 0.8)",thumbActive:"rgba(244, 67, 54, 1)",border:"rgba(244, 67, 54, 0.2)",borderHover:"rgba(244, 67, 54, 0.4)",borderActive:"rgba(244, 67, 54, 0.6)",track:"rgba(35, 36, 58, 0.3)"},brown:{thumb:"rgba(139, 69, 19, 0.6)",thumbHover:"rgba(139, 69, 19, 0.8)",thumbActive:"rgba(139, 69, 19, 1)",border:"rgba(139, 69, 19, 0.2)",borderHover:"rgba(139, 69, 19, 0.4)",borderActive:"rgba(139, 69, 19, 0.6)",track:"rgba(35, 36, 58, 0.3)"}},t=o[a]||o.blue;e.querySelectorAll("*").forEach(a=>{const o=window.getComputedStyle(a),s=o.overflowY,r=o.overflow;if("auto"===s||"scroll"===s||"auto"===r||"scroll"===r){g.log("Found scrollable element:",a.id||a.className,"in popup:",e.id),a.style.setProperty("scrollbar-width","thin","important"),a.style.setProperty("scrollbar-color",`${t.thumb} ${t.track}`,"important");const o=a.id||`scrollable-${Math.random().toString(36).substr(2,9)}`;a.id||(a.id=o);const s=document.createElement("style");s.textContent=`\n                        #${o}::-webkit-scrollbar {\n                            width: 8px !important;\n                            height: 8px !important;\n                        }\n                        #${o}::-webkit-scrollbar-track {\n                            background: ${t.track} !important;\n                            border-radius: 4px !important;\n                            margin: 2px !important;\n                        }\n                        #${o}::-webkit-scrollbar-thumb {\n                            background: ${t.thumb} !important;\n                            border-radius: 4px !important;\n                            border: 1px solid ${t.border} !important;\n                            transition: all 0.2s ease !important;\n                        }\n                        #${o}::-webkit-scrollbar-thumb:hover {\n                            background: ${t.thumbHover} !important;\n                            border-color: ${t.borderHover} !important;\n                        }\n                        #${o}::-webkit-scrollbar-thumb:active {\n                            background: ${t.thumbActive} !important;\n                            border-color: ${t.borderActive} !important;\n                        }\n                        #${o}::-webkit-scrollbar-corner {\n                            background: ${t.track} !important;\n                            border-radius: 4px !important;\n                        }\n                    `,document.head.appendChild(s)}});const s=window.getComputedStyle(e);if("auto"===s.overflowY||"scroll"===s.overflowY){g.log("Popup itself is scrollable:",e.id),e.style.setProperty("scrollbar-width","thin","important"),e.style.setProperty("scrollbar-color",`${t.thumb} ${t.track}`,"important");const a=document.createElement("style");a.textContent=`\n                    #${e.id}::-webkit-scrollbar {\n                        width: 8px !important;\n                        height: 8px !important;\n                    }\n                    #${e.id}::-webkit-scrollbar-track {\n                        background: ${t.track} !important;\n                        border-radius: 4px !important;\n                        margin: 2px !important;\n                    }\n                    #${e.id}::-webkit-scrollbar-thumb {\n                        background: ${t.thumb} !important;\n                        border-radius: 4px !important;\n                        border: 1px solid ${t.border} !important;\n                        transition: all 0.2s ease !important;\n                    }\n                    #${e.id}::-webkit-scrollbar-thumb:hover {\n                        background: ${t.thumbHover} !important;\n                        border-color: ${t.borderHover} !important;\n                    }\n                    #${e.id}::-webkit-scrollbar-thumb:active {\n                        background: ${t.thumbActive} !important;\n                        border-color: ${t.borderActive} !important;\n                    }\n                    #${e.id}::-webkit-scrollbar-corner {\n                        background: ${t.track} !important;\n                        border-radius: 4px !important;\n                    }\n                `,document.head.appendChild(a)}}"undefined"!=typeof window&&(window.addTooltipToElement=function(e,a){let o=null,t=null;return e.addEventListener("mouseenter",()=>{t=setTimeout(()=>{o=C(a),o.show(e)},a.delay||300)}),e.addEventListener("mouseleave",()=>{t&&(clearTimeout(t),t=null),o&&(o.hide(),o=null)}),e.addEventListener("click",()=>{t&&(clearTimeout(t),t=null),o&&(o.hide(),o=null)}),{element:e,tooltip:o,show:()=>o?.show(e),hide:()=>o?.hide()}});let k=null;function j(e,a="info",o=5e3){const t=k||(k=document.createElement("div"),k.id="roll20-notification-container",k.className="roll20-scrollbar-thin",k.style.cssText="\n                position: fixed;\n                top: 20px;\n                right: 20px;\n                z-index: 10005;\n                display: flex;\n                flex-direction: column;\n                gap: 10px;\n                pointer-events: none;\n            ",document.body.appendChild(k),k),s=document.createElement("div");s.className=`roll20-notification roll20-notification-${a}`,s.style.cssText=`\n                background: ${function(e){switch(e){case"success":return"#d4edda";case"warning":return"#fff3cd";case"error":return"#f8d7da";default:return"#d1ecf1"}}(a)};\n                border: 1px solid ${function(e){switch(e){case"success":return"#c3e6cb";case"warning":return"#ffeaa7";case"error":return"#f5c6cb";default:return"#bee5eb"}}(a)};\n                border-radius: 8px;\n                padding: 12px 16px;\n                margin-bottom: 8px;\n                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n                display: flex;\n                align-items: center;\n                gap: 12px;\n                min-width: 300px;\n                max-width: 400px;\n                opacity: 0;\n                transform: translateX(100%);\n                transition: all 0.3s ease;\n                pointer-events: auto;\n                font-family: 'Roboto', sans-serif;\n                font-size: 14px;\n                color: ${function(e){switch(e){case"success":return"#155724";case"warning":return"#856404";case"error":return"#721c24";default:return"#0c5460"}}(a)};\n            `;const r=document.createElement("div");r.innerHTML=function(e){switch(e){case"success":return"✓";case"warning":return"⚠";case"error":return"✗";default:return"ℹ"}}(a),r.style.cssText="\n                font-size: 18px;\n                flex-shrink: 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: 24px;\n                height: 24px;\n            ",s.appendChild(r);const n=document.createElement("div");n.textContent=e,n.style.cssText="\n                flex: 1;\n                line-height: 1.4;\n            ",s.appendChild(n);const i=window.Roll20Components.createCloseButton({text:"×",fontSize:"20px",width:"24px",height:"24px",padding:"0",customStyles:"opacity: 0.7; transition: opacity 0.2s ease;",onClick:()=>P(s)});return s.appendChild(i.render()),t.appendChild(s),setTimeout(()=>{s.style.opacity="1",s.style.transform="translateX(0)"},10),o>0&&setTimeout(()=>{P(s)},o),s}function P(e){e&&e.parentNode&&(e.style.opacity="0",e.style.transform="translateX(100%)",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}function A(e,a=5e3){return j(e,"success",a)}function _(e,a=5e3){return j(e,"warning",a)}function $(){return localStorage.getItem("tormenta-20-hotbars-sync-name")||localStorage.getItem(s)||"Nome do Personagem"}function I(){const e=localStorage.getItem("tormenta-20-hotbars-char-identification-key");return e&&""!==e.trim()?e.trim():$().replace(/['"]/g,"")}const T="tormenta-20-hotbars-char-level-attr";function D(){return localStorage.getItem("tormenta-20-hotbars-sync-level")||localStorage.getItem(T)||"1"}function M(){const e=document.getElementById("character-name");if(e){const a=$();e.textContent=a}const a=document.querySelector("#character-avatar").parentNode.querySelector('div[title="Nível do herói"]');a&&(a.textContent=D());const o=document.querySelector("#character-avatar").parentNode.querySelector('div[title="Defesa"]');if(o){const e=localStorage.getItem("tormenta-20-hotbars-sync-ac")||"0";o.textContent=e}!function(){const e=document.querySelector("#character-avatar")?.parentNode?.parentNode;if(!e)return;const a=e.children[1],o=a.children[1];if(o){const e=o.children[0]?.children[0],a=o.children[1];if(e&&a){const o=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-hp-current")||"0"),t=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-hp-total")||"1"),s=t>0?Math.max(0,Math.min(100,o/t*100)):0;e.style.width=`${s}%`,a.textContent=`${o}/${t}`,e.style.background=s>50?"#4caf50":s>25?"#ff9800":"#f44336"}}const t=a.children[2];if(t){const e=t.children[0]?.children[0],a=t.children[1];if(e&&a){const o=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-mp-current")||"0"),t=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-mp-total")||"1"),s=t>0?Math.max(0,Math.min(100,o/t*100)):0;e.style.width=`${s}%`,a.textContent=`${o}/${t}`}}}()}function R(){try{const a=localStorage.getItem(e);return a?JSON.parse(a):[]}catch(e){return g.log("Erro ao carregar favoritos:",e),[]}}function V(){try{const e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch(e){return g.log("Erro ao carregar magias favoritas:",e),[]}}function B(){try{const e=localStorage.getItem(o);return e?JSON.parse(e):{}}catch(e){return g.log("Erro ao carregar imagens customizadas das magias:",e),{}}}function N(e,a){const t=B();return a&&a.trim()?(t[e]=a.trim(),A(`Imagem customizada adicionada para "${e}"!`)):(delete t[e],_(`Imagem customizada removida de "${e}"!`)),function(e){try{localStorage.setItem(o,JSON.stringify(e))}catch(e){g.log("Erro ao salvar imagens customizadas das magias:",e)}}(t),t}function O(e){return B()[e]||""}function F(){try{return localStorage.getItem(t)||null}catch(e){return g.log("Erro ao carregar avatar:",e),null}}function U(e){try{localStorage.setItem(t,e)}catch(e){g.log("Erro ao salvar avatar:",e)}}function L(){try{const e=localStorage.getItem(r);return e?JSON.parse(e):[]}catch(e){return g.log("Erro ao carregar habilidades aprendidas:",e),[]}}function W(e){try{localStorage.setItem(r,JSON.stringify(e))}catch(e){g.log("Erro ao salvar habilidades aprendidas:",e)}}function H(e){const a=L(),o=a.indexOf(e);return o>-1?(a.splice(o,1),_(`Habilidade "${e}" removida da lista de aprendidas.`)):(a.push(e),A(`Habilidade "${e}" adicionada à lista de aprendidas!`)),W(a),a}function J(e){const a=[];return e>=3&&a.push("Explorador"),e>=5&&a.push("Caminho do Explorador"),e>=20&&a.push("Mestre Caçador"),a}function G(e,a){if(["Marca da Presa","Rastreador"].includes(e))return!0;if(J(a).includes(e))return!0;const o=L(),t=function(e){return{2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,10:9,11:10,12:11,13:12,14:13,15:14,16:15,17:16,18:17,19:18,20:19}[e]||0}(a);return o.filter(e=>!["Marca da Presa","Rastreador"].includes(e)&&!J(a).includes(e)).length<t}function Q(){try{const e=localStorage.getItem(d);return e?JSON.parse(e):[]}catch(e){return g.log("Erro ao carregar magias aprendidas:",e),[]}}function K(e){const a=L();return!!["Marca da Presa","Rastreador"].includes(e)||a.includes(e)}function Y(){const e=document.getElementById("avatar-popup");e&&e.remove();const a=document.getElementById("avatar-overlay");a&&a.remove();const o=document.createElement("div");o.id="avatar-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="avatar-popup",t.className="roll20-popup",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="20px",t.style.zIndex="10001",t.style.maxWidth="400px",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("avatar-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Configurar Avatar",n.style.color="#ecf0f1",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.display="flex",i.style.justifyContent="center",i.style.marginBottom="15px";const c=F(),d=document.createElement("div");d.style.width="80px",d.style.height="80px",d.style.borderRadius="50%",d.style.border="3px solid #6ec6ff",d.style.display="flex",d.style.alignItems="center",d.style.justifyContent="center",d.style.fontSize="24px",d.style.fontWeight="bold",d.style.color="#ecf0f1",d.style.background="#23243a",d.style.overflow="hidden",c?(d.style.background=`url(${c}) center/cover`,d.textContent=""):d.textContent="EE",i.appendChild(d),t.appendChild(i);const l=document.createElement("label");l.textContent="URL da imagem:",l.style.color="#ecf0f1",l.style.fontSize="14px",l.style.fontWeight="bold",l.style.marginBottom="8px",t.appendChild(l);const m=document.createElement("input");m.type="url",m.placeholder="https://exemplo.com/imagem.jpg",m.value=c||"",m.style.width="100%",m.style.padding="10px",m.style.borderRadius="6px",m.style.border="1px solid #6ec6ff",m.style.background="#23243a",m.style.color="#fff",m.style.fontSize="14px",m.style.outline="none",m.style.boxSizing="border-box",m.style.marginBottom="15px",t.appendChild(m);const u=document.createElement("div");u.style.display="flex",u.style.gap="10px";const p=document.createElement("button");p.textContent="Salvar",p.style.flex="1",p.style.padding="10px",p.style.background="#6ec6ff",p.style.color="#23243a",p.style.border="none",p.style.borderRadius="6px",p.style.fontSize="14px",p.style.fontWeight="bold",p.style.cursor="pointer",p.style.transition="all 0.2s",p.onmouseover=()=>{p.style.background="#5bb8ff"},p.onmouseout=()=>{p.style.background="#6ec6ff"},p.onclick=()=>{const e=m.value.trim();e&&(U(e),X(),A("Avatar do personagem atualizado!")),t.remove();const a=document.getElementById("avatar-overlay");a&&a.remove()};const g=document.createElement("button");g.textContent="Limpar",g.style.flex="1",g.style.padding="10px",g.style.background="#444",g.style.color="#ecf0f1",g.style.border="none",g.style.borderRadius="6px",g.style.fontSize="14px",g.style.fontWeight="bold",g.style.cursor="pointer",g.style.transition="all 0.2s",g.onmouseover=()=>{g.style.background="#555"},g.onmouseout=()=>{g.style.background="#444"},g.onclick=()=>{U(""),X(),_("Avatar do personagem removido."),t.remove();const e=document.getElementById("avatar-overlay");e&&e.remove()},u.appendChild(p),u.appendChild(g),t.appendChild(u),document.body.appendChild(t),S(t,"blue")}function X(){const e=document.getElementById("character-avatar");if(!e)return;const a=F();a?(e.style.background=`url(${a}) center/cover`,e.textContent=""):(e.style.background="#23243a",e.textContent="EE")}function Z(e){const a=document.querySelector("#textchat-input textarea"),o=document.querySelector("#chatSendBtn");if(a&&o){let t=e.replace(/\s+/g," ").trim();a.value=t,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),o.click()}}async function ee(e){try{const a="DATA_"+Math.random().toString(36).substr(2,9).toUpperCase()+"_"+Date.now().toString(36),o=I(),t={};Object.keys(e).forEach(a=>{const s=e[a];t[a]=`@{${o}|${s}}`});const s=`${JSON.stringify(t)} [${a}]`;g.log("=== DEBUG SINCRONIZAÇÃO ==="),g.log("Nome do personagem:",o),g.log("Atributos configurados:",e),g.log("Objeto JSON criado:",t),g.log("Comando de sincronização JSON enviado:",s),g.log("================================"),Z(s);const r=await function(e,a=5e3){return new Promise((o,t)=>{const s=Date.now(),r=()=>{const n=document.querySelectorAll("#textchat .message");g.log(`Procurando mensagem com chave: ${e}`),g.log(`Mensagens encontradas no chat: ${n.length}`);for(let a of n){const t=a.textContent||a.innerText;if(t.includes(e))return g.log("Mensagem encontrada:",t),void o(a)}Date.now()-s<a?setTimeout(r,100):(console.error("Timeout: Mensagem de dados não encontrada"),t(new Error("Timeout: Mensagem de dados não encontrada")))};r()})}(a),n=function(e,a){try{const o=e.textContent||e.innerText;g.log("Mensagem JSON completa recebida:",o);let t,s=o.replace(`[${a}]`,"").trim();g.log("Texto JSON limpo (sem chave):",s),s=s.replace(/^[^{[]*/,"").replace(/[^}\]]*$/,""),g.log("Texto JSON limpo (sem caracteres extras):",s);try{t=JSON.parse(s)}catch(e){return console.error("Erro ao fazer parse do JSON:",e),g.log("Texto que falhou no parse:",s),g.log("Tentando extração manual dos dados..."),function(e){try{g.log("Extraindo dados manualmente do texto:",e);let a=e;a=a.replace(/^\{|\}$/g,""),a=a.replace(/"/g,""),g.log("Texto limpo:",a);const o=a.split(",").map(e=>e.trim()),t={};return o.forEach(e=>{if(e.includes(":")){const a=e.indexOf(":"),o=e.substring(0,a).trim(),s=e.substring(a+1).trim();if(o&&s){const e=s.replace(/^['"]|['"]$/g,"");t[o]=e,g.log(`Extraído: ${o} = ${e}`)}}}),g.log("Dados extraídos manualmente:",t),0===Object.keys(t).length?(g.log("Tentando extração agressiva..."),function(e){try{g.log("Extração agressiva do texto:",e);const a=e.replace(/[^\w\s,:]/g,"");g.log("Texto limpo agressivamente:",a);const o=/(\w+):\s*([^,]+)/g,t={};let s;for(;null!==(s=o.exec(a));){const e=s[1].trim(),a=s[2].trim();e&&a&&(t[e]=a,g.log(`Extraído agressivamente: ${e} = ${a}`))}return g.log("Dados extraídos agressivamente:",t),t}catch(e){return console.error("Erro na extração agressiva:",e),null}}(e)):t}catch(e){return console.error("Erro na extração manual:",e),null}}(s)}return g.log("Dados JSON extraídos:",t),t}catch(e){return console.error("Erro ao extrair dados JSON da mensagem:",e),null}}(r,a);if(n)return function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(r),g.log("=== DADOS CAPTURADOS DA FICHA ==="),g.log("Dados brutos:",n),Object.keys(n).forEach(e=>{const a=n[e];if(null!=a){const o=`tormenta-20-hotbars-sync-${e}`;localStorage.setItem(o,a),g.log(`Salvando ${o}: ${a}`)}}),g.log("=== FIM DOS DADOS CAPTURADOS ==="),M(),n;throw new Error("Falha ao extrair dados JSON da mensagem")}catch(e){throw console.error("Erro na sincronização de dados:",e),e}}function ae(){const a=document.getElementById("skills-popup");a&&a.remove();const o=document.getElementById("skills-overlay");o&&o.remove();const t=document.createElement("div");t.id="skills-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10000",t.onclick=()=>{document.querySelectorAll('[style*="z-index: 10002"]').forEach(e=>{"fixed"===e.style.position&&e.style.background.includes("rgba(0, 0, 0, 0.9)")&&e.remove()}),t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="skills-popup",s.className="roll20-popup",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #6ec6ff",s.style.borderRadius="12px",s.style.padding="18px 20px 16px 20px",s.style.zIndex="10001",s.style.maxWidth="340px",s.style.maxHeight="480px",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="10px",r.style.width="100%";const n=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{document.querySelectorAll('[style*="z-index: 10002"]').forEach(e=>{"fixed"===e.style.position&&e.style.background.includes("rgba(0, 0, 0, 0.9)")&&e.remove()}),s.remove();const e=document.getElementById("skills-overlay");e&&e.remove()}}),i=document.createElement("h3");i.textContent="Perícias",i.style.color="#ecf0f1",i.style.margin="0",i.style.fontSize="17px",i.style.fontWeight="bold",r.appendChild(i),r.appendChild(n.render()),s.appendChild(r);const c=x({placeholder:"Filtrar perícias...",theme:"blue",onInput:()=>{u()},onClear:()=>{u()}});s.appendChild(c.container);const d=z("skill");s.appendChild(d);const l=[{nome:"Acrobacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Acrobacia}}{{theroll=[[1d20+[[@{${I()}|acrobaciatotal}]]]]}}`},{nome:"Adestramento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Adestramento}}{{theroll=[[1d20+[[@{${I()}|adestramentototal}]]]]}}`},{nome:"Atletismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Atletismo}}{{theroll=[[1d20+[[@{${I()}|atletismototal}]]]]}}`},{nome:"Atuação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Atuação}}{{theroll=[[1d20+[[@{${I()}|atuacaototal}]]]]}}`},{nome:"Cavalgar",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Cavalgar}}{{theroll=[[1d20+[[@{${I()}|cavalgartotal}]]]]}}`},{nome:"Conhecimento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Conhecimento}}{{theroll=[[1d20+[[@{${I()}|conhecimentototal}]]]]}}`},{nome:"Cura",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Cura}}{{theroll=[[1d20+[[@{${I()}|curatotal}]]]]}}`},{nome:"Diplomacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Diplomacia}}{{theroll=[[1d20+[[@{${I()}|diplomaciatotal}]]]]}}`},{nome:"Enganação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Enganação}}{{theroll=[[1d20+[[@{${I()}|enganacaototal}]]]]}}`},{nome:"Fortitude",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Fortitude}}{{theroll=[[1d20+[[@{${I()}|fortitudetotal}]]]]}}`},{nome:"Furtividade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Furtividade}}{{theroll=[[1d20+[[@{${I()}|furtividadetotal}]]]]}}`},{nome:"Guerra",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Guerra}}{{theroll=[[1d20+[[@{${I()}|guerratotal}]]]]}}`},{nome:"Iniciativa",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Iniciativa}}{{theroll=[[1d20+[[@{${I()}|iniciativatotal}]] &{tracker}]]}}`},{nome:"Intimidação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Intimidação}}{{theroll=[[1d20+[[@{${I()}|intimidacaototal}]]]]}}`},{nome:"Intuição",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Intuição}}{{theroll=[[1d20+[[@{${I()}|intuicaototal}]]]]}}`},{nome:"Investigação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Investigação}}{{theroll=[[1d20+[[@{${I()}|investigacaototal}]]]]}}`},{nome:"Jogatina",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Jogatina}}{{theroll=[[1d20+[[@{${I()}|jogatinatotal}]]]]}}`},{nome:"Ladinagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Ladinagem}}{{theroll=[[1d20+[[@{${I()}|ladinagemtotal}]]]]}}`},{nome:"Luta",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Luta}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`},{nome:"Misticismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Misticismo}}{{theroll=[[1d20+[[@{${I()}|misticismototal}]]]]}}`},{nome:"Nobreza",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Nobreza}}{{theroll=[[1d20+[[@{${I()}|nobrezatotal}]]]]}}`},{nome:"Ofício",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Ofício @{${I()}|oficionome}}}{{theroll=[[1d20+[[@{${I()}|oficiototal}]]]]}}`},{nome:"Percepção",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Percepção}}{{theroll=[[1d20+[[@{${I()}|percepcaototal}]]]]}}`},{nome:"Pilotagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Pilotagem}}{{theroll=[[1d20+[[@{${I()}|pilotagemtotal}]]]]}}`},{nome:"Pontaria",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Pontaria}}{{theroll=[[1d20+[[@{${I()}|pontariatotal}]]]]}}`},{nome:"Reflexos",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Reflexos}}{{theroll=[[1d20+[[@{${I()}|reflexostotal}]]]]}}`},{nome:"Religião",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Religião}}{{theroll=[[1d20+[[@{${I()}|religiaototal}]]]]}}`},{nome:"Sobrevivência",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Sobrevivência}}{{theroll=[[1d20+[[@{${I()}|sobrevivenciatotal}]]]]}}`},{nome:"Vontade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Vontade}}{{theroll=[[1d20+[[@{${I()}|vontadetotal}]]]]}}`}],m=document.createElement("div");function u(){document.querySelectorAll('[style*="z-index: 10002"]').forEach(e=>{"fixed"===e.style.position&&e.style.background.includes("rgba(0, 0, 0, 0.9)")&&e.remove()});const a=c.getValue().trim().toLowerCase(),o=R();let t=l.filter(e=>e.nome.toLowerCase().includes(a));const s=[...t.filter(e=>o.includes(e.nome)),...t.filter(e=>!o.includes(e.nome))];if(m.innerHTML="",0===s.length&&a.length>0){const e=ye(a,"perícia","blue");return void m.appendChild(e)}s.forEach(a=>{const t=o.includes(a.nome),s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.gap="8px",s.style.background=t?"rgba(110, 198, 255, 0.1)":"transparent",s.style.borderRadius="6px",s.style.padding="2px";const r=document.createElement("button"),n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.width="100%",n.style.padding="0 8px";const i=document.createElement("span");i.textContent=a.nome,i.style.textAlign="center",i.style.fontWeight="bold",n.appendChild(i),r.appendChild(n),r.style.flex="1",r.style.background="#23243a",r.style.color="#fff",r.style.border="1px solid #6ec6ff",r.style.borderRadius="6px",r.style.padding="8px 0",r.style.fontSize="15px",r.style.fontWeight="bold",r.style.cursor="pointer",r.style.transition="all 0.2s",r.onmouseover=()=>{r.style.background="#6ec6ff",r.style.color="#23243a"},r.onmouseout=()=>{r.style.background="#23243a",r.style.color="#fff"};let c=null,d=null;r.onmouseenter=()=>{const e=xe[a.nome];if(!e||!e.descricao)return;c&&(c.hide(),c=null),d&&(clearTimeout(d),d=null);const o=e.descricao,t={title:a.nome,description:o,theme:"blue",tags:[{text:"Perícia",bgColor:"#6ec6ff",color:"#23243a"}]};c=C(t),c.show(r)},r.onmouseleave=()=>{c&&(c.hide(),c=null)},r.onclick=e=>{c&&(c.hide(),c=null),e.ctrlKey?we(a.nome):(Z(a.comando),Ce())};const l=document.createElement("button");l.innerHTML=t?"📌":"📍",l.style.background="none",l.style.border="none",l.style.color=t?"#6ec6ff":"#666",l.style.fontSize="14px",l.style.cursor="pointer",l.style.padding="4px",l.style.borderRadius="4px",l.style.transition="all 0.2s",l.style.minWidth="24px",l.style.height="24px",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="center",l.title=t?"Remover dos favoritos":"Adicionar aos favoritos",l.onmouseover=()=>{l.style.background="rgba(110, 198, 255, 0.2)",l.style.color="#6ec6ff"},l.onmouseout=()=>{l.style.background="none",l.style.color=t?"#6ec6ff":"#666"},l.onclick=o=>{o.stopPropagation(),function(a){const o=R(),t=o.indexOf(a);t>-1?(o.splice(t,1),_(`Skill "${a}" removida dos favoritos.`)):(o.push(a),A(`Skill "${a}" adicionada aos favoritos!`)),function(a){try{localStorage.setItem(e,JSON.stringify(a))}catch(e){g.log("Erro ao salvar favoritos:",e)}}(o)}(a.nome),u()},s.appendChild(r),s.appendChild(l),m.appendChild(s)})}m.style.display="flex",m.style.flexDirection="column",m.style.gap="6px",m.style.marginTop="2px",s.appendChild(m),u(),document.body.appendChild(s),S(s,"blue")}const oe=e=>({nome:e.nome,comando:e.comando,onClick:()=>function(e,a){const o=document.getElementById("spell-cast-popup");o&&o.remove();const t=document.getElementById("spell-cast-overlay");t&&t.remove();const s=document.createElement("div");s.id="spell-cast-overlay",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.background="rgba(0,0,0,0.5)",s.style.zIndex="10002",s.onclick=()=>{s.remove(),r.remove()},document.body.appendChild(s);const r=document.createElement("div");r.id="spell-cast-popup",r.className="roll20-modal roll20-popup-purple",r.style.position="fixed",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.background="rgba(30,30,40,0.98)",r.style.border="2px solid #6ec6ff",r.style.borderRadius="12px",r.style.padding="20px",r.style.zIndex="10003",r.style.maxWidth="500px",r.style.maxHeight="600px",r.style.overflowY="auto",r.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="stretch";const n=document.createElement("div");n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.marginBottom="15px",n.style.width="100%";const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="flex-start",i.style.gap="2px";const c=document.createElement("h3");c.textContent=a,c.style.color="#ecf0f1",c.style.margin="0",c.style.fontSize="18px",c.style.fontWeight="bold",i.appendChild(c);const d=document.createElement("div");function l(e,a,o){const t=document.createElement("span");return t.textContent=e,t.style.background=o,t.style.color=a,t.style.fontSize="11px",t.style.fontWeight="bold",t.style.borderRadius="12px",t.style.padding="3px 8px",t.style.display="inline-block",t.style.letterSpacing="0.3px",t.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)",t.style.border="1px solid rgba(255,255,255,0.1)",t}d.style.display="flex",d.style.flexWrap="wrap",d.style.gap="6px",d.style.marginTop="8px";const m=function(e){return{"Luz Sagrada":{tipo:"Divina",ciclo:1,escola:"Evocação"},"Sombras Profanas":{tipo:"Universal",ciclo:1,escola:"Necromancia"},"Cura Ferimentos Leves":{tipo:"Divina",ciclo:1,escola:"Cura"},"Proteção Divina":{tipo:"Divina",ciclo:1,escola:"Abjuração"},"Bênção":{tipo:"Divina",ciclo:1,escola:"Encantamento"},"Raio de Energia":{tipo:"Arcana",ciclo:1,escola:"Evocação"},"Escudo Mágico":{tipo:"Arcana",ciclo:1,escola:"Abjuração"},"Disfarce Ilusório":{tipo:"Arcana",ciclo:1,escola:"Ilusão"},"Detectar Magia":{tipo:"Universal",ciclo:1,escola:"Adivinhação"},"Compreender Idiomas":{tipo:"Universal",ciclo:1,escola:"Adivinhação"},"Cura Ferimentos Moderados":{tipo:"Divina",ciclo:2,escola:"Cura"},"Silêncio":{tipo:"Divina",ciclo:2,escola:"Ilusão"},"Bola de Fogo":{tipo:"Arcana",ciclo:3,escola:"Evocação"},"Relâmpago":{tipo:"Arcana",ciclo:3,escola:"Evocação"},Invisibilidade:{tipo:"Arcana",ciclo:2,escola:"Ilusão"},"Sugestão":{tipo:"Arcana",ciclo:2,escola:"Encantamento"},"Dissipar Magia":{tipo:"Universal",ciclo:3,escola:"Abjuração"},Voo:{tipo:"Arcana",ciclo:3,escola:"Transmutação"},Teleporte:{tipo:"Arcana",ciclo:4,escola:"Conjuração"},"Ressurreição":{tipo:"Divina",ciclo:5,escola:"Cura"},Meteoro:{tipo:"Arcana",ciclo:6,escola:"Evocação"}}[e]||{}}(e);if(m.tipo){const e=l(m.tipo,"#23243a","Arcana"===m.tipo?"#9c27b0":"#ff9800");d.appendChild(e)}if(m.ciclo){const e=l(`${m.ciclo}º Círculo`,"#23243a","#2196f3");d.appendChild(e)}if(m.escola){const e=l(m.escola,"#23243a","#4caf50");d.appendChild(e)}if("Luz Sagrada"===e){const e=l("Aggelus","#23243a","#6ec6ff");d.appendChild(e)}else if("Sombras Profanas"===e){const e=l("Sulfure","#23243a","#6ec6ff");d.appendChild(e)}i.appendChild(d),n.appendChild(i);const u=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{r.remove();const e=document.getElementById("spell-cast-overlay");e&&e.remove()}});n.appendChild(u.render()),r.appendChild(n);const p=document.createElement("div");p.style.background="#1a1a2e",p.style.border="1px solid #6ec6ff",p.style.borderRadius="8px",p.style.padding="12px",p.style.marginBottom="15px",p.style.display="grid",p.style.gridTemplateColumns="1fr 1fr",p.style.gap="8px",[{label:"Tipo",value:"Universal"},{label:"Execução",value:"Padrão"},{label:"Duração",value:"Cena"},{label:"Alcance",value:"Curto"},{label:"Área/Alvo",value:"1 Objeto"},{label:"Resistência",value:"Vontade"}].forEach(e=>{const a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.gap="2px";const o=document.createElement("span");o.textContent=e.label,o.style.color="#6ec6ff",o.style.fontSize="11px",o.style.fontWeight="bold",o.style.textTransform="uppercase";const t=document.createElement("span");t.textContent=e.value,t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.fontWeight="bold",a.appendChild(o),a.appendChild(t),p.appendChild(a)}),r.appendChild(p);const g=document.createElement("div");g.style.background="#1a1a2e",g.style.border="1px solid #6ec6ff",g.style.borderRadius="8px",g.style.padding="12px",g.style.marginBottom="15px",g.style.display="flex",g.style.flexDirection="column",g.style.gap="6px";const f=document.createElement("div");f.textContent="Descrição",f.style.color="#6ec6ff",f.style.fontSize="13px",f.style.fontWeight="bold",f.style.marginBottom="2px",g.appendChild(f);const v=document.createElement("div");v.style.color="#ecf0f1",v.style.fontSize="14px",v.style.lineHeight="1.4","Luz Sagrada"===e?v.textContent="O alvo emite luz (mas não produz calor) em uma área com 6m de raio. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a luz, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Luz anula Escuridão.":"Sombras Profanas"===e&&(v.textContent="O alvo emana sombras em uma área com 6m de raio. Criaturas dentro da área recebem camuflagem leve por escuridão leve. As sombras não podem ser iluminadas por nenhuma fonte de luz natural. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a escuridão, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Escuridão anula Luz."),g.appendChild(v);let y=[];"Luz Sagrada"===e?y=[{label:"+1 PM: aumenta a área iluminada em +3m de raio.",cost:1},{label:"+2 PM: muda a duração para um dia.",cost:2},{label:"+2 PM: muda a duração para permanente e adiciona componente material (pó de rubi no valor de T$ 50). Não pode ser usado em conjunto com outros aprimoramentos. Requer 2º círculo.",cost:2},{label:"+0 PM (Apenas Arcanos): muda o alvo para 1 criatura. Você lança a magia nos olhos do alvo, que fica ofuscado pela cena. Não afeta criaturas cegas.",cost:0},{label:"+2 PM (Apenas Arcanos): muda o alcance para longo e o efeito para cria 4 pequenos globos flutuantes de pura luz. Você pode posicionar os globos onde quiser dentro do alcance. Uma vez por rodada, você pode mover os globos com uma ação livre. Cada um ilumina como uma tocha, mas não produz calor. Se um globo ocupar o espaço de uma criatura, ela fica ofuscada e sua silhueta pode ser vista claramente (ela não recebe camuflagem por escuridão ou invisibilidade). Requer 2º círculo.",cost:2},{label:"+2 PM (Apenas Divinos): a luz é cálida como a do sol. Criaturas que sofrem penalidades e dano pela luz solar sofrem seus efeitos como se estivessem expostas à luz solar real. Seus aliados na área estabilizam automaticamente e ficam imunes à condição sangrando, e seus inimigos ficam ofuscados. Requer 2º círculo.",cost:2},{label:"+5 PM (Apenas Divinos): muda o alcance para toque e o alvo para 1 criatura. Em vez do normal, o alvo é envolto por um halo de luz, recebendo +10 em testes de Diplomacia e redução de trevas 10. Requer 2º círculo.",cost:5}]:"Sombras Profanas"===e&&(y=[{label:"+1 PM: aumenta a área da escuridão em +1,5m de raio.",cost:1},{label:"+2 PM: camuflagem total por escuridão total.",cost:2},{label:"+2 PM: alvo 1 criatura, resistência Fortitude parcial, cego pela cena (requer 2º círculo).",cost:2},{label:"+3 PM: duração de um dia.",cost:3},{label:"+5 PM: alcance pessoal, alvo você, +10 Furtividade/camuflagem (requer 2º círculo).",cost:5}]);const b=document.createElement("div");b.textContent="Aprimoramentos:",b.style.color="#6ec6ff",b.style.fontSize="13px",b.style.fontWeight="bold",b.style.margin="10px 0 4px 0",g.appendChild(b);const h=document.createElement("div");h.style.display="flex",h.style.flexDirection="column",h.style.gap="4px";const x=[];y.forEach((e,a)=>{const o=document.createElement("label");o.style.display="flex",o.style.alignItems="center",o.style.gap="8px";const t=document.createElement("input");t.type="checkbox",t.value=a,x.push(t),o.appendChild(t);const s=document.createElement("span");s.textContent=e.label,s.style.color="#ecf0f1",s.style.fontSize="13px",o.appendChild(s),h.appendChild(o)}),g.appendChild(h);const C=document.createElement("div");function w(){let e=1;x.forEach((a,o)=>{a.checked&&(e+=y[o].cost)}),C.textContent=`Custo total: ${e} PM`}C.style.color="#6ec6ff",C.style.fontWeight="bold",C.style.marginTop="10px",x.forEach(e=>{e.onchange=w}),w(),g.appendChild(C);const q=document.createElement("button");q.textContent="Compartilhar",q.style.background="none",q.style.border="1px solid #6ec6ff",q.style.color="#6ec6ff",q.style.fontSize="14px",q.style.fontWeight="bold",q.style.borderRadius="6px",q.style.padding="8px 0",q.style.marginTop="10px",q.style.width="100%",q.style.cursor="pointer",q.style.transition="all 0.2s",q.onmouseover=()=>{q.style.background="#6ec6ff",q.style.color="#23243a"},q.onmouseout=()=>{q.style.background="none",q.style.color="#6ec6ff"},q.onclick=()=>{const a=$();let o="";"Luz Sagrada"===e?o=`${v.textContent}\n\n    +1 PM: aumenta a área iluminada em +3m de raio.\n\n    +2 PM: muda a duração para um dia.\n\n    +2 PM: muda a duração para permanente e adiciona componente material (pó de rubi no valor de T$ 50). Não pode ser usado em conjunto com outros aprimoramentos. Requer 2º círculo.\n\n    +0 PM (Apenas Arcanos): muda o alvo para 1 criatura. Você lança a magia nos olhos do alvo, que fica ofuscado pela cena. Não afeta criaturas cegas.\n\n    +2 PM (Apenas Arcanos): muda o alcance para longo e o efeito para cria 4 pequenos globos flutuantes de pura luz. Você pode posicionar os globos onde quiser dentro do alcance. Uma vez por rodada, você pode mover os globos com uma ação livre. Cada um ilumina como uma tocha, mas não produz calor. Se um globo ocupar o espaço de uma criatura, ela fica ofuscada e sua silhueta pode ser vista claramente (ela não recebe camuflagem por escuridão ou invisibilidade). Requer 2º círculo.\n\n    +2 PM (Apenas Divinos): a luz é cálida como a do sol. Criaturas que sofrem penalidades e dano pela luz solar sofrem seus efeitos como se estivessem expostas à luz solar real. Seus aliados na área estabilizam automaticamente e ficam imunes à condição sangrando, e seus inimigos ficam ofuscados. Requer 2º círculo.\n\n    +5 PM (Apenas Divinos): muda o alcance para toque e o alvo para 1 criatura. Em vez do normal, o alvo é envolto por um halo de luz, recebendo +10 em testes de Diplomacia e redução de trevas 10. Requer 2º círculo.`:"Sombras Profanas"===e&&(o=`${v.textContent}\n\n    +1 PM: aumenta a área da escuridão em +1,5m de raio.\n\n    +2 PM: muda o efeito para fornecer camuflagem total por escuridão total. As sombras bloqueiam a visão na área e através dela.\n\n    +2 PM: muda o alvo para 1 criatura e a resistência para Fortitude parcial. Você lança a magia nos olhos do alvo, que fica cego pela cena. Se passar na resistência, fica cego por 1 rodada. Requer 2º círculo.\n\n    +3 PM: muda a duração para um dia.\n\n    +5 PM: muda o alcance para pessoal e o alvo para você. Em vez do normal, você é coberto por sombras, recebendo +10 em testes de Furtividade e camuflagem leve. Requer 2º círculo.`),Z(`&{template:spell}{{character=@{${a}|character_name}}}{{spellname=${e}}}{{type=Universal}}{{execution=Padrão}}{{duration=Cena}}{{range=Curto}}{{targetarea=1 Objeto}}{{resistance=Vontade}}{{description=${o}\n    JdA:193}}{{cd=[[@{${a}|cdtotal}+0]]}}`)},g.appendChild(q),r.appendChild(g),document.body.appendChild(r),S(r,"blue")}(e.nome,e.nome,e.comando)});function te(){const e=document.getElementById("misc-popup");e&&e.remove();const a=document.getElementById("misc-overlay");a&&a.remove();const o=document.createElement("div");o.id="misc-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="misc-popup",t.className="roll20-popup roll20-popup-orange",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="400px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Miscelâneos",n.style.color="#ffb86c",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="16px",i.style.marginTop="10px",t.appendChild(i);const c=document.createElement("div");c.style.background="#23243a",c.style.border="1.5px solid #ffb86c",c.style.borderRadius="8px",c.style.padding="16px",c.style.cursor="pointer",c.style.transition="all 0.2s",c.onmouseover=()=>{c.style.background="#2d2e4a"},c.onmouseout=()=>{c.style.background="#23243a"},c.onclick=()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove(),function(){g.log("Abrindo Pratos Especiais");try{const e=document.getElementById("pratos-popup");e&&e.remove();const a=document.getElementById("pratos-overlay");a&&a.remove();const o=document.createElement("div");o.id="pratos-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="pratos-popup",t.className="roll20-popup roll20-popup-orange",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="480px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{t.remove();const e=document.getElementById("pratos-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Pratos Especiais",n.style.color="#ffb86c",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.position="relative",i.style.marginBottom="10px";const c=document.createElement("input");c.type="text",c.placeholder="Filtrar pratos...",c.style.width="100%",c.style.padding="10px 12px",c.style.borderRadius="8px",c.style.border="1px solid #ffb86c",c.style.background="#23243a",c.style.color="#fff",c.style.fontSize="14px",c.style.outline="none",c.style.boxSizing="border-box",c.style.fontSize="15px",i.appendChild(c),t.appendChild(i);const d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.gap="14px",d.style.marginTop="10px",t.appendChild(d);const l=[{nome:"Assado de Carnes",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_60.jpg",raridade:"Comum",descricao:"Um prato muito apreciado no Reinado, mas mal visto no Império de Tauron. Pura proteína, deixa qualquer um mais forte.",bonus:"+2 em rolagens de dano corpo a corpo.",preco:"T$ 30",ingredientes:"Carne, carne de caça, porco",custoIngredientes:"T$ 56",cdTeste:"20",icone:"🥩"},{nome:"Balinhas",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_halloween_candy_01.jpg",raridade:"Comum",descricao:"Balas coloridas e doces. Arcanistas gostam — dizem que o açúcar feérico usado nas balinhas potencializa suas magias.",bonus:"+2 em rolagens de dano de magias.",preco:"T$ 30",ingredientes:"Açúcar das fadas, fruta",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍬"},{nome:"Banquete dos Heróis",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_cauldron_frost.jpg",raridade:"Comum",descricao:"Uma mesa repleta das melhores comidas que o dinheiro pode pagar.",bonus:"+1 em um atributo a sua escolha. Esse aumento não oferece PV, PM e perícias adicionais.",preco:"T$ 150",ingredientes:"Carne de caça, ovo de monstro, avelã de Norba",custoIngredientes:"T$ 82",cdTeste:"25",icone:"🍽️"},{nome:"Batata Valkariana",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_103_potatobread.jpg",raridade:"Comum",descricao:"Batatas cortadas em tiras e mergulhadas em óleo fervente. Gordurentas e pouco nutritivas, são o tipo de prato que só é servido numa metrópole como Valkaria. Apesar disso, são saborosas e deixam qualquer um empolgado.",bonus:"+1d6 em um teste a sua escolha realizado até o fim do dia.",preco:"T$ 2",ingredientes:"Óleo, legume",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍟"},{nome:"Bolo de Cenoura",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_fishcake.jpg",raridade:"Comum",descricao:'Uma sobremesa simples, que "faz bem para a vista", segundo anciões de todo o Reinado. Aparentemente, os anciões estão certos, pois o bolo de cenoura fornece +2 em testes de Percepção.',bonus:"+2 em testes de Percepção.",preco:"T$ 4",ingredientes:"Farinha, fruta, óleo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍰"},{nome:"Bolo do Panteão",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_144_cakeslice.jpg",raridade:"Comum",descricao:"Uma sobremesa divina! Este bolo de gorad é preparado com os melhores ingredientes, por isso é caríssimo, servido apenas em banquetes reais — ou em tavernas que atendem aventureiros famosos. Dizem que o gorad usado no bolo é uma das fontes de energia do Panteão.",bonus:"Seu custo para ativar habilidades e lançar magias diminui em -1 PM (mínimo 1).",preco:"T$ 150",ingredientes:"Açúcar das fadas, avelã de Norba, farinha, gorad",custoIngredientes:"T$ 121",cdTeste:"25",icone:"🍰"},{nome:"Ensopado Reforçado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Um prato nutritivo, mas pesado.",bonus:"+20 PV temporários, mas seu deslocamento diminui em –1,5m.",preco:"T$ 6",ingredientes:"Cereal, porco, verdura",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍲"},{nome:"Estrogonofe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_sauteedcarrots.jpg",raridade:"Comum",descricao:"Essa iguaria deliciosa foi inventada nas cortes do antigo Reino de Yudennach — dizem que é uma das poucas coisas boas a sair daquele lugar. Comer estrogonofe deixa você firme em suas convicções.",bonus:"+2 em testes de Vontade.",preco:"T$ 12",ingredientes:"Carne, cogumelo, leite",custoIngredientes:"T$ 22",cdTeste:"15",icone:"🍲"},{nome:"Fritada Monstruosa",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_06.jpg",raridade:"Comum",descricao:"A receita é simples — o segredo está nos ingredientes. Feita com ovos de monstros, esta omelete é extremamente nutritiva.",bonus:"+10 PV temporários.",preco:"T$ 30",ingredientes:"Ovo de monstro, óleo",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍳"},{nome:"Futomaki",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_161_fish_white.jpg",raridade:"Comum",descricao:"Criado no Império de Jade, este prato consiste em um rolo de arroz recheado com peixes, folhas e raízes. Uma refeição elegante, que deixa todos dispostos a dialogar.",bonus:"+2 em testes de Diplomacia.",preco:"T$ 12",ingredientes:"Cereal, peixe",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🍣"},{nome:"Gorad Quente",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_meat_cooked_08.jpg",raridade:"Comum",descricao:"Gorad e leite, servidos fumegando. Não tem erro. O gorad ativa o cérebro.",bonus:"+2 PM temporários.",preco:"T$ 18",ingredientes:"Gorad, leite",custoIngredientes:"T$ 31",cdTeste:"20",icone:"🥛"},{nome:"Gorvelã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cask_04.jpg",raridade:"Comum",descricao:"Gorad com avelã de Norba. É uma sobremesa cara, mas deliciosa.",bonus:"+5 PM temporários.",preco:"T$ 42",ingredientes:"Gorad, avelã de Norba",custoIngredientes:"T$ 70",cdTeste:"25",icone:"🍰"},{nome:"Macarrão de Yuvalin",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_90_cinnamonbonefishstew.jpg",raridade:"Comum",descricao:"Yuvalin é uma cidade mineradora em Zakharov, na fronteira com as Montanhas Uivantes. Seus habitantes criaram este prato reforçado (macarrão, bacon e creme de leite) para encarar suas árduas jornadas de trabalho nas minas. Deliciosa, a receita se espalhou por outras cidades e reinos.",bonus:"+5 PV temporários.",preco:"T$ 6",ingredientes:"Farinha, leite, porco",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍝"},{nome:"Pão de Queijo",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_orchardfruit01.jpg",raridade:"Comum",descricao:"Um bom pão de queijo deixa qualquer aventureiro bem nutrido e saudável.",bonus:"+2 em testes de Fortitude.",preco:"T$ 10",ingredientes:"Farinha, queijo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🥨"},{nome:"Pizza",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_deliciouspizza.jpg",raridade:"Comum",descricao:"Um disco de massa coberto com molho de tomate e queijo, este prato foi criado por Guido Venusto, um nobre de Ahlen que queria ascender socialmente. Inepto nas artes da intriga, Venusto resolveu manipular a corte pela barriga. Funcionou — o prato foi um sucesso e o nobre cozinheiro teve muita influência por anos. Certa noite, um espião conseguiu roubar a receita. O segredo da pizza se espalhou e, sem seu trunfo, Venusto foi assassinado logo depois. Comer uma pizza deixa-o pronto para encarar qualquer perigo.",bonus:"+1 em todos os testes de resistência.",preco:"T$ 6",ingredientes:"Farinha, fruta, queijo",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍕"},{nome:"Porco Assado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_123_roast.jpg",raridade:"Comum",descricao:"Um prato típico e popular em Deheon, que já se alastrou pelo Reinado. Comer um porco assado o deixa valente e brigão.",bonus:"+1 em testes de Luta.",preco:"T$ 36",ingredientes:"Porco, frutas, legume",custoIngredientes:"T$ 12",cdTeste:"15",icone:"🍖"},{nome:"Prato do Aventureiro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_fish_18.jpg",raridade:"Comum",descricao:"Um cozido de frango com legumes, esta é uma refeição simples, mas mantém qualquer um bem alimentado.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de vida em +1 por nível.",preco:"T$ 2",ingredientes:"Ave, legume",custoIngredientes:"T$ 5",cdTeste:"10",icone:"🍲"},{nome:"Salada de Salistick",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Com folhas e carne de frango, esta salada foi criada no Reino dos Médicos, onde a saúde é uma grande preocupação. Uma alimentação leve, mas nutritiva.",bonus:"Aumenta seu deslocamento em +1,5m (1 quadrado).",preco:"T$ 4",ingredientes:"Ave, fruta, legume",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🥗"},{nome:"Salada Élfica",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Esta salada vegetariana leva uma mistura de folhas, frutas e legumes. Segundo os relatos, a receita foi inventada em Lenórienn e passada aos reinos humanos de Lamnor, antes do isolamento dos povos. Felizmente, a salada se espalhou por Arton antes da queda do continente. Um prato leve e equilibrado, inspira disparos precisos.",bonus:"+1 em testes de Pontaria.",preco:"T$ 4",ingredientes:"Fruta, legume, verdura",custoIngredientes:"T$ 5",cdTeste:"15",icone:"🥗"},{nome:"Salada Imperial",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_braisedturtle.jpg",raridade:"Comum",descricao:"Uma mistura de folhas com bacon e queijo, esta salada é leve, mas empolgante.",bonus:"+2 em testes de Iniciativa.",preco:"T$ 6",ingredientes:"Porco, queijo, verdura",custoIngredientes:"T$ 15",cdTeste:"15",icone:"🥗"},{nome:"Sashimi",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_valleystirfry.jpg",raridade:"Comum",descricao:"Uma iguaria da culinária tamuraniana, este prato consiste de peixes e frutos do mar fatiados em pequenos pedaços e servidos com um molho típico do Império de Jade. Uma refeição refinada, leve e equilibrada.",bonus:"+2 em rolagens de dano à distância.",preco:"T$ 22",ingredientes:"Peixe, molho tamuraniano",custoIngredientes:"T$ 37",cdTeste:"20",icone:"🍣"},{nome:"Sopa de Cogumelos",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_slime_02.jpg",raridade:"Comum",descricao:"Esta sopa expande sua percepção mística.",bonus:"+2 em testes de Misticismo.",preco:"T$ 6",ingredientes:"Cogumelo, legume, verdura",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍲"},{nome:"Sopa de Peixe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_63.jpg",raridade:"Comum",descricao:"Um cozido de peixe com verduras, é um prato simples e humilde, mas garante descanso relaxante.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de mana em +1 por nível.",preco:"T$ 3",ingredientes:"Verdura, peixe",custoIngredientes:"T$ 8",cdTeste:"10",icone:"🍲"},{nome:"Torta de Maçã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_10.jpg",raridade:"Comum",descricao:"Dizem que, após uma bruxa usar uma maçã envenenada para matar uma princesa, Thantalla-Dhaedelin, a Rainha das Fadas, decretou que maçãs nunca mais fariam mal a ninguém. Se a lenda é verdade, ou se maçãs são simplesmente saudáveis, ninguém sabe dizer, mas comer este prato fornece resistência a veneno +5.",bonus:"Resistência a veneno +5.",preco:"T$ 2",ingredientes:"Farinha, fruta",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍰"},{nome:"Baga Celeste Cozida",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Encontradas originalmente nas encostas invertidas de Vectora, estas bagas se espalharam por toda Arton. Quando preparadas adequadamente, fornecem qualidades místicas de flutuação.",bonus:"Todo dano de queda que você sofre é reduzido em −1d6.",preco:"T$ 25",ingredientes:"Fruta, especiaria",custoIngredientes:"T$ 35",cdTeste:"20",icone:"🌟"},{nome:"Cozido de Pimenta",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_159_fish_82.jpg",raridade:"Comum",descricao:"Um prato forte, capaz de trazer lágrimas aos olhos do mais resistente dos comensais.",bonus:"+1 em Fortitude (cumulativo com outros itens) e +1 na rolagem do D20 para testes da perícia Fortitude.",preco:"T$ 15",ingredientes:"Legume, especiaria",custoIngredientes:"T$ 12",cdTeste:"18",icone:"🌶️"},{nome:"Manjar de Sombras",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_80_ravenberrytart.jpg",raridade:"Comum",descricao:"A origem da receita original deste prato se perdeu, mas sua essência se manteve inalterada. Consiste de um manjar com ingredientes cultivados em terras próximas de cemitérios, que protege o corpo contra energias sombrias.",bonus:"Você ignora os próximos 10 pontos de dano de trevas que sofrer.",preco:"T$ 40",ingredientes:"Cereal, especiaria, verdura",custoIngredientes:"T$ 28",cdTeste:"22",icone:"🌑"}];function m(e=""){d.innerHTML="";const a=l.filter(a=>a.nome.toLowerCase().includes(e.toLowerCase())||a.descricao.toLowerCase().includes(e.toLowerCase())||a.bonus.toLowerCase().includes(e.toLowerCase())),o=ce();if(a.sort((e,a)=>{const t=o.includes(e.nome),s=o.includes(a.nome);return t&&!s?-1:!t&&s?1:e.nome.localeCompare(a.nome)}),a.forEach(e=>{const a=ve(e,"food",()=>m(c.value));d.appendChild(a)}),0===a.length&&e.length>0){const a=ye(e,"prato especial","orange");d.appendChild(a)}}c.addEventListener("input",()=>{m(c.value)}),m(),document.body.appendChild(t),S(t,"orange")}catch(u){console.error("Erro ao abrir Pratos Especiais:",u),alert("Erro ao abrir Pratos Especiais. Veja o console para detalhes.")}}()};const d=document.createElement("div");d.textContent="Pratos Especiais",d.style.color="#ffb86c",d.style.fontSize="16px",d.style.fontWeight="bold",d.style.marginBottom="6px",c.appendChild(d);const l=document.createElement("div");l.textContent="Comidas raras que concedem bônus únicos. Disponibilidade e efeitos definidos pelo mestre.",l.style.color="#ecf0f1",l.style.fontSize="13px",c.appendChild(l),i.appendChild(c);const m=document.createElement("div");m.style.background="#23243a",m.style.border="1.5px solid #ffb86c",m.style.borderRadius="8px",m.style.padding="16px",m.style.cursor="pointer",m.style.transition="all 0.2s",m.onmouseover=()=>{m.style.background="#2d2e4a"},m.onmouseout=()=>{m.style.background="#23243a"},m.onclick=()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove(),function(){g.log("Abrindo Bebidas Artonianas");try{const e=document.getElementById("bebidas-popup");e&&e.remove();const a=document.getElementById("bebidas-overlay");a&&a.remove();const o=document.createElement("div");o.id="bebidas-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="bebidas-popup",t.className="roll20-popup roll20-popup-orange",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="480px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{t.remove();const e=document.getElementById("bebidas-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Bebidas Artonianas",n.style.color="#ffb86c",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.position="relative",i.style.marginBottom="10px";const c=document.createElement("input");c.type="text",c.placeholder="Filtrar bebidas...",c.style.width="100%",c.style.padding="10px 12px",c.style.borderRadius="8px",c.style.border="1px solid #ffb86c",c.style.background="#23243a",c.style.color="#fff",c.style.fontSize="14px",c.style.outline="none",c.style.boxSizing="border-box",c.style.fontSize="15px",i.appendChild(c),t.appendChild(i);const d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.gap="14px",d.style.marginTop="10px",t.appendChild(d);const l=[{nome:"Baba de Troll",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_136.jpg",tipo:"Não alcoólica",descricao:"Uma bebida sem álcool, à base de leite, castanhas, nozes e mel.",efeito:"+1d4 em um teste à sua escolha até o fim do dia.",cd:"—",icone:"🧃"},{nome:"Barba Queimada",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_05.jpg",tipo:"Alcoólica",descricao:"Forte e amarga, esta cerveja anã fortalece o corpo e o espírito.",efeito:"Redução de Dano 2.",cd:"20",icone:"🍺"},{nome:"Cerveja Deheoni",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_08.jpg",tipo:"Alcoólica",descricao:"A bebida mais comum nas tavernas do Reinado.",efeito:"+1 em testes de resistência.",cd:"15",icone:"🍻"},{nome:"Dilínio",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_11.jpg",tipo:"Alcoólica",descricao:"Destilado tradicional de Mortenstenn, feito com um cereal que só cresce no continente sul. A receita se perdeu após as invasões duyshidakk, e poucos barris chegaram ao Reinado.",efeito:"O limite de gasto de PM aumenta em +1.",cd:"20",observacao:"Não pode ser fabricado",icone:"🥃"},{nome:"Grogue Negro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_12.jpg",tipo:"Alcoólica",descricao:"Rum misturado com especiarias. Seu nome vem de sua origem — piratas do Conclave, que atuam no Mar Negro — e não da cor da bebida, que é dourada clara.",efeito:"Quando você usa Audácia, o bônus fornecido pelo poder aumenta em +1.",cd:"15",icone:"🏴‍☠️"},{nome:"Grogue Rubro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_13.jpg",tipo:"Alcoólica",descricao:"Variação do grogue negro, com especiarias picantes que fazem a bebida adquirir uma coloração avermelhada — e quem a bebe, certa inclinação para a violência.",efeito:"Você pode usar Audácia para testes de ataque.",cd:"20",icone:"🔥"},{nome:"Hidromel Uivante",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_14.jpg",tipo:"Alcoólica",descricao:"Fabricada nas montanhas geladas, esta bebida aquece e incita.",efeito:"+2 em rolagens de dano corpo a corpo.",cd:"20",icone:"❄️"},{nome:"Licor Feérico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_15.jpg",tipo:"Alcoólica",descricao:"De aparência enevoada e gosto adocicado, dizem que é feito na Pondsmânia e trazido com dificuldade ao Reinado. Alguns acham que é invenção dos taverneiros, até provarem uma dose.",efeito:"Escolha uma habilidade. O custo para ativá-la diminui em –1 PM.",cd:"25",icone:"✨"},{nome:"Sidra Ahleniense",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_16.jpg",tipo:"Alcoólica",descricao:"Esta bebida doce deixa qualquer um mais falante.",efeito:"+2 em testes de perícias originalmente baseadas em Carisma.",cd:"15",icone:"🍏"},{nome:"Vinho Pruss",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_17.jpg",tipo:"Alcoólica",descricao:"Batizado em homenagem ao antigo Rei-Imperador Thormy — dizem que era o favorito do monarca.",efeito:"Concede 3 pontos de mana temporários.",cd:"15",icone:"🍷"},{nome:"Vinho Élfico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_18.jpg",tipo:"Alcoólica",descricao:"De sabor complexo, aguça a mente.",efeito:"+1 na CD para resistir às suas habilidades.",cd:"20",icone:"🌿"}];function m(e=""){d.innerHTML="";const a=l.filter(a=>a.nome.toLowerCase().includes(e.toLowerCase())||a.descricao.toLowerCase().includes(e.toLowerCase())||a.efeito.toLowerCase().includes(e.toLowerCase())),o=de();if(a.sort((e,a)=>{const t=o.includes(e.nome),s=o.includes(a.nome);return t&&!s?-1:!t&&s?1:e.nome.localeCompare(a.nome)}),a.forEach(e=>{const a=ve(e,"drink",()=>m(c.value));d.appendChild(a)}),0===a.length&&e.length>0){const a=ye(e,"bebida artoniana","orange");d.appendChild(a)}}c.addEventListener("input",()=>{m(c.value)}),m(),document.body.appendChild(t),S(t,"orange")}catch(u){console.error("Erro ao abrir Bebidas Artonianas:",u),alert("Erro ao abrir Bebidas Artonianas. Veja o console para detalhes.")}}()};const u=document.createElement("div");u.textContent="Bebidas Artonianas",u.style.color="#ffb86c",u.style.fontSize="16px",u.style.fontWeight="bold",u.style.marginBottom="6px",m.appendChild(u);const p=document.createElement("div");p.textContent="Bebidas alcoólicas e não alcoólicas que concedem bônus únicos. Efeitos duram 24 horas.",p.style.color="#ecf0f1",p.style.fontSize="13px",m.appendChild(p),i.appendChild(m);const f=document.createElement("div");f.style.background="#23243a",f.style.border="1.5px solid #ffb86c",f.style.borderRadius="8px",f.style.padding="16px",f.style.cursor="pointer",f.style.transition="all 0.2s",f.onmouseover=()=>{f.style.background="#2d2e4a"},f.onmouseout=()=>{f.style.background="#23243a"},f.onclick=()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove(),function(){const e=document.getElementById("conditions-popup");e&&e.remove();const a=document.getElementById("conditions-overlay");a&&a.remove();const o=document.createElement("div");o.id="conditions-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="conditions-popup",t.className="roll20-popup roll20-popup-orange",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="450px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px";const r=document.createElement("h3");r.textContent="Condições",r.style.color="#ffb86c",r.style.margin="0",r.style.fontSize="18px",r.style.fontWeight="bold";const n=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{t.remove();const e=document.getElementById("conditions-overlay");e&&e.remove()}});s.appendChild(r),s.appendChild(n.render()),t.appendChild(s);const i=x({placeholder:"Buscar condições...",theme:"orange",marginBottom:"12px",onInput:e=>{d(e)}});t.appendChild(i.container);const c=document.createElement("div");function d(e){const a=da().filter(a=>!e||a.nome.toLowerCase().includes(e.toLowerCase())||a.descricao.toLowerCase().includes(e.toLowerCase())||a.efeitos.toLowerCase().includes(e.toLowerCase()));c.innerHTML="",a.forEach(e=>{const a=window.Roll20Components.createFavoritableCardWithPreset("condition",{title:e.nome,summary:fe(e.descricao),efeitos:e.efeitos,onClick:()=>{w(e)}});c.appendChild(a.render())})}c.id="conditions-list",c.style.display="flex",c.style.flexDirection="column",c.style.gap="8px",d(""),t.appendChild(c),document.body.appendChild(t),S(t,"orange")}()};const v=document.createElement("div");v.textContent="Lista de Condições",v.style.color="#ffb86c",v.style.fontSize="16px",v.style.fontWeight="bold",v.style.marginBottom="6px",f.appendChild(v);const y=document.createElement("div");y.textContent="Condições que afetam o personagem.",y.style.color="#ecf0f1",y.style.fontSize="13px",f.appendChild(y),i.appendChild(f);const b=document.createElement("div");b.style.background="#23243a",b.style.border="1.5px solid #ffb86c",b.style.borderRadius="8px",b.style.padding="16px",b.style.cursor="pointer",b.style.transition="all 0.2s",b.onmouseover=()=>{b.style.background="#2d2e4a"},b.onmouseout=()=>{b.style.background="#23243a"},b.onclick=()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove(),function(){g.log("Abrindo Poções");try{const e=document.getElementById("pocoes-popup");e&&e.remove();const a=document.getElementById("pocoes-overlay");a&&a.remove();const o=document.createElement("div");o.id="pocoes-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="pocoes-popup",t.className="roll20-popup roll20-popup-orange",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="480px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{t.remove();const e=document.getElementById("pocoes-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Poções",n.style.color="#ffb86c",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.position="relative",i.style.marginBottom="10px";const c=document.createElement("input");c.type="text",c.placeholder="Filtrar poções...",c.style.width="100%",c.style.padding="10px 12px",c.style.borderRadius="8px",c.style.border="1px solid #ffb86c",c.style.background="#23243a",c.style.color="#fff",c.style.fontSize="14px",c.style.outline="none",c.style.boxSizing="border-box",c.style.fontSize="15px",i.appendChild(c),t.appendChild(i);const d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.gap="14px",d.style.marginTop="10px",t.appendChild(d);const l=me();function m(e=""){d.innerHTML="";const a=l.filter(a=>a.nome.toLowerCase().includes(e.toLowerCase())||a.descricao.toLowerCase().includes(e.toLowerCase())||a.efeito.toLowerCase().includes(e.toLowerCase())||a.tipo.toLowerCase().includes(e.toLowerCase())),o=le();if(a.sort((e,a)=>{const t=o.includes(e.nome),s=o.includes(a.nome);return t&&!s?-1:!t&&s?1:e.nome.localeCompare(a.nome)}),a.forEach(e=>{const a=ve(e,"potion",()=>m(c.value));d.appendChild(a)}),0===a.length&&e.length>0){const a=ye(e,"poção","orange");d.appendChild(a)}}c.addEventListener("input",()=>{m(c.value)}),m(),document.body.appendChild(t),S(t,"orange")}catch(u){console.error("Erro ao abrir Poções:",u),alert("Erro ao abrir Poções. Veja o console para detalhes.")}}()};const h=document.createElement("div");h.textContent="Poções",h.style.color="#ffb86c",h.style.fontSize="16px",h.style.fontWeight="bold",h.style.marginBottom="6px",b.appendChild(h);const C=document.createElement("div");C.textContent="Poções mágicas que concedem efeitos temporários. Efeitos duram por cena.",C.style.color="#ecf0f1",C.style.fontSize="13px",b.appendChild(C),i.appendChild(b);const q=document.createElement("div");q.style.background="#23243a",q.style.border="1.5px solid #ffb86c",q.style.borderRadius="8px",q.style.padding="16px",q.style.cursor="pointer",q.style.transition="all 0.2s",q.onmouseover=()=>{q.style.background="#2d2e4a"},q.onmouseout=()=>{q.style.background="#23243a"},q.onclick=()=>{t.remove();const e=document.getElementById("misc-overlay");e&&e.remove(),ne()};const E=document.createElement("div");E.textContent="Grimório de Magias",E.style.color="#ffb86c",E.style.fontSize="16px",E.style.fontWeight="bold",E.style.marginBottom="6px",q.appendChild(E);const z=document.createElement("div");z.textContent="Catálogo completo de magias organizadas por tradições e círculos.",z.style.color="#ecf0f1",z.style.fontSize="13px",q.appendChild(z),i.appendChild(q),document.body.appendChild(t),S(t,"orange")}async function se(){const e=[],a={abj:"Abjuração",adv:"Adivinhação",con:"Conjuração",enc:"Encantamento",evo:"Evocação",ilu:"Ilusão",nec:"Necromancia",tra:"Transmutação"},o={acao:"Ação",action:"Ação",bonus:"Ação Bônus",reacao:"Reação",reaction:"Reação",free:"Livre",full:"Ação Completa",minute:"1 Minuto",hour:"1 Hora",move:"Movimento",special:"Especial",ritual:"Ritual"},t={1:"1º Círculo",2:"2º Círculo",3:"3º Círculo",4:"4º Círculo",5:"5º Círculo"},s={arcana:{"1-circulo":{abjuracao:{alarme:{name:"Alarme",type:"Magia",img:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_orb_01.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 dia",alvo:"Esfera de 9m de raio",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você cria uma barreira protetora invisível que detecta qualquer criatura que tocar ou entrar na área protegida. Ao lançar a magia, você pode escolher quais criaturas podem entrar na área sem ativar seus efeitos. Alarme pode emitir um aviso telepático ou sonoro, decidido quando a magia é lançada. Um aviso telepático alerta apenas você, inclusive acordando-o se estiver dormindo, mas apenas se estiver a até 1km da área protegida. Um aviso sonoro alerta todas as criaturas em alcance longo."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para pessoal. A área é emanada a partir de você.",aumenta:!1},{custo:5,descricao:'além do normal, você também percebe qualquer efeito de adivinhação que seja usado dentro da área ou atravesse a área. Você pode fazer um teste oposto de Misticismo contra quem usou o efeito; se passar, tem um vislumbre de seu rosto e uma ideia aproximada de sua localização ("três dias de viagem ao norte", por exemplo).',aumenta:!1},{custo:9,descricao:"muda a duração para 1 dia ou até ser descarregada e a resistência para Vontade anula. Quando um intruso entra na área, você pode descarregar a magia. Se o intruso falhar na resistência, ficará paralisado por 1d4 rodadas. Além disso, pelas próximas 24 horas você e as criaturas escolhidas ganham +10 em testes de Sobrevivência para rastrear o intruso.",aumenta:!1}]},"armadura-arcana":{name:"Armadura Arcana",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_magearmor.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Esta magia cria uma película protetora invisível, mas tangível, fornecendo +5 na Defesa. Esse bônus é cumulativo com outras magias, mas não com bônus fornecido por armaduras."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus na Defesa em +1.",aumenta:!0},{custo:2,descricao:"muda a duração para 1 dia.",aumenta:!1}]},"tranca-arcana":{name:"Tranca Arcana",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane01.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 objeto Grande ou menor",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Esta magia tranca uma porta ou outro item que possa ser aberto ou fechado (como um baú, caixa etc.), aumentando a CD de testes de Força ou Ladinagem para abri-lo em +10. Você pode abrir livremente sua própria tranca sem problemas.Componente material: chave de bronze no valor de T$ 25."}},aprimoramentos:[{custo:5,descricao:"aumenta a CD para abrir o alvo em +5.",aumenta:!0},{custo:5,descricao:"muda o alvo para 1 objeto de qualquer tamanho, podendo afetar até mesmo os portões de um castelo. Requer 3º círculo.",aumenta:!1}]}},adivinhacao:{"concentracao-de-combate":{name:"Concentração de Combate",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_focusedmind.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"free"},alcance:"pessoal",duracao:"1 rodada",alvo:"Você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Esta magia amplia sua percepção, antecipando movimentos dos inimigos e encontrando brechas em suas defesas. Quando faz um ataque, você rola dois dados e usa o melhor resultado."}},aprimoramentos:[{custo:2,descricao:"muda a execução para padrão e a duração para cena. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"além do normal, ao atacar você, um inimigo deve rolar dois dados e usar o pior resultado. Requer 3º círculo.",aumenta:!1},{custo:9,descricao:"muda a execução para padrão, o alcance para curto, o alvo para criaturas escolhidas e a duração para cena. Requer 4º círculo.",aumenta:!1},{custo:14,descricao:"muda a execução para padrão e a duração para 1 dia. Além do normal, você recebe um sexto sentido que o avisa de qualquer perigo ou ameaça. Você fica imune às condições surpreendido e desprevenido e recebe +10 em Defesa e Reflexos. Requer 5º círculo.",aumenta:!1}]}},convocacao:{"area-escorregadia":{name:"Área Escorregadia",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_web.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"Quadrado de 3m ou 1 objeto",resistencia:"Reflexos (veja texto)",custo:"1 PM",description:{value:"Esta magia recobre uma superfície com uma substância gordurosa e escorregadia. Criaturas na área devem passar na resistência para não cair. Nas rodadas seguintes, criaturas que tentem movimentar-se pela área devem fazer testes de Acrobacia para equilíbrio (CD 10). área Escorregadia pode tornar um item escorregadio. Uma criatura segurando um objeto afetado deve passar na resistência para não deixar o item cair cada vez que usá-lo."}},aprimoramentos:[{custo:2,descricao:"muda a CD dos testes de Acrobacia para 15.",aumenta:!1},{custo:5,descricao:"muda a CD dos testes de Acrobacia para 20.",aumenta:!1}]},"conjurar-monstro":{name:"Conjurar Monstro",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_summonnatureguardian.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",resistencia:"Nenhuma",custo:"1 PM",description:{value:'Esta magia conjura um monstro Pequeno que ataca seus inimigos. Você escolhe a aparência do monstro e o tipo de dano que ele pode causar (corte, impacto ou perfuração). O monstro não é uma criatura real, mas sim um construto feito de energia. Se for destruído ou quando a magia acabar, ele desaparece sem deixar nada para trás. Você só pode ter um monstro conjurado por esta magia por vez. O monstro surge em um ponto escolhido por você dentro do alcance e pode agir no começo do seu próximo turno, sempre na sua Iniciativa. O monstro tem deslocamento de 9m e pode fazer uma ação de movimento por rodada. Você pode usar uma ação padrão para dar uma das seguintes ordens a ele: Mover: O monstro se movimenta o dobro do deslocamento nessa rodada. Atacar: O monstro ataca um alvo em alcance corpo a corpo. O ataque acerta automaticamente e causa 2d4+2 pontos de dano. Lançar Magia: O monstro pode servir como ponto de origem para uma magia lançada por você com execução de uma ação padrão ou menor. Ele pode descarregar um Toque Chocante em um inimigo distante ou mesmo "cuspir" uma Bola de Fogo. Você gasta PM normalmente para lançar a magia. O monstro conjurado tem For 14, Des 17 e todos os outros atributos nulos. Ele tem 20 pontos de vida, não tem um valor de Defesa (ataques feitos contra ele acertam automaticamente) e usa o seu bônus para teste de Reflexos. Ele é imune a efeitos que pedem um teste de Fortitude ou Vontade.'}},aprimoramentos:[{custo:2,descricao:"aumenta os PV do monstro em +10 para cada categoria de tamanho a partir de Pequeno (+10 PV para Pequeno, +20 PV para Médio etc.).",aumenta:!0},{custo:2,descricao:"aumenta o tamanho do monstro para Médio. Ele tem For 4, Des 3, 45 PV, deslocamento 12m e seu ataque causa 2d6+6 pontos de dano.",aumenta:!1},{custo:2,descricao:"o monstro ganha resistência 5 contra dois tipos de dano (por exemplo, corte e frio).",aumenta:!1},{custo:4,descricao:"o monstro ganha uma nova ordem: Arma de Sopro. Para dar essa ordem você gasta 1 PM, e faz o monstro causar o dobro de seu dano de ataque em um cone de 6m a partir de si (Reflexos reduz à metade).",aumenta:!1},{custo:5,descricao:"aumenta o tamanho do monstro para Grande. Ele tem For 7, Des 2, 75 PV, deslocamento 12m e seu ataque causa 4d6+10 pontos de dano com 3m de alcance. Requer 2º círculo.",aumenta:!1},{custo:9,descricao:"o monstro ganha deslocamento de voo igual ao dobro do deslocamento.",aumenta:!1},{custo:9,descricao:"o monstro ganha imunidade contra dois tipos de dano.",aumenta:!1},{custo:9,descricao:"aumenta o tamanho do monstro para Enorme. Ele tem For 11, Des 1, 110 PV, deslocamento 15m e seu ataque causa 4d8+15 pontos de dano com 4,5m de alcance. Requer 4º círculo.",aumenta:!0},{custo:14,descricao:"aumenta o tamanho do monstro para Colossal. Ele tem For 15, Des 0, 180 PV, deslocamento 15m e seu ataque causa 4d12+20 pontos de dano com 9m de alcance. Requer 5º círculo.",aumenta:!0}]},teia:{name:"Teia",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_web.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"cubo com 6m de lado",resistencia:"Reflexos anula",custo:"1 PM",description:{value:"Teia cria várias camadas de fibras entrelaçadas e pegajosas na área. Qualquer criatura na área que falhar na resistência fica Enredado. Uma vítima pode se libertar com uma ação padrão e um teste de Acrobacia ou Atletismo. A área ocupada por Teia é terreno difícil. A Teia é inflamável. Qualquer ataque que cause dano de fogo destrói as teias por onde passar, libertando as criaturas enredadas mas deixando-as em chamas."}},aprimoramentos:[{custo:2,descricao:"além do normal, no início de seus turnos a magia afeta novamente qualquer criatura na área, exigindo um novo teste de Reflexos. Requer 2º círculo.",aumenta:!1},{custo:2,descricao:"aumenta a área em +1 cubo de 1,5m.",aumenta:!0}]}},encantamento:{"adaga-mental":{name:"Adaga Mental",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade parcial",custo:"1 PM",description:{value:"Você manifesta e dispara uma adaga imaterial contra a mente do alvo, que sofre 2d6 pontos de dano psíquico e fica Atordoado por uma rodada. Se passar no teste de resistência, sofre apenas metade do dano e evita a condição. Uma criatura só pode ficar atordoada por esta magia uma vez por cena."}},aprimoramentos:[{custo:2,descricao:'muda a duração para 1 dia. Além do normal, você "finca" a adaga na mente do alvo. Enquanto a magia durar, você sabe a direção e localização do alvo, desde que ele esteja no mesmo mundo.',aumenta:!1},{custo:2,descricao:"aumenta o dano em +1d6.",aumenta:!0}]},enfeiticar:{name:"Enfeitiçar",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_charm.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 humanóide",resistencia:"Vontade anula",custo:"1 PM",description:{value:"O alvo fica enfeitiçado (veja a página 394). Um alvo hostil ou que esteja envolvido em um combate recebe +5 em seu teste de resistência. Se você ou seus aliados tomarem qualquer ação hostil contra o alvo, a magia é dissipada e o alvo retorna à atitude que tinha antes (ou piorada, de acordo com o mestre)."}},aprimoramentos:[{custo:2,descricao:"em vez do normal, você sugere uma ação para o alvo e ele obedece. A sugestão deve ser feita de modo que pareça aceitável, a critério do mestre. Pedir ao alvo que pule de um precipício, por exemplo, dissipa a magia. Já sugerir a um guarda que descanse um pouco, de modo que você e seus aliados passem por ele, é aceitável. Quando o alvo executa a ação, a magia termina. Você pode determinar uma condição específica para a sugestão: por exemplo, que um rico mercador doe suas moedas para o primeiro mendigo que encontrar.",aumenta:!1},{custo:5,descricao:"muda o alvo para 1 espírito ou monstro. Requer 3º círculo.",aumenta:!1},{custo:5,descricao:"afeta todos os alvos dentro do alcance.",aumenta:!1}]},hipnotismo:{name:"Hipnotismo",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soothingkiss.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1d4 Rodadas",alvo:"1 animal ou humanoide",resistencia:"Vontade anula",custo:"1 PM",description:{value:"Suas palavras e movimentos ritmados deixam o alvo fascinado. Esta magia só afeta criaturas que possam perceber você. Se usar esta magia em combate, o alvo recebe +5 em seu teste de resistência. Se a criatura passar, fica imune a este efeito por um dia."}},aprimoramentos:[{custo:2,descricao:"muda o alvo para animais ou humanoides escolhidos.",aumenta:!1},{custo:2,descricao:"muda a duração para sustentada.",aumenta:!1},{custo:2,descricao:"também afeta espíritos e monstros na área. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"também afeta construtos, espíritos, monstros e mortos-vivos na área. Requer 3º círculo.",aumenta:!1}]},sono:{name:"Sono",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_sleep.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 humanoide",resistencia:"Vontade parcial",custo:"1 PM",description:{value:"Um cansaço místico recai sobre o alvo. Se falhar na resistência, ele fica inconsciente e caído ou, se estiver envolvido em combate ou outra situação perigosa, fica Exausto por 1 rodada, depois fatigado. Em ambos os casos, se passar, o alvo fica Fatigado por 1d4 rodadas."}},aprimoramentos:[{custo:2,descricao:"alvos que falhem na resistência ficam exaustos por 1d4+1 rodadas, em vez de apenas 1.",aumenta:!1},{custo:2,descricao:"muda o alvo para criatura.",aumenta:!1},{custo:5,descricao:"afeta todos os alvos válidos a sua escolha dentro do alcance.",aumenta:!1}]}},evocacao:{"explosao-de-chamas":{name:"Explosão de Chamas",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Cone de 6m",resistencia:"Reflexos reduz à metade",custo:"1 PM",description:{value:"Um leque de chamas irrompe de suas mãos, causando 2d6 pontos de dano de fogo às criaturas na área."}}},"seta-infalivel":{name:"Seta Infalível",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane02.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"até 2 criaturas",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Favorita entre arcanistas iniciantes, esta magia lança duas setas de energia que causam 1d4+1 pontos de dano de essência cada. Você pode lançar as setas em alvos diferentes ou concentrá-las num mesmo alvo. Caso você possua um bônus no dano de magias, como pelo poder Arcano de Batalha, ele é aplicado em apenas uma seta (o bônus vale para a magia, não cada alvo)."}},aprimoramentos:[{custo:2,descricao:"muda as setas para lanças de energia que surgem e caem do céu. Cada lança causa 1d8+1 pontos de dano de essência. Requer 2º círculo.",aumenta:!1},{custo:2,descricao:"muda o número de setas/lanças para três.",aumenta:!1},{custo:4,descricao:"muda o número de setas/lanças para cinco. Requer 2º círculo.",aumenta:!1},{custo:9,descricao:"muda o número de setas/lanças para dez. Requer 4º círculo.",aumenta:!1}]},"toque-chocante":{name:"Toque Chocante",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Fortitude reduz à metade",custo:"1 PM",description:{value:"Arcos elétricos envolvem sua mão, causando 2d8+2 pontos de dano de eletricidade. Se o alvo usa armadura de metal (ou carrega muito metal, a critério do mestre), sofre uma penalidade de –5 no teste de resistência."}},aprimoramentos:[{custo:2,descricao:"muda a resistências para nenhum. Como parte da execução da magia, você faz um ataque corpo a corpo contra o alvo. Se acertar, causa o dano do ataque e da magia.",aumenta:!1},{custo:2,descricao:"muda o alcance para pessoal e o alvo para área: esfera com 6m de raio. Você dispara raios pelas pontas dos dedos que afetam todas as criaturas na área.",aumenta:!1}]}},ilusao:{"criar-ilusao":{name:"Criar Ilusão",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_illusion.jpg",system:{circulo:"1",escola:"ilusao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Vontade desacredita",custo:"1 PM",description:{value:"Esta magia cria uma ilusão visual (uma criatura, uma parede...) ou sonora (um grito de socorro, um uivo assustador...). A magia cria apenas imagens ou sons simples, com volume equivalente ao tom de voz normal para cada cubo de 1,5m no efeito. Não é possível criar cheiros, texturas ou temperaturas, nem sons complexos, como uma música ou diálogo. Criaturas e objetos atravessam uma ilusão sem sofrer dano, mas a magia pode, por exemplo, esconder uma armadilha ou inimigo. A magia é dissipada se você sair do alcance."}},aprimoramentos:[{custo:2,descricao:"também pode criar odores e sensações térmicas, que são percebidos a uma distância igual ao dobro do tamanho máximo do efeito. Por exemplo, uma miragem de uma fogueira com 4 cubos de 1,5m poderia emanar calor e cheiro de queimado a até 12m.",aumenta:!1},{custo:2,descricao:"muda o alcance para longo e o efeito para esfera de 30m de raio. Em vez do normal, você cria um som muito alto, equivalente a uma multidão. Criaturas na área lançam magias como se estivessem em uma condição ruim e a CD de testes de Percepção para ouvir aumenta em +10. Requer 2º círculo.",aumenta:!1},{custo:2,descricao:"também criar sensações táteis, como texturas; criaturas que não saibam que é uma ilusão não conseguem atravessá-la sem passar em um teste de Vontade (objetos ainda a atravessam). A ilusão ainda é incapaz de causar ou sofrer dano. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda a duração para sustentada. Além do normal, você pode gastar uma ação livre para modificar livremente a ilusão (mas não pode acrescentar novos aprimoramentos após lançá-la). Requer 3º círculo.",aumenta:!1}]},"disfarce-ilusorio":{name:"Disfarce Ilusório",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_disguise.jpg",system:{circulo:"1",escola:"ilusao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Vontade desacredita",custo:"1 PM",description:{value:"Você muda a aparência do alvo, incluindo seu equipamento. Isso inclui altura, peso, tom de pele, cor de cabelo, timbre de voz etc. O alvo recebe +10 em testes de Enganação para disfarce. O alvo não recebe novas habilidades (você pode ficar parecido com outra raça, mas não ganhará as habilidades dela), nem modifica o equipamento (uma espada longa disfarçada de bordão continua funcionando e causando dano como uma espada)."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para curto e o alvo para 1 criatura. Uma criatura involuntária pode anular o efeito com um teste de Vontade.",aumenta:!1},{custo:2,descricao:"a ilusão inclui odores e sensações. Isso muda o bônus em testes de Enganação para disfarce para +20.",aumenta:!1},{custo:3,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas. Cada criatura pode ter uma aparência diferente. Criaturas involuntárias podem anular o efeito com um teste de Vontade. Requer 2º círculo.",aumenta:!1}]},"imagem-espelhada":{name:"Imagem Espelhada",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_mirrorimage.jpg",system:{circulo:"1",escola:"ilusao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Três cópias ilusórias suas aparecem. As duplicatas ficam ao seu redor e imitam suas ações, tornando difícil para um inimigo saber quem atacar. Você recebe +6 na Defesa. Cada vez que um ataque contra você erra, uma das imagens desaparece e o bônus na Defesa diminui em 2. Um oponente deve ver as cópias para ser confundido. Se você estiver invisível, ou o atacante fechar os olhos, você não recebe o bônus (mas o atacante ainda sofre penalidades normais por não enxergar)."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de cópias em +1 (e o bônus na Defesa em +2).",aumenta:!0},{custo:2,descricao:"além do normal, toda vez que uma cópia é destruída, emite um clarão de luz. A criatura que destruiu a cópia fica ofuscada por uma rodada. Requer 2º círculo.",aumenta:!1}]},"leque-cromatico":{name:"Leque Cromático",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane03.jpg",system:{circulo:"1",escola:"ilusao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"cone de 4,5m",resistencia:"Vontade parcial",custo:"1 PM",description:{value:"Um cone de luzes brilhantes surge das suas mãos, deixando os animais e humanoides na área atordoados por 1 rodada (apenas uma vez por cena, Vontade anula) e ofuscados pela cena."}},aprimoramentos:[{custo:2,descricao:"além do normal, as criaturas afetadas ficam vulneráveis pela cena.",aumenta:!0},{custo:2,descricao:"também afeta espíritos e monstros na área. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"também afeta construtos, espíritos, monstros e mortos-vivos na área. Requer 3º círculo.",aumenta:!1}]}},necromancia:{amedrontar:{name:"Amedrontar",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathscream.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 animal ou humanoide",resistencia:"Vontade parcial",custo:"1 PM",description:{value:"O alvo é envolvido por energias sombrias e assustadoras. Se falhar na resistência, fica Apavorado por 1 rodada, depois Abalado. Se passar, fica abalado por 1d4 rodadas."}},aprimoramentos:[{custo:2,descricao:"alvos que falhem na resistência ficam apavorados por 1d4+1 rodadas, em vez de apenas 1.",aumenta:!1},{custo:2,descricao:"muda o alvo para 1 criatura.",aumenta:!1},{custo:5,descricao:"afeta todos os alvos válidos a sua escolha dentro do alcance.",aumenta:!1}]},"raio-do-enfraquecimento":{name:"Raio do Enfraquecimento",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_rayofweakness.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Fortitude parcial",custo:"1 PM",description:{value:"Você dispara um raio púrpura que drena as forças do alvo. Se falhar na resistência, o alvo fica Fatigado. Se passar, fica Vulnerável. Note que, como efeitos de magia não acumulam, lançar esta magia duas vezes contra o mesmo alvo não irá deixá-lo exausto."}},aprimoramentos:[{custo:2,descricao:"em vez do normal, se falhar na resistência o alvo fica exausto. Se passar, fica fatigado. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"em vez do normal, se falhar na resistência o alvo fica exausto. Se passar, fica fatigado. Muda o alvo para criaturas escolhidas. Requer 3º círculo.",aumenta:!1}]},"vitalidade-fantasma":{name:"Vitalidade Fantasma",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você suga energia vital da terra, recebendo 2d10 pontos de vida temporários. Os PV temporários desaparecem ao final da cena."}},aprimoramentos:[{custo:2,descricao:"aumenta os PV temporários recebidos em +1d10. Caso a magia cause dano, em vez disso aumenta o dano causado em +1d10.",aumenta:!0},{custo:5,descricao:"muda o alvo para área: esfera com 6m de raio centrada em você e a resistência para Fortitude reduz à metade. Em vez do normal, você suga energia das criaturas vivas na área, causando 1d10 pontos de dano de trevas e recebendo PV temporários iguais ao dano total causado. Os PV temporários desaparecem ao final da cena. Requer 2º círculo.",aumenta:!1}]}},transmutacao:{"primor-atletico":{name:"Primor Atlético",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_agility.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você modifica os limites físicos do alvo, que recebe deslocamento +9m e +10 em testes de Atletismo."}},aprimoramentos:[{custo:3,descricao:"além do normal, ao fazer testes de perícias baseadas em Força, Destreza ou Constituição, o alvo pode rolar dois dados e escolher o melhor. Não afeta testes de ataque ou resistência. Requer 2º círculo.",aumenta:!1}]},"queda-suave":{name:"Queda Suave",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_featherfall.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"reaction"},alcance:"curto",duracao:"até chegar ao solo ou cena, o que vier primeiro",alvo:"1 criatura ou objeto com até 200kg",resistencia:"Nenhuma",custo:"1 PM",description:{value:"O alvo cai lentamente. A velocidade da queda é reduzida para 18m por rodada — o suficiente para não causar dano. Como lançar esta magia é uma reação, você pode lançá-la rápido o bastante para salvar a si ou um aliado de quedas inesperadas. Lançada sobre um projétil — como uma flecha ou uma rocha largada do alto de um penhasco —, a magia faz com que ele cause metade do dano normal, devido à lentidão. Queda Suave só funciona em criaturas e objetos em queda livre ou similar; a magia não vai frear um golpe de espada ou o mergulho rasante de um atacante voador."}},aprimoramentos:[{custo:2,descricao:"muda o alvo para até 10 criaturas ou objetos.",aumenta:!1},{custo:2,descricao:"aumenta a categoria de tamanho do alvo em uma",aumenta:!1}]},"transmutar-objetos":{name:"Transmutar Objetos",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane04.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"matéria-prima, como madeira, rochas, ossos",resistencia:"Nenhuma",custo:"1 PM",description:{value:"A magia transforma matéria bruta para moldar um novo objeto. Você pode usar matéria-prima mundana para criar um objeto de tamanho Pequeno ou menor e preço máximo de T$ 25, como um balde ou uma espada. O objeto reverte à matéria-prima no final da cena, ou se for tocado por um objeto feito de chumbo. Esta magia não pode ser usada para criar objetos consumíveis, como alimentos ou itens alquímicos, nem objetos com mecanismos complexos, como bestas ou armas de fogo. Transmutar Objetos anula Despedaçar."}},aprimoramentos:[{custo:2,descricao:"aumenta o limite de tamanho do objeto em uma categoria.",aumenta:!0},{custo:3,descricao:"aumenta o preço máximo do objeto criado em um fator de x10 (+3 PM por T$ 250 de preço, +6 PM por T$ 2.500 de preço, e assim por diante).",aumenta:!0},{custo:5,descricao:"muda o alvo para 1 objeto mundano e a duração para instantânea. Em vez do normal, você cura todos os PV do alvo, restaurando o objeto totalmente. Este aprimoramento está sujeito aos limites de tamanho e preço do objeto conforme a magia original e não funciona se o objeto tiver sido completamente destruído (queimado até virar cinzas ou desintegrado, por exemplo). Requer 3º círculo.",aumenta:!1},{custo:9,descricao:"como o aprimoramento anterior, mas passa a afetar itens mágicos.",aumenta:!1},{custo:2,descricao:"aumentar a cura em +1d8.",aumenta:!0}]}}},"2-circulo":{abjuracao:{"campo-de-forca":{name:"Campo de Força",type:"magia",img:"systems/tormenta20/icons/magias/campo-de-forca.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia cria uma película protetora sobre você. Você recebe 30 pontos de vida temporários."}},aprimoramentos:[{custo:1,descricao:"muda a execução para reação e a duração para instantânea. Em vez do normal, você recebe redução 30 contra o próximo dano que sofrer.",aumenta:!1},{custo:7,descricao:"muda o alcance para curto, o alvo para outra criatura ou objeto Enorme ou menor e a duração para sustentada. Em vez do normal, cria uma esfera imóvel e tremeluzente ao redor do alvo. Nenhuma criatura, objeto ou efeito de dano pode passar pela esfera, embora criaturas possam respirar normalmente. Criaturas na área podem fazer um teste de Reflexos para evitar serem aprisionadas e sempre que você se concentrar. Requer 4º círculo.",aumenta:!1},{custo:9,descricao:"como o aprimoramento acima, mas tudo dentro da esfera fica praticamente sem peso. Uma vez por rodada, você pode gastar uma ação livre para flutuar a esfera e seu conteúdo 9m em uma direção. Requer 4º círculo.",aumenta:!1},{custo:7,descricao:"muda os PV temporários ou a RD para 70. Requer 4º círculo.",aumenta:!1}]},refugio:{name:"Refúgio",type:"magia",img:"systems/tormenta20/icons/magias/refugio.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",duracao:"1 dia",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia cria um domo imóvel e quase opaco por fora, mas transparente pelo lado de dentro. Ele protege contra calor, frio e forças pequenas, mas não contra qualquer coisa capaz de causar dano. Assim, o domo protege contra neve e vento comuns, mas não contra uma flecha ou Bola de Fogo. Porém, como o domo é quase opaco, qualquer criatura dentro dele tem camuflagem total contra ataques vindos de fora. Criaturas podem entrar e sair do domo livremente. Descansar dentro do Refúgio concede recuperação normal de PV e PM."}},aprimoramentos:[{custo:1,descricao:"além do normal, os limites do domo são envoltos por uma fumaça escura e espessa, que impede criaturas do lado de fora de enxergar ou ouvir o que está dentro. Criaturas do lado de dentro enxergam e ouvem normalmente o que está do lado de fora. A fumaça também bloqueia magias de adivinhação.",aumenta:!1},{custo:9,descricao:"em vez do normal, cria uma mansão extradimensional que comporta até 100 criaturas Médias, com quartos luxuosos, comida e bebida e dez servos fantasmagóricos (como na magia Servos Invisíveis). Descansar na mansão concede recuperação luxuosa (recupera PV e PM igual ao triplo do nível). A mansão tem uma única entrada, uma porta feita de luz. Você pode deixá-la visível ou invisível como uma ação livre e apenas criaturas escolhidas por você podem passar. Requer 4º círculo.",aumenta:!1}]}},adivinhacao:{"ligacao-telepatica":{name:"Ligação Telepática",type:"magia",img:"systems/tormenta20/icons/magias/ligacao-telepatica.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",duracao:"1 dia",alvo:"2 criaturas voluntárias",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você cria um elo mental entre duas criaturas com Inteligência -3 ou maior (você pode ser uma delas). As criaturas podem se comunicar independente de idioma ou distância, mas não em mundos diferentes."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0}]},localizacao:{name:"Localização",type:"magia",img:"systems/tormenta20/icons/magias/localizacao.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"esfera com 90m de raio",resistencia:"Nenhuma",custo:"3 PM",description:{value:'Esta magia pode encontrar uma criatura ou objeto a sua escolha. Você pode pensar em termos gerais ("um elfo", "algo de metal") ou específicos ("Gwen, a elfa", "uma espada longa"). A magia indica a direção e distância da criatura ou objeto mais próximo desse tipo, caso esteja ao alcance. Você pode movimentar-se para continuar procurando. Procurar algo muito específico ("a espada longa encantada do Barão Rulyn") exige que você tenha em mente uma imagem precisa do objeto; caso a imagem não seja muito próxima da verdade, a magia falha, mas você gasta os PM mesmo assim. Esta magia pode ser bloqueada por uma fina camada de chumbo.'}},aprimoramentos:[{custo:5,descricao:"aumenta a área em um fator de 10 (90m para 900m, 900m para 9km e assim por diante).",aumenta:!0}]},mapear:{name:"Mapear",type:"magia",img:"systems/tormenta20/icons/magias/mapear.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"superfície ou objeto plano, como uma mesa ou pergaminho",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Uma fagulha percorre a superfície afetada, queimando-a enquanto esboça um mapa da região onde o conjurador está. Se você conhece o lugar, o mapa será completo. Caso contrário, apresentará apenas um esboço geral, além de um ponto de referência (para possibilitar localização) e um lugar de interesse, ambos definidos pelo mestre. A região representada no mapa tem tamanho máximo de um quadrado de 10km de lado. Caso você esteja dentro de uma construção, o mapa mostrará o andar no qual você se encontra."}}}},convocacao:{"amarras-etereas":{name:"Amarras Etéreas",type:"magia",img:"systems/tormenta20/icons/magias/amarras-etereas.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Reflexos anula",custo:"3 PM",description:{value:"Três laços de energia surgem e se enroscam no alvo, deixando-o agarrado. A vítima pode tentar se livrar, gastando uma ação padrão para fazer um teste de Atletismo (CD igual à da magia). Se passar, destrói um laço, mais um laço adicional para cada 5 pontos pelos quais superou a CD. Os laços também podem ser atacados e destruídos: cada um tem Defesa 10, 10 PV, RD 5 e imunidade a dano mágico. Se todos os laços forem destruídos, a magia é dissipada. Por serem feitos de energia, os laços afetam criaturas incorpóreas."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:2,descricao:"aumenta o número de laços em um alvo a sua escolha em +1. (bônus máximo limitado pelo círculo máximo de magia que você pode lançar)",aumenta:!0}]},"montaria-arcana":{name:"Montaria Arcana",type:"magia",img:"systems/tormenta20/icons/magias/montaria-arcana.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 dia",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia convoca um parceiro cavalo (ou pônei) de guerra veterano. Sua aparência é de um animal negro com crina e cauda cinzentas e cascos feitos de fumaça, mas você pode mudá-la se quiser. Além dos benefícios normais, a Montaria Arcana pode atravessar terreno difícil sem redução em seu deslocamento.Você pode usar Misticismo no lugar de Cavalgar para efeitos desta montaria (incluindo ser considerado treinado)."}},aprimoramentos:[{custo:1,descricao:"além do normal, criaturas do tipo animal em alcance curto da montaria devem fazer um teste de Vontade. Se passarem, ficam abaladas pela cena; se falharem, ficam apavoradas por 1d4 rodadas, depois abaladas pela cena.",aumenta:!1}]},"salto-dimensional":{name:"Salto Dimensional",type:"magia",img:"systems/tormenta20/icons/magias/salto-dimensional.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"você",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia transporta você para outro lugar dentro do alcance. Você não precisa perceber nem ter linha de efeito ao seu destino, podendo simplesmente imaginá-lo. Por exemplo, pode se transportar 3m adiante para ultrapassar uma porta fechada. Uma vez transportadas, criaturas não podem agir até a rodada seguinte. Esta magia não permite que você apareça dentro de um corpo sólido; se o ponto de chegada não tem espaço livre, você ressurge na área vazia mais próxima."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para médio.",aumenta:!1},{custo:1,descricao:"muda o alvo para você e uma criatura voluntária. Você pode escolher este aprimoramento mais vezes para aumentar o número de alvos adicionais em +1, mas deve estar tocando todos os alvos.",aumenta:!0},{custo:2,descricao:"muda a execução para reação. Em vez do normal, você salta para um espaço adjacente (1,5m), recebendo +5 na Defesa e em testes de Reflexos contra um ataque ou efeito que esteja prestes a atingi-lo. Após a resolução do efeito, salta para um espaço adjacente (1,5m).",aumenta:!1}]},"servos-invisiveis":{name:"Servos Invisíveis",type:"magia",img:"systems/tormenta20/icons/magias/servos-invisiveis.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",resistencia:"Nenhuma",custo:"3 PM",description:{value:'Você cria até três servos invisíveis e silenciosos, capazes de realizar tarefas simples como apanhar lenha, colher frutos, varrer o chão ou alimentar um cavalo. Os servos podem ser usados para manter arrumada e organizada uma mansão ou pequena torre ou para preparar um acampamento nos ermos para você e seus aliados (veja a perícia Sobrevivência, na página 123). Eles também podem ajudá-lo em tarefas mais complexas, como fazer uma pesquisa ou preparar uma poção, mas isso consome sua energia mágica. Você pode "gastar" um servo para receber um bônus não cumulativo de +2 em um teste de perícia (exceto testes de ataque e resistência). Os servos não são criaturas reais; não podem lutar, nem resistir a qualquer dano ou efeito que exija um teste de resistência ou teste oposto — falharão automaticamente no teste e serão destruídos.'}},aprimoramentos:[{custo:2,descricao:"aumenta o número de servos conjurados em 1.",aumenta:!0}]}},encantamento:{"desespero-esmagador":{name:"Desespero Esmagador",type:"magia",img:"systems/tormenta20/icons/magias/desespero-esmagador.webp",system:{circulo:"2",escola:"encantamento",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Cone de 6m",resistencia:"Vontade parcial",custo:"3 PM",description:{value:"Humanoides na área são acometidos de grande tristeza, adquirindo as condições Fraco e Frustrado. Se passarem na resistência, adquirem essas condições por uma rodada."}},aprimoramentos:[{custo:2,descricao:"em vez do normal, as condições adquiridas são debilitado e esmorecido.",aumenta:!1}]},"sussurros-insanos":{name:"Sussurros Insanos",type:"magia",img:"systems/tormenta20/icons/magias/sussurros-insanos.webp",system:{circulo:"2",escola:"encantamento",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 humanoide",resistencia:"Vontade anula",custo:"3 PM",description:{value:"Você murmura palavras desconexas que afetam a mente do alvo. O alvo fica Confuso."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:12,descricao:"muda o alvo para criaturas escolhidas. Requer 5º círculo.",aumenta:!1}]}},evocacao:{"bola-de-fogo":{name:"Bola de Fogo",type:"magia",img:"systems/tormenta20/icons/magias/bola-de-fogo.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"esfera com 6m de raio",resistencia:"Reflexos reduz à metade",custo:"3 PM",description:{value:"Esta famosa magia de ataque cria uma poderosa explosão, causando 6d6 pontos de dano de fogo em todas as criaturas e objetos livres na área."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +2d6.",aumenta:!0},{custo:2,descricao:"muda a área para efeito de esfera flamejante com tamanho Médio e a duração para cena. Em vez do normal, cria uma esfera flamejante com 1,5m de diâmetro que causa 3d6 pontos de dano a qualquer criatura no mesmo espaço. Você pode gastar uma ação de movimento para fazer a esfera voar 9m em qualquer direção. Ela é imune a dano, mas pode ser apagada com água. Uma criatura só pode sofrer dano da esfera uma vez por rodada.",aumenta:!1}]},"flecha-acida":{name:"Flecha Ácida",type:"magia",img:"systems/tormenta20/icons/magias/flecha-acida.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura ou objeto",resistencia:"Reflexos parcial",custo:"3 PM",description:{value:"Você dispara um projétil que causa 4d6 pontos de dano de ácido. Se falhar no teste de resistência, o alvo também fica coberto por um muco corrosivo, sofrendo mais 2d6 de dano de ácido no início de seus dois próximos turnos. Se lançada contra um objeto que não esteja em posse de uma criatura a magia causa dano dobrado e ignora a RD do objeto."}},aprimoramentos:[{custo:1,descricao:"além do normal, se o alvo coberto pelo muco ácido estiver usando armadura ou escudo, o item é corroído. Isso reduz o bônus na Defesa do item em 1 ponto permanentemente. O item pode ser consertado, restaurando seu bônus (veja Ofício, na página 121).",aumenta:!1},{custo:2,descricao:"aumenta a redução na Defesa em +1.",aumenta:!0},{custo:2,descricao:"aumenta o dano inicial e o dano por rodada em +1d6.",aumenta:!0}]},relampago:{name:"Relâmpago",type:"magia",img:"systems/tormenta20/icons/magias/relampago.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"linha",resistencia:"Reflexos reduz à metade",custo:"3 PM",description:{value:"Você dispara um poderoso raio que causa 6d6 pontos de dano de eletricidade em todas as criaturas e objetos livres na área."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +2d6.",aumenta:!0}]},"sopro-das-uivantes":{name:"Sopro das Uivantes",type:"magia",img:"systems/tormenta20/icons/magias/sopro-das-uivantes.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"cone de 9m",resistencia:"Fortitude parcial",custo:"3 PM",description:{value:"Você sopra ar gélido que causa 4d6 pontos de dano de frio (Fortitude reduz à metade). Criaturas de tamanho Médio ou menor que falhem na resistência ficam caídas e são empurradas 6m na direção oposta. Se houver uma parede ou outro objeto sólido (mas não uma criatura) no caminho, a criatura para de se mover, mas sofre +2d6 pontos de dano de impacto."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano de frio em +2d6.",aumenta:!0}]}},ilusao:{"aparencia-perfeita":{name:"Aparência Perfeita",type:"magia",img:"systems/tormenta20/icons/magias/aparencia-perfeita.webp",system:{circulo:"2",escola:"ilusao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"3 PM",description:{value:'Esta magia lhe concede um rosto idealizado, porte físico garboso, voz melodiosa e olhar sedutor, deixando-o mais atraente e confiável. Enquanto a magia estiver ativa, seu Carisma torna-se 20 (ou recebe um bônus de +4, caso seja 20 ou maior) e você recebe +5 nos testes de Diplomacia e Enganação. Quando a magia acaba, quaisquer observadores percebem a mudança e tendem a suspeitar de você. Da mesma maneira, pessoas que o viram sob o efeito da magia sentirão que "algo está errado" ao vê-lo em condições normais. Quando a cena acabar, você pode gastar os PM da magia novamente como uma ação livre para mantê-la ativa. Este efeito não fornece PV ou PM adicionais.'}},aprimoramentos:[{custo:1,descricao:"muda o alcance para toque e o alvo para 1 humanoide",aumenta:!1}]},"camuflagem-ilusoria":{name:"Camuflagem Ilusória",type:"magia",img:"systems/tormenta20/icons/magias/camuflagem-ilusoria.webp",system:{circulo:"2",escola:"ilusao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"O alvo fica com sua imagem nublada, como se vista através de um líquido, recebendo os efeitos de camuflagem leve."}},aprimoramentos:[{custo:7,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas. Requer 4º círculo.",aumenta:!1}]},"esculpir-sons":{name:"Esculpir Sons",type:"magia",img:"systems/tormenta20/icons/magias/esculpir-sons.webp",system:{circulo:"2",escola:"ilusao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura ou objeto",resistencia:"Vontade anula",custo:"3 PM",description:{value:"Esta magia altera os sons emitidos pelo alvo. Ela não é capaz de criar sons, mas pode omiti-los (como fazer uma carroça ficar silenciosa) ou transformá-los (como fazer uma pessoa ficar com voz de passarinho). Você não pode criar sons que não conhece (não pode fazer uma criatura falar num idioma que não conheça). Uma vez que escolha a alteração, ela não pode ser mudada. Um conjurador que tenha a voz modificada drasticamente não poderá lançar magias."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +1. Todas as criaturas e objetos devem ser afetadas da mesma forma.",aumenta:!0}]},invisibilidade:{name:"Invisibilidade",type:"magia",img:"systems/tormenta20/icons/magias/invisibilidade.webp",system:{circulo:"2",escola:"ilusao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"free"},alcance:"pessoal",duracao:"1 rodada",alvo:"você",resistencia:"Nenhuma",custo:"3 PM",description:{value:"O alvo fica invisível (incluindo seu equipamento). Um personagem invisível recebe camuflagem total, +10 em testes de Furtividade contra ouvir e criaturas que não possam vê-lo ficam desprevenidas contra seus ataques. A magia termina se o alvo faz uma ação hostil contra uma criatura. Ações contra objetos livres não dissipam a Invisibilidade (você pode tocar ou apanhar objetos que não estejam sendo segurados por outras criaturas). Causar dano indiretamente — por exemplo, acendendo o pavio de um barril de pólvora que vai detonar mais tarde — não é considerado um ataque. Objetos soltos pelo alvo voltam a ser visíveis e objetos apanhados por ele ficam invisíveis. Qualquer parte de um item carregado que se estenda além de seu alcance corpo a corpo natural se torna visível. Uma luz nunca fica invisível (mesmo que sua fonte seja)."}},aprimoramentos:[{custo:1,descricao:"muda a execução para ação padrão, o alcance para toque e o alvo para 1 criatura ou um objeto Grande ou menor.",aumenta:!1},{custo:7,descricao:"muda a execução para ação padrão, o alcance para toque e o alvo para 1 criatura. A magia não é dissipada caso o alvo faça um ação hostil. Requer 4º círculo.",aumenta:!1}]}},necromancia:{"cranio-voador":{name:"Crânio Voador",type:"magia",img:"systems/tormenta20/icons/magias/cranio-voador.webp",system:{circulo:"2",escola:"necromancia",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Fortitude reduz à metade",custo:"3 PM",description:{value:"Esta magia cria um crânio envolto em energia negativa. Quando atinge o alvo, causa 4d8+4 pontos de dano de trevas e se desfaz emitindo um som horrendo, deixando abalado o alvo e todos os inimigos num raio de 3m dele (criaturas já abaladas ficam apavoradas por 1d4 rodadas). Passar no teste de resistência diminui o dano à metade e evita a condição (as demais criaturas na área também tem direito ao teste de resistência, para evitar a condição). Abalado Apavorado"}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +1d8+1.",aumenta:!0},{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0}]},"toque-vampirico":{name:"Toque Vampírico",type:"magia",img:"systems/tormenta20/icons/magias/toque-vampirico.webp",system:{circulo:"2",escola:"necromancia",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Fortitude reduz à metade",custo:"3 PM",description:{value:"Sua mão brilha com energia sombria, causando 6d6 pontos de dano de trevas. Você recupera pontos de vida iguais à metade do dano causado (se causou algum dano)."}},aprimoramentos:[{custo:2,descricao:"muda a resistência para nenhum. Como parte da execução da magia, você pode fazer um ataque corpo a corpo contra o alvo. Se acertar, causa o dano do ataque e da magia, e recupera pontos de vida iguais à metade do dano da magia.",aumenta:!1},{custo:2,descricao:"aumenta o dano em +2d6.",aumenta:!0},{custo:2,descricao:"muda o alcance para pessoal, o alvo para você e a duração para cena. Em vez do normal, a cada rodada você pode gastar uma ação padrão para tocar 1 criatura e causar 3d6 pontos de dano. Você recupera pontos de vida iguais à metade do dano causado. Requer 3º círculo.",aumenta:!1}]}},transmutacao:{"alterar-tamanho":{name:"Alterar Tamanho",type:"magia",img:"systems/tormenta20/icons/magias/alterar-tamanho.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 dia",alvo:"1 objeto",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia aumenta ou diminui o tamanho de um item mundano em até três categorias (um objeto Enorme vira Pequeno, por exemplo). Você também pode mudar a consistência do item, deixando-o rígido como pedra ou flexível como seda (isso não altera sua RD ou PV, apenas suas propriedades físicas). Se lançar a magia num objeto de uma criatura involuntária, ela pode fazer um teste de Vontade para anulá-la."}},aprimoramentos:[{custo:1,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:2,descricao:"muda o alcance para toque e o alvo para 1 criatura. Em vez do normal, o alvo aumenta uma categoria de tamanho (seu equipamento se ajusta ao novo tamanho). O alvo também recebe Força +2. Um alvo involuntário pode fazer um teste de Fortitude para negar o efeito.",aumenta:!1},{custo:7,descricao:"muda o alcance para toque, o alvo para 1 criatura, a duração para permanente e a resistência para Fortitude anula. Em vez do normal, se falhar na resistência o alvo e seu equipamento têm seu tamanho mudado para Minúsculo. O alvo também tem seu valor de Força reduzido a 1 e suas formas de deslocamento reduzidas a 3m. Requer 4o círculo.",aumenta:!1}]},metamorfose:{name:"Metamorfose",type:"magia",img:"systems/tormenta20/icons/magias/metamorfose.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você muda sua aparência e forma — incluindo seu equipamento — para qualquer outra criatura, existente ou imaginada. Independentemente da forma escolhida, você recebe +20 em testes de Enganação para disfarce. Características não mencionadas não mudam. Se mudar para uma forma humanoide, pode mudar o tipo de dano (entre corte, impacto e perfuração) de suas armas (se usa uma maça e transformá- la em espada longa, ela pode causar dano de corte, por exemplo). Se quiser, pode assumir uma forma humanoide com uma categoria de tamanho acima ou abaixo da sua; nesse caso aplique os modificadores em Furtividade e testes de manobra. Se mudar para outras formas, você pode escolher uma Forma Selvagem do druida (veja no Capítulo 1). Nesse caso você não pode atacar com suas armas, falar ou lançar magias até voltar ao normal, mas recebe uma ou mais armas naturais e os bônus da forma selvagem escolhida."}},aprimoramentos:[{custo:1,descricao:"a forma escolhida recebe uma habilidade de sentidos entre faro, visão na penumbra e visão no escuro.",aumenta:!1},{custo:5,descricao:"se mudar para formas não humanoides, pode escolher uma Forma Selvagem Aprimorada. Requer 3º círculo.",aumenta:!1},{custo:9,descricao:"se mudar para formas não humanoides, pode escolher uma Forma Selvagem Superior. Requer 4º círculo.",aumenta:!1},{custo:12,descricao:"além do normal, no início de seus turnos o alvo pode mudar de forma novamente, como uma ação livre, fazendo novas escolhas. Requer 5º círculo.",aumenta:!1}]},velocidade:{name:"Velocidade",type:"magia",img:"systems/tormenta20/icons/magias/velocidade.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"O alvo pode realizar uma ação padrão ou de movimento adicional por turno. Esta ação não pode ser usada para lançar magias e ativar engenhocas."}},aprimoramentos:[{custo:7,descricao:"muda o alvo para criaturas escolhidas no alcance. Requer 4º círculo.",aumenta:!1},{custo:7,descricao:"muda o alcance para pessoal e o alvo para você. Você acelera sua mente, além de seu corpo. A ação adicional pode ser usada para lançar magias e ativar engenhocas. Requer 4º círculo.",aumenta:!1},{custo:0,descricao:"muda a duração para cena. A ação adicional que você pode fazer é apenas de movimento. Uma criatura só pode receber uma ação adicional por turno como efeito de Velocidade.",aumenta:!1}]}}},"3-circulo":{abjuracao:{"ancora-dimensional":{name:"Âncora Dimensional",type:"magia",img:"systems/tormenta20/icons/magias/ancora-dimensional.webp",system:{circulo:"3",escola:"abjuracao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura ou objeto",resistencia:"Nenhuma",custo:"6 PM",description:{value:"O alvo é envolvido por um campo de força cor de esmeralda que impede qualquer forma de movimento planar ou extradimensional. Isso inclui magias de teletransporte (como Salto Dimensional e Teletransporte), convocação que mova o alvo (como ser banido ou convocado), viagens astrais, movimento através de portais dimensionais e a habilidade incorpóreo. O alvo não pode deixar o plano atual por nenhum meio mágico, mas ainda pode se mover normalmente dentro do plano. Criaturas incorpóreas afetadas tornam-se temporariamente corpóreas enquanto durar o efeito."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para médio, a área para esfera com 3m de raio e o alvo para criaturas escolhidas.",aumenta:!1},{custo:2,descricao:"muda o efeito para criar um fio de energia cor de esmeralda que prende o alvo a um ponto no espaço dentro do alcance. O ponto precisa ser fixo, mas não precisa de nenhum apoio ou superfície (pode simplesmente flutuar no ar). O alvo não pode se afastar mais de 3m do ponto, nem fisicamente, nem com movimento planar. O fio possui 20 PV e resistência a dano 20 (mas pode ser dissipado por efeitos que libertam criaturas, como o Julgamento Divino: Libertação do paladino).",aumenta:!1},{custo:4,descricao:"muda o efeito para criar um fio de energia cor de esmeralda que prende o alvo a um ponto no espaço dentro do alcance. O ponto precisa ser fixo, mas não precisa de nenhum apoio ou superfície (pode simplesmente flutuar no ar). O alvo não pode se afastar mais de 3m do ponto, nem fisicamente, nem com movimento planar. O fio possui 20 PV e redução de dano 40 (mas pode ser dissipado por efeitos que libertam criaturas, como o Julgamento Divino: Libertação do paladino).",aumenta:!1},{custo:4,descricao:"muda o alvo para área de cubo de 9m, a duração para permanente e adiciona componente material (chave de esmeralda no valor de T$ 2.000). Em vez do normal, nenhum tipo de movimento planar pode ser feito para entrar ou sair da área.",aumenta:!1},{custo:9,descricao:"muda o alcance para médio, a área para esfera de 3m de raio e o alvo para criaturas escolhidas. Cria um fio de energia (veja acima) que prende todos os alvos ao centro da área.",aumenta:!1}]},"dificultar-deteccao":{name:"Dificultar Detecção",type:"magia",img:"systems/tormenta20/icons/magias/dificultar-deteccao.webp",system:{circulo:"3",escola:"abjuracao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",duracao:"1 dia",alvo:"1 criatura ou objeto",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Esta magia oculta a presença do alvo contra qualquer meio mágico de detecção, inclusive detectar magia. Um conjurador que lance uma magia de adivinhação para detectar a presença ou localização do alvo deve fazer um teste de Vontade. Se falhar, a magia não funciona, mas os PM são gastos mesmo assim. Se for lançada sobre uma criatura, Dificultar Detecção protege tanto a criatura quanto seu equipamento."}},aprimoramentos:[{custo:4,descricao:"muda o alvo para área de cubo de 9m. Qualquer criatura ou objeto na área recebe o efeito da magia enquanto estiver dentro dela.",aumenta:!1},{custo:4,descricao:"muda a duração para 1 semana.",aumenta:!1}]},"globo-de-invulnerabilidade":{name:"Globo de Invulnerabilidade",type:"magia",img:"systems/tormenta20/icons/magias/globo-de-invulnerabilidade.webp",system:{circulo:"3",escola:"abjuracao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você é envolto por uma esfera mágica brilhante com 3m de raio, que detém qualquer magia de 2º círculo ou menor. Nenhuma magia pode ser lançada contra um alvo dentro do globo e magias de área não o penetram. No entanto, magias ainda podem ser lançadas de dentro para fora. Uma magia que dissipa outras magias só dissipa o globo se for usada diretamente sobre você, não o afetando se usada em área. Efeitos mágicos não são dissipados quando entram na esfera, apenas suprimidos (voltam a funcionar fora do globo, caso sua duração não tenha acabado). O globo é imóvel e não tem efeito sobre criaturas ou objetos. Após lançá-lo, você pode entrar ou sair livremente."}},aprimoramentos:[{custo:4,descricao:"muda o efeito para afetar magias de até 3º círculo. Requer 4º círculo.",aumenta:!1},{custo:9,descricao:"muda o efeito para afetar magias de até 4º círculo. Requer 5º círculo.",aumenta:!1}]}},adivinhacao:{"contato-extraplanar":{name:"Contato Extraplanar",type:"magia",img:"systems/tormenta20/icons/magias/contato-extraplanar.webp",system:{circulo:"3",escola:"adv",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",duracao:"1 dia",alvo:"Você",resistencia:"Nenhuma",custo:"6 PM",description:{value:'Sua mente viaja até outro plano de existência, onde entra em contato com seres extraplanares como gênios e demônios. Você firma um contrato com uma dessas entidades para que o auxilie durante o dia, em troca de se alimentar de seu mana. Quando a magia é lançada, você recebe 6d6 dados de auxílio. Enquanto a magia durar, sempre que for realizar um teste de perícia, você pode gastar 1d6 (mais 1d6 para cada círculo de magias acima do 3º que puder lançar) e adicionar o resultado como bônus no teste. No entanto, sempre que rolar um "6" num desses dados, a entidade "suga" 1 PM de você. A magia termina se você gastar todos os dados, ficar sem PM ou no fim do dia (o que acontecer primeiro).'}},aprimoramentos:[{custo:2,descricao:"aumenta o número de dados de auxílio em +1.",aumenta:!0},{custo:8,descricao:'Muda os dados de auxílio para d12. Sempre que rolar um resultado 12 num desses d12, a entidade "suga" 2 PM de você. Requer 4º círculo.',aumenta:!1}]}},convocacao:{"convocacao-instantanea":{name:"Convocação Instantânea",type:"magia",img:"systems/tormenta20/icons/magias/convocacao-instantanea.webp",system:{circulo:"3",escola:"convocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"any",alvo:"1 objeto de 2 espaços",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você invoca um objeto de qualquer lugar para sua mão. O item deve ter sido previamente preparado com uma runa ou marca pessoal sua (ao custo de T$ 5). A magia não funciona se o objeto estiver com outra criatura, mas você saberá onde ele está e quem o está carregando (ou sua descrição física, caso não conheça a criatura)."}},aprimoramentos:[{custo:1,descricao:"além do normal, até 1 hora após ter lançado a magia, você pode gastar uma ação de movimento para enviar o objeto de volta para o local em que ele estava antes.",aumenta:!1},{custo:1,descricao:"muda o alvo para um baú Médio, a duração para permanente e adiciona sacrifício de 1 PM. Em vez do normal, você esconde o baú alvo no Etér Entre Mundos, com até 20 espaços de equipamento. A magia faz com que qualquer objeto caiba no baú, independentemente do seu tamanho. Uma vez escondido, você pode convocar o baú para um espaço livre adjacente, ou de volta para o Etér, com uma ação padrão. Componente material: baú construído com matéria-prima da melhor qualidade (T$ 1.000). Você deve ter em mãos uma miniatura do baú, no valor de T$ 100, para invocar o baú verdadeiro.",aumenta:!1},{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:2,descricao:"muda o alvo para 1 objeto de até 10 espaços. Um objeto muito grande ou pesado para aparecer em suas mãos surge em um espaço adjacente a sua escolha.",aumenta:!0}]},"enxame-rubro":{name:"Enxame Rubro",type:"magia",img:"systems/tormenta20/icons/magias/enxame-rubro.webp",system:{circulo:"3",escola:"convocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Reflexos reduz à metade",custo:"6 PM",description:{value:"Você conjura um enxame de pequenas criaturas corrosivas da Tormenta que ocupa um quadrado de 3m de lado. O enxame pode passar pelo espaço de outras criaturas e não impede que outras criaturas entrem no espaço dele, mas é perigoso fazê-lo. No final de cada um de seus turnos, o enxame causa 4d12 pontos de dano de ácido a qualquer criatura que esteja ocupando o mesmo espaço que ele. As criaturas afetadas podem fazer um teste de Reflexos para reduzir o dano à metade. Você pode gastar uma ação de movimento para mover o enxame até 12m em qualquer direção. O enxame persiste enquanto você mantiver concentração na magia."}},aprimoramentos:[{custo:1,descricao:"além do normal, uma criatura que falhe no teste de Reflexos fica agarrada (o enxame escala e cobre o corpo dela). A criatura pode gastar uma ação padrão e fazer um teste de Acrobacia ou Atletismo para escapar. Se você mover o enxame, a criatura fica livre.",aumenta:!1},{custo:2,descricao:"aumenta o dano em +1d12.",aumenta:!0},{custo:2,descricao:"muda o dano para trevas.",aumenta:!1},{custo:3,descricao:"o enxame vira Enorme (quadrado de 6m de lado).",aumenta:!1},{custo:3,descricao:"o enxame ganha deslocamento de voo 18m e passa a ocupar um cubo ao invés de um quadrado.",aumenta:!1},{custo:4,descricao:"o enxame inclui parasitas inchados que explodem e criam novos enxames. No início de cada um de seus turnos, role 1d6. Em um resultado 5 ou 6, um novo enxame surge adjacente a um já existente à sua escolha. Você pode mover todos os enxames com uma única ação de movimento, mas eles não podem ocupar o mesmo espaço. Requer 4º círculo.",aumenta:!1}]},teletransporte:{name:"Teletransporte",type:"magia",img:"systems/tormenta20/icons/magias/teletransporte.webp",system:{circulo:"3",escola:"convocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"até 5 criaturas voluntárias",resistencia:"Nenhuma",custo:"6 PM",description:{value:'Esta magia transporta os alvos para um lugar a sua escolha a até 1.000km. Você precisa fazer um teste de Misticismo, com dificuldade que depende de seu conhecimento sobre o local de destino. CD 20. Um lugar familiar, que você visita com frequência. CD 30. Um lugar conhecido, que você já visitou pelo menos uma vez. CD 40. Um que você nunca visitou e só conhece a partir da descrição de outra pessoa que esteve lá. Você não pode se teletransportar para um lugar que nunca visitou sem a descrição de alguém. Ou seja, não pode se transportar para a "sala de tesouro do rei" se nunca esteve nela nem falou com alguém que esteve. Se passar no teste, os alvos chegam ao lugar desejado. Se falhar, os alvos surgem 1d10 x 10km afastados em qualquer direção (se o destino é uma cidade costeira, você pode surgir em alto-mar). Se falhar por 5 ou mais, você chega em um lugar parecido, mas errado. E se você rolar 1 natural no teste a magia falha (mas você gasta os PM) e fica atordoado por 1d4 rodadas.'}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +5.",aumenta:!0},{custo:2,descricao:"em vez do normal, a magia teletransporta os alvos para seu santuário - um local familiar e previamente preparado. A magia pode ser usada sem limite de distância ou necessidade de testes, mas apenas dentro do mesmo plano. Preparar um local como seu santuário exige um ritual de um dia e o gasto de T$ 1.000. Você só pode ter um santuário por vez.",aumenta:!1},{custo:9,descricao:"muda a execução para ação completa, a duração para cena e adiciona sacrifício de 1 PM. Em vez do normal, você cria um círculo de 1,5m de diâmetro no chão, que transporta qualquer criatura que pisar nele. O destino é escolhido quando a magia é lançada e pode ser qualquer lugar, em qualquer mundo, sem a necessidade de testes, desde que seja conhecido por você. O círculo é tênue e praticamente invisível. Você pode marcá-lo de alguma forma (por exemplo, lançando-o sobre uma plataforma elevada). Se não fizer isso, alguém pode pisar nele por acidente. Junte isso a um destino hostil e você terá uma armadilha bastante eficaz! Requer 5º círculo.",aumenta:!1}]}},evocacao:{"erupcao-glacial":{name:"Erupção Glacial",type:"magia",img:"systems/tormenta20/icons/magias/erupcao-glacial.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"quadrado de 6m de lado",resistencia:"Relfexos parcial",custo:"6 PM",description:{value:"Estacas de gelo irrompem do chão. Criaturas na área sofrem 4d6 de dano de corte, 4d6 de dano de frio e ficam caídas. Passar no teste de Reflexos evita o dano de corte e a queda. As estacas duram pela cena, o que torna a área afetada terreno difícil, e concedem cobertura leve para criaturas dentro da área ou atrás dela. As estacas são destruídas caso sofram qualquer quantidade de dano por fogo mágico."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano de frio em +2d6 e o dano de corte em +2d6.",aumenta:!0},{custo:4,descricao:"muda a área para cilindro com 6m de raio e 6m de altura e a duração para sustentada. Em vez do normal, a magia cria uma tempestade de granizo que causa 3d6 pontos de dano de impacto e 3d6 pontos de dano de frio em todas as criaturas na área (sem teste de resistência). A tempestade fornece camuflagem leve as criaturas dentro dela e deixa o piso escorregadio. Piso escorregadio conta como terreno difícil e obriga criaturas na área a fazer testes de Acrobacia para equilíbrio (veja o Capítulo 2). Requer 4º círculo.",aumenta:!1}]},"lanca-ignea":{name:"Lança Ígnea",type:"magia",img:"systems/tormenta20/icons/magias/lanca-ignea.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Reflexos parcial",custo:"6 PM",description:{value:"Esta magia foi desenvolvida por um mago imortal, um entusiasta dos estudos vulcânicos. Ela dispara um projétil de magma contra o alvo, que sofre 4d6 pontos de dano de fogo e 4d6 pontos de dano de perfuração e fica em chamas. As chamas causam 2d6 pontos de dano por rodada, em vez do dano normal. Se passar no teste de resistência, o alvo sofre metade do dano e não fica em chamas. Respingos de rocha incandescente se espalham com a explosão, atingindo todas as criaturas adjacentes ao alvo, que devem fazer um teste de Reflexos. Se falharem, ficam em chamas, como descrito acima."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano inicial em +2d6 e o dano do efeito em chamas em +1d6.",aumenta:!0},{custo:4,descricao:"muda a duração para cena ou até ser descarregada. Em vez do efeito normal, a magia cria quatro dardos de lava que flutuam ao lado do conjurador. Uma vez por rodada, como uma ação livre, você pode disparar um dos dardos em uma criatura, causando o efeito normal da magia. Requer 4º Círculo.",aumenta:!1}]},"muralha-elemental":{name:"Muralha Elemental",type:"magia",img:"systems/tormenta20/icons/magias/muralha-elemental.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"veja texto",custo:"6 PM",description:{value:"Cria uma muralha de um elemento a sua escolha. A muralha pode ser um muro de até 30m de comprimento e 3m de altura (ou o contrário) ou uma cúpula de 3m de raio. Os efeitos variam conforme o elemento escolhido. Fogo. Faz surgir uma violenta cortina de chamas. Um lado da muralha (a sua escolha) emite ondas de calor, que causam 2d6 pontos de dano de fogo em criaturas a até 6m quando você lança a magia e no início de seus turnos. Atravessar a muralha causa 8d6 pontos de dano de fogo. Caso seja criada em uma área onde existem criaturas, elas sofrem dano como se estivessem atravessando a muralha, mas podem fazer um teste de Reflexos para reduzir o dano à metade (a criatura escolhe para qual lado quer escapar, mas se escapar para o lado quente sofrerá mais 2d6 pontos de dano). Gelo. Evoca uma parede grossa de gelo denso com 15cm de espessura. Na forma de cúpula, pode prender uma ou mais criaturas, mas elas têm direito a um teste de Reflexos para escapar antes que a cúpula se forme. Cada trecho de 3m da muralha tem Defesa 8, 40 PV e RD 5. Um trecho da muralha que atinja 0 PV será rompido. Qualquer efeito de fogo causa dano dobrado à muralha. Uma criatura que atravesse um trecho rompido da muralha sofre 4d6 pontos de dano de frio."}},aprimoramentos:[{custo:2,descricao:"aumenta o comprimento em +15m e altura em +3m, até 60m de comprimento e 9m de altura.",aumenta:!0},{custo:4,descricao:"muda a duração para sustentada e adiciona uma nova escolha, Essência. A muralha é invisível e indestrutível - imune a qualquer forma de dano e não afetada por nenhuma magia. Ela não pode ser atravessada nem mesmo por criaturas incorpóreas. No entanto, magias que teletransportam criaturas, como Salto Dimensional, podem atravessá-la. Magias e efeitos de dano, como Bola de Fogo e o sopro de um dragão, não vencem a muralha, mas magias lançadas diretamente sobre uma criatura ou área, como Sono, podem ser lançadas contra alvos que estejam no outro lado como se tivessem linha de efeito. Requer 4º círculo.",aumenta:!1},{custo:2,descricao:"aumenta o dano por atravessar a muralha em +2d6.",aumenta:!0}]}},ilusao:{"ilusao-lacerante":{name:"Ilusão Lacerante",type:"magia",img:"systems/tormenta20/icons/magias/ilusao-lacerante.webp",system:{circulo:"3",escola:"ilusao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"cubo de 9m",resistencia:"Vontade anula",custo:"6 PM",description:{value:"Você cria uma ilusão de algum perigo mortal. Quando a magia é lançada, criaturas na área devem fazer um teste de Vontade; uma falha significa que a criatura acredita que a ilusão é real e sofre 3d6 pontos de dano psíquico não letal. Sempre que uma criatura iniciar seu turno dentro da área, deve repetir o teste de Vontade. Se falhar, sofre o dano novamente. Somente criaturas que falham veem a ilusão, e racionalizam o efeito sempre que falham no teste (por exemplo, acredita que o mesmo teto pode cair sobre ela várias vezes)."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano em +2d6.",aumenta:!0},{custo:4,descricao:"muda a área para um cubo de 90m. Requer 4º círculo.",aumenta:!0}]},miragem:{name:"Miragem",type:"magia",img:"systems/tormenta20/icons/magias/miragem.webp",system:{circulo:"3",escola:"ilusao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 dia",alvo:"cubo de até 90m de lado",resistencia:"Vontade desacredita",custo:"6 PM",description:{value:"Você faz um terreno parecer outro, incluindo sons e cheiros. Uma planície pode parecer um pântano, uma floresta pode parecer uma montanha etc. Esta magia pode ser usada para criar armadilhas: areia movediça pode parecer terra firme ou um precipício pode parecer um lago. Você pode alterar, incluir e esconder estruturas dentro da área, mas não criaturas (embora elas possam se esconder nas estruturas ilusórias)."}},aprimoramentos:[{custo:4,descricao:"além do normal, pode alterar a aparência de criaturas escolhidas na área, como se usando Disfarce Ilusório.",aumenta:!1},{custo:9,descricao:"muda a duração para permanente e adiciona componente material (pó de diamante no valor de T$ 1.000). Requer 5º círculo.",aumenta:!1}]}},necromancia:{"ferver-sangue":{name:"Ferver Sangue",type:"magia",img:"systems/tormenta20/icons/magias/ferver-sangue.webp",system:{circulo:"3",escola:"necromancia",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Fortitude parcial",custo:"6 PM",description:{value:"O sangue do alvo aquece rapidamente até entrar em ebulição. Quando a magia é lançada, e no início de cada um de seus turnos, o alvo sofre 4d8 pontos de dano de fogo e fica Enjoado por uma rodada (Fortitude reduz o dano à metade e evita a condição). Se o alvo passar em dois testes de Fortitude seguidos, dissipa a magia. Se o alvo for reduzido a 0 PV pelo dano desta magia, seu corpo explode, matando-o e causando 6d6 pontos de dano de fogo em todas as criaturas a até 3m (Reflexos reduz à metade). Essa magia não afeta criaturas sem sangue, como construtos ou mortos-vivos."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +1d8.",aumenta:!0},{custo:9,descricao:"muda alvo para criaturas escolhidas. Requer 5º círculo.",aumenta:!1}]},"tentaculos-de-trevas":{name:"Tentáculos de Trevas",type:"magia",img:"systems/tormenta20/icons/magias/tentaculos-de-trevas.webp",system:{circulo:"3",escola:"necromancia",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"esfera com 6m de raio",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Um círculo de energias sombrias se abre no chão, de onde surgem tentáculos feitos de treva viscosa. Ao lançar a magia e no início de cada um de seus turnos, você faz um teste da manobra agarrar (usando seu bônus de Misticismo) contra cada criatura na área. Se você passar, a criatura é agarrada; se a vítima já está agarrada, é esmagada, sofrendo 4d6 pontos de dano de trevas. A área conta como terreno difícil. Os tentáculos são imunes a dano. Agarrado"}},aprimoramentos:[{custo:2,descricao:"aumenta o raio da área em +3m.",aumenta:!0},{custo:3,descricao:"aumenta o dano dos tentáculos em +2d6.",aumenta:!0}]}},transmutacao:{telecinesia:{name:"Telecinésia",type:"magia",img:"systems/tormenta20/icons/magias/telecinesia.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",duracao:"sustentada ou instantânea (veja texto)",alvo:"veja texto;",resistencia:"Nenhuma",custo:"6 PM",description:{value:'Você move objetos ou criaturas se concentrando. Ao lançar a magia, escolha uma das opções a seguir. Força Contínua: você move uma criatura ou objeto de até 10 espaços, a até 6m por rodada. Uma criatura pode anular o efeito sobre ela, ou sobre um objeto que possua, passando num teste de Vontade. O alvo pode ser movido em qualquer direção dentro do alcance. Ele cai no chão se sair do alcance ou a magia terminar. Duração: sustentada. Empurrão Violento: nesta versão a energia mágica é expelida de uma única vez e arremessa até 10 objetos (no máximo 10 espaços). Os objetos devem estar a até 3m uns dos outros e podem ser arremessados até o alcance da magia. Objetos arremessados podem atingir criaturas em seu caminho, causando de 1 ponto de dano de impacto por espaço (objetos macios, sem pontas ou sem fio) até 1d6 pontos de dano por espaço (objetos duros, pontudos ou afiados). Criaturas atingidas têm direito a um teste de Reflexos para reduzir o dano à metade. Criaturas médias ou menores podem ser arremessadas, mas têm direito a um teste de Vontade para evitar o efeito (em si mesmas ou em objetos que estejam segurando). Uma criatura arremessada contra uma superfície sólida sofre 1d6 pontos de dano de impacto para cada 3m que "voou" no deslocamento (incluindo outras criaturas; nesse caso, ambas sofrem o dano). Duração: instantânea.'}},aprimoramentos:[{custo:3,descricao:"aumenta o tamanho máximo da criatura em uma categoria (para Grande, Enorme e Colossal) ou dobra a quantidade de espaços do objeto.",aumenta:!0}]},"transformacao-de-guerra":{name:"Transformação de Guerra",type:"magia",img:"systems/tormenta20/icons/magias/transformacao-de-guerra.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você se torna uma máquina de combate, ficando mais forte, rápido e resistente. Você recebe +6 na Defesa, testes de ataque e rolagens de dano corpo a corpo, e 30 PV temporários. Durante a Transformação de Guerra você não pode lançar magias, mas se torna proficiente em todas as armas."}},aprimoramentos:[{custo:2,descricao:"aumenta os bônus na Defesa, testes de ataque e rolagens de dano corpo a corpo em +1, e os PV temporários em +10.",aumenta:!0},{custo:2,descricao:"adiciona componente material (uma barra de adamante no valor de T$ 100). Sua forma de combate ganha um aspecto metálico e sem expressões. Além do normal, você recebe resistência a dano 10 e imunidade a atordoamento e efeitos de cansaço, encantamento, metabolismo, trevas e veneno, e não precisa respirar.",aumenta:!1}]},voo:{name:"Voo",type:"magia",img:"systems/tormenta20/icons/magias/voo.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você recebe deslocamento de voo 12m. Voar por meio desta magia é simples como andar — você pode atacar e lançar magias normalmente enquanto voa. Quando a magia termina, você desce lentamente até o chão, como se estivesse sob efeito de Queda Suave."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para toque e o alvo para 1 criatura.",aumenta:!1},{custo:4,descricao:"muda a duração para 1 dia. Requer 4º círculo.",aumenta:!1},{custo:4,descricao:"muda o alcance para curto e o alvo para até 10 criaturas. Requer 4° círculo.",aumenta:!1}]}}},"4-circulo":{abjuracao:{"campo-antimagia":{name:"Campo Antimagia",type:"magia",img:"systems/tormenta20/icons/magias/campo-antimagia.webp",system:{circulo:"4",escola:"abjuracao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você é cercado por uma barreira invisível com 3m de raio que acompanha seus movimentos. Qualquer magia ou habilidade mágica que entre na área da barreira é suprimida enquanto estiver lá. Criaturas convocadas que entrem em um Campo Antimagia desaparecem. Elas reaparecem na mesma posição quando a duração do Campo termina — supondo que a duração da magia que as convocou ainda não tenha terminado. Criaturas mágicas, como elementais, ou construtos imbuídos com magia durante sua criação, como golens, não são diretamente afetados pelo Campo Antimagia. Entretanto, como qualquer criatura, não poderão usar magias ou habilidades mágicas dentro dele. Magias que dissipam outras magias, como Dissipar Magia, nãodissipam um Campo Antimagia, e dois Campos na mesma área não se neutralizam. Artefatos e deuses maiores não são afetados por um Campo Antimagia"}}}},adivinhacao:{sonho:{name:"Sonho",type:"magia",img:"systems/tormenta20/icons/magias/sonho.webp",system:{circulo:"4",escola:"adv",ativacao:{custo:10,qtd:"10","condição":"",special:"",execucao:"minuto"},alcance:"any",duracao:"Veja Texto",alvo:"1 criatura viva",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você entra nos sonhos de uma criatura. Uma vez lá, pode conversar com ela até que ela acorde. Se o alvo não estiver dormindo quando você lançar a magia, você pode permanecer em transe até que ele adormeça. Durante o transe, você fica Indefeso e sem consciência dos arredores. Você pode sair do transe quando quiser, mas a magia termina."}},aprimoramentos:[{custo:2,descricao:"transforma o sonho do alvo em um pesadelo. A vítima deve fazer um teste de Vontade. Se falhar, não recupera PV ou PM pela noite, sofre 1d10 pontos de dano de trevas e acorda fatigada. A vítima recebe bônus ou penalidades em seu teste de resistência, dependendo do conhecimento que você tiver dela. Use os mesmos modificadores da magia Vidência.",aumenta:!1},{custo:1,descricao:"aumenta o número de alvos em +1. Todos os alvos compartilham um mesmo sonho (ou pesadelo) entre si e com você.",aumenta:!0}]}},convocacao:{"conjurar-elemental":{name:"Conjurar Elemental",type:"magia",img:"systems/tormenta20/icons/magias/conjurar-elemental.webp",system:{circulo:"4",escola:"convocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"medio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Esta magia transforma uma porção de um elemento inerte em uma poderosa criatura elemental Grande do tipo correspondente ao elemento utilizado. Você deve ter acesso a uma quantidade significativa do elemento: uma fogueira ou tocha para fogo, uma poça d'água ou fonte para água, terra solta ou rocha para terra, ou ar em movimento (como vento) para ar. O elemental criado é uma entidade consciente que obedece completamente aos seus comandos mentais, mesmo à distância. O elemental funciona como um parceiro mestre do tipo destruidor (cuja habilidade especial custa apenas 2 PM para ser usada) e possui um tipo adicional de parceiro à sua escolha entre os listados abaixo, baseado em seu elemento. O elemental auxilia apenas você e não conta em seu limite normal de parceiros. Tipos por elemento: Ar (assassino, perseguidor ou vigilante) - causa dano de eletricidade. Água (ajudante, guardião ou médico) - causa dano de frio. Fogo (atirador, combatente ou fortão) - causa dano de fogo. Terra (combatente, guardião ou montaria) - causa dano de impacto. O elemental persiste enquanto você mantiver concentração e possui inteligência suficiente para interpretar ordens complexas."}},aprimoramentos:[{custo:5,descricao:"o elemental muda para Enorme e recebe dois tipos de aliado indicados no seu elemento.",aumenta:!1},{custo:5,descricao:"você convoca um elemental de cada tipo. Quando lança a magia, você pode escolher se cada elemental vai auxiliar você ou um aliado no alcance. Requer 5º círculo.",aumenta:!1},{custo:0,descricao:"Elemental do Fogo Fortão",aumenta:!1}]},"mao-poderosa":{name:"Mão Poderosa",type:"magia",img:"systems/tormenta20/icons/magias/mao-poderosa.webp",system:{circulo:"4",escola:"convocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Esta magia cria uma mão flutuante de tamanho Grande que sempre se posiciona entre você e um oponente a sua escolha. A mão fornece cobertura leve (+5 na Defesa) contra esse oponente. Nada é capaz de enganar a mão — coisas como escuridão, invisibilidade, metamorfose e disfarces mundanos não a impedem de protegê-lo. A mão tem Defesa 20 e PV e resistências iguais aos seus. Com uma ação de movimento, você pode comandar a mão para que o proteja de outro oponente ou para que realize uma das ações a seguir. Agarrar: a mão usa uma manobra agarrar contra o oponente, usando o seu Misticismo com um bônus adicional de +10. A mão mantém o oponente agarrado, mas não causa dano. Esmagar: a mão esmaga um oponente agarrado, causando 2d6+10 pontos de dano de impacto. Empurrar: a mão afasta o oponente (manobra empurrar usando o seu Misticismo com um bônus adicional de +10). A mão acompanha o oponente para empurrá-lo o máximo que conseguir, dentro do alcance da magia."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano de impacto em +1d6+5.",aumenta:!0},{custo:5,descricao:"muda o bônus adicional em Misticismo para +20. Requer 5º círculo.",aumenta:!1}]}},encantamento:{"alterar-memoria":{name:"Alterar Memória",type:"magia",img:"systems/tormenta20/icons/magias/alterar-memoria.webp",system:{circulo:"4",escola:"encantamento",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Vontade anula",custo:"10 PM",description:{value:"Você invade a mente do alvo e altera ou apaga suas memórias da última hora."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para pessoal e o alvo para área cone de 4,5m.",aumenta:!1},{custo:5,descricao:"você pode alterar ou apagar as memórias das últimas 24 horas.",aumenta:!1}]},marionete:{name:"Marionete",type:"magia",img:"systems/tormenta20/icons/magias/marionete.webp",system:{circulo:"4",escola:"encantamento",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Fortitude anula",custo:"10 PM",description:{value:"Esta magia sinistra manipula diretamente o sistema nervoso do alvo, transformando-o em uma marionete viva sob seu controle. Ao ser afetada pela magia, e no início de cada um de seus turnos subsequentes, a vítima deve fazer um teste de Fortitude. Se passar, a magia é anulada e ela recupera o controle de seu corpo. Se falhar, todas as suas ações físicas naquele turno ficam completamente sob seu controle. A vítima mantém total consciência de tudo que acontece ao seu redor - pode ver, ouvir, pensar e até falar com certo esforço (mas não pode lançar magias que exijam gestos ou componentes verbais complexos). Contudo, seu corpo executa apenas os movimentos que você desejar. A vítima pode ser forçada a se movimentar, atacar aliados, usar habilidades de combate, abrir portas, entregar itens - qualquer ação física de que seja capaz. Você deve manter linha de efeito visual para controlar a vítima. Se perder o contato visual, não poderá dar novos comandos, mas ela ficará paralisada até que você recupere o controle ou a magia termine. Esta é uma das magias de controle mental mais temidas e éticamente questionáveis."}}}},evocacao:{"raio-polar":{name:"Raio Polar",type:"magia",img:"systems/tormenta20/icons/magias/raio-polar.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Fortitude parcial",custo:"10 PM",description:{value:"Você dispara um raio azul esbranquiçado de gelo e ar congelante. O alvo sofre 10d8 pontos de dano de frio e fica preso em um bloco de gelo (Paralisado). Se passar no teste de resistência, sofre metade do dano e, em vez de paralisado, fica Lento por uma rodada. é possível quebrar o gelo para libertar uma criatura presa: o bloco tem 20 PV, resistência a dano 10 e é vulnerável a fogo. Uma criatura presa pode usar uma ação completa para fazer um teste de Atletismo (com a mesma CD para resistir à magia) e tentar se libertar do gelo; cada vez que passar no teste causa 10 pontos de dano ao bloco, ignorando a RD."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano em +2d8.",aumenta:!0},{custo:5,descricao:"muda o alvo para área de esfera de 6m de raio. Em vez de um raio, você dispara uma esfera de gelo que explode, causando o efeito da magia em todas as criaturas na área.",aumenta:!1}]},"relampago-flamejante":{name:"Relâmpago Flamejante",type:"magia",img:"systems/tormenta20/icons/magias/relampago-flamejante.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"Duas Rodadas",execucao:"especial"},alcance:"medio",resistencia:"Reflexos reduz à metade",custo:"10 PM",description:{value:"Esta é uma magia poderosa, desenvolvida por um metódico e impassível arquimago. Você invoca as energias elementais do fogo e do relâmpago, fazendo com que uma de suas mãos fique em chamas e a outra mão eletrificada. Pela duração da magia, você pode gastar uma ação de movimento para disparar uma bola de fogo (10d6 pontos de dano de fogo numa esfera com 6m de raio) ou um relâmpago (10d6 pontos de dano de eletricidade numa linha). Você também pode, como uma ação padrão, usar as duas mãos num ataque de energia mista (20d12 pontos de dano, metade de fogo e metade de eletricidade, numa esfera de 9m de raio). Você precisa estar com as duas mãos livres para invocar o efeito misto e isso consome toda a energia da magia, terminando-a imediatamente. Por se tratar de um ritual complexo, o tempo de execução dessa magia não pode ser reduzido."}},aprimoramentos:[{custo:3,descricao:"aumenta o dano das rajadas em +1d6.",aumenta:!0},{custo:3,descricao:"aumenta o dano da rajada mista em +2d12.",aumenta:!0}]},"talho-invisivel":{name:"Talho Invisível",type:"magia",img:"systems/tormenta20/icons/magias/talho-invisivel.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"cone de 9m",resistencia:"Fortitude parcial",custo:"10 PM",description:{value:"Esta magia cruel foi desenvolvida por um mago de combate, quando ainda era um bípede. Você faz um gesto rápido e dispara uma lâmina de ar em alta velocidade. Criaturas na área sofrem 10d8 pontos de dano de corte e ficam sangrando. Alvos que passem no teste de resistência sofrem metade do dano e não ficam sangrando."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +2d8.",aumenta:!0},{custo:2,descricao:"muda o alvo para você e a duração para sustentada. Uma vez por rodada, como uma ação padrão, você pode disparar uma lâmina de ar contra um alvo em alcance médio, causando 6d8 pontos de dano de corte (Fortitude reduz à metade).",aumenta:!1}]}},ilusao:{"duplicata-ilusoria":{name:"Duplicata Ilusória",type:"magia",img:"systems/tormenta20/icons/magias/duplicata-ilusoria.webp",system:{circulo:"4",escola:"ilusao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você cria uma cópia ilusória semirreal de... você mesmo! Ela é idêntica em aparência, som e cheiro, mas é intangível. A cada turno, você escolhe se verá e ouvirá através da duplicata ou de seu corpo original. A cópia reproduz todas as suas ações, incluindo fala. Qualquer magia com alcance de toque ou maior que você lançar pode se originar da duplicata, em vez do seu corpo original. As magias afetam outros alvos normalmente, com a única diferença de se originarem da cópia, em vez de você. Se quiser que a duplicata faça algo diferente de você, você deve gastar uma ação de movimento. Qualquer criatura que interagir com a cópia tem direito a um teste de Vontade para perceber que é uma ilusão. As magias que se originam dela, no entanto, são reais. A cópia desaparece se sair do alcance."}},aprimoramentos:[{custo:3,descricao:"cria uma cópia adicional.",aumenta:!1}]},"explosao-caleidoscopica":{name:"Explosão Caleidoscópica",type:"magia",img:"systems/tormenta20/icons/magias/explosao-caleidoscopica.webp",system:{circulo:"4",escola:"ilusao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"esfera com 6m de raio",resistencia:"Fortitude parcial",custo:"10 PM",description:{value:"Esta magia cria uma forte explosão de luzes estroboscópicas e sons cacofônicos que desorientam as criaturas atingidas. O efeito que cada criatura sofre depende do ND dela. ND 4 ou menor: se falhar no teste de resistência, fica inconsciente. Se passar, fica atordoada por 1d4 rodadas e enjoada pelo resto da cena. ND entre 5 e 9: se falhar no teste de resistência, fica atordoada por 1d4 rodadas e enjoada pelo resto da cena. Se passar, fica atordoada por 1 rodada e enjoada por 1d4 rodadas. ND 10 ou maior: se falhar no teste de resistência, fica atordoada por 1 rodada e enjoada por 1d4 rodadas. Se passar, fica desprevenida e enjoada por 1 rodada. Uma criatura só pode ser atordoada por esta magia uma vez por cena. Inconsciente Atordoado Enjoado"}}}},necromancia:{"assassino-fantasmagorico":{name:"Assassino Fantasmagórico",type:"magia",img:"systems/tormenta20/icons/magias/assassino-fantasmagorico.webp",system:{circulo:"4",escola:"necromancia",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"cena, até ser descarregada",alvo:"1 criatura",resistencia:"Vontade Anula, Fortitude Parcial",custo:"10 PM",description:{value:"Usando os medos subconscientes do alvo, você cria uma imagem daquilo que ele mais teme. Apenas a própria vítima pode ver o Assassino Fantasmagórico com nitidez; outras criaturas presentes (incluindo o conjurador) enxergam apenas um espectro sombrio. Quando você lança a magia, o espectro surge adjacente a você e a vítima faz um teste de Vontade. Se ela passar, percebe que o espectro é uma ilusão e a magia é dissipada. Se falhar, acredita na existência do espectro, que então flutua 18m por rodada em direção à vítima, sempre no fim do seu turno. Ele é incorpóreo e imune a magias (exceto magias que dissipam outras). Se o espectro terminar seu turno adjacente à vítima, ela deve fazer um teste de Fortitude. Se passar, sofre 6d6 pontos de dano de trevas (este dano não pode reduzir o alvo a menos de 0 PV e não o deixa sangrando). Se falhar, sofre um colapso, ficando imediatamente com –1 PV e sangrando. O espectro persegue o alvo implacavelmente. Ele desaparece se o alvo ficar inconsciente ou se afastar além de alcance longo dele, ou se for dissipado."}}}},transmutacao:{"animar-objetos":{name:"Animar Objetos",type:"magia",img:"systems/tormenta20/icons/magias/animar-objetos.webp",system:{circulo:"4",escola:"transmutacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"Até 8 objetos Minúsculos ou Pequenos, 4 objetos Médios, 2 objetos Grandes ou 1 objeto Enorme",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você concede vida a objetos inanimados. Cada objeto se torna um parceiro sob seu controle. O tipo dele é escolhido da lista de tamanho e ele não conta em seu limite de parceiros. Com uma ação de movimento, você pode comandar mentalmente qualquer objeto animado dentro do alcance para que auxilie você ou outra criatura. Outros usos criativos para os objetos ficam a cargo do mestre. Objetos animados são construtos com valores de Força, Destreza e PV de acordo com seu tamanho. Todos os outros atributos nulos, eles não têm valor de Defesa ou testes de resistência e falham automaticamente em qualquer teste oposto. Diferente de parceiros comuns, um objeto pode ser alvo de um ataque direto. Esta magia não afeta itens mágicos, nem objetos que estejam sendo carregados por outra criatura. Esta magia não afeta itens mágicos, nem objetos que estejam sendo carregados por outra criatura. Estatísticas de objetos animados Minúsculo: For -3, Des 4, 5 PV; Assassino ou Combatente Iniciante. Pequeno: For -2, Des 2, 10 PV; Combatente ou Guardião Iniciante. Médio: For 0, Des 1, 20 PV; Combatente ou Guardião Veterano. Grande: For 2, Des 0, 40 PV; Fortão, Guardião ou Montaria (cavalo) Veterano. Enorme: For 4, Des -2, 60 PV; Fortão, Guardião ou Montaria (cavalo) Mestre."}},aprimoramentos:[{custo:5,descricao:"muda a duração para permanente e adiciona componente material (prataria no valor de T$ 1.000). Você pode ter um máximo de objetos animados igual à metade do seu nível.",aumenta:!1},{custo:0,descricao:"Assassino Iniciante",aumenta:!1},{custo:0,descricao:"Combatente Iniciante",aumenta:!1},{custo:0,descricao:"Combatente Veterano",aumenta:!1},{custo:0,descricao:"Fortão Veterano",aumenta:!1},{custo:0,descricao:"Fortão Mestre",aumenta:!1}]},"controlar-a-gravidade":{name:"Controlar a Gravidade",type:"magia",img:"systems/tormenta20/icons/magias/controlar-gravidade.webp",system:{circulo:"4",escola:"transmutacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"cubo de 12m de lado",resistencia:"Nenhuma",custo:"10 PM",description:{value:'Você controla os efeitos da gravidade dentro da área. Ao lançar a magia, escolha um dos efeitos abaixo. Enquanto a magia durar, você pode usar uma ação padrão para mudar o efeito. Aumentar: a gravidade fica mais forte. No início de seus turnos, cada criatura na área deve fazer um teste de Atletismo. Se passar, fica fatigada. Se falhar, fica fatigada e caída. Inverter: inverte a gravidade da área, fazendo com que criaturas e objetos "caiam" para cima, atingindo o topo (12m) em uma rodada. Se um obstáculo (como um teto) impedir o movimento das criaturas, elas sofrem 1d6 pontos de dano de impacto para cada 1,5m de "queda". Elas podem então se levantar e caminhar no obstáculo, de cabeça para baixo. Se não houver obstáculo, as criaturas e objetos ficam flutuando no topo da área afetada, sem poder sair do lugar. Criaturas voadoras podem se movimentar normalmente. Alguém adjacente a algo que possa agarrar tem direito a um teste de Reflexos para evitar a "queda". A criatura deve permanecer presa pela duração da magia; caso contrário "cairá". Reduzir: a gravidade fica mais leve. Criaturas ou objetos livres com até 100kg flutuam para cima e para baixo conforme sua vontade, com deslocamento de voo 6m. Criaturas na área recebem +20 de bônus em testes de Atletismo para escalar e saltar. Uma criatura levitando fica instável, sofrendo –2 de penalidade em testes de ataque. Fatigado Caído'}}},desintegrar:{name:"Desintegrar",type:"magia",img:"systems/tormenta20/icons/magias/desintegrar.webp",system:{circulo:"4",escola:"transmutacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura ou objeto",resistencia:"Fortitude parcial",custo:"10 PM",description:{value:"Você dispara um raio fino e esverdeado de energia desintegradora que causa 10d12 pontos de dano de essência. Este dano ignora qualquer resistência ou redução de dano, pois ataca diretamente a estrutura molecular do alvo. Se o alvo passar no teste de resistência de Fortitude, em vez disso sofre apenas 2d12 pontos de dano. Independentemente do resultado do teste de resistência, se os pontos de vida do alvo forem reduzidos a 0 ou menos por esta magia, ele será completamente desintegrado, restando apenas uma pequena pilha de pó fino. Criaturas desintegradas não podem ser ressuscitadas por magias normais, apenas por Desejo ou intervenção divina direta."}},aprimoramentos:[{custo:4,descricao:"aumenta o dano total em +2d12 e o dano mínimo em +1d12.",aumenta:!0}]},"forma-eterea":{name:"Forma Etérea",type:"magia",img:"systems/tormenta20/icons/magias/forma-eterea.webp",system:{circulo:"4",escola:"transmutacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você e todo o equipamento que está com você são transportados para o plano etéreo, que existe paralelamente ao plano material (o mundo físico). Na prática, é como ser transformado em um fantasma (mas você ainda é considerado uma criatura viva). Uma criatura etérea é invisível (pode alterar entre visível e invisível como ação livre), incorpórea e capaz de se mover em qualquer direção, inclusive para cima e para baixo. Ela enxerga o plano material, mas tudo parece cinza e insubstancial, reduzindo o alcance da visão e audição para 18m. Magias de abjuração e essência afetam criaturas etéreas, mas outras magias, não. Da mesma forma, uma criatura etérea não pode atacar nem lançar magias contra criaturas no plano material. Duas criaturas etéreas podem se afetar normalmente. Uma criatura afetada pode se materializar como uma ação de movimento, encerrando a magia. Uma criatura etérea que se materialize em um espaço ocupado é jogada para o espaço não ocupado mais próximo e sofre 1d6 pontos de dano de impacto para cada 1,5m de deslocamento."}},aprimoramentos:[{custo:5,descricao:"muda o alcance para toque e o alvo para até 5 criaturas voluntárias que estejam de mãos dadas. Depois que a magia é lançada, as criaturas podem soltar as mãos. Requer 5º círculo.",aumenta:!1}]}}},"5-circulo":{abjuracao:{"alterar-destino":{name:"Alterar Destino",type:"magia",img:"systems/tormenta20/icons/magias/alterar-destino.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"reaction"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Sua mente visualiza todas as possibilidades de um evento, permitindo a você escolher o melhor curso de ação. Você pode rolar novamente um teste de resistência com um bônus de +10 ou um inimigo deve rolar novamente um ataque contra você com uma penalidade de –10"}}},aprisionamento:{name:"Aprisionamento",type:"magia",img:"systems/tormenta20/icons/magias/aprisionamento.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade anula",custo:"15 PM",description:{value:"Você cria uma prisão mágica para aprisionar uma criatura. Se falhar no testede resistência, o alvo sofre o efeito da magia; se passar, fica imune a esta magia por uma semana. Enquanto estiver aprisionada, a criatura não precisa respirar e alimentar-se, e não envelhece. Magias de adivinhação não conseguem localizar ou perceber o alvo. Ao lançar a magia, você escolhe uma das seguintes formas de prisão. O componente material varia, mas todos custam T$ 1.000. Acorrentamento: o alvo é preso por correntes firmemente enraizadas no chão, que o mantém no lugar. O alvo fica paralisado e não pode se mover ou ser movido por qualquer meio. Componente Material: uma fina corrente de mitral. Contenção Mínima: o alvo diminui para 2 cm de altura e é preso dentro de uma pedra preciosa ou objeto semelhante. Luz passa através da pedra, permitindo que o alvo veja o lado de fora e seja visto, mas nada mais pode passar, nem por meio de teletransporte ou viagem planar. A pedra não pode ser quebrada enquanto o alvo estiver dentro. Componente Material: uma pedra preciosa, como um diamante ou rubi. Prisão Dimensional: o alvo é transportado para um semiplano protegido contra teletransporte e viagens planares. Pode ser um labirinto, uma gaiola, uma torre ou qualquer estrutura ou área confinada e pequena a sua escolha. Componente Material: uma representação em miniatura da prisão, feita de jade. Sepultamento: o alvo é sepultado nas profundezas da terra, em uma esfera mágica. Nada pode destruir ou atravessar a esfera, nem mesmo teletransporte ou viagens planares. Componente Material: um pequeno orbe de adamante. Sono Eterno: o alvo adormece e não pode ser acordado. Componente Material: fruta preparada com ervas soníferas raras. Quando a magia é lançada, você deve especificar uma condição que fará com que ela termine e solte o alvo. A condição pode ser tão específica ou elaborada quanto você quiser, mas deve ser possível de acontecer. As condições podem se basear no nome, identidade ou divindade padroeira de uma criatura, ou em ações ou qualidades observáveis, mas nunca em estatísticas intangíveis, como nível, classe ou pontos de vida. O mestre tem a palavra final sobre se uma condição é válida ou não. Paralisado"}}}},convocacao:{"chuva-de-meteoros":{name:"Chuva de Meteoros",type:"magia",img:"systems/tormenta20/icons/magias/chuva-de-meteoros.webp",system:{circulo:"5",escola:"convocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"longo",alvo:"quadrado com 18m de lado",resistencia:"Reflexos parcial",custo:"15 PM",description:{value:"Esta é uma das magias de destruição em massa mais devastadoras conhecidas. Você rasga um portal no espaço e convoca uma chuva literal de meteoros flamejantes que descem dos céus como punhos dos deuses. O céu escurece momentaneamente antes de dezenas de rochas incandescentes, cada uma do tamanho de uma carroça, despencarem sobre a área alvo em uma exibição apocalíptica de poder. EFEITOS DEVASTADORES: Todas as criaturas na área de 18m x 18m sofrem 15d6 pontos de dano de impacto (pelo impacto brutal das rochas) e 15d6 pontos de dano de fogo (pelo calor extremo), além de ficarem Caídas e Agarradas pelos escombros pesados. Criaturas que passem no teste de Reflexos sofrem apenas metade do dano total e conseguem evitar ficar caídas e agarradas. EFEITOS DURADOUROS: A área fica permanentemente alterada - coberta de crateras fumegantes, escombros de meteoros e uma densa nuvem de poeira que concede camuflagem leve a todas as criaturas. Todo o terreno torna-se difícil devido aos destroços. Criaturas agarradas pelos escombros podem escapar gastando uma ação padrão e passando em um teste de Atletismo (CD igual à da magia). LIMITAÇÕES: Esta magia só pode ser lançada a céu aberto - tetos, cavernas ou estruturas cobertas impedem a convocação dos meteoros. A magia é tão poderosa que pode ser vista e ouvida a quilômetros de distância, atraindo atenção indesejada. Estruturas na área são automaticamente destruídas, e o terreno pode ficar permanentemente alterado."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de meteoros que atingem a área, o que aumenta o dano em +2d6 de impacto e +2d6 de fogo.",aumenta:!0}]},semiplano:{name:"Semiplano",type:"magia",img:"systems/tormenta20/icons/magias/semiplano.webp",system:{circulo:"5",escola:"convocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",duracao:"1 dia",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Você cria uma dimensão particular. Você pode entrar no semiplano gastando uma ação padrão e 10 PM, desaparecendo do plano material como se tivesse se teletransportado. Você pode levar criaturas voluntárias que esteja tocando, ao custo de 1 PM por criatura extra. Você também pode levar objetos que esteja tocando, ao custo de 1 PM por objeto Médio ou menor, 2 PM por objeto Grande, 5 PM por Enorme e 10 PM por Colossal. Uma vez no semiplano, pode gastar uma ação completa para voltar ao plano material, no mesmo local onde estava. Caso conheça a magia Viagem Planar, pode lançá-la para voltar ao plano material em outro local. Você escolhe a forma e a aparência do semiplano — uma caverna, um asteroide que singra o éter, um palacete de cristal etc. Ele contém ar, luz e calor, mas além disso é vazio. Entretanto, você pode levar itens (mobília, ferramentas etc.) a cada viagem."}},aprimoramentos:[{custo:2,descricao:"adiciona alvo (1 criatura). Você cria uma semiplano labiríntico e expulsa o alvo para ele. A cada rodada, a vítima tem direito a um teste de Investigação ou Sobrevivência (CD da magia), com bônus cumulativo de +1 para cada teste já realizado, para escapar do labirinto. Quando o alvo escapa, a magia termina e o alvo reaparece no plano material no mesmo local onde estava quando a magia foi lançada. Magias como Salto Dimensional e\nTeletransporte não ajudam a escapar do\nlabirinto, mas Viagem Planar, sim.",aumenta:!1},{custo:5,descricao:"muda a duração para permanente e adiciona componente material (maquete do semiplano feito de materiais preciosos no valor de T$ 5.000). Você pode lançar a magia diversas vezes para aumentar as dimensões do semiplano em +30m de lado a cada vez.",aumenta:!1}]}},encantamento:{legiao:{name:"Legião",type:"magia",img:"systems/tormenta20/icons/magias/legiao.webp",system:{circulo:"5",escola:"encantamento",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"até 10 criaturas na área",resistencia:"Vontade parcial",custo:"15 PM",description:{value:"Você domina a mente dos alvos. Os alvos obedecem cegamente a seus comandos, exceto ordens claramente suicidas. Um alvo tem direito a um teste no final de cada um de seus turnos para se livrar do efeito. Alvos que passarem no teste ficam Abalado por 1 rodada enquanto recuperam a consciência."}},aprimoramentos:[{custo:1,descricao:"aumenta o número de alvos em +1.",aumenta:!0}]},possessao:{name:"Possessão",type:"magia",img:"systems/tormenta20/icons/magias/possessao.webp",system:{circulo:"5",escola:"encantamento",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 dia",alvo:"1 criatura",resistencia:"Vontade anual",custo:"15 PM",description:{value:"Você projeta sua consciência no corpo do alvo. Enquanto possuir uma criatura, você assume o controle total do corpo dela. O seu próprio corpo fica inconsciente e a consciência do alvo fica inerte. Em termos de jogo, você continua usando a sua ficha, mas com os atributos físicos e deslocamento da criatura. Se o alvo passar no teste de resistência, sabe que você tentou possuí-lo e fica imune a esta magia por um dia. Caso o corpo da criatura morra enquanto você a possui, a criatura morre e você deve fazer um teste de Vontade contra a CD da sua própria magia. Se passar, sua consciência retorna para o seu corpo (contanto que esteja dentro do alcance). Do contrário, você também morre. Retornar para o seu corpo voluntariamente é uma ação livre."}},aprimoramentos:[{custo:5,descricao:"você ganha acesso às habilidades de raça e classe da criatura.",aumenta:!1},{custo:5,descricao:'enquanto a magia durar e você estiver dentro do alcance do seu corpo original, pode "saltar" de uma criatura possuída para outra. O novo alvo tem direito a um teste de Vontade. Se falhar, você assume o controle do corpo dele e o alvo anterior recobra a consciência.',aumenta:!1},{custo:5,descricao:"muda a duração para permanente, mas destrói seu corpo original no processo. Uma criatura possuída pode fazer um teste de Vontade no começo do dia para retomar seu corpo. Se passar, recobra a consciência (e a sua própria consciência fica inerte). O teste se repete no início de cada dia. Se o corpo de uma criatura possuída morrer e houver outra criatura em alcance curto, você pode tentar possuí-la como uma reação. Enquanto houver novos corpos para possuir, você é imortal!",aumenta:!1}]}},evocacao:{"barragem-elemental":{name:"Barragem Elemental",type:"magia",img:"systems/tormenta20/icons/magias/barragem-elemental.webp",system:{circulo:"5",escola:"evocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",resistencia:"Reflexos parcial",custo:"15 PM",description:{value:"Criada por um arquimago, esta magia produz quatro esferas elementais (ácido, eletricidade, fogo e frio) que voam até um ponto a sua escolha. Quando atingem o ponto escolhido, explodem causando 6d6 pontos de dano do seu respectivo tipo numa área com 12m de raio. Um teste de Reflexos reduz o dano à metade. Você pode mirar cada esfera em uma criatura ou ponto diferente. Uma criatura ao alcance da explosão de mais de uma esfera deve fazer um teste de resistência para cada uma. Além disso, as esferas causam os seguintes efeitos em criaturas que falharem em seus respectivos testes de resistência: • ácido: Vulnerável até o fim da cena. • Elétrica: Atordoado por uma rodada. (apenas uma vez por cena). • Fogo: Em Chamas. • Frio: Lentoaté o fim da cena."}},aprimoramentos:[{custo:5,descricao:"aumenta o dano de cada esfera em +2d6.",aumenta:!0},{custo:5,descricao:"muda o tipo de dano de todas as esferas para essência (mas elas ainda causam os outros efeitos como se seu tipo de dano não mudasse).",aumenta:!1}]},"deflagracao-de-mana":{name:"Deflagração de Mana",type:"magia",img:"systems/tormenta20/icons/magias/deflagracao-de-mana.webp",system:{circulo:"5",escola:"evocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",alvo:"esfera de 15m de raio",resistencia:"Fortitude parcial",custo:"15 PM",description:{value:"Após concentrar seu mana, você emana energia, como uma estrela em plena terra. Todas as criaturas na área sofrem 150 pontos de dano de essência e todos os itens mágicos (exceto artefatos) tornam-se mundanos. Você não é afetado pela magia. Alvos que passem no teste de Fortitude sofrem metade do dano e seus itens mágicos voltam a funcionar após um dia."}},aprimoramentos:[{custo:1,descricao:"aumenta o dano em 10.",aumenta:!0},{custo:5,descricao:"afeta apenas criaturas a sua escolha.",aumenta:!1}]},"mata-dragao":{name:"Mata-Dragão",type:"magia",img:"systems/tormenta20/icons/magias/mata-dragao.webp",system:{circulo:"5",escola:"evocacao",ativacao:{custo:15,qtd:"","condição":"",special:"2 Rodadas",execucao:"especial"},alcance:"pessoal",alvo:"cone de 30m",resistencia:"Reflexos reduz à metade",custo:"15 PM",description:{value:"Esta é uma das mais poderosas magias de destruição existentes. Após entoar longos cânticos, o conjurador dispara uma carga de energia que varre uma enorme área à sua frente, causando 20d12 pontos de dano de essência em todas as criaturas, construções e objetos livres atingidos. Sempre que rola um resultado 12 em um dado de dano, a magia causa +1d12 pontos de dano. Apesar de seu poder destrutivo, esta magia é lenta, tornando seu uso difícil em combate."}},aprimoramentos:[{custo:1,descricao:"aumenta o dano em 1d12.",aumenta:!0}]}},ilusao:{requiem:{name:"Réquiem",type:"magia",img:"systems/tormenta20/icons/magias/requiem.webp",system:{circulo:"5",escola:"ilusao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",alvo:"criaturas escolhidas",resistencia:"Vontade anula",custo:"15 PM",description:{value:"Esta magia cria uma ilusão particular para cada uma das criaturas que atingir. Enquanto a magia durar, no início de cada um de seus turnos, cada criatura afetada deve fazer um teste de Vontade; se falhar, acha que não tomou as ações que realmente fez no turno anterior e é obrigada a repetir as mesmas ações neste turno, com uma penalidade cumulativa de –5 em todos os testes para cada vez que se repetir (a penalidade não se aplica ao teste de Vontade contra esta magia). Por exemplo, se a criatura se aproximou de um alvo e o atacou, precisa se aproximar desse mesmo alvo e atacar novamente. A ação repetida consome PM e recursos normalmente e, caso exija um teste de resistência, qualquer alvo faz esse teste com um bônus igual ao da penalidade desta magia."}}},"sombra-assassina":{name:"Sombra Assassina",type:"magia",img:"systems/tormenta20/icons/magias/sombra-assassina.webp",system:{circulo:"5",escola:"ilusao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade parcial",custo:"15 PM",description:{value:"Esta magia cria uma duplicata ilusória do alvo na forma de uma silhueta, ligada a ele como se fosse uma manifestação sólida de sua própria sombra. A duplicata de sombras segue automaticamente o alvo. Sempre que o alvo faz uma ação hostil — fazer um ataque, usar uma habilidade, lançar uma magia — a sombra imediatamente realiza a mesma ação contra o alvo, usando as mesmas estatísticas e rolagens. A sombra pode ser atacada, tem as mesmas estatísticas do alvo e é destruída quando chega a 0 PV. Se o alvo passar no teste de resistência, a sombra desaparece no final do turno do alvo, depois de copiar sua ação dessa rodada."}},aprimoramentos:[{custo:10,descricao:"muda o alvo para criaturas escolhidas na área.",aumenta:!1}]}},transmutacao:{"controlar-o-tempo":{name:"Controlar o Tempo",type:"magia",img:"systems/tormenta20/icons/magias/controlar-tempo.webp",system:{circulo:"5",escola:"transmutacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"veja texto",alvo:"veja texto",resistencia:"Nenhuma",custo:"15 PM",description:{value:'"Aquele que controla o tempo controla o mundo." Esta magia lendária manipula o fluxo temporal ao seu redor, permitindo feitos que desafiam as leis da realidade. Escolha um dos três efeitos devastadores: CONGELAR O TEMPO: Você cria uma bolha temporal onde o tempo flui diferentemente. Para todas as outras criaturas, a bolha surge e desaparece instantaneamente, mas para você ela dura 3 rodadas completas. Durante esse período, você pode agir livremente enquanto o mundo permanece congelado - projéteis param no ar, chamas ficam imóveis, criaturas ficam como estátuas. Você não é afetado por efeitos contínuos (fogo, veneno, sangramento) durante essas rodadas. LIMITAÇÃO: Você e todos os efeitos que gerar ficam confinados à área que ocupava ao lançar a magia. Efeitos de área com duração maior que a bolha voltam a funcionar normalmente quando ela termina. SALTAR NO TEMPO: Você e até 5 criaturas voluntárias desaparecem em um brilho dourado e são transportadas de 1 a 24 horas para o futuro (você escolhe). Vocês ressurgem no mesmo local, com a mesma velocidade e orientação - do ponto de vista de vocês, nenhum tempo passou. Se objetos sólidos agora ocupam o espaço de alguma criatura, ela ressurge na área vazia mais próxima. Esta é uma forma de viagem temporal unidirecional. VOLTAR NO TEMPO: Você revive os últimos segundos, desfazendo completamente a rodada anterior. Todas as ações são anuladas (incluindo perda de PV e PM), tudo retorna às posições do início do seu turno anterior, e apenas você mantém a memória do que aconteceu. Todos os outros personagens devem repetir exatamente as mesmas ações - a menos que você interfira ativamente (alertando aliados, mudando sua própria ação, etc.). Esta é a forma mais perigosa de manipulação temporal.'}}},desejo:{name:"Desejo",type:"magia",img:"systems/tormenta20/icons/magias/desejo.webp",system:{circulo:"5",escola:"transmutacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"especial",duracao:"veja texto",alvo:"veja texto",resistencia:"veja texto",custo:"15 PM",description:{value:"Esta é a mais poderosa e temida das magias arcanas, capaz de alterar a própria realidade através da força de vontade pura. Ao pronunciar seu desejo, você canaliza energias primordiais para remodelar o mundo. EFEITOS SEGUROS (sem custo adicional): • Dissipar instantaneamente os efeitos de qualquer magia de 4º círculo ou menor em qualquer criatura ou área. • Transportar até 10 criaturas voluntárias em alcance longo para qualquer local conhecido, em qualquer plano de existência. • Desfazer um acontecimento recente, permitindo que um teste realizado por qualquer criatura em alcance longo na última rodada seja refeito. Por exemplo, se um aliado morreu devido a um ataque crítico, você pode forçar o inimigo a rolar o ataque novamente. EFEITOS PODEROSOS (custam 2 PM adicionais): • Criar permanentemente um item mundano não-mágico de até T$ 30.000. • Duplicar perfeitamente os efeitos de qualquer magia de até 4º círculo (componentes materiais ainda são necessários). • Aumentar permanentemente um atributo de uma criatura em +1 (cada atributo pode ser aumentado apenas uma vez por Desejo). • Curar completamente todas as feridas, doenças, maldições e condições negativas de uma criatura. EFEITOS EXTRAORDINÁRIOS: Desejo pode realizar feitos ainda mais impressionantes, mas com riscos proporcionais. Desejar riqueza pode transportá-lo para o tesouro de um dragão furioso; desejar imortalidade pode transformá-lo em um lich; desejar poder supremo pode atrair a atenção de deuses hostis. O mestre tem total autoridade sobre esses efeitos e suas consequências imprevistas. Lembre-se: quanto maior o desejo, maior o preço a pagar."}}}}}},divina:{"1-circulo":{abjuracao:{"escudo-da-fe":{name:"Escudo da Fé",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_powerwordshield.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"reaction"},alcance:"curto",duracao:"1 turn",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Um escudo místico se manifesta momentaneamente para bloquear um golpe. O alvo recebe +2 na Defesa."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus na Defesa em +1.",aumenta:!0},{custo:2,descricao:"muda a execução para ação padrão, o alcance para toque e a duração para cena. A magia cria uma conexão mística entre você e o alvo. Além do efeito normal, o alvo sofre metade do dano por ataques e efeitos; a outra metade do dano é transferida a você. Se o alvo sair de alcance curto de você, a magia é dissipada. Requer 2º círculo.",aumenta:!1},{custo:3,descricao:"muda a duração para 1 dia. Requer 2º círculo.",aumenta:!1}]},"protecao-divina":{name:"Proteção Divina",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_divineprotection.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Esta magia cria uma barreira mística invisível que fornece ao alvo +2 em testes de resistência."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus concedido em +1.",aumenta:!0},{custo:2,descricao:"muda a execução para reação, o alcance para curto e a duração para 1 rodada. Em vez do normal, o alvo recebe +5 no próximo teste de resistência que fizer.",aumenta:!1},{custo:2,descricao:"muda o alvo para área de esfera com 3m de raio. Todos os aliados dentro da esfera recebem o bônus da magia. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"também torna o alvo imune a efeitos mentais e de medo. Requer 3º círculo.",aumenta:!1}]},santuario:{name:"Santuário",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sanctuary.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Vontade anula",custo:"1 PM",description:{value:"Qualquer criatura que tente fazer uma ação hostil contra o alvo deve fazer um teste de Vontade. Se falhar, não consegue, perde a ação e não pode tentar novamente até o fim da cena. Santuário não protege o alvo de efeitos de área. Além disso, o próprio alvo também não pode fazer ações hostis (incluindo forçar outras criaturas a atacá-lo), ou a magia é dissipada — mas pode usar habilidades e magias de cura e suporte como Curar Ferimentos e Bênção."}},aprimoramentos:[{custo:9,descricao:"também protege o alvo contra efeitos de área. Uma criatura que tente atacar uma área que inclua o alvo deve fazer o teste de Vontade; se falhar, não consegue e perde a ação. Ela só pode tentar novamente se o alvo sair da área.",aumenta:!1}]},"suporte-ambiental":{name:"Suporte Ambiental",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_protectionformnature.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",duracao:"1 dia",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Esta magia garante a sobrevivência em ambientes hostis. O alvo fica imune aos efeitos de calor e frio extremos, pode respirar na água se respirar ar (ou vice-versa) e não sufoca em fumaça densa."}},aprimoramentos:[{custo:5,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas.",aumenta:!1}]}},adivinhacao:{"detectar-ameacas":{name:"Detectar Ameaças",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_detectevil.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",duracao:"Cena, até ser descarregada",alvo:"Esfera de 18m de raio",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você recebe uma intuição aguçada sobre perigos ao seu redor. Quando uma criatura hostil ou armadilha entra na área do efeito, você faz um teste de Percepção (CD determinada pelo mestre de acordo com a situação). Se passar, sabe a origem (criatura ou armadilha), direção e distância do perigo. Se falhar, sabe apenas que o perigo existe."}},aprimoramentos:[{custo:2,descricao:"além do normal, você não fica surpreso e desprevenido contra perigos detectados com sucesso e recebe +5 em testes de resistência contra armadilhas. Requer 2º círculo.",aumenta:!1}]},orientacao:{name:"Orientação",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_guidance.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 rodada",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Em seu próximo teste de perícia, o alvo pode rolar dois dados e ficar com o melhor resultado"}},aprimoramentos:[{custo:2,descricao:"muda a duração para cena. Em vez do normal, escolha um atributo. Sempre que o alvo fizer um teste de perícia baseado no atributo escolhido, pode rolar dois dados e ficar com o melhor resultado. Não se aplica a testes de ataque ou resistência.\nRequer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda a duração para cena. Escolha entre atributos físicos (Força, Destreza e Constituição) ou mentais (Inteligência, Sabedoria e Carisma). Sempre que o alvo fizer um teste de perícia, pode rolar dois dados e ficar com o melhor resultado. Não se aplica a testes de ataque ou resistência. Requer 3º círculo.",aumenta:!1},{custo:5,descricao:"muda o alvo para criaturas escolhidas. Requer 3º círculo.",aumenta:!1}]}},convocacao:{"arma-espiritual":{name:"Arma Espiritual",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_spiritualguidence.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você invoca a arma preferida de sua divindade (se tiver uma), que surge flutuando a seu lado. Uma vez por rodada, quando você sofre um ataque corpo a corpo, pode usar uma reação para que a arma cause automaticamente 2d6pontos de dano do tipo da arma — por exemplo, uma espada longa causa dano de corte — no oponente que fez o ataque. Esta magia se dissipa se você morrer."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus na Defesa em +1.",aumenta:!0},{custo:2,descricao:"muda a duração para sustentada. Além do normal, uma vez por rodada, você pode gastar uma ação livre para fazer a arma acertar automaticamente um alvo adjacente. Se a arma atacar, não poderá contra-atacar até seu próximo turno. Requer 2o círculo.",aumenta:!1},{custo:2,descricao:"muda o tipo do dano para essência. Requer 2o círculo.",aumenta:!1},{custo:5,descricao:"invoca duas armas, permitindo que você contra-ataque (ou ataque, se usar o aprimoramento acima) duas vezes por rodada. Requer 3o círculo.",aumenta:!1},{custo:2,descricao:"aumenta o dano causado pela arma em +1d6, limitado pelo círculo máximo de magia que você pode lançar.",aumenta:!0}]},"caminhos-da-natureza":{name:"Caminhos da Natureza",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_naturepath.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 dia",alvo:"criaturas escolhidas",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você invoca espíritos da natureza, pedindo que eles abram seu caminho. As criaturas afetadas recebem deslocamento +3m e ignoram penalidades por terreno difícil em terrenos naturais."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus de deslocamento em +3m.",aumenta:!0}]},"criar-elementos":{name:"Criar Elementos",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_elementalprecision_01.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você cria uma pequena porção de um elemento, a sua escolha. Os elementos criados são reais, não mágicos. Elementos físicos devem surgir em uma superfície. Em vez de um cubo, pode-se criar objetos simples (sem partes móveis) feitos de gelo, terra ou pedra.Água: enche um recipiente de tamanho Minúsculo (como um odre) com água potável ou cria um cubo de gelo de tamanho Minúsculo.Ar: cria um vento fraco em um quadrado de 1,5m. Isso purifica a área de qualquer gás ou fumaça, ou remove névoa por uma rodada.Fogo: cria uma chama que ilumina como uma tocha. Você pode segurá-la na palma de sua mão sem se queimar, ou fazê-la surgir em um quadrado de 1,5m. Se uma criatura ou objeto estiver no quadrado, sofre 1d6 pontos de dano de fogo; se falhar num teste de Reflexos, pega fogo.Terra: cria um cubo de tamanho Minúsculo feito de terra, argila ou pedra."}},aprimoramentos:[{custo:2,descricao:"se escolheu fogo, aumenta o dano inicial de cada chama em +1d6.",aumenta:!0}]}},encantamento:{"acalmar-animal":{name:"Acalmar Animal",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_calmanimal.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 animal",resistencia:"Vontade anula",custo:"1 PM",description:{value:"O animal fica prestativo em relação a você. Ele não fica sob seu controle, mas percebe suas palavras e ações da maneira mais favorável possível. Você recebe +10 nos testes de Adestramento e Diplomacia que fizer contra o animal. Um alvo hostil ou que esteja envolvido em um combate recebe +5 em seu teste de resistência. Se você ou seus aliados tomarem qualquer ação hostil contra o alvo, a magia é dissipada e ele retorna à atitude que tinha antes (ou piorada, de acordo com o mestre). Se tratar bem o alvo, a atitude pode permanecer mesmo após o término da magia."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:5,descricao:"muda o alvo para 1 monstro ou espírito. Requer 3o círculo.",aumenta:!1}]},bencao:{name:"Bênção",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessing.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"Aliados",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Abençoa os alvos, que recebem +1 em testes de ataque e rolagens de dano. Bênção anula Perdição."}},aprimoramentos:[{custo:2,descricao:"aumenta os bônus em +1, limitado pelo círculo máximo de magia que você pode lançar.",aumenta:!0}]},comando:{name:"Comando",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_command.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 rodada",alvo:"1 humanóide",resistencia:"Vontade anula",custo:"1 PM",description:{value:"Esta magia permite que você dê uma ordem irresistível a um humanoide dentro do alcance. O alvo deve ser capaz de ouvir a ordem, mas não precisa entendê-la. Se falhar no teste de resistência de Vontade, ele obedecerá ao comando no seu próximo turno da melhor maneira possível. Você pode escolher entre os seguintes comandos: Fuja: O alvo gasta seu turno se afastando de você, utilizando todas as suas ações. Largue: O alvo solta quaisquer itens que esteja segurando e não pode pegá-los novamente até o início de seu próximo turno. Como esta é uma ação livre, ele ainda pode executar outras ações, exceto pegar o que largou. Pare: O alvo fica pasmo (apenas uma vez por cena). Sente: Com uma ação livre, o alvo senta no chão (se estava pendurado ou voando, desce até o chão). Ele pode fazer outras ações, mas não se levantar até o início de seu próximo turno. Venha: O alvo gasta seu turno se aproximando de você, utilizando todas as suas ações."}},aprimoramentos:[{custo:2,descricao:"aumenta a quantidade de alvos em +1",aumenta:!0}]},tranquilidade:{name:"Tranquilidade",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_tranquility.jpg",system:{circulo:"1",escola:"encantamento",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 animal ou humanóide",resistencia:"Vontade parcial",custo:"1 PM",description:{value:"Você emana ondas de serenidade. Se falhar na resistência, o alvo tem sua atitude mudada para indiferente (veja a página 259) e não pode atacar ou realizar qualquer ação agressiva. Se passar, sofre –2 em testes de ataque. Qualquer ação hostil contra o alvo ou seus aliados dissipa a magia e faz ele retornar à atitude que tinha antes (ou pior, de acordo com o mestre)."}},aprimoramentos:[{custo:5,descricao:"muda o alcance para médio e o alvo para criaturas escolhidas. Requer 3º círculo.",aumenta:!1}]}},evocacao:{consagrar:{name:"Consagrar",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_consecration.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 dia",alvo:"esfera com 9m de raio",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você enche a área com energia positiva. Pontos de vida curados por efeitos de luz são maximizados dentro da área. Isso também afeta dano causado em mortos-vivos por esses efeitos. Por exemplo, Curar Ferimentos cura automaticamente 18 PV. Esta magia não pode ser lançada em uma área contendo um símbolo visível dedicado a uma divindade que não a sua. Consagrar anula Profanar."}},aprimoramentos:[{custo:2,descricao:"aumenta as penalidades para mortos-vivos em -1.",aumenta:!0},{custo:9,descricao:"muda a execução para 1 hora, a duração para permanente e adiciona componente material (incenso e óleos no valor de T$ 1.000). Requer 4º círculo.",aumenta:!1}]},"curar-ferimentos":{name:"Curar Ferimentos",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_heal.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você canaliza energia positiva que recupera 2d8+2 pontos de vida na criatura tocada."}},aprimoramentos:[{custo:2,descricao:"também remove uma condição de fadiga do alvo.",aumenta:!1},{custo:2,descricao:"muda o alcance para curto.",aumenta:!1},{custo:5,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas.",aumenta:!1}]},despedacar:{name:"Despedaçar",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_smite.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura ou objeto mundano pequeno",resistencia:"Fortitude parcial ou Reflexos anula",custo:"1 PM",description:{value:"Esta magia emite um som alto e agudo. O alvo sofre 1d8+2 pontos de dano de impacto (ou o dobro disso e ignora RD se for um construto ou objeto mundano) e fica Atordoado por uma rodada (apenas uma vez por cena). Um teste de Fortitude reduz o dano à metade e evita o atordoamento."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +1d8+2.",aumenta:!0},{custo:2,descricao:"muda o alvo para objeto mundano Médio. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda o alvo para objeto mundano Grande. Requer 3º círculo.",aumenta:!1},{custo:9,descricao:"muda o alvo para objeto mundano Enorme. Requer 4º círculo.",aumenta:!1},{custo:14,descricao:"muda o alvo para objeto mundano Colossal. Requer 5º círculo.",aumenta:!1},{custo:5,descricao:"muda o alcance para pessoal e a área para esfera de 6m de raio. Todas as criaturas e objetos na área são afetados.",aumenta:!1}]}},necromancia:{"infligir-ferimentos":{name:"Infligir Ferimentos",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_inflictpain.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Fortitude reduz à metade",custo:"1 PM",description:{value:"Você canaliza energia negativa contra um alvo, causando 2d8+2 pontos de dano de trevas (ou curando 2d8+2 PV, se for um morto-vivo). Infligir Ferimentos anula Curar Ferimentos."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em 1d8+1.",aumenta:!0},{custo:2,descricao:"muda a resistência para nenhum. Como parte da execução da magia, você pode fazer um ataque corpo a corpo contra o alvo. Se acertar, causa o dano do ataque e o efeito da magia.",aumenta:!1},{custo:5,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas.",aumenta:!1}]},perdicao:{name:"Perdição",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curse.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"Criaturas Escolhidas",resistencia:"nenhuma",custo:"1 PM",description:{value:"Amaldiçoa os alvos, que recebem –1 em testes de ataque e rolagens de dano. Perdição anula Bênção."}},aprimoramentos:[{custo:2,descricao:"aumenta as penalidades em -1, limitado pelo círculo máximo de magia que você pode lançar.",aumenta:!0}]},profanar:{name:"Profanar",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_desecration.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 dia",alvo:"esfera com 9m de raio",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você enche a área com energia negativa. Dano causado por efeitos de trevas é maximizado dentro da área. Isso também afeta PV curados em mortos-vivos por esses efeitos. Esta magia não pode ser lançada em uma área contendo um símbolo visível dedicado a uma divindade que não a sua. Profanar anula Consagrar."}},aprimoramentos:[{custo:2,descricao:"aumenta os bônus para mortos-vivos em +1.",aumenta:!0},{custo:9,descricao:"muda a execução para 1 hora, a duração para permanente e adiciona componente material (incenso e óleos no valor de T$ 1.000). Requer 4º círculo.",aumenta:!1}]}},transmutacao:{"abencoar-alimentos":{name:"Abençoar Alimentos",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessingoffood.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"Alimento para 1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você purifica e abençoa uma porção de comida ou dose de bebida. Isso torna um alimento sujo, estragado ou envenenado próprio para consumo. Além disso, se for consumido até o final da duração, o alimento oferece 5 PV temporários ou 1 PM temporário (além de quaisquer bônus que já oferecesse). Bônus de alimentação duram um dia e cada personagem só pode receber um bônus de alimentação por dia."}}},"armamento-da-natureza":{name:"Armamento da Natureza",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_natureweapon.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 arma (veja texto)",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Você fortalece uma arma mundana primitiva (sem custo em T$, como bordão, clava, funda ou tacape), uma arma natural ou um ataque desarmado. O dano da arma aumenta em um passo e ela é considerada mágica. Ao lançar a magia, você pode mudar o tipo de dano da arma (escolhendo entre corte, impacto ou perfuração)."}},aprimoramentos:[{custo:2,descricao:"muda a execução para ação de movimento.",aumenta:!1},{custo:3,descricao:"aumenta o bônus nos testes de ataque em +1.",aumenta:!0},{custo:5,descricao:"aumenta o dano da arma em mais um passo.",aumenta:!0}]},"controlar-plantas":{name:"Controlar Plantas",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_controlplants.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"quadrado com 9m de lado",resistencia:"Reflexos anula",custo:"1 PM",description:{value:"Esta magia só pode ser lançada em uma área com vegetação. As plantas se enroscam nas criaturas da área. Aquelas que falharem na resistência ficam Enredado. Uma vítima pode se libertar com uma ação padrão e um teste de Acrobacia ou Atletismo. Além disso, a área é considerada terreno difícil. No início de seus turnos, a vegetação tenta enredar novamente qualquer criatura na área, exigindo um novo teste de Reflexos."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para pessoal, a área para alvo (você) e a resistência para nenhuma. Em vez do normal, você consegue se comunicar com plantas, que começam com atitude prestativa em relação a você. Além disso, você pode fazer testes de Diplomacia com plantas. Em geral, plantas têm uma percepção limitada de seus arredores e normalmente fornecem respostas simplórias.",aumenta:!1}]}}},"2-circulo":{abjuracao:{"circulo-da-justica":{name:"Círculo da Justiça",type:"magia",img:"systems/tormenta20/icons/magias/circulo-da-justica.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",duracao:"1 dia",alvo:"cubo com 9m de lado;",resistencia:"Vontade parcial",custo:"3 PM",description:{value:"Também conhecida como Lágrimas do Deus da Trapaça, esta magia é usada em tribunais e para proteger áreas sensíveis. Criaturas na área sofrem –10 em testes de Acrobacia, Enganação, Furtividade e Ladinagem e não podem mentir deliberadamente — mas podem tentar evitar perguntas que normalmente responderiam com uma mentira (sendo evasivas ou cometendo omissões, por exemplo). Uma criatura que passe na resistência tem as penalidades reduzidas para –5 e pode mentir."}},aprimoramentos:[{custo:1,descricao:"muda a execução para ação padrão, o alcance para pessoal, o alvo para você, a duração para cena e a resistência para nenhuma. Em vez do normal, qualquer criatura ou objeto invisível em alcance curto se torna visível. Isso não dissipa o efeito mágico; se sair do seu alcance, a criatura ou objeto voltam a ficar invisíveis.",aumenta:!1},{custo:7,descricao:"muda a duração para permanente e adiciona componente material (balança de prata no valor de T$ 5.000).",aumenta:!1}]},"vestimenta-da-fe":{name:"Vestimenta da Fé",type:"magia",img:"systems/tormenta20/icons/magias/vestimenta-da-fe.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",duracao:"1 dia",alvo:"1 armadura, escudo ou vestimenta",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você fortalece um item, aumentando o bônus de Defesa de uma armadura ou escudo em +2. No caso de um vestuário, ele passa a oferecer +2 na Defesa (não cumulativo com armadura). Os efeitos desta magia são uma melhoria no item, portanto são cumulativos com outras magias, mas não com bônus por encantos nesse item."}},aprimoramentos:[{custo:4,descricao:"aumenta o bônus em +1.",aumenta:!0},{custo:7,descricao:"o objeto também oferece resistência a dano 5. Requer 4º círculo.",aumenta:!1},{custo:0,descricao:"Aumenta o bônus em resistência em +1 (relativo ao efeito de +4 PM, que aumenta o bônus fornecido pela magia).",aumenta:!0}]}},adivinhacao:{augurio:{name:"Augúrio",type:"magia",img:"systems/tormenta20/icons/magias/augurio.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"3 PM",description:{value:'Esta magia diz se uma ação que você tomará em breve — no máximo uma hora no futuro — trará resultados bons ou ruins. O mestre rola 1d6 em segredo; com um resultado de 2 a 6, a magia funciona e você recebe uma das seguintes respostas: "felicidade" (a ação trará bons resultados); "miséria" (a ação trará maus resultados); "felicidade e miséria" (para ambos) ou "nada" (para ações que não trarão resultados bons ou ruins). Com um resultado 1, a magia falha e oferece o resultado "nada". Não há como saber se esse resultado foi dado porque a magia falhou ou não. Lançar esta magia múltiplas vezes sobre o mesmo assunto gera sempre o primeiro resultado. Por exemplo, se o grupo está prestes a entrar em uma câmara, o augúrio dirá "felicidade" se a câmara contém um tesouro desprotegido, "miséria" se contém um monstro, "felicidade e miséria" se houver um tesouro e um monstro ou "nada" se a câmara estiver vazia.'}},aprimoramentos:[{custo:7,descricao:'muda a execução para 10 minutos e a duração para 1 minuto. Em vez do normal, você consulta uma divindade, podendo fazer uma pergunta por rodada, desde que ela possa ser respondida com "sim", "não" ou "não sei" (embora poderosos, os deuses não são oniscientes). O mestre rola a chance de falha para cada pergunta. Em caso de falha, a resposta também é "não sei". Requer 4º círculo.',aumenta:!1},{custo:7,descricao:"o mestre rola 1d12; a magia só falha em um resultado 1.",aumenta:!1},{custo:12,descricao:"o mestre rola 1d20; a magia só falha em um resultado 1.",aumenta:!1}]},condicao:{name:"Condição",type:"magia",img:"systems/tormenta20/icons/magias/condicao.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"até 5 criaturas",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Pela duração da magia, você sabe a posição e status (PV atuais, se estão sob efeito de magia...) dos alvos. Depois de lançada, a distância entre você e os alvos não importa — a magia só deixa de detectar um alvo se ele morrer ou for para outro plano."}},aprimoramentos:[{custo:1,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:1,descricao:"aumenta a duração para 1 dia.",aumenta:!0}]},"globo-da-verdade":{name:"Globo da Verdade",type:"magia",img:"systems/tormenta20/icons/magias/globo-da-verdade.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Cria um globo flutuante e intangível, com 50cm de diâmetro. O globo mostra uma cena vista até uma semana atrás por você ou por uma criatura que você toque ao lançar a magia (mediante uma pergunta; a criatura pode fazer um teste de Vontade para anular o efeito), permitindo que outras pessoas a vejam."}},aprimoramentos:[{custo:1,descricao:"o globo mostra uma cena vista até um mês atrás.",aumenta:!1},{custo:2,descricao:"o globo mostra uma cena vista até um ano atrás.",aumenta:!1},{custo:2,descricao:"ao lançar a magia, você pode tocar um cadáver. O globo mostra a última cena vista por essa criatura.",aumenta:!1},{custo:4,descricao:"muda o alcance para longo e o efeito para 10 globos. Todos mostram a mesma cena.",aumenta:!1}]},"mente-divina":{name:"Mente Divina",type:"magia",img:"systems/tormenta20/icons/magias/mente-divina.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você fortalece a mente do alvo. Ele recebe +2 em Inteligência, Sabedoria ou Carisma, a sua escolha. Esse aumento não oferece PV, PM ou perícias adicionais."}},aprimoramentos:[{custo:7,descricao:"em vez do normal, o alvo recebe +4 no atributo escolhido. Requer 4º círculo.",aumenta:!1},{custo:0,descricao:"+2 Inteligência",aumenta:!0},{custo:0,descricao:"+2 Sabedoria",aumenta:!0},{custo:0,descricao:"+2 Carisma",aumenta:!0},{custo:15,descricao:"em vez do normal, o alvo recebe +4 nos três atributos mentais. Requer 5º círculo.",aumenta:!1}]},"voz-divina":{name:"Voz Divina",type:"magia",img:"systems/tormenta20/icons/magias/voz-divina.webp",system:{circulo:"2",escola:"adv",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você pode conversar com criaturas de qualquer raça e tipo: animal, construto, espírito, humanoide, monstro ou morto-vivo. Pode fazer perguntas e entende suas respostas, mesmo sem um idioma em comum ou se a criatura não for capaz de falar, mas respeitando os limites da Inteligência dela. A atitude dessas criaturas não é alterada, mas você pode usar a perícia Diplomacia para tentar mudar sua atitude."}},aprimoramentos:[{custo:1,descricao:"você concede um pouco de vida a um cadáver, suficiente para que ele responda a suas perguntas. O conhecimento do corpo é limitado ao que ele tinha enquanto vivo e suas respostas são curtas e enigmáticas. Um corpo só pode ser alvo desta magia uma vez. Ela também não funciona em um corpo cuja cabeça tenha sido destruída.",aumenta:!1},{custo:1,descricao:"você pode falar com plantas (normais ou monstruosas) e rochas. Plantas e rochas têm percepção limitada de seus arredores e normalmente fornecem respostas simplórias.",aumenta:!1}]}},convocacao:{"enxame-de-pestes":{name:"Enxame de Pestes",type:"magia",img:"systems/tormenta20/icons/magias/enxame-de-pestes.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"medio",resistencia:"Fortitude reduz à metade",custo:"3 PM",description:{value:"Você conjura um enxame de criaturas a sua escolha, como besouros, gafanhotos, ratos, morcegos ou serpentes. O enxame pode passar pelo espaço de outras criaturas e não impede que outras criaturas entrem no espaço dele. No final de seus turnos, o enxame causa 2d12 pontos de dano de corte a qualquer criatura em seu espaço (Fortitude reduz à metade). Você pode gastar uma ação de movimento para mover o enxame 12m."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +1d12.",aumenta:!0},{custo:5,descricao:"aumenta o número de enxames em +1. Eles não podem ocupar o mesmo espaço. Requer 3º círculo.",aumenta:!0},{custo:7,descricao:"muda a resistência para Reflexos reduz à metade e o enxame para criaturas elementais. Ele causa 5d12 pontos do dano (a sua escolha entre ácido, eletricidade, fogo ou frio). O resto da magia segue normal. Requer 4º círculo.",aumenta:!1}]},"soco-do-mestre":{name:"Soco do Mestre",type:"magia",img:"systems/tormenta20/icons/magias/soco-do-mestre.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura",resistencia:"Fortitude parcial",custo:"3 PM",description:{value:"Ninguém sabe se Mestre foi realmente o criador desta magia — mas ele foi o primeiro a utilizá-la. Você fecha o punho e gesticula como se estivesse golpeando o alvo, causando dano de impacto igual a 4d6 + sua Força. A vítima é empurrada 3m na direção oposta à sua. Passar no teste de resistência reduz o dano à metade e evita o empurrão."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para pessoal, o alvo para você, a duração para cena e a resistência para nenhuma. Em vez do normal, seus ataques corpo a corpo passam a acertar inimigos distantes. Seu alcance natural aumenta em 3m; uma criatura Média pode atacar adversários a até 4,5m, por exemplo.",aumenta:!1},{custo:2,descricao:"aumenta o dano em +1d6.",aumenta:!0},{custo:4,descricao:"aumenta o empurrão em +3m.",aumenta:!0},{custo:5,descricao:"muda o tipo do dano para essência.",aumenta:!1}]}},encantamento:{"aliado-animal":{name:"Aliado Animal",type:"magia",img:"systems/tormenta20/icons/magias/aliado-animal.webp",system:{circulo:"2",escola:"encantamento",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 animal prestativo",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você cria um vínculo mental com um animal prestativo em relação a você. O Aliado Animal obedece a você no melhor de suas capacidades, mesmo que isso arrisque a vida dele. Ele funciona como um parceiro veterano, de um tipo a sua escolha entre ajudante, combatente, fortão, guardião, montaria ou perseguidor."}},aprimoramentos:[{custo:1,descricao:"muda o alvo para 1 animal Minúsculo e a duração para 1 semana. Em vez do normal, o animal se desloca no melhor de suas capacidades até um local designado por você - em geral, para levar um item, carta ou similar. Quando o animal chega ao destino, fica esperando até o fim da magia, permitindo apenas que uma ou mais criaturas escolhidas por você se aproximem e peguem o que ele estiver carregando.",aumenta:!1},{custo:7,descricao:"muda o parceiro para mestre. Requer 3º círculo.",aumenta:!1},{custo:12,descricao:"muda o alvo para 2 animais prestativos. Cada animal funciona como um parceiro de um tipo diferente, e você pode receber a ajuda de ambos (mas ainda precisa seguir o limite de parceiros de acordo com o seu nível de personagem). Requer 4º círculo.",aumenta:!1}]},oracao:{name:"Oração",type:"magia",img:"systems/tormenta20/icons/magias/oracao.webp",system:{circulo:"2",escola:"encantamento",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"todas as criaturas (veja texto)",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você e todos os seus aliados no alcance recebem +2 em testes de perícia e rolagens de dano, e todos os seus inimigos no alcance sofrem –2 em testes de perícia e rolagens de dano. Esse efeito é cumulativo com outras magias. Componente Material: T$ 25por PM gastos em incensos ou outras oferendas."}},aprimoramentos:[{custo:2,descricao:"aumenta os bônus em +1 (bônus máximo limitado pelo círculo máximo de magia que você pode lançar).",aumenta:!0},{custo:2,descricao:"aumenta as penalidades em -1, limitado pelo círculo máximo de magia que você pode lançar.",aumenta:!0},{custo:7,descricao:"muda o alcance para médio. Requer 3º círculo.",aumenta:!1},{custo:12,descricao:"muda a duração para cena. Requer 4º círculo",aumenta:!1}]}},evocacao:{"controlar-fogo":{name:"Controlar Fogo",type:"magia",img:"systems/tormenta20/icons/magias/controlar-fogo.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"veja texto",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você pode criar, moldar, mover ou extinguir chamas e emanações de calor. Ao lançar a magia, escolha um dos efeitos. Chamejar: o alvo é armas escolhidas. Elas causam +1d6 de dano de fogo. Também afeta armas naturais e ataques desarmados. Esquentar: o alvo é 1 objeto, que começa a esquentar. Ele sofre 1d6 pontos de dano de fogo por rodada e causa o mesmo dano a qualquer criatura que o esteja segurando ou vestindo. A critério do mestre, o objeto ou a criatura vestindo-o também podem fica em chamas. Uma criatura pode gastar uma ação completa para resfriar o objeto (jogando areia ou se jogando numa fonte de água próxima, por exemplo) e cancelar o efeito da magia. Extinguir: o alvo é 1 chama de tamanho Grande ou menor, que é apagada. Isso cria uma nuvem de fumaça que ocupa uma esfera de 3m de raio centrada onde estava a chama. Dentro da fumaça, criaturas têm camuflagem leve. Modelar: o alvo é 1 chama de tamanho Grande ou menor. A cada rodada, você pode gastar uma ação livre para movimentá-la 9m em qualquer direção. Se atravessar o espaço ocupado por uma criatura, causa 2d6 pontos de dano de fogo. Uma criatura só pode receber dano dessa maneira uma vez por rodada."}},aprimoramentos:[{custo:1,descricao:"muda a duração para sustentada e a resistência para Reflexos reduz à metade. Em vez do normal, você deve escolher o seguinte efeito. Labaredas: a cada rodada, você pode gastar uma ação de movimento para projetar uma labareda, acertando um alvo em alcance curto a partir da chama. O alvo sofre 4d6 pontos de dano de fogo (Reflexos reduz à metade).",aumenta:!1},{custo:2,descricao:"aumenta o dano em +1d6 (exceto Chamejar).",aumenta:!0}]},purificacao:{name:"Purificação",type:"magia",img:"systems/tormenta20/icons/magias/purificacao.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você purifica a criatura tocada, removendo uma condição dela entre abalado, Apavorado, Alquebrado, Atordoado, Cego, Confuso, Debilitado, Enjoado, Envenenado, Esmorecido, Exausto, Fascinado, Fatigado,Fraco, Frustrado, Lento, Ofuscado, Paralisado, Pasmo ou Surdo."}},aprimoramentos:[{custo:2,descricao:"também cura todos os PV perdidos por veneno.",aumenta:!1},{custo:2,descricao:"em vez de uma, remove todas as condições listadas.",aumenta:!1},{custo:7,descricao:"também dissipa magias e efeitos prejudiciais de encantamento, necromancia e transmutação afetando o alvo. Requer 3º círculo.",aumenta:!1}]},"raio-solar":{name:"Raio Solar",type:"magia",img:"systems/tormenta20/icons/magias/raio-solar.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"linha",resistencia:"Reflexos (veja texto)",custo:"3 PM",description:{value:"Você canaliza uma poderosa rajada de energia positiva que ilumina o campo de batalha. Criaturas na área sofrem 4d8 pontos de dano de luz (ou 4d12, se forem mortos-vivos) e ficam Ofuscado por uma rodada. Se passarem na resistência, sofrem metade do dano e não ficam ofuscadas. Cego"}},aprimoramentos:[{custo:2,descricao:"aumenta o dano ou cura em +1d8 (ou +1d12 em mortos-vivos).",aumenta:!0}]},"tempestade-divina":{name:"Tempestade Divina",type:"magia",img:"systems/tormenta20/icons/magias/tempestade-divina.webp",system:{circulo:"2",escola:"evocacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"longo",alvo:"cilindro com 15m de raio e 15m de altura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Esta magia só pode ser usada em ambientes abertos. A área fica sujeita a um vendaval — ataques à distância sofrem penalidade de –5, chamas são apagadas e névoas são dissipadas. Você também pode gerar chuva (–5 em testes de Percepção), neve (como chuva, e a área se torna terreno difícil) ou granizo (como chuva, mais 1 ponto de dano de impacto por rodada, no início de seus turnos)."}},aprimoramentos:[{custo:1,descricao:"muda a duração para sustentada. Além do normal, uma vez por rodada você pode gastar uma ação padrão para fazer um raio cair sobre um alvo na área, causando 3d8 pontos de dano de eltricidade (Reflexos reduz à metade).",aumenta:!1},{custo:2,descricao:"aumenta o dano de raios (veja acima) em +1d8.",aumenta:!0}]}},ilusao:{silencio:{name:"Silêncio",type:"magia",img:"systems/tormenta20/icons/magias/silencio.webp",system:{circulo:"2",escola:"ilusao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"esfera com 6m de raio",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Um silêncio sepulcral recai sobre a área e nenhum som é produzido nela. Enquanto estiverem na área, todas as criaturas ficam Surdo. Além disso, como lançar magias exige palavras mágicas, normalmente nenhuma magia pode ser lançada dentro da área."}},aprimoramentos:[{custo:1,descricao:"muda a área para alvo de 1 objeto. Em vez do normal, o alvo emana uma área de silêncio com 3m de raio. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la.",aumenta:!1},{custo:2,descricao:"muda a duração para cena. Em vez do normal, nenhum som pode deixar a área, mas criaturas dentro da área podem falar, ouvir e lançar magias com palavras mágicas normalmente.",aumenta:!1}]}},necromancia:{"miasma-mefitico":{name:"Miasma Mefítico",type:"magia",img:"systems/tormenta20/icons/magias/miasma-mefitico.webp",system:{circulo:"2",escola:"necromancia",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"nuvem com 6m de raio",resistencia:"Fortitude (veja texto)",custo:"3 PM",description:{value:"A área é coberta por emanações letais. Criaturas na área sofrem 5d6 pontos de dano de ácido e ficam Enjoado por 1 rodada. Se passarem na resistência, sofrem metade do dano e não ficam enjoadas."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +1d6.",aumenta:!0}]},"rogar-maldicao":{name:"Rogar Maldição",type:"magia",img:"systems/tormenta20/icons/magias/rogar-maldicao.webp",system:{circulo:"2",escola:"necromancia",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Fortitude anula",custo:"3 PM",description:{value:"Você entoa cânticos maléficos que amaldiçoam uma vítima, criando efeitos variados. Ao lançar a magia, escolha entre os seguintes. Debilidade: o alvo fica Esmorecido e não pode se comunicar ou lançar magias. Ainda reconhece seus aliados e pode segui-los e ajudá-los, mas sempre de maneira simplória. Doença: muda a duração para instantânea. O alvo contrai uma doença a sua escolha, que o afeta imediatamente (sem período de incubação). Fraqueza: o alvo fica Debilitadoe Lento. Isolamento: o alvo perde o uso de um de seus cinco sentidos a sua escolha. Se perder a visão, fica Cego. Se perder a audição, fica Surdo. Se perder o olfato ou paladar, não pode usar a habilidade faro. Se perder o tato, fica Caído e não pode se levantar. Você também pode inventar sua própria maldição, usando esses exemplos como sugestões, mas o mestre tem a palavra final sobre o efeito."}},aprimoramentos:[{custo:7,descricao:"muda a duração para permanente e resistência para Fortitude parcial. Se passar, a criatura ainda sofre os efeitos da maldição, mas por 1 rodada. Requer 4º círculo.",aumenta:!1}]}},transmutacao:{"controlar-ar":{name:"Controlar Ar",type:"magia",img:"icons/magic/air/wind-tornado-cyclone-white.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"varia",resistencia:"veja texto",custo:"3 PM",description:{value:'ERRATA DO ALMANAQUE DRAGãO BRASIL (jamboeditora.com.br) Você pode controlar os movimentos e comportamentos de massas de ar. Ao lançar a magia, escolha um dos efeitos abaixo. Ascender:cria uma corrente de ar ascendente capaz de erguer do chão uma criatura ou objeto médio, fazendo o alvo ﬂutuar para cima e para baixo conforme sua vontade. Você pode gastar uma ação de movimento para subir ou descer o alvo até 6m por rodada, até um máximo de 30m de altura. Você não pode mover o alvo horizontalmente — mas o alvo pode, por exemplo, escalar uma colina ou se apoiar no teto para mover-se lateralmente (com metade de seu deslocamento normal). Uma criatura levitando fica vulnerável e sofre –2 nas jogadas de ataque. Alvos involuntários tem direito a um teste de Fortitude no início de seu turno para negar o efeito. Derrubar um alvo flutuando (simplesmente parando a corrente de ar) causa o dano normal de queda, mas um alvo que passe no teste pode "nadar" para o chão contra a corrente. Você pode usar essa opção para fazer uma manobra derrubar contra uma criatura voadora dentro do alcance, usando seu atributo-chave no lugar de Força. Sopro:cria uma lufada de vento a partir de suas mãos, que empurra qualquer criatura Média ou menor em um cone de 4,5m — faça uma manobraempurrarusando seu atributo-chave ao invés de força, usando o mesmo resultado de sua rolagem para todos os alvos. A lufada de vento também faz qualquer coisa que um vento forte e súbito faria, como levantar pó, dispersar vapores, apagar chamas, espalhar papéis ou mover uma embarcação. Manter o sopro ativo exige uma ação padrão. Vento:cria uma área de vento forte (Tormenta20 página 253) dentro do alcance da magia. Se lançada numa área que já esteja com algum efeito de vento, aumenta esse efeito em um passo. Manter o vento ativo requer uma ação de movimento. Você também pode usar essa opção para reduzir os efeitos de vento em uma área.'}},aprimoramentos:[{custo:2,descricao:"aumenta o limite de tamanho de criaturas e objetos afetados em um passo.",aumenta:!0}]},"controlar-madeira":{name:"Controlar Madeira",type:"magia",img:"systems/tormenta20/icons/magias/controlar-madeira.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1objeto de madeira grande ou menor",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você molda, retorce, altera ou repele madeira. Se lançar esta magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Ao lançar a magia, escolha. Fortalecer: deixa o alvo mais resistente. Armas têm seu dano aumentado em um passo. Escudos têm seu bônus de Defesa aumentado em +2 (isso é uma melhoria no item, portanto é cumulativa com outras magias). Esses e outros itens de madeira recebem +5 na RD e dobram seus PV. Modelar: muda a forma do alvo. Pode transformar um galho em espada, criar uma porta onde antes havia apenas uma parede, transformar um tronco em uma caixa... Mas não pode criar mecanismos complexos (como uma besta) ou itens consumíveis. Repelir: o alvo é repelido por você. Se for uma arma, ataques feitos com ela contra você falham automaticamente. Se for uma porta ou outro objeto que possa ser aberto, ele vai se abrir quando você se aproximar, mesmo que esteja trancado. Um objeto que vá atingi-lo, como uma carroça, tronco ou barril, vai desviar ou parar adjacente a você, sem lhe causar dano. Os efeitos de regras em outros objetos de madeira ficam a cargo do mestre. Retorcer: estraga o alvo. Uma porta retorcida emperra (exigindo um teste de Força contra CD 25 para ser aberta). Armas e itens retorcidos impõem –5 em testes de perícia. Escudos retorcidos deixam de oferecer bônus (mas ainda impõem penalidades). Um barco retorcido começa a afundar e naufraga ao final da cena. Os efeitos de regras em outros objetos de madeira ficam a cargo do mestre."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para pessoal, o alvo para você e a duração para 1 dia. Você e seu equipamento se transformam em uma árvore de tamanho Grande. Nessa forma, você não pode falar ou fazer ações físicas, mas consegue perceber seus arredores normalmente. Se for atacado nessa forma, a magia é dissipada. Um teste de Sobrevivência (CD 30) revela que você não é uma árvore verdadeira.",aumenta:!1},{custo:7,descricao:"muda o alvo para Enorme ou menor. Requer 3º círculo.",aumenta:!1},{custo:12,descricao:"muda o alvo para Colossal ou menor. Requer 4º círculo.",aumenta:!1}]},"fisico-divino":{name:"Físico Divino",type:"magia",img:"systems/tormenta20/icons/magias/fisico-divino.webp",system:{circulo:"2",escola:"transmutacao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você fortalece o corpo do alvo. Ele recebe +2 em Força, Destreza ou Constituição, a sua escolha. Esse aumento não oferece PV ou PM adicionais."}},aprimoramentos:[{custo:7,descricao:"em vez do normal, o alvo recebe +4 no atributo escolhido. Requer 4º círculo.",aumenta:!1},{custo:15,descricao:"em vez do normal, o alvo recebe +4 nos três atributos físicos. Requer 5º círculo.",aumenta:!1},{custo:0,descricao:"+2 em Força",aumenta:!0},{custo:0,descricao:"+2 em Destreza",aumenta:!0},{custo:0,descricao:"+2 em Constituição",aumenta:!0}]}}},"3-circulo":{abjuracao:{banimento:{name:"Banimento",type:"magia",img:"systems/tormenta20/icons/magias/banimento.webp",system:{circulo:"3",escola:"abjuracao",ativacao:{custo:6,qtd:"","condição":"",special:"1d3+1 rodadas",execucao:"especial"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade parcial",custo:"6 PM",description:{value:"Você expulsa uma criatura não nativa de Arton. Um alvo nativo de outro mundo (como muitos espíritos), é teletransportado de volta para um lugar aleatório de seu mundo de origem. Já um alvo morto-vivo tem sua conexão com as energias negativas rompidas, sendo reduzido a 0 PV. Se passar na resistência, em vez dos efeitos acima, o alvo fica enjoado por 1d4 rodadas. Se você tiver um ou mais itens que se oponham ao alvo de alguma maneira, a CD do teste de resistência aumenta em +2 por item. Por exemplo, se lançar a magia contra demônios do frio (vulneráveis a água benta e que odeiam luz e calor) enquanto segura um frasco de água benta e uma tocha acesa, a CD aumenta em +4. O mestre decide se determinado item é forte o bastante contra a criatura para isso."}},aprimoramentos:[{custo:0,descricao:"muda a resistência para nenhum. Em vez do normal, devolve automaticamente uma criatura conjurada (como por uma magia de convocação) para seu plano de origem.",aumenta:!1}]},"protecao-contra-magia":{name:"Proteção Contra Magia",type:"magia",img:"systems/tormenta20/icons/magias/protecao-contra-magia.webp",system:{circulo:"3",escola:"abjuracao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você protege o alvo contra efeitos mágicos nocivos. O alvo recebe +5 em testes de resistência contra magias."}},aprimoramentos:[{custo:4,descricao:"muda o bônus para +10. Requer 4º círculo.",aumenta:!1},{custo:4,descricao:"em vez do normal, o alvo fica imune a uma escola de magia a sua escolha. Requer 4º Círculo.",aumenta:!1},{custo:9,descricao:"em vez do normal, o alvo fica imune a duas escolas de magia a sua escolha. Requer 5º Círculo.",aumenta:!1}]}},adivinhacao:{"comunhao-com-a-natureza":{name:"Comunhão com a Natureza",type:"magia",img:"systems/tormenta20/icons/magias/comunhao-com-a-natureza.webp",system:{circulo:"3",escola:"adv",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",duracao:"1 dia",alvo:"Você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Após uma breve união com a natureza local, você obtém informações e intuições sobre a região em que está, numa distância equivalente a um dia de viagem. Você recebe 6d4 dados de auxílio. Enquanto a magia durar, sempre que for realizar um teste de perícia em áreas naturais, você pode gastar 2d4 (mais 2d4 para cada círculo de magias acima do 3º que puder lançar) e adicionar o resultado rolado como bônus no teste. A magia termina se você ficar sem dados."}},aprimoramentos:[{custo:1,descricao:"muda a execução para 1 minuto e a duração para instantânea. Em vez do normal, você descobre 1d4+1 informações sobre os seguintes temas: terreno, animais, vegetais, minerais, cursos d'água e presença de criaturas antinaturais numa região natural em que você esteja. Você pode, por exemplo, descobrir a quantidade de cavernas (terreno), se uma planta rara existe (vegetais) e se há mortos-vivos (criaturas antinaturais) na região.",aumenta:!1},{custo:3,descricao:"aumenta o número de dados de auxílio em +2.",aumenta:!0},{custo:4,descricao:"muda o tipo dos dados de auxílio para d6.",aumenta:!1},{custo:8,descricao:"muda o tipo dos dados de auxílio para d8.",aumenta:!1}]}},convocacao:{"servo-divino":{name:"Servo Divino",type:"magia",img:"systems/tormenta20/icons/magias/servo-divino.webp",system:{circulo:"3",escola:"convocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"Cena ou até ser descarregada",resistencia:"Nenhuma",custo:"6 PM",description:{value:'Você pede a sua divindade que envie um espírito para ajudá-lo. Esse espírito realiza uma tarefa a sua escolha que possa ser cumprida em até uma hora — desde algo simples como "use suas asas para nos levar até o topo da montanha" até algo complexo como "escolte esses camponeses até o castelo". A magia é descarregada quando a criatura cumpre a tarefa, retornando a seu plano natal. O tipo de criatura é escolhido pelo mestre, de acordo com as necessidades da tarefa.Componente material: um pagamento de T$ 100 ao espírito. A forma de pagamento varia — doações a um templo, um item mágico ou mesmo dinheiro.'}},aprimoramentos:[{custo:4,descricao:"muda a duração para 1 dia ou até ser descarregada. O espírito realiza uma tarefa a sua escolha que exija até um dia. O custo do pagamento aumenta para T$ 500. O resto segue normal.",aumenta:!1},{custo:9,descricao:"muda a duração para 1 semana ou até ser descarregada. O espírito realiza uma tarefa que exija até uma semana. O custo do pagamento aumenta para T$ 1.000. O resto segue normal.",aumenta:!1}]},"viagem-arborea":{name:"Viagem Arbórea",type:"magia",img:"systems/tormenta20/icons/magias/viagem-arborea.webp",system:{circulo:"3",escola:"convocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Como parte da execução, você entra em uma árvore adjacente que seja maior do que você. Você pode permanecer dentro da árvore, percebendo os arredores de forma normal (mas sem poder fazer ações). Você pode gastar uma ação de movimento para sair da mesma árvore, ou de qualquer outra dentro de 1km. Se estiver dentro de uma árvore que seja destruída, a magia termina e você sofre 10d6 pontos de dano de impacto. Enquanto a magia durar você pode gastar uma ação de movimento e 1 PM para entrar em outras árvores."}},aprimoramentos:[{custo:2,descricao:'muda o alcance para toque, o alvo para até cinco criaturas e a duração para instantânea. Os alvos entram em uma planta (de tamanho Médio ou maior) e saem em outra planta do mesmo tamanho a até 100km de distância, especificada em direção e distância aproximadas (como "50km ao norte").',aumenta:!1}]}},encantamento:{"despertar-consciencia":{name:"Despertar Consciência",type:"magia",img:"systems/tormenta20/icons/magias/despertar-consciencia.webp",system:{circulo:"3",escola:"encantamento",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"toque",duracao:"1 dia",alvo:"1 animal ou planta",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você desperta a consciência de um animal ou planta. O alvo se torna um parceiro veterano de um tipo a sua escolha entre ajudante, combatente, fortão, guardião, médico, perseguidor ou vigilante. Se usar esta magia em um parceiro que já possua, o nível de poder de um de seus tipos aumenta em um passo (iniciante para veterano, veterano para mestre). Se já for um parceiro mestre, recebe o bônus de outro tipo de parceiro iniciante (entre as escolhas acima). O alvo se torna uma criatura racional, com Inteligência –1, e pode falar"}},aprimoramentos:[{custo:4,descricao:"muda o alvo para 1 escultura mundana inanimada. Além do normal, o alvo tem as mesmas características de um construto.",aumenta:!1},{custo:4,descricao:"muda a duração para permanente e adiciona penalidade de -3 PM.",aumenta:!1}]},heroismo:{name:"Heroísmo",type:"magia",img:"systems/tormenta20/icons/magias/heroismo.webp",system:{circulo:"3",escola:"encantamento",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Esta magia imbui uma criatura com coragem e valentia sobrenaturais. O alvo fica imune a medo e recebe 40 pontos de vida temporários. Além disso, recebe +4 em testes de ataque e rolagens de dano contra o inimigo de maior ND na cena. Se houver múltiplos inimigos com o mesmo ND mais alto, você escolhe qual será o alvo dos bônus. Os bônus se aplicam a todos os tipos de ataque (corpo a corpo, à distância e magias de ataque)."}},aprimoramentos:[{custo:2,descricao:"muda o bônus para +6.",aumenta:!1}]},"missao-divina":{name:"Missão Divina",type:"magia",img:"systems/tormenta20/icons/magias/missao-divina.webp",system:{circulo:"3",escola:"encantamento",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"1 semana ou até ser descarregada",alvo:"1 criatura",resistencia:"Vontade anula (veja texto)",custo:"6 PM",description:{value:"Esta magia obriga o alvo a cumprir uma tarefa a sua escolha. Ela dura uma semana ou até o alvo cumprir a tarefa, o que vier primeiro. O alvo pode recusar a missão — mas, no fim de cada dia em que não se esforçar para cumprir a tarefa, deve fazer um teste de Vontade; se falhar, sofre uma penalidade cumulativa de –2 em todos os testes e rolagens. A Missão Divina não pode forçar uma criatura a um ato suicida, nem designar uma missão impossível (como matar uma criatura que não existe)."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para toque, a\nduração para permanente e adiciona\npenalidade de -1 PM. Em vez do normal,\nvocê inscreve uma marca (como uma tatuagem) na pele do alvo e escolhe um tipo de ação que ativará a marca. Normalmente, será cometer um crime (roubar, matar...) ou outra coisa contrária às Obrigações & Restrições de sua divindade. Sempre que a marca é ativada, o alvo recebe uma penalidade cumulativa de -2 em todos os testes. Muitas vezes, portar essa marca é um estigma por si só, já que esta magia normalmente é lançada em criminosos ou traidores. Uma magia que dissipe outras suprime a marca e suas penalidades por um dia; elas só podem ser totalmente removidas pelo conjurador original ou pela magia Purificação.",aumenta:!1},{custo:4,descricao:"aumenta a duração para 1 ano ou até ser descarregada.",aumenta:!0}]}},evocacao:{"coluna-de-chamas":{name:"Coluna de Chamas",type:"magia",img:"systems/tormenta20/icons/magias/coluna-de-chamas.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",alvo:"cilindro com 3m de raio e 30m de altura",resistencia:"Reflexos reduz à metade",custo:"6 PM",description:{value:"Um pilar de fogo sagrado desce dos céus, causando 6d6 pontos de dano de fogo mais 6d6 pontos de dano de luz nas criaturas e objetos livres na área."}},aprimoramentos:[{custo:1,descricao:"aumenta o dano de fogo em +1d6.",aumenta:!0},{custo:1,descricao:"aumenta o dano de luz em +1d6.",aumenta:!0}]},"dispersar-as-trevas":{name:"Dispersar as Trevas",type:"magia",img:"systems/tormenta20/icons/magias/dispersar-trevas.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",duracao:"veja texto",alvo:"Esfera de 6m de raio",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Esta magia cria um forte brilho (multicolorido ou de uma cor que remeta a sua divindade) que causa diversos efeitos. Todas as magias de 3º círculo ou menor ativas na área são dissipadas se você passar num teste de Religião contra a CD de cada magia. Seus aliados na área recebem +4 em testes de resistência e redução de trevas 10 até o fim da cena, protegidos por uma aura sutil da mesma cor. Inimigos na área ficam Cego por 1d4 rodadas (apenas uma vez pela magia). Dispersar as Trevas anula Anular a Luz (este efeito tem duração instantânea)."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus nas resistências em +1.",aumenta:!0},{custo:4,descricao:"muda o alcance para curto, a área para alvo 1 criatura e a duração para cena. O alvo fica imune a efeitos de necromancia e trevas.",aumenta:!1},{custo:4,descricao:"muda o círculo máximo de magias dissipadas para 4º. Requer 4º círculo.",aumenta:!1},{custo:9,descricao:"muda o círculo máximo de magias dissipadas para 5º. Requer 5º círculo.",aumenta:!1}]},"sopro-da-salvacao":{name:"Sopro da Salvação",type:"magia",img:"systems/tormenta20/icons/magias/sopro-da-salvacao.webp",system:{circulo:"3",escola:"evocacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"cone de 9m",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você enche seus pulmões de energia positiva e sopra um cone de poeira reluzente. O sopro afeta apenas seus aliados na área, curando 2d8+4 pontos de vida e removendo uma das seguintes condições de todos os alvos: Abalado, Atordoado, Apavorado, Alquebrado, Cego, Confuso, Debilitado, Enjoado, Esmorecido, Exausto, Fascinado, Fatigado, Fraco, Frustrado, Lento, Paralisado, Pasmo e Surdo."}},aprimoramentos:[{custo:2,descricao:"aumenta a quantidade de cura em 1d8+2.",aumenta:!0},{custo:4,descricao:"além do normal, se um aliado estiver com PV negativos, seus PV são levados a 0 e então a cura é aplicada.",aumenta:!1},{custo:4,descricao:"remove todas as condições listadas, em vez de apenas uma.",aumenta:!1}]}},necromancia:{"anular-a-luz":{name:"Anular a Luz",type:"magia",img:"systems/tormenta20/icons/magias/anular-luz.webp",system:{circulo:"3",escola:"necromancia",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",duracao:"Ver Texto",alvo:"esfera de 6m de raio",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Esta magia cria uma onda de escuridão que causa diversos efeitos. Todas as magias de 3º círculo ou menor ativas na área são dissipadas se você passar num teste de Religião contra a CD de cada magia. Seus aliados na área são protegidos por uma aura sombria e recebem +4 na Defesa até o fim da cena. Inimigos na área ficam Enjoadopor 1d4 rodadas (apenas uma vez por cena). Anular a Luz anula Dispersar as Trevas (este efeito tem duração instantânea)."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus na Defesa em +1.",aumenta:!0},{custo:4,descricao:"muda o círculo máximo de magias dissipadas para 4º. Requer 4º Círculo.",aumenta:!1},{custo:9,descricao:"muda o círculo máximo de magias dissipadas para 5º. Requer 5º Círculo.",aumenta:!1}]},"poeira-da-podridao":{name:"Poeira da Podridão",type:"magia",img:"systems/tormenta20/icons/magias/poeira-da-podridao.webp",system:{circulo:"3",escola:"necromancia",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"nuvem com 6m de raio",resistencia:"Fortitude (veja texto)",custo:"6 PM",description:{value:"Você manifesta uma nuvem de poeira carregada de energia negativa, que apodrece lentamente as criaturas na área. Ao lançar a magia, e no início de seus turnos, criaturas na área sofrem 2d8+8 pontos de dano de trevas (Fortitude reduz à metade). Alvos que falharem no teste não podem recuperar PV por uma rodada."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em 1d8+4.",aumenta:!0}]}},transmutacao:{"controlar-agua":{name:"Controlar Água",type:"magia",img:"systems/tormenta20/icons/magias/controlar-agua.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",alvo:"esfera com 30m de raio",resistencia:"Veja texto",custo:"6 PM",description:{value:"Você controla os movimentos e comportamentos da água. Ao lançar a magia, escolha um dos efeitos abaixo. Congelar: toda a água mundana na área é congelada. Criaturas nadando na área ficam imóveis; escapar exige gastar uma ação padrão e passar num teste de Atletismo ou Acrobacia. Derreter: gelo mundano na área vira água e a magia termina. A critério do mestre, isso pode criar terreno difícil. Enchente: eleva o nível da água mundana na área em até 4,5m. A sua escolha, muda área para alvo: uma embarcação. O alvo recebe +3m em seu deslocamento pela duração do efeito. Evaporar: toda a água e gelo mundano na área evaporam instantaneamente e a magia termina. Elementais da água, plantas monstruosas e criaturas com imunidade a frio na área sofrem 10d8 pontos de dano de fogo; outras criaturas vivas recebem metade desse dano (Fortitude reduz à metade). Partir: diminui o nível de toda água mundana na área em até 4,5m. Em um corpo d'água raso, isso abre um caminho seco, que pode ser atravessado a pé. Em um corpo d'água profundo, cria um redemoinho que pode prender barcos (um teste de Pilotagem com CD igual à da magia permite ao piloto livrar a embarcação). Elementais da água na área ficam lentos."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +2d8.",aumenta:!0}]},"controlar-terra":{name:"Controlar Terra",type:"magia",img:"systems/tormenta20/icons/magias/controlar-terra.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",alvo:"9 cubos com 1,5m de lado",resistencia:"Veja texto",custo:"6 PM",description:{value:"Você manipula a densidade e a forma de toda terra, pedra, lama, argila ou areia na área. Ao lançar a magia, escolha.Amolecer: se afetar o teto, uma coluna ou suporte, provoca um desabamento que causa 10d6 pontos de dano de impacto às criaturas na área (Reflexos reduz à metade). Se afetar um piso de terra ou pedra, cria terreno difícil de areia ou argila, respectivamente.Modelar: pode usar pedra ou argila para criar um ou mais objetos simples de tamanho Enorme ou menor (sem mecanismos ou partes móveis). Por exemplo, pode transformar um tijolo em uma maça, criar uma passagem onde antes havia apenas uma parede ou levantar uma ou mais paredes que oferecem cobertura total (RD 8 e 50 PV para cada 3m).Solidificar: transforma lama ou areia em terra ou pedra. Criaturas com os pés na superfície ficam agarradas. Elas podem se soltar com uma ação padrão e um teste de Acrobacia ou Atletismo."}},aprimoramentos:[{custo:1,descricao:"aumenta o número de cubos de 1,5m em +2.",aumenta:!0},{custo:1,descricao:"muda o alcance para pessoal, o alvo para você e a duração para 1 dia. Você e seu equipamento fundem-se a uma superfície ou objeto adjacente feito de pedra, terra, argila ou areia que possa acomodá-lo. Você pode voltar ao espaço adjacente como uma ação livre, dissipando a magia. Enquanto mesclado, você não pode falar ou fazer ações físicas, mas consegue perceber seus arredores normalmente. Pequenos danos não o afetam, mas se o objeto (ou o trecho onde você está imerso) for destruído, a magia é dissipada, você volta a um espaço livre adjacente e sofre 10d6 pontos de dano de impacto.",aumenta:!1}]},"potencia-divina":{name:"Potência Divina",type:"magia",img:"systems/tormenta20/icons/magias/potencia-divina.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você canaliza o poder de sua divindade. Você aumenta uma categoria de tamanho (seu equipamento muda de acordo) e recebe Força +4 e RD 10. Você não pode lançar magias enquanto estiver sob efeito de Potência Divina."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus de Força em +1.",aumenta:!0},{custo:5,descricao:"aumenta a resistência a dano em +5.",aumenta:!0},{custo:2,descricao:"muda o alcance para toque e o alvo para 1 criatura. A magia falha se você e o alvo não forem devotos da mesma divindade.",aumenta:!1}]}}},"4-circulo":{abjuracao:{"cupula-de-repulsao":{name:"Cúpula de Repulsão",type:"magia",img:"systems/tormenta20/icons/magias/cupula-de-repulsao.webp",system:{circulo:"4",escola:"abjuracao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Vontade Anula",custo:"10 PM",description:{value:"Uma cúpula de energia invisível o cerca, impedindo a aproximação de certas criaturas. Escolha um tipo de criatura (animais, espíritos, monstros...) ou uma raça de humanoides (elfos, goblins, minotauros..). Criaturas do grupo escolhido que tentem se aproximar a menos de 3m de você (ou seja, que tentem ficar adjacentes a você) devem fazer um teste de Vontade. Se falharem, não conseguem, gastam a ação e só podem tentar novamente na rodada seguinte. Isso impede ataques corpo a corpo, mas não ataques ou outros efeitos à distância. Se você tentar se aproximar além do limite de 3m, rompe a cúpula e a magia é dissipada."}},aprimoramentos:[{custo:2,descricao:"a cúpula impede criaturas de se aproximarem a menos de 4,5m de você (ou seja, deve haver dois quadrados entre você e as criaturas).",aumenta:!1},{custo:5,descricao:"além do normal, criaturas afetadas também precisam fazer o teste de resistência se fizerem um ataque ou efeito à distância você. Se falharem, o efeito é desviado pela cúpula. Requer 5º círculo.",aumenta:!1}]}},adivinhacao:{premonicao:{name:"Premonição",type:"magia",img:"systems/tormenta20/icons/magias/premonicao.webp",system:{circulo:"4",escola:"adv",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Vislumbres do futuro permitem que você reavalie suas ações. Uma vez por rodada, você pode rolar novamente um teste recém realizado, mas deve aceitar o resultado da nova rolagem."}},aprimoramentos:[{custo:3,descricao:"muda a execução para reação, o alcance para curto, o alvo para 1 criatura e a duração para instantânea. Esta magia só pode ser usada em uma criatura que tenha acabado de fazer um teste. Obriga a criatura a fazer uma nova rolagem de dados e aceitar o novo resultado, seja ele um sucesso ou falha. Criaturas involuntárias têm direito a um teste de Vontade para negar o efeito.",aumenta:!1}]}},convocacao:{"guardiao-divino":{name:"Guardião Divino",type:"magia",img:"systems/tormenta20/icons/magias/guardiao-divino.webp",system:{circulo:"4",escola:"convocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"Cena ou até ser descarregado",resistencia:"Nenhuma",custo:"10 PM",description:{value:"A magia invoca um elemental Pequeno, com a forma de um orbe feito de luz divina. A criatura é incorpórea, imune a dano e ilumina como uma tocha. O elemental tem 100 pontos de luz.Uma vez por rodada, durante o seu turno, o elemental pode se movimentar (deslocamento de voo 18m) e gastar quantos pontos de luz quiser para curar dano ou condições de criaturas em alcance curto, à taxa de 1 PV por 1 ponto de luz ou uma condição por 3 pontos de luz (entre abalado, apavorado, alquebrado, atordoado, cego, confuso, debilitado, enjoado, esmorecido, exausto, fascinado, fatigado, fraco, frustrado, ofuscado, pasmo, sangrando, surdo ou vulnerável). A magia é encerrada quando o elemental fica sem pontos de luz."}}}},encantamento:{"conceder-milagre":{name:"Conceder Milagre",type:"magia",img:"systems/tormenta20/icons/magias/conceder-milagre.webp",system:{circulo:"4",escola:"encantamento",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",duracao:"permanente ou até ser descarregada",alvo:"1 criatura",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você transfere um pouco de seu poder divino a outra criatura. Escolha uma magia de até 2º círculo que você conheça; o alvo pode lançar essa magia uma vez, sem pagar o custo base dela em PM (aprimoramentos podem ser usados, mas o alvo deve gastar seus próprios PM). Você sofre uma penalidade de –3 PM até que o alvo lance a magia."}},aprimoramentos:[{custo:4,descricao:"muda o círculo da magia concedida para 3º e a penalidade de PM para -6.",aumenta:!1}]}},evocacao:{"circulo-da-restauracao":{name:"Círculo da Restauração",type:"magia",img:"systems/tormenta20/icons/magias/circulo-da-restauracao.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"5 rodada",alvo:"esfera de 3m de raio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você evoca um círculo de luz que emana uma energia poderosa. Qualquer criatura viva que termine o turno dentro do círculo recupera 3d8+3 PV e 1 PM. Mortos-vivos e criaturas que sofrem dano por luz perdem PV e PM na mesma quantidade. Uma criatura pode recuperar no máximo 5 PM por dia com esta magia."}},aprimoramentos:[{custo:2,descricao:"aumenta a regeneração de PV em 1d8+1.",aumenta:!0}]},"colera-do-deus-sol":{name:"Cólera do Deus-Sol",type:"magia",img:"systems/tormenta20/icons/magias/colera-do-deus-sol.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",duracao:"5 instantanea",alvo:"esfera com 6m de raio",resistencia:"Reflexos Parcial",custo:"10 PM",description:{value:"Você cria uma explosão de luz dourada e intensa. Criaturas na área ficam Cego por 1d4 rodadas e Em Chamas , e sofrem 10d6 pontos de dano de fogo (mortos-vivos sofrem 10d8 pontos de dano). Uma criatura que passe no teste de resistência não fica cega, nem em chamas e sofre metade do dano."}},aprimoramentos:[{custo:2,descricao:"aumenta o dano em +2d6 (+2d8 contra mortos-vivos).",aumenta:!0},{custo:2,descricao:"aumenta a área em +6m de raio.",aumenta:!0},{custo:5,descricao:"a luz purificadora do Deus-Sol dissipa todas as magias de necromancia ativas na área. Requer 5º círculo",aumenta:!1}]},"manto-do-cruzado":{name:"Manto do Cruzado",type:"magia",img:"systems/tormenta20/icons/magias/manto-do-cruzado.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"vocẽ",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você invoca o poder de sua divindade na forma de um manto de energia que reveste seu corpo. Esta magia tem duas versões. Você escolhe qual versão pode lançar quando aprende esta magia. Ela não pode ser mudada. Manto de Luz: um manto dourado e luminoso. No início de cada um de seus turnos, você e todos os seus aliados em alcance curto recuperam 2d8 PV. Você recebe imunidade a dano de trevas e seus ataques corpo a corpo causam +2d8 pontos de dano de luz. Manto de Trevas: um manto negro como a noite. No início de cada um de seus turnos, todos os inimigos em alcance curto sofrem 4d8 pontos de dano de trevas. Você cura metade de todo o dano causado pela magia."}}},terremoto:{name:"Terremoto",type:"magia",img:"systems/tormenta20/icons/magias/terremoto.webp",system:{circulo:"4",escola:"evocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 rodada",alvo:"esfera com 30m de raio",resistencia:"veja texto",custo:"10 PM",description:{value:"Esta magia devastadora invoca o poder da terra para criar um tremor sísmico que rasga o solo em uma área de 30m de raio. O terremoto dura uma rodada completa, durante a qual todas as criaturas sobre o solo ficam atordoadas pela vibração intensa. Barreiras físicas não interrompem a área do Terremoto - a energia sísmica passa através de paredes e obstáculos. O efeito exato varia drasticamente conforme o terreno: CAVERNA/SUBTERRÂNEO: O teto desmorona, causando 12d6 pontos de dano de impacto e deixando todas as criaturas agarradas pelos escombros. Reflexos reduz o dano à metade e evita ficar agarrado. CONSTRUÇÕES: Estruturas sofrem 200 pontos de dano, suficiente para derrubar construções de madeira ou alvenaria simples (mas não alvenaria reforçada). Criaturas em construções que desmoronem sofrem o mesmo efeito de cavernas. ESPAÇO ABERTO: Fendas profundas se abrem aleatoriamente. Role 1d6 para cada criatura - em resultado ímpar, uma fenda se abre sob ela. Reflexos evita cair na fenda. Criaturas que caírem podem escapar com ação completa + teste de Atletismo (CD da magia). No início do seu próximo turno, as fendas se fecham, matando quem estiver dentro. PENHASCOS: Criam desmoronamento horizontal igual à altura (penhasco de 30m = desmoronamento de 30m). Criaturas no caminho: 12d6 dano de impacto + agarrado (Reflexos reduz dano à metade e evita agarramento). CORPOS D'ÁGUA: Fissuras drenam a água, criando lamaçal. Reflexos evita afundar e ficar agarrado. Fissuras se fecham no próximo turno, podendo afogar quem ficou preso. CRIATURAS AGARRADAS sofrem 1d6 dano/rodada até serem libertadas (ação completa + Atletismo da vítima ou aliado adjacente)."}}}},necromancia:{"ligacao-sombria":{name:"Ligação Sombria",type:"magia",img:"systems/tormenta20/icons/magias/ligacao-sombria.webp",system:{circulo:"4",escola:"necromancia",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"longo",duracao:"1 dia",alvo:"1 criatura",resistencia:"Fortitude anula",custo:"10 PM",description:{value:"Cria uma conexão entre seu corpo e o da criatura alvo, deixando uma marca idêntica na pele de ambos. Enquanto a magia durar, sempre que você sofrer qualquer dano ou condição, o alvo desta magia deve fazer um teste de Fortitude; se falhar, sofre o mesmo dano que você ou adquire a mesma condição. A magia termina se o alvo chegar a 0 pontos de vida."}},aprimoramentos:[{custo:5,descricao:"além do normal, o alvo também pode morrer por perda de PV ou se você morrer (um teste de Fortitude anula a morte).",aumenta:!1}]}},transmutacao:{"controlar-o-clima":{name:"Controlar o Clima",type:"magia",img:"systems/tormenta20/icons/magias/controlar-clima.webp",system:{circulo:"4",escola:"transmutacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"km",duracao:"4d12 horas",alvo:"esfera com 2km de raio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você muda o clima da área onde se encontra, podendo criar qualquer condição climática: chuva, neve, ventos, névoas... Veja o Capítulo 6: O Mestre para os efeitos em jogo do clima."}},aprimoramentos:[{custo:1,descricao:"(Apenas Druidas): muda o raio da área para 3km e duração para 1d4 dias.",aumenta:!1}]}}},"5-circulo":{abjuracao:{"aura-divina":{name:"Aura Divina",type:"magia",img:"systems/tormenta20/icons/magias/aura-divina.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"esfera com 9m de raio",resistencia:"Vontade parcial",custo:"15 PM",description:{value:"Você se torna um conduíte da energia de sua divindade, emanando uma aura brilhante. Você e aliados devotos da mesma divindade ficam imunes a encantamento e recebem +10 na Defesa e em testes de resistência. Aliados não devotos da mesma divindade recebem+5 na Defesa e em testes de resistência. Além disso, inimigos que entrem na área afetada devem fazer um teste de Vontade; em caso de falha, recebem uma condição a sua escolha entre Esmorecido, Debilitadoou Lento até o fim da cena. O teste deve ser refeito cada vez que a criatura entrar novamente na área."}},aprimoramentos:[{custo:2,descricao:"aumenta os bônus na Defesa e em testes de resistência em +1.",aumenta:!0}]},"engenho-de-mana":{name:"Engenho de Mana",type:"magia",img:"systems/tormenta20/icons/magias/engenho-de-mana.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Você cria um disco de energia que lembra uma roda de engenho e flutua no ponto em que foi conjurado. O disco é imune a dano, não pode ser movido e faz uma contramágica automática contra qualquer magia lançada em alcance médio dele (exceto as suas), usando seu teste de Misticismo. Caso vença o teste, o engenho não só anula a magia como absorve os PM usados para lançá-la, acumulando PM temporários. No seu turno, se estiver ao alcance do disco, você pode gastar PM nele para lançar magias."}},aprimoramentos:[{custo:1,descricao:"em vez de flutuar no ponto em que foi conjurado, o disco flutua atrás de você, mantendo-se sempre adjacente.",aumenta:!1},{custo:4,descricao:"muda a duração para 1 dia.",aumenta:!1}]},"lagrimas-da-deusa-da-magia":{name:"Lágrimas da Deusa da Magia",type:"magia",img:"systems/tormenta20/icons/magias/lagrimas-da-deusa-da-magia.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade parcial",custo:"15 PM",description:{value:"Se falhar no teste de resistência, o alvo perde a habilidade de lançar magias arcanas até o fim da cena. Se passar, perde a habilidade por uma rodada."}},aprimoramentos:[{custo:2,descricao:"muda a área para esfera de 6m de raio e o alvo para criaturas escolhidas.",aumenta:!1},{custo:5,descricao:"muda a execução para 1 dia e adiciona custo adicional (sacrifício de 1 PM). O alvo da magia precisa ser mantido em alcance curto do conjurador durante toda a execução. Ao término, faz um teste de Vontade. Se falhar, perde a habilidade de lançar magias arcanas permanentemente. Se passar, resiste, mas ainda pode ser alvo da magia no dia seguinte. Nenhum poder mortal é capaz de reverter essa perda. Os clérigos da deusa da Magia dizem que a deusa chora cada vez que este ritual é realizado.",aumenta:!1}]}},adivinhacao:{"projetar-consciencia":{name:"Projetar Consciência",type:"magia",img:"systems/tormenta20/icons/magias/projetar-consciencia.webp",system:{circulo:"5",escola:"adv",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"any",alvo:"local ou criatura conhecidos",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Esta magia faz com que sua consciência deixe seu corpo e se transporte instantaneamente para um local ou para perto de uma criatura alvo. Se escolher um local, ele precisa ser conhecido por você. Se escolher uma criatura, você transporta sua consciência até onde a criatura estiver, contanto que estejam no mesmo plano. Você adquire uma forma fantasmagórica invisível, mas pode se mostrar sando uma ação de movimento. Pode se mover em qualquer direção com deslocamento de voo 18m e, por ser incorpóreo, é capaz de atravessar objetos sólidos, mas fica limitado a se mover dentro dos limites do local, ou dentro de alcance curto da criatura alvo. Você pode ver e ouvir como se estivesse presente no local e pode falar mentalmente com qualquer criatura que possa ver, contanto que tenham um idioma em comum."}},aprimoramentos:[{custo:10,descricao:"além do normal, sua projeção é capaz de lançar magias que não precisem de componentes materiais e tenham duração diferente de sustentada. Sua forma fantasmagórica funciona como na magia Forma Etérea, sendo afetada por magias de abjuração e essência, mas as magias que ela lança podem afetar criaturas corpóreas.",aumenta:!1}]}},convocacao:{"intervencao-divina":{name:"Intervenção Divina",type:"magia",img:"systems/tormenta20/icons/magias/intervencao-divina.webp",system:{circulo:"5",escola:"convocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"especial",alvo:"veja texto",resistencia:"veja texto",custo:"15 PM",description:{value:"Esta é a manifestação suprema da fé, um pedido direto à sua divindade para que ela intervenha pessoalmente na realidade mortal. Os céus se abrem, uma presença divina desce, e milagres acontecem diante dos olhos de todos. A própria divindade responde ao seu chamado, alterando a realidade conforme sua vontade divina. MILAGRES MENORES (sem custo adicional): • CURA DIVINA: Até 10 criaturas em alcance longo são instantaneamente curadas de todos os pontos de vida perdidos e de todas as condições negativas. Uma luz dourada os envolve, restaurando-os completamente. Curiosamente, este poder divino também cura mortos-vivos em vez de destruí-los, demonstrando a natureza transcendente da intervenção. • BANIMENTO MÁGICO: Todos os efeitos de magias de 4º círculo ou menor em uma área ampla são instantaneamente dissipados pela presença divina. MILAGRES MAIORES (custam 2 PM adicionais): • CRIAÇÃO DIVINA: Sua divindade materializa um item mundano de até T$ 30.000 do nada, criado pela vontade divina. • DUPLICAÇÃO MÁGICA: A divindade replica perfeitamente qualquer magia de até 4º círculo (componentes materiais ainda são necessários). • PROTEÇÃO CELESTIAL: Uma cidade inteira é protegida de desastres naturais - vulcões param de entrar em erupção, enchentes recuam, terremotos cessam. • RESSURREIÇÃO MILAGROSA: Uma criatura que morreu há até uma rodada é trazida de volta à vida com 1 PV, sua alma sendo literalmente arrancada das garras da morte. MILAGRES EXTRAORDINÁRIOS: Sua divindade pode realizar feitos ainda mais impressionantes, mas sempre de acordo com sua natureza, domínios e objetivos. Khalmyr pode forjar armas lendárias, Marah pode curar pragas inteiras, Wynna pode revelar segredos cósmicos. O mestre tem autoridade final sobre esses efeitos, que devem sempre refletir a personalidade e poder da divindade invocada. Lembre-se: você está pedindo a um deus para agir - seja respeitoso e esteja preparado para as consequências."}}}},evocacao:{"furia-do-panteao":{name:"Fúria do Panteão",type:"magia",img:"systems/tormenta20/icons/magias/furia-do-panteao.webp",system:{circulo:"5",escola:"evocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"longo",alvo:"cubo de 90m",resistencia:"veja texto",custo:"15 PM",description:{value:"Você cria uma nuvem de tempestade violenta. Os ventos tornam ataques à distância impossíveis e fazem a área contar como condição terrível para lançar magia. Além disso, inimigos na área têm a visibilidade reduzida (como a magia Névoa). Uma vez por turno, você pode gastar uma ação de movimento para gerar um dos efeitosa seguir. Nevasca. Inimigos na área sofrem 10d6 pontos de dano de frio (Fortitude reduz à metade). A área fica coberta de neve, virando terreno difícil até o fim da cena ou até você usar siroco. Raios. Até 6 inimigos a sua escolha na área sofrem 10d8 pontos de dano de eletricidade (Reflexos reduz à metade). Siroco. Transforma a chuva em uma tempestade de areia escaldante. Inimigos na área sofrem 10d6 pontos de dano (metade corte, metade fogo) e ficam Sangrando (Fortitude reduz o dano à metade e evita a condição). Trovões. Inimigos sofrem 10d6 pontos de dano de impacto e ficam Desprevenido por uma rodada (Fortitude reduz o dano à metade e evita a condição)."}}},"segunda-chance":{name:"Segunda Chance",type:"magia",img:"systems/tormenta20/icons/magias/segunda-chance.webp",system:{circulo:"5",escola:"evocacao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Um brilho alaranjado, na forma de asas de fênix, emana do alvo. Ele recupera 200 pontos de vida e se cura de qualquer das seguintes condições: abalado, apavorado, alquebrado, atordoado, cego, confuso, debilitado, enjoado, envenenado, esmorecido, exausto, fascinado, fatigado, fraco, frustrado, lento, ofuscado, paralisado, pasmo ou surdo."}},aprimoramentos:[{custo:1,descricao:"aumenta a cura em +20 PV.",aumenta:!0},{custo:2,descricao:"muda o alcance para curto e o alvo para até 5 criaturas.",aumenta:!1},{custo:5,descricao:"muda o alvo para uma criatura que tenha morrido há até uma rodada. Esta magia pode curá-la.",aumenta:!1}]}},necromancia:{"reanimacao-impura":{name:"Reanimação Impura",type:"magia",img:"systems/tormenta20/icons/magias/reanimacao-impura.webp",system:{circulo:"5",escola:"necromancia",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Você reanima uma criatura morta recentemente (dentro da mesma cena), trazendo sua alma de volta ao corpo de forma forçada. O tipo da criatura muda para morto-vivo, mas ela retém suas memórias e habilidades de quando estava viva, podendo inclusive lançar magias. A criatura pode pensar e falar livremente, mas obedece cegamente a seus comandos. Quando a cena termina, a criatura volta a ficar morta, mas muitos clérigos malignos usam meios para guardar e preservar o corpo de criaturas poderosas para serem reanimadas dessa forma quando necessário. Se for destruída, a criatura não pode ser reanimada novamente com esta magia."}}},"roubar-a-alma":{name:"Roubar a Alma",type:"magia",img:"systems/tormenta20/icons/magias/roubar-alma.webp",system:{circulo:"5",escola:"necromancia",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Vontade parcial",custo:"15 PM",description:{value:'Você rouba a alma da vítima, armazenando-a em um objeto. Se o alvo passar no teste de resistência, sente o impacto de sua alma ser puxada para fora do corpo e fica Abaladopor 1 rodada. Se falhar, seu corpo fica caído, Inconscientee inerte, enquanto sua alma é transportada para dentro do objeto. O corpo não envelhece nem se decompõe, permanecendo em estase. Ele pode ser atacado e destruído normalmente. O objeto escolhido deve custar T$ 1.000 por nível ou ND da criatura e não possuir uma alma presa ou se quebrará quando a magia for lançada (embora personagens não conheçam o conceito de "nível" dentro do mundo de jogo, podem ter noção do poder geral de uma criatura, estimando assim o valor do objeto). Se o objeto for destruído, a magia se esvai. Se o corpo ainda estiver disponível, a alma retorna para ele. Caso contrário, escapa para os Mundos dos Deuses. Custo adicional: sacrifício de 1 PM.'}},aprimoramentos:[{custo:5,descricao:"o objeto que abriga a alma detém os mesmos PM totais que o alvo. Se estiver empunhando o objeto, você pode usar esses PM para lançar magias no lugar dos seus. O objeto recupera PM por dia como se o personagem estivesse em descanso normal.",aumenta:!1},{custo:10,descricao:"como uma reação ao lançar esta magia, você possui o corpo sem alma do alvo, como na magia Possessão (mesmo que não conheça a magia).",aumenta:!1}]}}}},universal:{"1-circulo":{abjuracao:{"resistencia-a-energia":{name:"Resistência à Energia",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_resistnature.jpg",system:{circulo:"1",escola:"abjuracao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Ao lançar esta magia, escolha entre ácido, eletricidade, fogo, frio, luz ou trevas. O alvo recebe redução de dano 10 contra o tipo de dano escolhido."}},aprimoramentos:[{custo:2,descricao:"muda a duração para 1 dia. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas. Requer 3º círculo.",aumenta:!1},{custo:5,descricao:"muda o efeito para redução de dano contra todos os tipos listados na magia. Requer 3º círculo.",aumenta:!1},{custo:9,descricao:"muda o efeito para imunidade a um tipo listado na magia. Requer 4º círculo",aumenta:!1},{custo:0,descricao:"Resistência a Ácido",aumenta:!1},{custo:0,descricao:"Resistência a Eletricidade",aumenta:!1},{custo:0,descricao:"Resistência a Fogo",aumenta:!1},{custo:0,descricao:"Resistência a Frio",aumenta:!1},{custo:0,descricao:"Resistência a Luz",aumenta:!1},{custo:0,descricao:"Resistência a Trevas",aumenta:!1},{custo:2,descricao:"aumenta a resistência a ácido em +5.",aumenta:!0},{custo:2,descricao:"aumenta a resistência a eletricidade em +5",aumenta:!0},{custo:2,descricao:"aumenta a resistência a fogo em +5",aumenta:!0},{custo:2,descricao:"aumenta a resistência a frio em +5",aumenta:!0},{custo:2,descricao:"aumenta a resistência a luz em +5",aumenta:!0},{custo:2,descricao:"aumenta a resistência a trevas em +5",aumenta:!0}]}},adivinhacao:{aviso:{name:"Aviso",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane05.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"move"},alcance:"longo",alvo:"1 criatura",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Envia um aviso telepático para uma criatura, mesmo que não possa vê-la nem tenha linha de efeito. Escolha um: Alerta: o alvo recebe +5 em seu próximo teste de Iniciativa e de Percepção dentro da cena. Mensagem: o alvo recebe uma mensagem sua de até 25 palavras. Vocês devem ter um idioma em comum para o alvo poder entendê-lo. Localização: o alvo sabe onde você está naquele momento. Se você mudar de posição, ele não saberá."}},aprimoramentos:[{custo:2,descricao:"se escolher localização, muda a duração para cena. O alvo sabe onde você está mesmo que você mude de posição.",aumenta:!1},{custo:3,descricao:"aumenta o número de alvos em +1.",aumenta:!0}]},compreensao:{name:"Compreensão",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane06.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura ou texto",resistencia:"Vontade anula (veja descrição)",custo:"1 PM",description:{value:"Esta magia confere a você uma compreensão sobrenatural. Você pode tocar um texto e entender as palavras, mesmo que não conheça o idioma. Se tocar uma criatura inteligente, pode se comunicar com ela, mesmo que não tenham um idioma em comum. Se tocar uma criatura não inteligente, como um animal, pode perceber seus sentimentos. Além disso, você pode gastar uma ação de movimento para ouvir os pensamentos de uma criatura tocada. Um alvo involuntário tem direito a um teste de Vontade para proteger seus pensamentos e evitar este efeito."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas. Você pode entender todas as criaturas afetadas, mas só pode ouvir os pensamentos de uma por vez.",aumenta:!1},{custo:2,descricao:"muda o alvo para 1 criatura. Em vez do normal, pode vasculhar os pensamentos do alvo para extrair informações. O alvo tem direito a um teste de Vontade para anular este efeito. O mestre decide se a criatura sabe ou não a informação que você procura. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda o alcance para pessoal e o alvo para você. Em vez do normal, você pode falar, entender e escrever qualquer idioma. Requer 3º círculo.",aumenta:!1}]},"visao-mistica":{name:"Visão Mística",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane07.jpg",system:{circulo:"1",escola:"adv",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Seus olhos brilham com uma luz azul e passam a enxergar auras mágicas. Este efeito é similar ao uso de Misticismo para detectar magia, mas você detecta todas as auras mágicas em alcance médio e recebe todas as informações sobre elas sem gastar ações. Além disso, você pode gastar uma ação de movimento para descobrir se uma criatura que possa perceber em alcance médio é capaz de lançar magias e qual a aura gerada pelas magias de círculo mais alto que ela pode lançar."}},aprimoramentos:[{custo:2,descricao:"muda a duração para 1 dia.",aumenta:!1},{custo:2,descricao:"também pode enxergar objetos e criaturas invisíveis. Eles aparecem como formas translúcidas.",aumenta:!1}]}},convocacao:{nevoa:{name:"Névoa",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_fog.jpg",system:{circulo:"1",escola:"convocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",resistencia:"Nenhuma",custo:"1 PM",description:{value:"Uma névoa espessa eleva-se de um ponto a sua escolha, obscurecendo toda a visão — criaturas a até 1,5m têm camuflagem e criaturas a partir de 3m têm camuflagem total. Um vento forte dispersa a névoa em 4 rodadas e um vendaval a dispersa em 1 rodada. Esta magia não funciona sob a água."}},aprimoramentos:[{custo:2,descricao:"você pode escolher criaturas no alcance ao lançar a magia; elas enxergam através do efeito. Requer 2º círculo.",aumenta:!1},{custo:2,descricao:"a nuvem tem um cheiro horrível. No início de seus turnos, qualquer criatura dentro dela, ou qualquer criatura com faro em alcance curto da nuvem, deve fazer um teste de Fortitude. Se falhar, fica enjoada por uma rodada.",aumenta:!1},{custo:2,descricao:"a nuvem tem um tom esverdeado e se torna cáustica. No início de seus turnos, criaturas dentro dela sofrem 2d4 pontos de dano de ácido.",aumenta:!1},{custo:3,descricao:"aumenta o dano de ácido em +2d4.",aumenta:!0},{custo:5,descricao:"além do normal, a nuvem fica espessa, quase sólida. Qualquer criatura dentro dela tem seu deslocamento reduzido para 3m (independentemente de seu deslocamento normal) e sofre -2 em testes de ataque e rolagens de dano.",aumenta:!1}]}},evocacao:{luz:{name:"Luz",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_light.jpg",system:{circulo:"1",escola:"evocacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 objeto",resistencia:"Vontade anula (veja texto)",custo:"1 PM",description:{value:"O alvo emite luz (mas não produz calor) em uma área com 6m de raio. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a luz, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Luz anula Escuridão."}},aprimoramentos:[{custo:2,descricao:"muda a duração para 1 dia.",aumenta:!1},{custo:2,descricao:"muda a duração para permanente e adiciona componente material (pó de rubi no valor de T$ 50). Requer 2º círculo.",aumenta:!1},{custo:0,descricao:"(Apenas Arcanos): muda o alvo para 1 criatura. Você lança a magia nos olhos do alvo, que fica ofuscado pela cena. Não afeta criaturas cegas.",aumenta:!1},{custo:2,descricao:"(Apenas Arcanos): muda o alcance para longo e o efeito para cria 4 pequenos globos flutuantes de pura luz. Você pode posicionar os globos onde quiser dentro do alcance. Você pode enviar um à frente, outra para trás, outra para cima e manter um perto de você, por exemplo. Uma vez por rodada, você pode mover os globos com uma ação livre. Cada um ilumina como uma tocha, mas não produz calor. Se um globo ocupar o espaço de uma criatura, ela fica ofuscada e sua silhueta pode ser vista claramente (ela não recebe camuflagem por escuridão ou invisibilidade). Requer 2º círculo.",aumenta:!1},{custo:2,descricao:"(Apenas Divinos): a luz é cálida como a do sol. Criaturas que sofrem penalidades e dano pela luz solar sofrem seus efeitos como se estivessem expostos à luz solar real. Seus aliados na área estabilizam automaticamente e ficam imunes à condição sangrando, e seus inimigos ficam ofuscados. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"(Apenas Divinos): muda o alcance para toque e o alvo para 1 criatura. Em vez do normal, o alvo é envolto por um halo de luz, recebendo +10 em testes de Diplomacia e resistência a trevas 10. Requer 2º círculo.",aumenta:!1}]}},necromancia:{escuridao:{name:"Escuridão",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_darkness.jpg",system:{circulo:"1",escola:"necromancia",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 objeto",resistencia:"Vontade anula (veja texto)",custo:"1 PM",description:{value:"O alvo emana sombras em uma área com 6m de raio. Criaturas dentro da área recebem camuflagem leve por escuridão leve. As sombras não podem ser iluminadas por nenhuma fonte de luz natural. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a escuridão, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Escuridão anula Luz."}},aprimoramentos:[{custo:2,descricao:"muda o efeito para fornecer camuflagem total por escuridão total. As sombras bloqueiam a visão na área e através dela.",aumenta:!1},{custo:3,descricao:"muda a duração para 1 dia.",aumenta:!1},{custo:2,descricao:"muda o alvo para 1 criatura e a resistência para Fortitude parcial. Você lança a magia nos olhos do alvo, que fica cego pela cena. Se passar na resistência, fica cego por 1 rodada. Requer 2º círculo.",aumenta:!1},{custo:5,descricao:"muda o alcance para pessoal e o alvo para você. Em vez do normal, você é coberto por sombras, recebendo +10 em testes de Furtividade e camuflagem leve. Requer 2º círculo.",aumenta:!1}]}},transmutacao:{"arma-magica":{name:"Arma Mágica",type:"magia",img:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane08.jpg",system:{circulo:"1",escola:"transmutacao",ativacao:{custo:1,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 arma empunhada",resistencia:"Nenhuma",custo:"1 PM",description:{value:"A arma fornece um bônus de +1 nos testes de ataque e rolagens de dano e é considerada mágica (não cumulativo com bônus de encantos). Caso você esteja empunhando a arma, pode usar seu atributo-chave de magias em vez do atributo original nos testes de ataque (não cumulativo com efeitos que somam este atributo)."}},aprimoramentos:[{custo:2,descricao:"aumenta o bônus em +1 (bônus máximo limitado pelo círculo máximo de magia que você pode lançar).",aumenta:!0},{custo:2,descricao:"a arma passa a causar +1d6 de dano de ácido, eletricidade, fogo ou frio, escolhido no momento em que a magia é lançada. Este aprimoramento só pode ser usado uma vez.",aumenta:!1},{custo:5,descricao:"muda o bônus de dano do aprimoramento elemental para +2d6. (Custo do aprimoramento incluso)",aumenta:!1},{custo:0,descricao:"Arma Mágica",aumenta:!1}]}}},"2-circulo":{abjuracao:{"dissipar-magia":{name:"Dissipar Magia",type:"magia",img:"systems/tormenta20/icons/magias/dissipar-magia.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",alvo:"1 criatura ou 1 objeto mágico",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você dissipa outras magias que estejam ativas, como se sua duração tivesse acabado. Note que efeitos de magias instantâneas não podem ser dissipados (não se pode dissipar uma Bola de Fogo ou Relâmpago depois que já causaram dano...). Se lançar essa magia em uma criatura ou área, faça um teste de Misticismo; você dissipa as magias com CD igual ou menor que o resultado do teste. Se lançada contra um item mágico, o transforma em um item mundano por 1d6 rodadas (Vontade anula)."}},aprimoramentos:[{custo:12,descricao:"muda a área para esfera com 9m de raio. Em vez do normal, cria um\nefeito de disjunção. Todas as magias na área são automaticamente dissipadas e todos os itens mágicos na área, exceto aqueles que você estiver carregando, viram itens mundanos por uma cena (com direito a um teste de Vontade para evitar esse efeito). Requer 5º círculo.",aumenta:!1}]},"runa-de-protecao":{name:"Runa de Proteção",type:"magia",img:"systems/tormenta20/icons/magias/runa-de-protecao.webp",system:{circulo:"2",escola:"abjuracao",ativacao:{custo:3,qtd:"1","condição":"",special:"",execucao:"hora"},alcance:"toque",duracao:"permanente até ser descarregada",alvo:"uma área com 6m de raio",resistencia:"varia (veja o texto)",custo:"3 PM",description:{value:"Você escreve uma runa pessoal em uma superfície fixa, como uma parede ou o chão, que protege uma pequena área ao redor. Quando uma criatura entra na área afetada a runa explode, causando 6d6 pontos de dano em todos os alvos a até 6m. A criatura que ativa a runa não tem direito a teste de resistência; outras criaturas na área têm direito a um teste de Reflexos para reduzir o dano à metade. Quando lança a magia, você escolhe o tipo de dano, entre ácido, eletricidade, fogo, frio, luz ou trevas. Você pode determinar que a runa se ative apenas em condições específicas — por exemplo, apenas por goblins ou apenas por mortos-vivos. Você também pode criar uma palavra mágica que impeça a runa de se ativar. Um personagem pode encontrar a runa com um teste de Investigação e desarmá-la com um teste de Ladinagem (CD da magia). Componente material: pó de diamante no valor de T$ 200, com o qual o conjurador desenha a runa, que brilha por alguns instantes e depois se torna praticamente invisível."}},aprimoramentos:[{custo:1,descricao:"aumenta o dano em +2d6.",aumenta:!0},{custo:1,descricao:'muda o alvo para "você" e o alcance para "pessoal". Ao invés do normal, escolha uma magia de 1º círculo que você conhece e pode lançar, com tempo de execução de uma ação padrão ou menor. Você escreve a runa em seu corpo e especifica uma condição de ativação como, por exemplo, "quando eu for alvo de um ataque" ou "quando for alvo de uma magia". Quando a condição for cumprida, você pode ativar a runa e lançar a magia escolhida como uma reação. Você só pode escrever uma runa em seu corpo ao mesmo tempo.',aumenta:!1}]}},convocacao:{"preparacao-de-batalha":{name:"Preparação de Batalha",type:"magia",img:"systems/tormenta20/icons/magias/preparacao-de-batalha.webp",system:{circulo:"2",escola:"convocacao",ativacao:{custo:3,qtd:"","condição":"Custo Adicional: penalidade de 1 PM",special:"",execucao:"acao"},alcance:"toque",duracao:"Permanente até ser descarregada",alvo:"até dois itens que você possua, entre armas, armaduras e escudos",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Custo Adicional: penalidade de 1 PM Essa magia é muito utilizada por clérigos e bardos que não precisam (ou não podem) estar sempre com suas armas ou armaduras. A magia é lançada sobre até dois itens que você possua. A partir daí, em qualquer momento, você pode usar uma ação completa para convocar os itens, que aparecem sobre seu corpo e em suas mãos. O efeito é espalhafatoso, sendo praticamente impossível utilizá-lo sem chamar atenção. A magia funciona independentemente da distância dos itens, contanto que estejam no mesmo plano, mas termina se você perder a posse deles."}},aprimoramentos:[{custo:1,descricao:"Aumenta o número de alvos em dois e o custo adicional em 1 PM.",aumenta:!1}]}},encantamento:{"marca-da-obediencia":{name:"Marca da Obediência",type:"magia",img:"systems/tormenta20/icons/magias/marca-da-obediencia.webp",system:{circulo:"2",escola:"encantamento",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Vontade anula",custo:"3 PM",description:{value:'Você toca uma criatura, gravando uma marca mística no corpo dela enquanto profere uma ordem, como "não ataque a mim ou meus aliados", "siga-me" ou "não saia desta sala". A criatura deve seguir essa ordem, gastando todas as ações de seu turno para isso. A ordem não pode ser genérica demais (como "ajude-me", por exemplo), nem forçar o alvo a atos suicidas. A cada rodada, o alvo pode fazer um teste de Vontade. Se passar, a magia é dissipada.'}}}},necromancia:{"conjurar-mortos-vivos":{name:"Conjurar Mortos-Vivos",type:"magia",img:"systems/tormenta20/icons/magias/conjurar-mortos-vivos.webp",system:{circulo:"2",escola:"necromancia",ativacao:{custo:3,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"curto",resistencia:"Nenhuma",custo:"3 PM",description:{value:"Você conjura seis esqueletos capangas de tamanho Médio feitos de energia negativa em espaços desocupados dentro do alcance. Você pode gastar uma ação de movimento para fazer os mortos-vivos andarem (eles têm deslocamento 9m) ou uma ação padrão para fazê-los causar dano a criaturas adjacentes (1d6+2 pontos de dano de trevas cada). Os esqueletos têm For 2, Des 2, Defesa 18 e todos os outros atributos nulos; eles têm 1 PV e falham automaticamente em qualquer teste de resistência ou oposto, mas são imunes a atordoamento, dano não letal, doença, encantamento, fadiga, frio, ilusão, paralisia, sono e veneno. Eles desaparecem quando são reduzidos a 0 PV ou no fim da cena. Os mortos- -vivos não agem sem receber uma ordem. Usos criativos para capangas fora de combate ficam a critério do mestre. Carniçal: como esqueletos, mas têm For 3, Des 3, Defesa 27 e causam 1d8+3 pontos de dano de trevas mais perda de 1d8 PV por veneno. Além disso, criaturas atingidas por um carniçal devem passar num teste de Fortitude ou ficam Paralisado por 1 rodada. Uma criatura que passe no teste de resistência fica imune à paralisia dos carniçais por um dia. Sombra: como esqueletos, mas têm Des 4, Defesa 35, a habilidade incorpóreo e causam 2d10 pontos de dano de trevas. Além disso, criaturas vivas atingidas por uma sombra devem passar num teste de Fortitude ou perdem 1d4 PM. Sombras perdem a habilidade incorpóreo quando expostas à luz do sol."}},aprimoramentos:[{custo:2,descricao:"aumenta o número de mortos-vivos conjurados em +1.",aumenta:!0},{custo:7,descricao:"em vez de esqueletos, conjura sombras. Requer 4º círculo.",aumenta:!1}]}}},"3-circulo":{adivinhacao:{"lendas-e-historias":{name:"Lendas e Histórias",type:"magia",img:"systems/tormenta20/icons/magias/lendas-historias.webp",system:{circulo:"3",escola:"adv",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 craitura, objeto ou local",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Você descobre informações sobre uma criatura, objeto ou local que esteja tocando. O que exatamente você descobre depende do mestre: talvez você não descubra tudo que há para saber, mas ganhe pistas para continuar a investigação. A cada rodada que mantiver a magia, você descobre: Todas as informações sobre o alvo, como se tivesse passado em todos os testes de Conhecimento para tal. Todas as habilidades do alvo. Se for uma criatura, você sabe suas estatísticas de jogo como raça, classe, nível, atributos, magias, resistências e fraquezas. Se for um item mágico, aprende seu efeito e funcionamento. Se o alvo está sob influência de alguma magia e todas as informações sobre as magias ativas, se houver alguma."}},aprimoramentos:[{custo:4,descricao:"muda a execução para 1 dia, o alcance para ilimitado e adiciona componente material (cuba de ouro cheia d'água e ingredientes mágicos, no valor de T$ 1.000). Você ainda precisa ter alguma informação sobre o alvo, como um nome, descrição ou localização.",aumenta:!1}]},videncia:{name:"Vidência",type:"magia",img:"systems/tormenta20/icons/magias/videncia.webp",system:{circulo:"3",escola:"adv",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"any",alvo:"1 criatura",resistencia:"Vontade anula",custo:"6 PM",description:{value:"Através de uma superfície reflexiva (bacia de água benta para clérigos, lago para druidas, bola de cristal para magos, espelho para feiticeiros etc.) você pode ver e ouvir uma criatura escolhida e seus arredores (cerca de 6m em qualquer direção), mesmo que ela se mova. O alvo pode estar a qualquer distância, mas se passar em um teste de Vontade, a magia falha. A vítima recebe bônus ou penalidades em seu teste de resistência, dependendo do conhecimento que você tiver dela.Não conhece o alvo: +10.Ouviu falar do alvo: +5.O alvo está em outro plano ou mundo: +5.Já encontrou o alvo pessoalmente: +0.Tem uma pintura, escultura ou outra representação do alvo: –2.Conhece bem o alvo: –5.Tem um pertence pessoal ou peça de roupa do alvo: –5.Tem uma parte do corpo do alvo (unhas, cabelos...): –10."}}}},encantamento:{imobilizar:{name:"Imobilizar",type:"magia",img:"systems/tormenta20/icons/magias/imobilizar.webp",system:{circulo:"3",escola:"encantamento",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 humanóide ou animal",resistencia:"Vontade parcial",custo:"6 PM",description:{value:"Esta magia paralisa o alvo com energia mágica. Se falhar no teste de resistência, o alvo fica com a condição Paralisado (não pode realizar ações, fica indefeso e automaticamente falha em testes de Reflexos). Se passar no teste de resistência, em vez disso fica com a condição Lento (pode realizar apenas uma ação padrão ou de movimento por turno, não ambas). A cada rodada, o alvo pode gastar uma ação completa para fazer um novo teste de Vontade. Se passar, se liberta completamente do efeito."}},aprimoramentos:[{custo:1,descricao:"muda o alvo para 1 espírito.",aumenta:!1},{custo:2,descricao:"aumenta o número de alvos em +1.",aumenta:!0},{custo:3,descricao:"muda o alvo para 1 criatura. Requer 4º círculo",aumenta:!1}]},"selo-de-mana":{name:"Selo de Mana",type:"magia",img:"systems/tormenta20/icons/magias/selo-de-mana.webp",system:{circulo:"3",escola:"encantamento",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Vontade Parcial",custo:"6 PM",description:{value:"Seu toque manifesta um selo mágico na pele do alvo, que atrapalha o fluxo de mana. Pela duração da magia, sempre que o alvo realizar qualquer ação que gaste PM, deve fazer um teste de Vontade; se passar, faz a ação normalmente. Se falhar, a ação não tem efeito (mas os PM são gastos mesmo assim)."}},aprimoramentos:[{custo:4,descricao:"muda o alcance para curto e o alvo para criaturas escolhidas dentro do alcance. Requer 4º círculo.",aumenta:!1}]}},ilusao:{"manto-de-sombras":{name:"Manto de Sombras",type:"magia",img:"systems/tormenta20/icons/magias/manto-de-sombras.webp",system:{circulo:"3",escola:"ilusao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:'Você fica coberto por um manto de energia sombria. Nesta forma, torna-se incorpóreo (inclui seu equipamento): só pode ser afetado por armas mágicas, ou por outras criaturas incorpóreas e pode atravessar objetos sólidos, mas não manipulá-los. Também não pode atacar criaturas normais (mas ainda pode lançar magias nelas). Além disso, se torna vulnerável à luz direta: se exposto a uma fonte de luz, sofre 1 ponto de dano por rodada. Você pode gastar uma ação de movimento e 1 PM para "entrar" em uma sombra do seu tamanho ou maior e se teletransportar para outra sombra, também do seu tamanho ou maior, em alcance médio.'}},aprimoramentos:[{custo:4,descricao:"muda o alcance para toque e o alvo para 1 criatura. Requer 4º círculo.",aumenta:!1}]}},necromancia:{"servo-morto-vivo":{name:"Servo Morto-Vivo",type:"magia",img:"systems/tormenta20/icons/magias/servo-morto-vivo.webp",system:{circulo:"3",escola:"necromancia",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"toque",alvo:"1 cadáver",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Esta magia transforma o cadáver de um humanoide, animal ou monstro em um morto-vivo sob seu controle. Se o corpo estiver bem preservado, torna-se um zumbi; se estiver em decomposição avançada ou for apenas ossos, torna-se um esqueleto. O morto-vivo criado obedece a todos os seus comandos mentais, mesmo ordens suicidas, e não precisa de descanso, comida ou ar. Se desejar que o morto-vivo o acompanhe em aventuras, ele funciona como um aliado iniciante, de um tipo à sua escolha entre ajudante, atirador, combatente, fortão, guardião ou montaria. Uma vez por rodada, quando você sofrer dano, pode sacrificar um servo morto-vivo sob seu controle para evitar completamente esse dano. O servo é destruído no processo e não pode ser reanimado novamente. Você pode controlar um número de servos mortos-vivos igual ao seu modificador de atributo-chave. Componente material: um ônix negro (T$ 100), que deve ser inserido na boca ou olho do cadáver durante o ritual."}},aprimoramentos:[{custo:3,descricao:"muda o componente material para pó de ônix negro (T$ 500). Em vez de um zumbi ou esqueleto, cria um carniçal. Ele pode funcionar como um aliado veterano, escolhido entre ajudante, atirador, combatente, fortão ou guardião. O resto segue normal.",aumenta:!1},{custo:3,descricao:"muda o componente material para pó de ônix negro (T$ 500). Em vez de um zumbi ou esqueleto, cria uma sombra. Ela pode funcionar como um aliado veterano, escolhido entre assassino, combatente ou perseguidor. O restante da magia segue normal.",aumenta:!1},{custo:7,descricao:"muda o componente material para ferramentas de embalsamar (T$ 1.000). Em vez de um zumbi ou esqueleto, cria uma múmia. Ela pode funcionar como um aliado mestre, escolhido entre ajudante, destruidor, guardião ou médico. O restante da magia segue normal. Requer 4º círculo.",aumenta:!1}]}},transmutacao:{"pele-de-pedra":{name:"Pele de Pedra",type:"magia",img:"systems/tormenta20/icons/magias/pele-de-pedra.webp",system:{circulo:"3",escola:"transmutacao",ativacao:{custo:6,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"6 PM",description:{value:"Sua pele ganha aspecto e dureza de rocha, tornando-se mais resistente a ferimentos. Você recebe redução de dano 5, reduzindo em 5 pontos todo dano físico (corte, impacto e perfuração) que sofrer. Esta redução não se aplica a dano de energia (fogo, frio, eletricidade, ácido, trevas, luz) ou dano mental."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para toque e o alvo para 1 criatura.",aumenta:!1},{custo:4,descricao:"muda a duração para 1 dia.",aumenta:!1},{custo:4,descricao:"sua pele ganha aspecto e dureza de aço. Você recebe resistência a dano 10. Requer 4º círculo.",aumenta:!1},{custo:4,descricao:"muda o alcance para toque, o alvo para 1 criatura, a duração para 1d4 rodadas e adiciona Resistência: Fortitude anula. Em vez do efeito normal, a magia transforma o alvo e seu equipamento em uma estátua inerte e sem consciência. A estátua possui os mesmos PV da criatura e resistência a dano 8; se for quebrada, a criatura morrerá. Requer 4º círculo.",aumenta:!1},{custo:9,descricao:"como acima, mas com duração permanente. Requer 5º círculo.",aumenta:!1}]}}},"4-circulo":{abjuracao:{libertacao:{name:"Libertação",type:"magia",img:"systems/tormenta20/icons/magias/libertacao.webp",system:{circulo:"4",escola:"abjuracao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",alvo:"1 criatura",resistencia:"Nenhuma",custo:"10 PM",description:{value:"O alvo fica imune a efeitos de movimento e ignora qualquer efeito que impeça ou restrinja seu deslocamento. Por fim, pode usar habilidades que exigem liberdade de movimentos mesmo se estiver usando armadura ou escudo."}},aprimoramentos:[{custo:2,descricao:"além do normal, o alvo pode caminhar sobre a água ou outros líquidos com seu deslocamento normal. Entretanto, isso não protege contra qualquer efeito que o líquido possa causar (o alvo pode andar sobre lava, mas ainda vai sofrer dano).",aumenta:!1},{custo:2,descricao:"além do normal, o alvo pode escolher 20 em todos os testes de Atletismo.",aumenta:!1},{custo:2,descricao:"além do normal, o alvo pode escolher 20 em todos os testes de Acrobacia e pode fazer todas as manobras desta perícia mesmo sem treinamento.",aumenta:!1},{custo:5,descricao:"muda o alcance para curto e o alvo para até 5 criaturas.",aumenta:!1},{custo:5,descricao:"pode dissipar Aprisionamento.",aumenta:!1}]}},adivinhacao:{"visao-da-verdade":{name:"Visão da Verdade",type:"magia",img:"systems/tormenta20/icons/magias/visao-da-verdade.webp",system:{circulo:"4",escola:"adv",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"move"},alcance:"pessoal",alvo:"você",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Seus olhos brilham com uma luz dourada sutil e você passa a enxergar a forma real de todas as coisas. Esta visão mística permite que você veja através de camuflagem e escuridão (tanto normais quanto mágicas), assim como todos os efeitos de ilusão e transmutação. Quando olha para algo afetado por magia de ilusão ou transmutação, você vê tanto a aparência falsa quanto a verdadeira forma, sendo a verdadeira mais nítida. Você automaticamente detecta criaturas invisíveis, polimorfadas, disfarçadas magicamente ou escondidas por ilusões. Além disso, pode identificar a verdadeira natureza de construtos, mortos-vivos e criaturas extraplanares, vendo uma aura característica ao redor delas. Esta magia também revela a presença de magias ativas em objetos e criaturas, mostrando-as como uma tênue aura colorida."}},aprimoramentos:[{custo:1,descricao:"muda o alcance para toque e o alvo para 1 criatura.",aumenta:!1},{custo:1,descricao:"além do normal, o alvo fica com sentidos apurados; ele recebe +10 em todos os testes de Percepção.",aumenta:!1},{custo:2,descricao:"além do normal, o alvo escuta falsidades; ele recebe +10 em todos os testes de Intuição.",aumenta:!1},{custo:4,descricao:"além do normal, o alvo enxerga através de paredes e barreiras com 30cm de espessura ou menos (as paredes e barreiras parecem translúcidas).",aumenta:!1}]}},convocacao:{"viagem-planar":{name:"Viagem Planar",type:"magia",img:"systems/tormenta20/icons/magias/viagem-planar.webp",system:{circulo:"4",escola:"convocacao",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"toque",alvo:"pessoal",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Você e os alvos viajam instantaneamente para outro plano da Criação através de um portal dimensional temporário. No plano de destino, vocês chegam de 10 a 1.000km do local pretendido (role 1d100 e multiplique por 10km). A precisão da chegada depende do seu conhecimento sobre o destino: locais bem conhecidos tendem a ter menos variação na distância. Esta magia não funciona se você estiver em um local protegido contra viagem planar (como sob efeito de Âncora Dimensional). Componente material: um bastão de metal precioso em forma de forquilha (no valor de T$ 1.000), que é consumido pela magia. O tipo específico de metal determina para qual plano de existência você será enviado - diferentes planos requerem diferentes metais, e alguns podem ser extremamente raros ou difíceis de encontrar, a critério do mestre. Exemplos incluem prata para o Plano Astral, ferro frio para o Reino das Fadas, ou ouro para planos celestiais."}},aprimoramentos:[{custo:2,descricao:"muda o alvo para até cinco criaturas voluntárias que você esteja tocando.",aumenta:!1}]}},necromancia:{"muralha-de-ossos":{name:"Muralha de Ossos",type:"magia",img:"systems/tormenta20/icons/magias/muralha-de-ossos.webp",system:{circulo:"4",escola:"necromancia",ativacao:{custo:10,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"medio",resistencia:"Nenhuma",custo:"10 PM",description:{value:"Uma parede de ossos se eleva da terra. A parede tem 15m de comprimento, 9m de altura e 1,5m de espessura. Ela pode ter qualquer forma — não precisa ser uma linha reta —, mas sua base precisa estar sempre tocando o solo. Quando a parede surge, criaturas na área ocupada ou adjacentes sofrem 4d8 pontos de dano de corte e precisam fazer um teste de Reflexos para não ficarem presas no emaranhado de ossos. Uma criatura presa dessa maneira fica Agarrado, e pode usar uma ação padrão para fazer um teste de Atletismo (CD da magia) para se soltar. Se passar no teste, sai da muralha para um dos lados adjacentes. Se falhar, sofre 4d8 pontos de dano de corte. é possível destruir o muro para atravessá-lo ou libertar uma criatura agarrada. Cada trecho de 3m do muro tem Defesa 8, 40 PV e redução de corte, frio e perfuração 10. Também é possível escalar a parede. Isso exige um teste de Atletismo (CD da magia) e causa 4d8 pontos de dano de corte para cada 3m escalados."}},aprimoramentos:[{custo:3,descricao:"aumenta o comprimento em +15m e altura em +3m.",aumenta:!0},{custo:5,descricao:"o muro é feito de uma massa de esqueletos animados. Sempre que uma criatura iniciar seu turno adjacente ou escalando a muralha, deve fazer um teste de Reflexos. Se falhar fica agarrada, sofrendo os feitos normais de estar agarrada pela magia.",aumenta:!1}]}}},"5-circulo":{abjuracao:{"buraco-negro":{name:"Buraco Negro",type:"magia",img:"systems/tormenta20/icons/magias/buraco-negro.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"completa"},alcance:"longo",duracao:"3 rodada",resistencia:"Fortitude parcial",custo:"15 PM",description:{value:"Esta magia cria um vácuo capaz de sugar tudo nas proximidades. Escolha um espaço desocupado para o buraco negro. No início de cada um de seus três turnos seguintes, todas as criaturas a até alcance longo do buraco negro, incluindo você, devem fazer um teste de Fortitude. Em caso de falha, ficam caídas e são puxadas 30m na direção do buraco. Objetos soltos também são puxados. Criaturas podem gastar uma ação de movimento para se segurar em algum objeto fixo, recebendo +2 em seus testes de resistência. Criaturas e objetos que toquem o buraco negro são sugadas, desaparecendo para sempre.Criaturas e objetos que iniciem seu turno no espaço do buraco negro devem gastar uma ação de movimento e fazer um teste de Fortitude. Se passarem, podem escapar se arrastando (metade de seu deslocamento) para longe dele. Se falharem, perdem a ação (mas podem gastar outra para tentar novamente). Se terminarem seu turno no espaço do buraco negro, são sugadas, desaparecendo para sempre. Não se conhece o destino das coisas sugadas pelo buraco negro, uma vez que jamais retornam. Alguns estudiosos sugerem que podem ser enviadas para outros mundos. Muitos clérigos da Noite acreditam que esta magia abre um portal para Sombria, o lar de sua deusa, e sonham um dia poder realizar essa jornada."}},aprimoramentos:[{custo:5,descricao:"muda o efeito para que você não seja afetado.",aumenta:!1}]},invulnerabilidade:{name:"Invulnerabilidade",type:"magia",img:"systems/tormenta20/icons/magias/invulnerabilidade.webp",system:{circulo:"5",escola:"abjuracao",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"pessoal",alvo:"Você",resistencia:"Nenhuma",custo:"15 PM",description:{value:"Esta magia suprema cria uma barreira mágica absolutamente impenetrável ao seu redor, manifestando-se como uma aura cintilante que repele ameaças específicas. Você deve escolher um dos dois tipos de proteção ao lançar a magia: PROTEÇÃO MENTAL: Uma aura prateada envolve sua mente, tornando-a uma fortaleza inexpugnável. Você fica completamente imune às condições abalado, alquebrado, apavorado, atordoado, confuso, esmorecido, fascinado, frustrado e pasmo. Além disso, torna-se imune a todos os efeitos de encantamento e ilusão, independentemente de sua origem ou poder. Sua mente não pode ser lida, controlada, influenciada ou enganada por qualquer meio mágico. PROTEÇÃO FÍSICA: Uma aura dourada fortalece seu corpo contra todos os males físicos. Você fica completamente imune às condições atordoado, cego, debilitado, enjoado, envenenado, exausto, fatigado, fraco, lento, ofuscado e paralisado. Além disso, torna-se imune a acertos críticos (todos os ataques contra você causam dano normal), ataques furtivos (que falham automaticamente) e todas as doenças (naturais ou mágicas). Seu corpo torna-se um templo inviolável contra aflições físicas. IMPORTANTE: Esta proteção não impede dano direto - você ainda pode ser ferido por espadas, magias de dano, quedas, etc. A magia protege contra condições e efeitos especiais, não contra dano bruto. A escolha entre proteção mental ou física deve ser feita no momento do lançamento e não pode ser alterada durante a duração da magia."}},aprimoramentos:[{custo:5,descricao:"muda o alcance para curto e o alvo para 1 criatura.",aumenta:!1}]}},encantamento:{"palavra-primordial":{name:"Palavra Primordial",type:"magia",img:"systems/tormenta20/icons/magias/palavra-primordial.webp",system:{circulo:"5",escola:"encantamento",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"curto",duracao:"instantânea ou veja texto",alvo:"1 criatura com menos níveis que você",resistencia:"Vontade parcial",custo:"15 PM",description:{value:'Você pronuncia uma única palavra no idioma primordial da Criação - a linguagem que os deuses usaram para moldar a realidade. Esta palavra ressoa com poder cósmico, capaz de alterar a essência de uma criatura com menos níveis que você. O som ecoa através de dimensões, e mesmo criaturas surdas são afetadas, pois a palavra atinge diretamente a alma. Escolha um dos três efeitos devastadores: ATORDOAR: A palavra "KETH" paralisa a mente do alvo. A criatura fica Atordoada por 2d4 rodadas, completamente incapaz de agir. Se passar no teste de resistência de Vontade, fica apenas Desprevenida por 1d4 rodadas e torna-se imune ao efeito de atordoamento desta magia até o final da cena. CEGAR: A palavra "NETH" queima os olhos da criatura com luz primordial. O alvo fica permanentemente Cego, perdendo completamente a visão. Se passar no teste de resistência, fica apenas Ofuscado por 1d4 rodadas. A cegueira permanente só pode ser curada por magias de cura poderosas ou Desejo. MATAR: A palavra "DEATH" ordena que a alma se separe do corpo. A criatura morre instantaneamente, independentemente de seus pontos de vida atuais. Além do teste normal de Vontade, criaturas com mais da metade de seus PV têm direito a um teste adicional de Fortitude. Se passar em qualquer um dos testes, em vez de morrer, perde 10d8 pontos de vida e fica Sangrando. Esta é uma das magias mais temidas de todo o multiverso, pois representa o poder bruto da criação falando através de um mortal.'}}}},necromancia:{"toque-da-morte":{name:"Toque da Morte",type:"magia",img:"systems/tormenta20/icons/magias/toque-da-morte.webp",system:{circulo:"5",escola:"necromancia",ativacao:{custo:15,qtd:"","condição":"",special:"",execucao:"acao"},alcance:"toque",alvo:"1 criatura",resistencia:"Veja texto",custo:"15 PM",description:{value:"Esta é uma das magias necromânticas mais temidas, canalizando a própria essência da morte através de seu toque. Sua mão fica envolta em uma aura negra crepitante, emanando frio sobrenatural e o cheiro de túmulos antigos. Ao tocar uma criatura, você drena diretamente sua força vital. EFEITO NORMAL: A criatura sofre 10d8+10 pontos de dano de trevas conforme sua energia vital é sugada. Este dano representa o envelhecimento acelerado, o enfraquecimento dos órgãos vitais e a corrosão da alma. EFEITO LETAL: Se o alvo estiver com menos da metade de seus pontos de vida (já ferido ou enfraquecido), a magia torna-se potencialmente letal. Em vez de causar dano normal, a criatura deve fazer um teste de Fortitude contra a CD da magia. Se PASSAR no teste, sofre apenas o dano normal (10d8+10). Se FALHAR no teste, sua força vital é completamente drenada e seus pontos de vida são imediatamente reduzidos a -10, colocando-a em estado de morte iminente. NATUREZA SINISTRA: Esta magia não apenas fere - ela corrompe. Criaturas mortas por Toque da Morte frequentemente se levantam como mortos-vivos menores, e o local onde a magia foi lançada pode ficar permanentemente amaldiçoado. Usar esta magia repetidamente pode atrair a atenção de entidades das trevas ou causar pesadelos ao conjurador. A energia necromântica deixa uma marca sombria tanto no alvo quanto no usuário."}},aprimoramentos:[{custo:2,descricao:"muda o alcance para curto. Em vez de tocar no alvo, você dispara um raio púrpura da ponta de seu dedo indicador.",aumenta:!1},{custo:10,descricao:"muda o alcance para curto e o alvo para inimigos no alcance. Em vez de tocar no alvo, você dispara raios púrpuras da ponta de seus dedos.",aumenta:!1}]}}}}};for(const r in s)for(const n in s[r])for(const i in s[r][n])for(const c in s[r][n][i]){const d=s[r][n][i][c];d.system&&d.system.circulo&&e.push({...d,tradition:r,escola:a[d.system.escola]||d.system.escola,execucao:o[d.system.ativacao?.execução]||d.system.ativacao?.execução||"",circulo:d.system.circulo,circuloDisplay:t[d.system.circulo]||`${d.system.circulo}º Círculo`})}return g.log(`Carregadas ${e.length} magias do arquivo JSON`),e}function re(e,a="grimoire"){const o=document.createElement("div");o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10001";const t=document.createElement("div");function s(){o.remove(),t.remove()}t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30, 30, 40, 0.98)",t.style.border="2px solid #9c27b0",t.style.borderRadius="12px",t.style.padding="24px",t.style.zIndex="10002",t.style.maxWidth="600px",t.style.maxHeight="80vh",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px";const n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.flex="1";const i=document.createElement("img");i.style.width="48px",i.style.height="48px",i.style.borderRadius="6px",i.style.marginRight="16px",i.style.border="2px solid #9c27b0",async function(e,a){const o=function(){try{const e=localStorage.getItem(l);if(e){const a=JSON.parse(e);if(a.version===m)return a.data||{}}}catch(e){console.warn("Erro ao carregar cache de ícones de magias:",e)}return{}}(),t=`spell_${e}`;if(o[t])return o[t];let s=p;try{if(a&&a.startsWith("systems/tormenta20/icons/magias/")&&a.endsWith(".webp")){const o=a.replace("systems/tormenta20/icons/magias/","").replace(".webp",""),t=`${u}${o}.webp`;if(await b(t))s=t;else{const a=y(e);await b(a)&&(s=a)}}else if(a&&a!==p)if(await b(a))s=a;else{const a=y(e);await b(a)&&(s=a)}else{const a=y(e);await b(a)&&(s=a)}o[t]=s,function(e){try{localStorage.setItem(l,JSON.stringify({version:m,data:e,timestamp:Date.now()}))}catch(e){console.warn("Erro ao salvar cache de ícones de magias:",e)}}(o)}catch(a){console.warn(`Erro ao carregar ícone para magia "${e}":`,a)}return s}(e.name,e.img).then(e=>{i.src=e}).catch(a=>{console.warn(`Erro ao carregar ícone para "${e.name}":`,a),i.src=p});const c=document.createElement("h3");c.textContent=e.name,c.style.color="#9c27b0",c.style.margin="0",c.style.fontSize="24px",c.style.fontWeight="bold",n.appendChild(i),n.appendChild(c);const f=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#9c27b0",onClick:s});r.appendChild(n),r.appendChild(f.render());const v=document.createElement("div");v.style.display="flex",v.style.gap="8px",v.style.marginBottom="16px",v.style.flexWrap="wrap";const h=document.createElement("span");h.textContent=e.circuloDisplay||`${e.circulo}º Círculo`,h.style.background="#9c27b0",h.style.color="#fff",h.style.padding="6px 12px",h.style.borderRadius="16px",h.style.fontSize="14px",h.style.fontWeight="bold";const x=document.createElement("span");x.textContent=e.escola,x.style.background="#4caf50",x.style.color="#fff",x.style.padding="6px 12px",x.style.borderRadius="16px",x.style.fontSize="14px",x.style.fontWeight="bold";const C=document.createElement("span");C.textContent=e.system?.ativacao?.execucao||"N/A",C.style.background="#ff9800",C.style.color="#fff",C.style.padding="6px 12px",C.style.borderRadius="16px",C.style.fontSize="14px",C.style.fontWeight="bold",v.appendChild(h),v.appendChild(x),v.appendChild(C);const w=document.createElement("div");w.style.marginBottom="20px";const q=document.createElement("div");if(q.style.display="grid",q.style.gridTemplateColumns="repeat(auto-fit, minmax(200px, 1fr))",q.style.gap="12px",q.style.marginBottom="16px",e.system?.alcance){const a=k("Alcance",e.system.alcance);q.appendChild(a)}if(e.system?.duracao){const a=k("Duração",e.system.duracao);q.appendChild(a)}if(e.system?.alvo){const a=k("Alvo/Área",e.system.alvo);q.appendChild(a)}if(e.system?.resistencia){const a=k("Resistência",e.system.resistencia);q.appendChild(a)}if(e.system?.custo){const a=k("Custo PM",e.system.custo);q.appendChild(a)}const E=k("Tradição",e.tradition.charAt(0).toUpperCase()+e.tradition.slice(1));q.appendChild(E),w.appendChild(q);const z=document.createElement("div"),S=(e.system?.description?.value||"Descrição não disponível").split("\n\n").map(e=>`<p>${e.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<em>$1</em>")}</p>`).join("");function k(e,a){const o=document.createElement("div");o.style.background="rgba(35, 36, 58, 0.8)",o.style.border="1px solid #9c27b0",o.style.borderRadius="8px",o.style.padding="12px";const t=document.createElement("div");t.textContent=e,t.style.color="#9c27b0",t.style.fontSize="12px",t.style.fontWeight="bold",t.style.marginBottom="4px",t.style.textTransform="uppercase";const s=document.createElement("div");return s.textContent=a,s.style.color="#fff",s.style.fontSize="14px",o.appendChild(t),o.appendChild(s),o}if(z.innerHTML=S,z.style.color="#fff",z.style.fontSize="16px",z.style.lineHeight="1.6",z.style.marginBottom="16px",z.querySelectorAll("p").forEach(e=>{e.style.margin="0 0 12px 0",e.style.padding="0"}),t.appendChild(r),t.appendChild(v),t.appendChild(w),t.appendChild(z),e.aprimoramentos&&e.aprimoramentos.length>0){const a=document.createElement("div");a.setAttribute("data-aprimoramentos-section","true"),a.style.marginBottom="20px";const o=document.createElement("h4");o.textContent="Aprimoramentos",o.style.color="#ff9800",o.style.fontSize="18px",o.style.fontWeight="bold",o.style.marginBottom="12px",o.style.borderBottom="2px solid #ff9800",o.style.paddingBottom="8px",a.appendChild(o);const s=document.createElement("div");s.style.marginBottom="16px";const r=parseInt(e.system?.ativacao?.custo)||0,n=document.createElement("div");n.style.background="rgba(35, 36, 58, 0.8)",n.style.border="2px solid #ff9800",n.style.borderRadius="8px",n.style.padding="12px",n.style.marginBottom="16px",n.style.textAlign="center",n.style.fontWeight="bold",n.style.fontSize="16px",n.style.color="#ff9800",n.textContent=`Custo Total: ${r} PM`,s.appendChild(n);const i=[];e.aprimoramentos.forEach(e=>{const a=document.createElement("div");a.style.background="rgba(35, 36, 58, 0.8)",a.style.border="1px solid #ff9800",a.style.borderRadius="8px",a.style.padding="12px",a.style.marginBottom="8px",a.style.cursor="pointer",a.style.transition="all 0.2s ease";const o=document.createElement("div");o.style.display="flex",o.style.justifyContent="space-between",o.style.alignItems="center",o.style.marginBottom="8px";const t=document.createElement("span");t.textContent=`+${e.custo} PM`,t.style.background="#ff9800",t.style.color="#fff",t.style.padding="4px 8px",t.style.borderRadius="12px",t.style.fontSize="12px",t.style.fontWeight="bold";const c=document.createElement("span");c.textContent=e.aumenta?"Aumenta Custo":"Modifica Efeito",c.style.background=e.aumenta?"#e91e63":"#2196f3",c.style.color="#fff",c.style.padding="4px 8px",c.style.borderRadius="12px",c.style.fontSize="11px",c.style.fontWeight="bold",o.appendChild(t),o.appendChild(c);const d=document.createElement("div");d.textContent=e.descricao,d.style.color="#fff",d.style.fontSize="14px",d.style.lineHeight="1.4",a.appendChild(o),a.appendChild(d),a.addEventListener("click",()=>{const o=i.findIndex(a=>a===e);o>-1?i.splice(o,1):i.push(e),i.includes(e)?(a.style.border="2px solid #4caf50",a.style.background="rgba(76, 175, 80, 0.1)",a.style.boxShadow="0 0 10px rgba(76, 175, 80, 0.3)"):(a.style.border="1px solid #ff9800",a.style.background="rgba(35, 36, 58, 0.8)",a.style.boxShadow="none"),(()=>{const e=i.reduce((e,a)=>e+a.custo,0),a=r+e;n.textContent=`Custo Total: ${a} PM`})()}),a.addEventListener("mouseenter",()=>{i.includes(e)||(a.style.border="1px solid #4caf50",a.style.background="rgba(76, 175, 80, 0.05)")}),a.addEventListener("mouseleave",()=>{i.includes(e)||(a.style.border="1px solid #ff9800",a.style.background="rgba(35, 36, 58, 0.8)")}),s.appendChild(a)}),a.selectedAprimoramentos=i,a.custoBase=r,a.appendChild(s),t.appendChild(a)}const j=(P=e.name,Q().includes(P));var P;if(j&&"learned-list"===a){const a=document.createElement("div");a.style.marginBottom="20px";const o=document.createElement("h4");o.textContent="Imagem Customizada",o.style.color="#9c27b0",o.style.fontSize="18px",o.style.fontWeight="bold",o.style.marginBottom="12px",o.style.borderBottom="2px solid #9c27b0",o.style.paddingBottom="8px",a.appendChild(o);const s=document.createElement("div");s.style.background="rgba(35, 36, 58, 0.8)",s.style.border="2px solid #9c27b0",s.style.borderRadius="8px",s.style.padding="16px";const r=document.createElement("input");r.type="url",r.placeholder="Cole aqui a URL da imagem ou GIF...",r.value=O(e.name),r.style.width="100%",r.style.padding="8px 12px",r.style.border="1px solid #9c27b0",r.style.borderRadius="4px",r.style.background="#23243a",r.style.color="#fff",r.style.fontSize="14px",r.style.marginBottom="12px",r.style.boxSizing="border-box";const n=document.createElement("div");n.style.marginTop="12px",n.style.textAlign="center";const i=()=>{n.innerHTML="";const e=r.value.trim();if(e){const a=document.createElement("img");a.src=e,a.style.maxWidth="100%",a.style.maxHeight="200px",a.style.borderRadius="8px",a.style.border="2px solid #9c27b0",a.onerror=()=>{n.innerHTML='<div style="color: #f44336; font-size: 12px;">❌ Erro ao carregar imagem</div>'},n.appendChild(a)}else n.innerHTML='<div style="color: #666; font-size: 12px;">Nenhuma imagem definida</div>'};r.addEventListener("input",i),r.addEventListener("blur",()=>{N(e.name,r.value)});const c=document.createElement("button");c.textContent="Limpar Imagem",c.style.background="#f44336",c.style.color="#fff",c.style.border="none",c.style.borderRadius="4px",c.style.padding="8px 16px",c.style.fontSize="12px",c.style.cursor="pointer",c.style.marginTop="8px",c.style.transition="all 0.2s ease",c.onmouseover=()=>{c.style.background="#d32f2f"},c.onmouseout=()=>{c.style.background="#f44336"},c.onclick=()=>{r.value="",N(e.name,""),i()},i(),s.appendChild(r),s.appendChild(n),s.appendChild(c),a.appendChild(s),t.appendChild(a)}const I=document.createElement("div");I.style.display="flex",I.style.gap="10px",I.style.marginTop="20px";const T=document.createElement("button");T.textContent=j?"Esquecer":"Aprender",T.style.background=j?"#f44336":"#2196f3",T.style.color="#fff",T.style.border="none",T.style.borderRadius="8px",T.style.padding="12px 20px",T.style.fontSize="14px",T.style.fontWeight="bold",T.style.cursor="pointer",T.style.flex="1",T.style.transition="all 0.2s ease",T.onmouseover=()=>{T.style.background=j?"#d32f2f":"#1976d2",T.style.transform="translateY(-1px)"},T.onmouseout=()=>{T.style.background=j?"#f44336":"#2196f3",T.style.transform="translateY(0)"},T.onclick=()=>{(function(e){const a=Q(),o=a.indexOf(e);o>-1?(a.splice(o,1),_(`Magia "${e}" removida da lista de aprendidas.`)):(a.push(e),A(`Magia "${e}" adicionada à lista de aprendidas!`)),function(e){try{localStorage.setItem(d,JSON.stringify(e))}catch(e){g.log("Erro ao salvar magias aprendidas:",e)}}(a)})(e.name),s()};const D=document.createElement("button");D.textContent="Compartilhar",D.style.background="#4caf50",D.style.color="#fff",D.style.border="none",D.style.borderRadius="8px",D.style.padding="12px 20px",D.style.fontSize="14px",D.style.fontWeight="bold",D.style.cursor="pointer",D.style.flex="1",D.style.transition="all 0.2s ease",D.onmouseover=()=>{D.style.background="#45a049",D.style.transform="translateY(-1px)"},D.onmouseout=()=>{D.style.background="#4caf50",D.style.transform="translateY(0)"},D.onclick=()=>{let a=[];const o=t.querySelector("div[data-aprimoramentos-section]");o&&o.selectedAprimoramentos&&(a=o.selectedAprimoramentos),g.log("aprimoramentosSectionElement",o),g.log("selectedAprimoramentos",a),function(e,a=[]){try{const o=$(),t=parseInt(e.system?.ativacao?.custo)||0,s=a.reduce((e,a)=>e+a.custo,0),r=t+s;let n=e.system?.description?.value||"Descrição não disponível";const i=Q().includes(e.name)?O(e.name):"";i&&(n=`[Capa](${i}) %NEWLINE% ${n}`),a.length>0&&(n+="%NEWLINE%%NEWLINE%**Aprimoramentos aplicados:**",a.forEach(e=>{n+=`%NEWLINE%    +${e.custo} PM: ${e.descricao}`}),n+=`%NEWLINE%%NEWLINE%**Custo Total: ${r} PM**`);const c={name:e.name,type:e.tradition.charAt(0).toUpperCase()+e.tradition.slice(1),execution:e.system?.ativacao?.type||"Padrão",duration:e.system?.duracao||"Cena",range:e.system?.alcance||"Curto",target:e.system?.alvo||"1 Alvo",resistance:e.system?.resistencia||"Nenhuma",description:n};g.dir({spellData:c,selectedAprimoramentos:a,custoTotal:r,custoBase:t,custoAprimoramentos:s}),Z(`&{template:spell}{{character=@{${o}|character_name}}}{{spellname=${c.name}}}{{type=${c.type}}}{{execution=${c.execution}}}{{duration=${c.duration}}}{{range=${c.range}}}{{targetarea=${c.target}}}{{resistance=${c.resistance}}}{{description=${c.description}}}{{cd=[[@{${o}|cdtotal}+0]]}}`);const d=document.querySelector('button[onclick*="shareSpellToChat"]');if(d){const e=d.textContent;d.textContent="✅ Enviado!",d.style.background="#4caf50",setTimeout(()=>{d.textContent=e},2e3)}}catch(e){console.error("Erro ao compartilhar magia:",e),alert("Erro ao compartilhar magia no chat. Verifique o console para mais detalhes.")}finally{Ce()}}(e,a)},I.appendChild(T),I.appendChild(D),t.appendChild(I),o.onclick=s,document.body.appendChild(o),document.body.appendChild(t)}async function ne(){const e=document.getElementById("grimorio-popup");e&&e.remove();const a=document.getElementById("grimorio-overlay");if(a&&a.remove(),!window.grimorioSpellsCache){g.log("Carregando todas as magias...");const e=document.createElement("div");e.id="grimorio-loading",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.background="rgba(30, 30, 40, 0.98)",e.style.border="2px solid #9c27b0",e.style.borderRadius="12px",e.style.padding="40px",e.style.zIndex="10003",e.style.textAlign="center",e.style.color="#9c27b0",e.style.fontSize="18px",e.style.fontWeight="bold",e.innerHTML='\n                <div style="margin-bottom: 20px;">🔄</div>\n                <div>Carregando Grimório de Magias...</div>\n                <div style="font-size: 14px; margin-top: 10px; color: #ccc;">Isso pode levar alguns segundos</div>\n            ',document.body.appendChild(e);try{window.grimorioSpellsCache=await se(),g.log(`Carregadas ${window.grimorioSpellsCache.length} magias no total`)}catch(e){console.error("Erro ao carregar magias:",e),window.grimorioSpellsCache=[]}finally{const e=document.getElementById("grimorio-loading");e&&e.remove()}}const o=document.createElement("div");o.id="grimorio-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="grimorio-popup",t.className="roll20-popup roll20-popup-purple",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #9c27b0",t.style.borderRadius="12px",t.style.padding="20px",t.style.zIndex="10001",t.style.maxWidth="800px",t.style.maxHeight="700px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="20px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#9c27b0",onClick:()=>{t.remove();const e=document.getElementById("grimorio-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Grimório de Magias",n.style.color="#9c27b0",n.style.margin="0",n.style.fontSize="20px",n.style.fontWeight="bold",n.title="Atalho: Ctrl + G";const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="flex-start";const c=document.createElement("div");c.textContent="Atalho: Ctrl + G",c.style.color="#666",c.style.fontSize="12px",c.style.marginTop="2px",i.appendChild(n),i.appendChild(c),s.appendChild(i),s.appendChild(r.render()),t.appendChild(s);const d=x({placeholder:"Filtrar magias por nome...",theme:"purple",marginBottom:"15px",onInput:e=>{!function(e){g.log(`Filtrando magias por: ${e}`);const a=window.grimorioSpellsCache||[];if(a&&a.length>0){let o=[...a];if(u&&"todas"!==u&&(o=o.filter(e=>e.tradition===u)),e){const a=e.toLowerCase();o=o.filter(e=>e.name.toLowerCase().includes(a)||e.escola.toLowerCase().includes(a)||e.system?.description?.value&&e.system.description.value.toLowerCase().includes(a))}o.sort((e,a)=>e.name.localeCompare(a.name));const t=window.grimorioSpellsCache;window.grimorioSpellsCache=o,v(),window.grimorioSpellsCache=t}else v()}(e)}});t.appendChild(d.container);const l=document.createElement("div");l.style.display="flex",l.style.marginBottom="20px",l.style.borderBottom="2px solid #9c27b0";const m=[{id:"todas",name:"Todas",color:"#ffffff"},{id:"arcana",name:"Arcana",color:"#9c27b0"},{id:"divina",name:"Divina",color:"#4caf50"},{id:"universal",name:"Universal",color:"#ff9800"}];let u="todas";m.forEach(e=>{const a=document.createElement("div");a.id=`tab-${e.id}`,a.textContent=e.name,a.style.padding="12px 20px",a.style.cursor="pointer",a.style.borderBottom="3px solid transparent",a.style.color=e.id===u?e.color:"#666",a.style.fontWeight=e.id===u?e.color:"normal",a.style.transition="all 0.2s",a.style.borderRadius="6px 6px 0 0",a.onclick=()=>{m.forEach(e=>{const a=document.getElementById(`tab-${e.id}`);a&&(a.style.color="#666",a.style.fontWeight="normal",a.style.borderBottom="3px solid transparent")}),a.style.color=e.color,a.style.fontWeight="bold",a.style.borderBottom=`3px solid ${e.color}`,u=e.id,f(e.id)},e.id===u&&(a.style.color=e.color,a.style.fontWeight="bold",a.style.borderBottom=`3px solid ${e.color}`),l.appendChild(a)}),t.appendChild(l);const p=document.createElement("div");function f(e){g.log(`Atualizando conteúdo da aba: ${e}`);const a=p;a.innerHTML="";const o=window.grimorioSpellsCache||[];if(!o||0===o.length){const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.justifyContent="center",e.style.padding="40px 20px",e.style.color="#666",e.style.textAlign="center";const o=document.createElement("div");o.textContent="📚",o.style.fontSize="48px",o.style.marginBottom="15px";const t=document.createElement("div");t.textContent="Nenhuma magia registrada ainda",t.style.fontSize="18px",t.style.fontWeight="bold",t.style.marginBottom="8px";const s=document.createElement("div");return s.textContent="As magias desta tradição serão exibidas aqui quando forem adicionadas ao sistema.",s.style.fontSize="14px",s.style.lineHeight="1.4",e.appendChild(o),e.appendChild(t),e.appendChild(s),void a.appendChild(e)}let t;if("todas"===e?(t=o,g.log(`Encontradas ${t.length} magias no total`)):(t=o.filter(a=>a.tradition===e),g.log(`Encontradas ${t.length} magias para tradição ${e}`)),0===t.length){const o=document.createElement("div");o.style.display="flex",o.style.flexDirection="column",o.style.alignItems="center",o.style.justifyContent="center",o.style.padding="40px 20px",o.style.color="#666",o.style.textAlign="center";const t=document.createElement("div");t.textContent="🔮",t.style.fontSize="48px",t.style.marginBottom="15px";const s=document.createElement("div");s.textContent="Nenhuma magia nesta tradição",s.style.fontSize="18px",s.style.fontWeight="bold",s.style.marginBottom="8px";const r=document.createElement("div");return r.textContent=`Não há magias registradas para a tradição ${e}.`,r.style.fontSize="14px",r.style.lineHeight="1.4",o.appendChild(t),o.appendChild(s),o.appendChild(r),void a.appendChild(o)}const s=document.createElement("div");s.style.color="#9c27b0",s.style.fontSize="14px",s.style.fontWeight="bold",s.style.marginBottom="15px",s.style.textAlign="center",s.textContent=`${t.length} magia${1!==t.length?"s":""} encontrada${1!==t.length?"s":""}`,a.appendChild(s);const r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",r.style.gap="10px",t.forEach(e=>{const a=function(e){const a=document.createElement("div");a.style.background="rgba(35, 36, 58, 0.8)",a.style.border="1px solid #9c27b0",a.style.borderRadius="8px",a.style.padding="16px",a.style.cursor="pointer",a.style.transition="all 0.2s",a.style.marginBottom="8px",a.onmouseover=()=>{a.style.background="rgba(45, 46, 74, 0.9)",a.style.borderColor="#ba68c8",a.style.transform="translateY(-2px)"},a.onmouseout=()=>{a.style.background="rgba(35, 36, 58, 0.8)",a.style.borderColor="#9c27b0",a.style.transform="translateY(0)"},a.onclick=()=>{re(e)};const o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.marginBottom="12px";const t=document.createElement("div");t.textContent=e.name,t.style.color="#fff",t.style.fontSize="16px",t.style.fontWeight="bold",t.style.flex="1",o.appendChild(t);const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.marginBottom="8px",s.style.flexWrap="wrap";const r=document.createElement("span");r.textContent=e.circuloDisplay||`${e.circulo}º Círculo`,r.style.background="#9c27b0",r.style.color="#fff",r.style.padding="4px 8px",r.style.borderRadius="12px",r.style.fontSize="12px",r.style.fontWeight="bold";const n=document.createElement("span");n.textContent=e.escola,n.style.background="#4caf50",n.style.color="#fff",n.style.padding="4px 8px",n.style.borderRadius="12px",n.style.fontSize="12px",n.style.fontWeight="bold";const i=document.createElement("span");i.textContent=e.system?.ativacao?.execucao||"N/A",i.style.background="#ff9800",i.style.color="#fff",i.style.padding="4px 8px",i.style.borderRadius="12px",i.style.fontSize="12px",i.style.fontWeight="bold",s.appendChild(r),s.appendChild(n),s.appendChild(i);const c=document.createElement("div"),d=e.system?.description?.value||"Descrição não disponível";if(c.textContent=d.length>150?d.substring(0,150)+"...":d,c.style.color="#ccc",c.style.fontSize="14px",c.style.lineHeight="1.4",e.aprimoramentos&&e.aprimoramentos.length>0){const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.gap="6px",t.style.marginTop="8px",t.style.padding="6px 10px",t.style.background="rgba(255, 152, 0, 0.1)",t.style.border="1px solid rgba(255, 152, 0, 0.3)",t.style.borderRadius="6px";const r=document.createElement("span");r.textContent="⚡",r.style.fontSize="14px";const n=document.createElement("span");n.textContent=`${e.aprimoramentos.length} aprimoramento${e.aprimoramentos.length>1?"s":""} disponível${e.aprimoramentos.length>1?"eis":""}`,n.style.color="#ff9800",n.style.fontSize="12px",n.style.fontWeight="bold",t.appendChild(r),t.appendChild(n),a.appendChild(o),a.appendChild(s),a.appendChild(c),a.appendChild(t)}else a.appendChild(o),a.appendChild(s),a.appendChild(c);return a}(e);r.appendChild(a)}),a.appendChild(r)}function v(){g.log("🔄 Recarregando conteúdo do grimório..."),f(u)}p.id="grimorio-tab-content",p.style.flex="1",p.style.overflowY="auto",f(u),t.appendChild(p),document.body.appendChild(t),S(t,"purple")}function ie(){const e=document.getElementById("spells-popup");e&&e.remove();const o=document.getElementById("spells-overlay");o&&o.remove();const t=document.createElement("div");t.id="spells-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10000",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="spells-popup",s.className="roll20-popup roll20-popup-purple",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #6ec6ff",s.style.borderRadius="12px",s.style.padding="18px 20px 16px 20px",s.style.zIndex="10001",s.style.maxWidth="340px",s.style.maxHeight="480px",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="15px",r.style.width="100%";const n=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove();const e=document.getElementById("spells-overlay");e&&e.remove()}}),i=document.createElement("h3");i.textContent="Magias",i.style.color="#ecf0f1",i.style.margin="0",i.style.fontSize="17px",i.style.fontWeight="bold",r.appendChild(i),r.appendChild(n.render()),s.appendChild(r);const c=x({placeholder:"Filtrar magias...",theme:"blue",onInput:()=>{u()},onClear:()=>{u()}});s.appendChild(c.container);const d=z("spell");s.appendChild(d);const l=[oe({nome:"Sombras Profanas",comando:`&{template:spell}{{character=@{${I()}|character_name}}}{{spellname=Sombras Profanas}}{{type=Universal}}{{execution=Padrão}}{{duration=Cena}}{{range=Curto}}{{targetarea=1 Objeto}}{{resistance=Vontade}}{{description=O alvo emana sombras em uma área com 6m de raio. Criaturas dentro da área recebem camuflagem leve por escuridão leve. As sombras não podem ser iluminadas por nenhuma fonte de luz natural. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a escuridão, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Escuridão anula Luz.\n\n    +1 PM: aumenta a área da escuridão em +1,5m de raio.\n\n    +2 PM: muda o efeito para fornecer camuflagem total por escuridão total. As sombras bloqueiam a visão na área e através dela.\n\n    +2 PM: muda o alvo para 1 criatura e a resistência para Fortitude parcial. Você lança a magia nos olhos do alvo, que fica cego pela cena. Se passar na resistência, fica cego por 1 rodada. Requer 2º círculo.\n\n    +3 PM: muda a duração para um dia.\n\n    +5 PM: muda o alcance para pessoal e o alvo para você. Em vez do normal, você é coberto por sombras, recebendo +10 em testes de Furtividade e camuflagem leve. Requer 2º círculo.\n\n    JdA:193}}{{cd=[[@{${I()}|cdtotal}+0]]}}`}),oe({nome:"Luz Sagrada",comando:`&{template:spell}{{character=@{${I()}|character_name}}}{{spellname=Luz Sagrada}}{{type=Universal}}{{execution=Padrão}}{{duration=Cena}}{{range=Curto}}{{targetarea=1 Objeto}}{{resistance=Vontade}}{{description=O alvo emite luz (mas não produz calor) em uma área com 6m de raio. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a luz, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Luz anula Escuridão.\n\n    +1 PM: aumenta a área iluminada em +3m de raio.\n\n    +2 PM: muda a duração para um dia.\n    +2 PM: muda a duração para permanente e adiciona componente material (pó de rubi no valor de T$ 50). Não pode ser usado em conjunto com outros aprimoramentos. Requer 2º círculo.\n    +0 PM (Apenas Arcanos): muda o alvo para 1 criatura. Você lança a magia nos olhos do alvo, que fica ofuscado pela cena. Não afeta criaturas cegas.\n    +2 PM (Apenas Arcanos): muda o alcance para longo e o efeito para cria 4 pequenos globos flutuantes de pura luz. Você pode posicionar os globos onde quiser dentro do alcance. Uma vez por rodada, você pode mover os globos com uma ação livre. Cada um ilumina como uma tocha, mas não produz calor. Se um globo ocupar o espaço de uma criatura, ela fica ofuscada e sua silhueta pode ser vista claramente (ela não recebe camuflagem por escuridão ou invisibilidade). Requer 2º círculo.\n    +2 PM (Apenas Divinos): a luz é cálida como a do sol. Criaturas que sofrem penalidades e dano pela luz solar sofrem seus efeitos como se estivessem expostas à luz solar real. Seus aliados na área estabilizam automaticamente e ficam imunes à condição sangrando, e seus inimigos ficam ofuscados. Requer 2º círculo.\n    +5 PM (Apenas Divinos): muda o alcance para toque e o alvo para 1 criatura. Em vez do normal, o alvo é envolto por um halo de luz, recebendo +10 em testes de Diplomacia e redução de trevas 10. Requer 2º círculo.\n    JdA:193}}{{cd=[[@{${I()}|cdtotal}+0]]}}`})],m=document.createElement("div");async function u(){const e=c.getValue().trim().toLowerCase();m.innerHTML="";const o=Q();let t=window.grimorioSpellsCache||[];if(0===t.length&&o.length>0)try{window.grimorioSpellsCache=await se(),t=window.grimorioSpellsCache}catch(e){g.log("Erro ao carregar cache de magias:",e),t=[]}const s=o.map(e=>{const a=t.find(a=>a.name===e);if(a){const e=O(a.name);let o=a.system?.description?.value||"Descrição não disponível";return e&&(o=`[Cover](${e}) %NEWLINE% ${o}`),{nome:a.name,comando:`&{template:spell}{{character=@{${I()}|character_name}}}{{spellname=${a.name}}}{{type=${a.tradition.charAt(0).toUpperCase()+a.tradition.slice(1)}}}{{execution=${a.execucao||"Padrão"}}}{{duration=${a.system?.duracao||"Cena"}}}{{range=${a.system?.alcance||"Curto"}}}{{targetarea=${a.system?.alvo||"1 Alvo"}}}{{resistance=${a.system?.resistencia||"Nenhuma"}}}{{description=${o}}}{{cd=[[@{${I()}|cdtotal}+0]]}}`,onClick:()=>re(a,"learned-list")}}return null}).filter(e=>null!==e),r=[...l.filter(e=>"Sombras Profanas"===e.nome?Fe("Sombras Profanas"):"Luz Sagrada"===e.nome&&Fe("Luz Sagrada")),...s],n=V(),i=r.sort((e,a)=>{const o=n.includes(e.nome),t=n.includes(a.nome);return o&&!t?-1:!o&&t?1:e.nome.localeCompare(a.nome)}).filter(a=>a.nome.toLowerCase().includes(e));if(0===i.length){const a=document.createElement("div");if(a.style.textAlign="center",a.style.padding="20px",a.style.color="#999",a.style.fontSize="14px",a.style.fontStyle="italic",e.length>0){const a=ye(e,"magia","blue");return void m.appendChild(a)}{const e=Ve(),t=Ne();a.style.background="rgba(110, 198, 255, 0.1)",a.style.border="1px solid rgba(110, 198, 255, 0.3)",a.style.borderRadius="8px",a.style.marginTop="10px",a.style.color="#6ec6ff",e||0!==o.length?t||0!==o.length?0===o.length?a.innerHTML="🔮<br/>Nenhuma magia disponível<br><small>Use o grimório para aprender magias</small>":a.innerHTML="🔮<br/>Nenhuma magia disponível<br><small>Esta raça não possui magias especiais</small>":a.innerHTML="🔮<br/>Nenhuma magia disponível<br><small>Defina o tipo da sua raça para obter magias especiais ou aprenda magias no grimório</small>":a.innerHTML="🔮<br/>Nenhuma magia disponível<br><small>Selecione uma raça para obter magias especiais ou aprenda magias no grimório</small>"}return void m.appendChild(a)}i.forEach(e=>{const o=V().includes(e.nome),t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.gap="8px",t.style.background=o?"rgba(110, 198, 255, 0.1)":"transparent",t.style.borderRadius="6px",t.style.padding="2px";const s=document.createElement("button"),r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.width="100%",r.style.padding="0 8px";const n=document.createElement("span");n.textContent=e.nome,n.style.textAlign="center",n.style.fontWeight="bold",r.appendChild(n),s.appendChild(r),s.style.flex="1",s.style.background="#23243a",s.style.color="#fff",s.style.border="1px solid #6ec6ff",s.style.borderRadius="6px",s.style.padding="8px 0",s.style.fontSize="15px",s.style.fontWeight="bold",s.style.cursor="pointer",s.style.transition="all 0.2s",s.onmouseover=()=>{s.style.background="#6ec6ff",s.style.color="#23243a"},s.onmouseout=()=>{s.style.background="#23243a",s.style.color="#fff"},s.onclick=a=>{a.ctrlKey?e.onClick():(Z(e.comando),Ce())};const i=document.createElement("button");i.innerHTML=o?"📌":"📍",i.style.background="none",i.style.border="none",i.style.color=o?"#6ec6ff":"#666",i.style.fontSize="14px",i.style.cursor="pointer",i.style.padding="4px",i.style.borderRadius="4px",i.style.transition="all 0.2s",i.style.minWidth="24px",i.style.height="24px",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.title=o?"Remover dos favoritos":"Adicionar aos favoritos",i.onmouseover=()=>{i.style.background="rgba(110, 198, 255, 0.2)",i.style.color="#6ec6ff"},i.onmouseout=()=>{i.style.background="none",i.style.color=o?"#6ec6ff":"#666"},i.onclick=o=>{o.stopPropagation(),function(e){const o=V(),t=o.indexOf(e);t>-1?(o.splice(t,1),_(`Magia "${e}" removida dos favoritos.`)):(o.push(e),A(`Magia "${e}" adicionada aos favoritos!`)),function(e){try{localStorage.setItem(a,JSON.stringify(e))}catch(e){g.log("Erro ao salvar magias favoritas:",e)}}(o)}(e.nome),u()},t.appendChild(s),t.appendChild(i),m.appendChild(t)})}m.id="spells-list",m.style.display="flex",m.style.flexDirection="column",m.style.gap="6px",m.style.marginTop="2px",s.appendChild(m),u(),document.body.appendChild(s),S(s,"blue")}function ce(){return JSON.parse(localStorage.getItem("tormenta-20-hotbars-pratos-favoritos")||"[]")}function de(){return JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebidas-favoritas")||"[]")}function le(){return JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocoes-favoritas")||"[]")}function me(){try{return[{nome:"Granada de Bola de Fogo (10d6)",preco:"T$ 1470",efeito:"10d6",descricao:"Esta famosa magia de ataque cria uma poderosa explosão, causando 6d6 pontos de dano de fogo em todas as criaturas e objetos livres na área.",tipo:"Granada",icone:"🔥",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball02.jpg",system:{alcance:"medio",alvo:"esfera com 6m de raio",resistencia:"Reflexos reduz à metade",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 182"}},{nome:"Granada de Bola de Fogo",preco:"T$ 270",efeito:"6d6",descricao:"Esta famosa magia de ataque cria uma poderosa explosão, causando 6d6 pontos de dano de fogo em todas as criaturas e objetos livres na área.",tipo:"Granada",icone:"🔥",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball02.jpg",system:{alcance:"medio",alvo:"esfera com 6m de raio",resistencia:"Reflexos reduz à metade",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 182"}},{nome:"Granada de Névoa",preco:"T$ 30",efeito:"",descricao:"Uma névoa espessa eleva-se de um ponto a sua escolha, obscurecendo toda a visão — criaturas a até 1,5m têm camuflagem leve e criaturas a partir de 3m têm camuflagem total. Um vento forte dispersa a névoa em 4 rodadas e um vendaval a dispersa em 1 rodada. Esta magia não funciona sob a água.",tipo:"Granada",icone:"🌫️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_fogwalking.jpg",system:{alcance:"curto",alvo:"nuvem com 6m de raio e 6m de altura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 200"}},{nome:"Granada de Área Escorregadia",preco:"T$ 30",efeito:"ou",descricao:"Esta magia recobre uma superfície com uma substância gordurosa e escorregadia. Criaturas na área devem passar na resistência para não cair. Nas rodadas seguintes, criaturas que tentem movimentar- se pela área devem fazer testes de Acrobacia para equilíbrio (CD 10). Área Escorregadia pode tornar um item escorregadio. Uma criatura segurando um objeto afetado deve passar na resistência para não deixar o item cair cada vez que usá-lo.",tipo:"Granada",icone:"💣",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg",system:{alcance:"curto",alvo:"Quadrado de 3m ou 1 objeto",resistencia:"Reflexos (veja texto)",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 180"}},{nome:"Poção de Aparência Perfeita",preco:"T$ 270",efeito:"",descricao:"Esta magia lhe concede um rosto idealizado, porte físico garboso, voz melodiosa e olhar sedutor. Caso seu Carisma seja 5 ou mais, você recebe +2 neste atributo. Do contrário, ele se torna 5 (isso conta como um bônus). Além disso, você recebe +5 em Diplomacia e Enganação. Quando a magia acaba, quaisquer observadores percebem a mudança e tendem a suspeitar de você. Da mesma maneira, pessoas que o viram sob o efeito da magia sentirão que &ldquo;algo está errado&rdquo; ao vê-lo em condições normais. Quando a cena acabar, você pode gastar os PM da magia novamente como uma ação livre para mantê-la ativa. Este efeito não fornece PV ou PM adicionais.",tipo:"Poção",icone:"🎭",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_polymorph.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 180"}},{nome:"Poção de Camuflagem Ilusória",preco:"T$ 270",efeito:"",descricao:"O alvo fica com sua imagem nublada, como se vista através de um líquido, recebendo os efeitos de camuflagem leve.",tipo:"Poção",icone:"🥷",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_invisibility.jpg",system:{alcance:"none",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 183"}},{nome:"Poção de Compreensão",preco:"T$ 30",efeito:"",descricao:"Essa magia lhe confere compreensão sobrenatural. Você pode tocar um texto e entender as palavras mesmo que não conheça o idioma. Se tocar numa criatura inteligente, pode se comunicar com ela mesmo que não tenham um idioma em comum. Se tocar uma criatura não inteligente, como um animal, pode perceber seus sentimentos. Você também pode gastar uma ação de movimento para ouvir os pensamentos de uma criatura tocada (você &ldquo;ouve&rdquo; o que o alvo está pensando), mas um alvo involuntário tem direito a um teste de Vontade para proteger seus pensamentos e evitar este efeito.",tipo:"Poção",icone:"🧠",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_invisibilitytotem.jpg",system:{alcance:"toque",alvo:"1 criatura ou texto",resistencia:"Vontade anula (veja descrição).",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 184"}},{nome:"Poção de Concentração de Combate (cena)",preco:"T$ 270",efeito:"",descricao:"Você amplia sua percepção, antecipando movimentos dos inimigos e achando brechas em sua defesa. Quando faz um ataque, você rola dois dados e usa o melhor resultado.",tipo:"Poção",icone:"🎯",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessedrecovery.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Curar Ferimentos (11d8+11 PV)",preco:"T$ 3000",efeito:"11d8+11",descricao:"Você canaliza energia positiva que recupera 11d8+11 pontos de vida na criatura tocada.",tipo:"Poção",icone:"❤️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_54.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 189"}},{nome:"Poção de Curar Ferimentos (2d8+2 PV)",preco:"T$ 30",efeito:"2d8+2",descricao:"Você canaliza energia positiva que recupera 2d8+2 pontos de vida na criatura tocada.",tipo:"Poção",icone:"❤️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_54.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 189"}},{nome:"Poção de Curar Ferimentos (4d8+4 PV)",preco:"T$ 270",efeito:"2d8+2",descricao:"Você canaliza energia positiva que recupera 2d8+2 pontos de vida na criatura tocada.",tipo:"Poção",icone:"❤️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_54.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 189"}},{nome:"Poção de Curar Ferimentos (7d8+7 PV)",preco:"T$ 1080",efeito:"2d8+2",descricao:"Você canaliza energia positiva que recupera 7d8+7 pontos de vida na criatura tocada.",tipo:"Poção",icone:"❤️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_54.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 189"}},{nome:"Poção de Disfarce Ilusório",preco:"T$ 30",efeito:"",descricao:"Você muda a aparência do alvo, incluindo seu equipamento. Isso inclui altura, peso, tom de pele, cor de cabelo, timbre de voz etc. O alvo recebe +10 em testes de Enganação para disfarce. O alvo não recebe novas habilidades (você pode ficar parecido com outra raça, mas não ganhará as habilidades dela), nem modifica o equipamento (uma espada longa disfarçada de bordão continua funcionando e causando dano como uma espada).",tipo:"Poção",icone:"🎭",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_polymorph.jpg",system:{alcance:"self",alvo:"Você",resistencia:"Vontade desacredita",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 191"}},{nome:"Poção de Enfeitiçar",preco:"T$ 30",efeito:"",descricao:"O alvo da poção fica enfeitiçado pela primeira criatura que enxergar.Esta magia torna o alvo prestativo (veja a página 118). Ele não fica sob seu controle, mas percebe suas palavras e ações da maneira mais favorável possível. Você recebe um bônus de +10 em testes de Diplomacia com a vítima. Um alvo hostil ou que esteja envolvido em um combate recebe +5 em seu teste de resistência. Se você ou seus aliados tomarem qualquer ação hostil contra o alvo, a magia é dissipada e o alvo retorna à atitude que tinha antes (ou piorada, de acordo com o mestre).",tipo:"Poção",icone:"🧪",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_54.jpg",system:{alcance:"self",alvo:"1 humanoide",resistencia:"Vontade anula",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Escudo da Fé (cena)",preco:"T$ 30",efeito:"",descricao:"Um escudo místico se manifesta momentaneamente para bloquear um golpe. O alvo recebe +2 na Defesa.",tipo:"Poção",icone:"✝️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_powerwordshield.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Físico Divino (3 atributos)",preco:"T$ 1080",efeito:"",descricao:"O alvo se torna uma versão mais poderosa de si mesmo. O alvo recebe +2 em Força, Destreza e Constituição. Esse aumento não oferece PV ou PM adicionais.",tipo:"Poção",icone:"💪",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_fistofjustice.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Físico Divino",preco:"T$ 270",efeito:"",descricao:"O alvo se torna uma versão mais poderosa de si mesmo. O alvo recebe +2 em Força, Destreza ou Constituição, a sua escolha. Esse aumento não oferece PV ou PM adicionais.",tipo:"Poção",icone:"💪",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_fistofjustice.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Invisibilidade (cena)",preco:"T$ 1080",efeito:"",descricao:"O alvo fica invisível, incluindo seu equipamento. Ele recebe camuflagem total e +20 em testes de Furtividade. Como o normal, criaturas que não possam vê-lo ficam desprevenidas contra seus ataques.\n\nA magia termina se o alvo faz um ataque ou usa uma habilidade hostil. Ações contra objetos livres não dissipam a Invisibilidade (você pode tocar ou apanhar objetos que não estejam sendo segurados por outras criaturas). Causar dano indiretamente — por exemplo, acendendo o pavio de um barril de pólvora que vai detonar mais tarde — não é considerado um ataque.\n\nObjetos soltos pelo alvo voltam a ser visíveis e objetos apanhados por ele ficam invisíveis. Uma luz transportada pelo alvo nunca fica invisível (mesmo que sua fonte seja). Qualquer parte de um item carregado que se estenda além de seu alcance corpo a corpo natural se torna visível.",tipo:"Poção",icone:"👻",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Mente Divina",preco:"T$ 270",efeito:"",descricao:"Você traz inspiração divina à mente do alvo. Escolha entre Inteligência, Sabedoria ou Carisma. O alvo recebe +4 no atributo escolhido. Esse aumento não oferece PV, PM ou perícias adicionais.",tipo:"Poção",icone:"🧠",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane01.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Metamorfose",preco:"T$ 270",efeito:"",descricao:"Você muda sua aparência e forma — incluindo seu equipamento — para qualquer outra criatura, existente ou imaginada. Independentemente da forma escolhida, você recebe +20 em testes de Enganação para disfarce. Características não mencionadas não mudam.\n\nSe mudar para uma forma humanoide, pode mudar o tipo de dano físico de suas armas (se usa uma maça e transformá- la em espada longa, ela pode causar dano de corte, por exemplo). Se quiser, pode assumir uma forma humanoide com uma categoria de tamanho acima ou abaixo da sua; nesse caso aplique os modificadores em Furtividade e testes de manobra.\n\nSe mudar para outras formas, você pode escolher uma Forma Selvagem do druida (veja no Capítulo 1). Nesse caso você não pode atacar com suas armas, falar ou lançar magias até voltar ao normal, mas recebe uma ou mais armas naturais e os bônus da forma selvagem escolhida.",tipo:"Poção",icone:"🦋",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_polymorph.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Primor Atlético",preco:"T$ 30",efeito:"",descricao:"Você modifica os limites físicos do alvo, que recebe deslocamento +9m e +10 em testes de Atletismo.",tipo:"Poção",icone:"🏃",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_swiftness.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 201"}},{nome:"Poção de Proteção Divina",preco:"T$ 30",efeito:"",descricao:"Esta magia cria uma barreira mística invisível que fornece ao alvo +2 em testes de resistência.",tipo:"Poção",icone:"🛡️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_barrier.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 202"}},{nome:"Poção de Purificação",preco:"T$ 270",efeito:"",descricao:"Seu toque purifica a criatura tocada. Esta magia remove uma das seguintes condições: abalado, apavorado, alquebrado, atordoado, cego, confuso, debilitado, enjoado, envenenado, esmorecido, exausto, fascinado, fatigado, fraco, frustrado, lento, ofuscado, paralisado, pasmo ou surdo.",tipo:"Poção",icone:"🧹",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_purify.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 202"}},{nome:"Poção de Resistência a Energia",preco:"T$ 30",efeito:"",descricao:"Ao lançar esta magia, escolha entre ácido, eletricidade, fogo, frio, luz ou trevas. O alvo recebe redução de dano 10 contra o tipo de dano escolhido.",tipo:"Poção",icone:"🔥",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostresistancetotem_01.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 204"}},{nome:"Poção de Sono",preco:"T$ 30",efeito:"",descricao:"Um cansaço místico recai sobre o alvo. Se falhar na resistência, ele fica inconsciente e caído ou, se estiver envolvido em combate ou outra situação perigosa, fica exausto por 1 rodada, depois fatigado. Em ambos os casos, se passar, o alvo fica fatigado por 1d4 rodadas.",tipo:"Poção",icone:"😴",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_sleep.jpg",system:{alcance:"toque",alvo:"1 criatura de ND 2 ou menor",resistencia:"Vontade parcial",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 207"}},{nome:"Poção de Suporte Ambiental",preco:"T$ 30",efeito:"",descricao:"Esta magia garante a sobrevivência em ambientes hostis. O alvo fica imune aos efeitos de calor e frio extremos, pode respirar na água se respirar ar (ou vice-versa) e não sufoca em fumaça densa.",tipo:"Poção",icone:"🌊",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_ancestralguardian.jpg",system:{alcance:"toque",alvo:"1 criatura",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 207"}},{nome:"Poção de Velocidade",preco:"T$ 270",efeito:"",descricao:"O alvo pode realizar uma ação padrão ou de movimento adicional por turno. Esta ação não pode ser usada para lançar magias e ativar engenhocas.",tipo:"Poção",icone:"⚡",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_swiftness.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Visão Mística",preco:"T$ 30",efeito:"",descricao:"Seus olhos brilham com uma luz azul e passam a enxergar auras mágicas. Este efeito é similar ao uso de Misticismo para detectar magia, mas você detecta todas as auras mágicas em alcance médio e recebe todas as informações sobre elas sem gastar ações. Além disso, você pode gastar uma ação de movimento para descobrir se uma criatura que possa perceber em alcance médio é capaz de lançar magias e qual a aura gerada pelas magias de círculo mais alto que ela pode lançar.",tipo:"Poção",icone:"👁️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_searinglightpriest.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Vitalidade Fantasma",preco:"T$ 30",efeito:"2d8",descricao:"Você suga energia vital da terra, recebendo 2d8 pontos de vida temporários. Os PV temporários desaparecem ao final da cena.",tipo:"Poção",icone:"👻",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_ghoulfrenzy.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Poção de Voz Divina",preco:"T$ 270",efeito:"",descricao:"Você pode conversar com criaturas de qualquer raça e tipo: animal, construto, espírito, humanoide, monstro ou morto-vivo. Pode fazer perguntas e entende suas respostas, mesmo sem um idioma em comum ou se a criatura não for capaz de falar, mas respeitando os limites da Inteligência dela. A atitude dessas criaturas não é alterada, mas você pode usar a perícia Diplomacia para tentar mudar sua atitude.",tipo:"Poção",icone:"🗣️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_divinespirit.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5}},{nome:"Óleo de Abençoar Alimentos",preco:"T$ 30",efeito:"",descricao:"Você purifica e abençoa uma porção de comida ou dose de bebida. Isso torna um alimento sujo, estragado ou envenenado próprio para consumo. Além disso, se for consumido até o final da duração, o alimento oferece 5 PV temporários ou 1 PM temporário (além de quaisquer bônus que já oferecesse). Bônus de alimentação duram um dia e cada personagem só pode receber um bônus de alimentação por dia.",tipo:"Óleo",icone:"🛢️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessingofstrength.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 178"}},{nome:"Óleo de Alterar Tamanho",preco:"T$ 270",efeito:"",descricao:"Esta magia aumenta ou diminui o tamanho de um item mundano em até três categorias (um objeto Enorme vira Pequeno, por exemplo). Você também pode mudar a consistência do item, deixando-o rígido como pedra ou flexível como seda (isso não altera sua RD ou PV, apenas suas propriedades físicas). Se lançar a magia num objeto de uma criatura involuntária, ela pode fazer um teste de Vontade para anulá-la.",tipo:"Óleo",icone:"🛢️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessingofstrength.jpg",system:{alcance:"toque",alvo:"1 objeto",duracao:"1 dia",resistencia:"Vontade",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 179"}},{nome:"Óleo de Arma Mágica (+3)",preco:"T$ 750",efeito:"",descricao:"A arma fornece +3 nos testes de ataque e rolagens de dano e é considerada mágica (não cumulativo com bônus de encantos). Caso você esteja empunhando a arma, pode usar seu atributo-chave de magias em vez do atributo original nos testes de ataque (não cumulativo com efeitos que somam este atributo).",tipo:"Óleo",icone:"⚔️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_30.jpg",system:{alcance:"toque",alvo:"1 arma",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 181"}},{nome:"Óleo de Arma Mágica",preco:"T$ 30",efeito:"",descricao:"A arma fornece +1 nos testes de ataque e rolagens de dano e é considerada mágica (não cumulativo com bônus de encantos). Caso você esteja empunhando a arma, pode usar seu atributo-chave de magias em vez do atributo original nos testes de ataque (não cumulativo com efeitos que somam este atributo).",tipo:"Óleo",icone:"⚔️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_30.jpg",system:{alcance:"toque",alvo:"1 arma",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 181"}},{nome:"Óleo de Armamento da Natureza",preco:"T$ 270",efeito:"",descricao:"Você fortalece uma arma mundana primitiva (sem custo em T$, como bordão, clava, funda ou tacape), uma arma natural ou um ataque desarmado. O dano da arma aumenta em um passo e ela é considerada mágica. Ao lançar a magia, você pode mudar o tipo de dano da arma (escolhendo entre corte, impacto ou perfuração).",tipo:"Óleo",icone:"⚔️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_30.jpg",system:{alcance:"self",alvo:"1 arma (veja texto)",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 181"}},{nome:"Óleo de Escuridão",preco:"T$ 30",efeito:"",descricao:"O alvo emana sombras em uma área com 6m de raio. Criaturas dentro da área recebem camuflagem leve por escuridão leve. As sombras não podem ser iluminadas por nenhuma fonte de luz natural. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a escuridão, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Escuridão anula Luz.",tipo:"Óleo",icone:"🌑",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowbolt.jpg",system:{alcance:"toque",alvo:"1 alvo",resistencia:"Vontade anula (veja texto)",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 193"}},{nome:"Óleo de Luz",preco:"T$ 30",efeito:"",descricao:"O alvo emite luz (mas não produz calor) em uma área com 6m de raio. O objeto pode ser guardado (em um bolso, por exemplo) para interromper a luz, que voltará a funcionar caso o objeto seja revelado. Se lançar a magia num objeto de uma criatura involuntária, ela tem direito a um teste de Vontade para anulá-la. Luz anula Escuridão.",tipo:"Óleo",icone:"💡",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_flashheal.jpg",system:{alcance:"curto",alvo:"1 objeto",resistencia:"Vontade anula (veja texto)",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 197"}},{nome:"Óleo de Tranca Arcana",preco:"T$ 30",efeito:"",descricao:"Esta magia tranca uma porta ou outro item que possa ser aberto ou fechado (como um baú, caixa etc.), aumentando a CD de testes de Força ou Ladinagem para abri-lo em +10. Você pode abrir livremente sua própria tranca sem problemas.",tipo:"Óleo",icone:"🔒",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sprint.jpg",system:{alcance:"toque",alvo:"1 objeto Grande ou menor",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 209"}},{nome:"Óleo de Vestimenta da Fé",preco:"T$ 270",efeito:"",descricao:"Você fortalece uma indumentária com o poder de sua fé. Isso aumenta o bônus de Defesa de uma armadura ou escudo em +2 (isso é uma melhoria no item, portanto é cumulativa com outras magias). No caso de um traje, ele passa a oferecer +2 na Defesa e continua contando como se você não estivesse usando armadura.",tipo:"Óleo",icone:"🛡️",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofprotection.jpg",system:{alcance:"toque",resistencia:"Nenhuma",ativacao:"action",peso:.5,espacos:.5,source:"Tormenta20 — Edição Jogo do Ano, p. 210"}}]}catch{return console.warn("Generated potions data not available, using hardcoded data"),[]}}function ue(e){const a=document.getElementById("prato-detail-modal");a&&a.remove();const o=document.getElementById("prato-detail-overlay");o&&o.remove();const t=document.createElement("div");t.id="prato-detail-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.7)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="prato-detail-modal",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ffb86c",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="500px",s.style.maxHeight="80vh",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.8)";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="flex-start",r.style.marginBottom="15px";const n=document.createElement("div");if(n.style.display="flex",n.style.alignItems="center",n.style.gap="12px",n.style.flex="1",e.iconeUrl){const a=document.createElement("div");a.style.position="relative",a.style.width="3rem",a.style.height="3rem",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.border="2px solid #ffb86c",a.style.borderRadius="8px",a.style.padding="2px",a.style.backgroundColor="#23243a";const o=ua(e.iconeUrl,e.nome,e.icone||"🍲",{width:"100%",height:"100%",borderRadius:"6px",objectFit:"cover",showSkeleton:!0});a.appendChild(o),n.appendChild(a)}const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="4px";const c=document.createElement("div");c.textContent=e.nome,c.style.color="#ffb86c",c.style.fontSize="18px",c.style.fontWeight="bold",i.appendChild(c);const d=document.createElement("div");d.textContent=`Raridade: ${e.raridade||"Comum"}`,d.style.color="#6ec6ff",d.style.fontSize="14px",i.appendChild(d),n.appendChild(i),r.appendChild(n);const l=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove(),t.remove()}});r.appendChild(l.render()),s.appendChild(r);const m=document.createElement("div");m.style.marginBottom="15px";const u=document.createElement("h3");u.textContent="Descrição",u.style.color="#6ec6ff",u.style.fontSize="16px",u.style.margin="0 0 8px 0",m.appendChild(u);const p=document.createElement("p");p.textContent=e.descricao,p.style.color="#ecf0f1",p.style.fontSize="14px",p.style.margin="0",p.style.lineHeight="1.4",m.appendChild(p),s.appendChild(m);const g=document.createElement("div");g.style.marginBottom="15px";const f=document.createElement("h3");f.textContent="Benefício",f.style.color="#6ec6ff",f.style.fontSize="16px",f.style.margin="0 0 8px 0",g.appendChild(f);const v=document.createElement("p");v.textContent=e.bonus,v.style.color="#ffb86c",v.style.fontSize="14px",v.style.fontWeight="bold",v.style.margin="0",g.appendChild(v),s.appendChild(g);const y=document.createElement("div");y.style.marginBottom="15px";const b=document.createElement("h3");b.textContent="Duração do Efeito",b.style.color="#6ec6ff",b.style.fontSize="16px",b.style.margin="0 0 8px 0",y.appendChild(b);const h=document.createElement("p");let x="1 dia (24 horas)";"Batata Valkariana"===e.nome&&(x="Até o bônus ser aplicado (consumível)"),h.textContent=x,h.style.color="#27ae60",h.style.fontSize="14px",h.style.fontWeight="bold",h.style.margin="0",h.style.padding="8px 12px",h.style.background="#1a1a2e",h.style.border="1px solid #27ae60",h.style.borderRadius="6px",y.appendChild(h),s.appendChild(y);const C=document.createElement("div");C.style.marginBottom="20px";const w=document.createElement("h3");w.textContent="Informações de Culinária",w.style.color="#6ec6ff",w.style.fontSize="16px",w.style.margin="0 0 8px 0",C.appendChild(w);const q=document.createElement("div");q.style.display="grid",q.style.gridTemplateColumns="1fr 1fr",q.style.gap="10px",[{label:"Preço",value:e.preco,color:"#ffb86c"},{label:"CD do Teste",value:e.cdTeste,color:"#ffb86c"},{label:"Ingredientes",value:e.ingredientes,color:"#ecf0f1"},{label:"Custo dos Ingredientes",value:e.custoIngredientes,color:"#ecf0f1"}].forEach(e=>{const a=document.createElement("div");a.style.background="#23243a",a.style.padding="8px 10px",a.style.borderRadius="6px",a.style.border="1px solid #444";const o=document.createElement("div");o.textContent=e.label,o.style.color="#888",o.style.fontSize="12px",o.style.marginBottom="2px",a.appendChild(o);const t=document.createElement("div");t.textContent=e.value,t.style.color=e.color,t.style.fontSize="13px",t.style.fontWeight="bold",a.appendChild(t),q.appendChild(a)}),C.appendChild(q),s.appendChild(C);const E=document.createElement("div");E.style.display="flex",E.style.gap="10px",E.style.marginTop="20px";const z=document.createElement("button");z.textContent="Compartilhar",z.style.flex="1",z.style.padding="10px 15px",z.style.background="#2c3e50",z.style.border="1px solid #34495e",z.style.borderRadius="6px",z.style.color="#ecf0f1",z.style.cursor="pointer",z.style.fontSize="14px",z.onclick=()=>{Z(`&{template:t20-info}{{infoname=${e.nome}}}{{description=${e.descricao} ${e.bonus}}}`),A(`Prato "${e.nome}" compartilhado no chat!`),Ce()},E.appendChild(z);const S=document.createElement("button");S.textContent="Consumir Prato",S.style.flex="1",S.style.padding="10px 15px",S.style.background="#27ae60",S.style.border="1px solid #2ecc71",S.style.borderRadius="6px",S.style.color="#ecf0f1",S.style.cursor="pointer",S.style.fontSize="14px",S.onclick=()=>{const a="prato_"+e.nome.toLowerCase().replace(/[^a-z0-9]+/g,"_"),o={name:e.nome,description:e.descricao+" "+e.bonus,type:"Comida",effectKey:a};let t=Je();if(t.includes(a))_(`Prato "${e.nome}" já está ativo nos efeitos!`);else{let s=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]");s=s.filter(e=>e.effectKey!==a),s.push(o),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(s)),t.push(a),ia(a,"food"),A(`Prato "${e.nome}" consumido! Efeito ativo por 1 dia (24 horas).`),Ge(t),Ye(),pa(),Z(`/em ${$()} consumiu **${e.nome}** ${e.icone||"🍽️"}`)}Ce()},E.appendChild(S),s.appendChild(E),document.body.appendChild(s)}function pe(e){const a=document.getElementById("bebida-detail-modal");a&&a.remove();const o=document.getElementById("bebida-detail-overlay");o&&o.remove();const t=document.createElement("div");t.id="bebida-detail-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.7)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="bebida-detail-modal",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ffb86c",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="500px",s.style.maxHeight="80vh",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.8)";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="flex-start",r.style.marginBottom="15px";const n=document.createElement("div");if(n.style.display="flex",n.style.alignItems="center",n.style.gap="12px",n.style.flex="1",e.iconeUrl){const a=document.createElement("div");a.style.position="relative",a.style.width="3rem",a.style.height="3rem",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.border="2px solid #ffb86c",a.style.borderRadius="8px",a.style.padding="2px",a.style.backgroundColor="#23243a";const o=ua(e.iconeUrl,e.nome,e.icone||"🍺",{width:"100%",height:"100%",borderRadius:"6px",objectFit:"cover",showSkeleton:!0});a.appendChild(o),n.appendChild(a)}const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="4px";const c=document.createElement("div");c.textContent=e.nome,c.style.color="#ffb86c",c.style.fontSize="18px",c.style.fontWeight="bold",i.appendChild(c);const d=document.createElement("div");d.textContent=`Tipo: ${e.tipo}`,d.style.color="#6ec6ff",d.style.fontSize="14px",i.appendChild(d),n.appendChild(i),r.appendChild(n);const l=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove(),t.remove()}});r.appendChild(l.render()),s.appendChild(r);const m=document.createElement("div");m.style.marginBottom="15px";const u=document.createElement("h3");u.textContent="Descrição",u.style.color="#6ec6ff",u.style.fontSize="16px",u.style.margin="0 0 8px 0",m.appendChild(u);const p=document.createElement("p");p.textContent=e.descricao,p.style.color="#ecf0f1",p.style.fontSize="14px",p.style.margin="0",p.style.lineHeight="1.4",m.appendChild(p),s.appendChild(m);const g=document.createElement("div");g.style.marginBottom="15px";const f=document.createElement("h3");f.textContent="Efeito",f.style.color="#6ec6ff",f.style.fontSize="16px",f.style.margin="0 0 8px 0",g.appendChild(f);const v=document.createElement("p");v.textContent=e.efeito,v.style.color="#ffb86c",v.style.fontSize="14px",v.style.fontWeight="bold",v.style.margin="0",g.appendChild(v),s.appendChild(g);const y=document.createElement("div");y.style.marginBottom="15px";const b=document.createElement("h3");b.textContent="Duração do Efeito",b.style.color="#6ec6ff",b.style.fontSize="16px",b.style.margin="0 0 8px 0",y.appendChild(b);const h=document.createElement("p");let x="1 dia (24 horas)";"Baba de Troll"===e.nome&&(x="Até o bônus ser aplicado (consumível)"),h.textContent=x,h.style.color="#27ae60",h.style.fontSize="14px",h.style.fontWeight="bold",h.style.margin="0",h.style.padding="8px 12px",h.style.background="#1a1a2e",h.style.border="1px solid #27ae60",h.style.borderRadius="6px",y.appendChild(h),s.appendChild(y);const C=document.createElement("div");C.style.marginBottom="20px";const w=document.createElement("h3");w.textContent="Informações da Bebida",w.style.color="#6ec6ff",w.style.fontSize="16px",w.style.margin="0 0 8px 0",C.appendChild(w);const q=document.createElement("div");q.style.display="grid",q.style.gridTemplateColumns="1fr 1fr",q.style.gap="10px";const E=[{label:"CD Fortitude",value:e.cd,color:"#ffb86c"}];e.observacao&&E.push({label:"Observação",value:e.observacao,color:"#ecf0f1"}),E.forEach(e=>{const a=document.createElement("div");a.style.background="#23243a",a.style.padding="8px 10px",a.style.borderRadius="6px",a.style.border="1px solid #444";const o=document.createElement("div");o.textContent=e.label,o.style.color="#888",o.style.fontSize="12px",o.style.marginBottom="2px",a.appendChild(o);const t=document.createElement("div");t.textContent=e.value,t.style.color=e.color,t.style.fontSize="13px",t.style.fontWeight="bold",a.appendChild(t),q.appendChild(a)}),C.appendChild(q),s.appendChild(C);const z=document.createElement("div");z.style.display="flex",z.style.gap="10px",z.style.marginTop="20px";const S=document.createElement("button");S.textContent="Compartilhar",S.style.flex="1",S.style.padding="10px 15px",S.style.background="#2c3e50",S.style.border="1px solid #34495e",S.style.borderRadius="6px",S.style.color="#ecf0f1",S.style.cursor="pointer",S.style.fontSize="14px",S.onclick=()=>{Z(`&{template:t20-info}{{infoname=${e.nome}}}{{description=${e.descricao} ${e.efeito}}}`),A(`Bebida "${e.nome}" compartilhada no chat!`),Ce()},z.appendChild(S);const k=document.createElement("button");k.textContent="Consumir Bebida",k.style.flex="1",k.style.padding="10px 15px",k.style.background="#27ae60",k.style.border="1px solid #2ecc71",k.style.borderRadius="6px",k.style.color="#ecf0f1",k.style.cursor="pointer",k.style.fontSize="14px",k.onclick=()=>{const a="bebida_"+e.nome.toLowerCase().replace(/[^a-z0-9]+/g,"_"),o={name:e.nome,description:e.descricao+" "+e.efeito,type:"Bebida",effectKey:a};let t=Je();if(t.includes(a))_(`Bebida "${e.nome}" já está ativa nos efeitos!`);else{let s=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]");s=s.filter(e=>e.effectKey!==a),s.push(o),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(s)),t.push(a),ia(a,"drink");let r=`Bebida "${e.nome}" consumida! Efeito ativo por 1 dia (24 horas).`;"Baba de Troll"===e.nome&&(r=`Bebida "${e.nome}" consumida! Bônus disponível para uso.`),A(r),Ge(t),Ye(),pa(),Z(`/em ${$()} consumiu **${e.nome}** ${e.icone||"🍺"}`)}Ce()},z.appendChild(k),s.appendChild(z),document.body.appendChild(s)}function ge(e){const a=document.getElementById("pocao-detail-modal");a&&a.remove();const o=document.getElementById("pocao-detail-overlay");o&&o.remove();const t=document.createElement("div");t.id="pocao-detail-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.7)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="pocao-detail-modal",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ffb86c",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="600px",s.style.maxHeight="85vh",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.8)";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="flex-start",r.style.marginBottom="20px";const n=document.createElement("div");if(n.style.display="flex",n.style.alignItems="center",n.style.gap="12px",n.style.flex="1",e.iconeUrl){const a=document.createElement("div");a.style.position="relative",a.style.width="3rem",a.style.height="3rem",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.border="2px solid #ffb86c",a.style.borderRadius="8px",a.style.padding="2px",a.style.backgroundColor="#23243a";const o=ua(e.iconeUrl,e.nome,e.icone||"🧪",{width:"100%",height:"100%",borderRadius:"6px",objectFit:"cover",showSkeleton:!0});a.appendChild(o),n.appendChild(a)}const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="4px";const c=document.createElement("div");c.textContent=e.nome,c.style.color="#ffb86c",c.style.fontSize="18px",c.style.fontWeight="bold",i.appendChild(c);const d=document.createElement("div");d.textContent=`Tipo: ${e.tipo}`,d.style.color="#6ec6ff",d.style.fontSize="14px",i.appendChild(d),n.appendChild(i),r.appendChild(n);const l=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove(),t.remove()}});r.appendChild(l.render()),s.appendChild(r);const m=document.createElement("div");m.style.display="flex",m.style.flexWrap="wrap",m.style.gap="8px",m.style.marginBottom="20px";const u=(e,a,o)=>{const t=document.createElement("div");return t.textContent=e,t.style.padding="4px 8px",t.style.borderRadius="12px",t.style.fontSize="12px",t.style.fontWeight="bold",t.style.color=a,t.style.backgroundColor=o,t.style.border=`1px solid ${a}`,t};if(e.preco&&m.appendChild(u(e.preco,"#ffb86c","rgba(255,184,108,0.1)")),e.system?.alcance&&m.appendChild(u(`Alcance: ${e.system.alcance}`,"#6ec6ff","rgba(110,198,255,0.1)")),e.system?.alvo&&m.appendChild(u(`Alvo: ${e.system.alvo}`,"#a78bfa","rgba(167,139,250,0.1)")),e.system?.duracao&&m.appendChild(u(`Duração: ${e.system.duracao}`,"#27ae60","rgba(39,174,96,0.1)")),e.system?.resistencia&&"Nenhuma"!==e.system.resistencia&&m.appendChild(u(`Resistência: ${e.system.resistencia}`,"#e74c3c","rgba(231,76,60,0.1)")),e.system?.ativacao&&m.appendChild(u(`Ativação: ${e.system.ativacao}`,"#f39c12","rgba(243,156,18,0.1)")),s.appendChild(m),e.efeito){const a=document.createElement("div");a.style.marginBottom="20px",a.style.padding="15px",a.style.background="rgba(255,184,108,0.05)",a.style.border="1px solid rgba(255,184,108,0.2)",a.style.borderRadius="8px";const o=document.createElement("h3");o.textContent="🎯 Efeito Principal",o.style.color="#ffb86c",o.style.fontSize="16px",o.style.margin="0 0 10px 0",o.style.fontWeight="bold",a.appendChild(o);const t=document.createElement("div"),r=e.efeito.split("\n\n").map(e=>`<p>${e.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<em>$1</em>")}</p>`).join("");t.innerHTML=r,t.style.color="#ecf0f1",t.style.fontSize="15px",t.style.fontWeight="bold",t.style.lineHeight="1.4",t.querySelectorAll("p").forEach(e=>{e.style.margin="0 0 8px 0",e.style.padding="0"}),a.appendChild(t),s.appendChild(a)}if(e.descricao){const a=document.createElement("div");a.style.marginBottom="20px";const o=document.createElement("h3");o.textContent="📖 Descrição",o.style.color="#6ec6ff",o.style.fontSize="16px",o.style.margin="0 0 10px 0",o.style.fontWeight="bold",a.appendChild(o);const t=document.createElement("div"),r=e.descricao.split("\n\n").map(e=>`<p>${e.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<em>$1</em>")}</p>`).join("");t.innerHTML=r,t.style.color="#ecf0f1",t.style.fontSize="14px",t.style.lineHeight="1.5",t.querySelectorAll("p").forEach(e=>{e.style.margin="0 0 8px 0",e.style.padding="0"}),a.appendChild(t),s.appendChild(a)}const p=[];if(e.system?.peso&&p.push({label:"Peso",value:`${e.system.peso} kg`}),e.system?.espacos&&p.push({label:"Espaços",value:e.system.espacos}),e.system?.source&&p.push({label:"Fonte",value:e.system.source}),p.length>0){const e=document.createElement("div");e.style.marginBottom="20px";const a=document.createElement("h3");a.textContent="⚙️ Informações Técnicas",a.style.color="#6ec6ff",a.style.fontSize="16px",a.style.margin="0 0 10px 0",a.style.fontWeight="bold",e.appendChild(a);const o=document.createElement("div");o.style.display="grid",o.style.gridTemplateColumns="repeat(auto-fit, minmax(150px, 1fr))",o.style.gap="10px",p.forEach(e=>{const a=document.createElement("div");a.style.background="#23243a",a.style.padding="8px 12px",a.style.borderRadius="6px",a.style.border="1px solid #444";const t=document.createElement("div");t.textContent=e.label,t.style.color="#888",t.style.fontSize="12px",t.style.marginBottom="2px",a.appendChild(t);const s=document.createElement("div");s.textContent=e.value,s.style.color="#ecf0f1",s.style.fontSize="13px",s.style.fontWeight="bold",a.appendChild(s),o.appendChild(a)}),e.appendChild(o),s.appendChild(e)}const g=document.createElement("div");g.style.display="flex",g.style.gap="10px",g.style.marginTop="20px";const f=document.createElement("button");f.textContent="📤 Compartilhar",f.style.flex="1",f.style.padding="12px 15px",f.style.background="#2c3e50",f.style.border="1px solid #34495e",f.style.borderRadius="6px",f.style.color="#ecf0f1",f.style.cursor="pointer",f.style.fontSize="14px",f.style.fontWeight="bold",f.onclick=()=>{Z(`&{template:t20-info}{{infoname=${e.nome}}}{{description=${e.descricao} ${e.efeito}}}`),A(`Poção "${e.nome}" compartilhada no chat!`),Ce()},g.appendChild(f);const v=document.createElement("button");v.textContent="🧪 Usar Poção",v.style.flex="1",v.style.padding="12px 15px",v.style.background="#27ae60",v.style.border="1px solid #2ecc71",v.style.borderRadius="6px",v.style.color="#ecf0f1",v.style.cursor="pointer",v.style.fontSize="14px",v.style.fontWeight="bold",v.onclick=()=>{const a="pocao_"+e.nome.toLowerCase().replace(/[^a-z0-9]+/g,"_"),o={name:e.nome,description:e.descricao+" "+e.efeito,type:"Poção",effectKey:a};let t=Je();if(t.includes(a))_(`Poção "${e.nome}" já está ativa nos efeitos!`);else{let s=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]");s=s.filter(e=>e.effectKey!==a),s.push(o),localStorage.setItem("tormenta-20-hotbars-pocao-effects",JSON.stringify(s)),t.push(a),ia(a,"potion"),A(`Poção "${e.nome}" usada! Efeito ativo por cena.`),Ge(t),Ye(),pa(),Z(`/em ${$()} usou **${e.nome}** ${e.icone||"🧪"}`)}Ce()},g.appendChild(v),s.appendChild(g),document.body.appendChild(s)}function fe(e,a=25){if(!e)return"";const o=e.trim().split(/\s+/);return o.length<=a?e:o.slice(0,a).join(" ")+"..."}function ve(e,a,o){const t="food"===a?"food":"drink"===a?"drink":"potion"===a?"potion":"condition";let s=fe(e.descricao),r=null;if("potion"===a){const a=[];e.preco&&a.push({text:e.preco,color:"#ffb86c"}),e.system?.alcance&&a.push({text:`Alcance: ${e.system.alcance}`,color:"#6ec6ff"}),e.system?.duracao&&a.push({text:`Duração: ${e.system.duracao}`,color:"#27ae60"}),e.system?.resistencia&&"Nenhuma"!==e.system.resistencia&&a.push({text:`Resistência: ${e.system.resistencia}`,color:"#e74c3c"}),a.length>0&&(r=a)}var n,i,c;return window.Roll20Components.createFavoritableCardWithPreset(t,{title:e.nome,summary:s,bonus:"food"===a?e.bonus:void 0,efeito:"drink"===a||"potion"===a?e.efeito:void 0,efeitos:"condition"===a?e.efeitos:void 0,additionalInfo:r,isFavorite:"food"===a?(c=e.nome,ce().includes(c)):"drink"===a?(i=e.nome,de().includes(i)):"potion"===a&&(n=e.nome,le().includes(n)),onClick:()=>{"food"===a?ue(e):"drink"===a?pe(e):"potion"===a&&ge(e)},onFavoriteToggle:()=>{"food"===a?function(e){let a=ce();const o=a.indexOf(e);o>-1?(a.splice(o,1),_(`Prato "${e}" removido dos favoritos.`)):(a.push(e),A(`Prato "${e}" adicionado aos favoritos!`)),function(e){localStorage.setItem("tormenta-20-hotbars-pratos-favoritos",JSON.stringify(e))}(a)}(e.nome):"drink"===a?function(e){let a=de();const o=a.indexOf(e);o>-1?(a.splice(o,1),_(`Bebida "${e}" removida dos favoritos.`)):(a.push(e),A(`Bebida "${e}" adicionada aos favoritos!`)),function(e){localStorage.setItem("tormenta-20-hotbars-bebidas-favoritas",JSON.stringify(e))}(a)}(e.nome):"potion"===a&&function(e){let a=le();const o=a.indexOf(e);o>-1?(a.splice(o,1),_(`Poção "${e}" removida dos favoritos.`)):(a.push(e),A(`Poção "${e}" adicionada aos favoritos!`)),function(e){localStorage.setItem("tormenta-20-hotbars-pocoes-favoritas",JSON.stringify(e))}(a)}(e.nome),o&&o()}}).render()}function ye(e,a,o="blue"){const t={blue:"#6ec6ff",orange:"#ffb86c",purple:"#9c27b0",green:"#4caf50",red:"#ff6b6b",brown:"#8B4513"},s=t[o]||t.blue,r=document.createElement("div");return r.style.textAlign="center",r.style.padding="20px",r.style.color="#999",r.style.fontSize="14px",r.style.fontStyle="italic",r.innerHTML=`\n                <div style="margin-bottom: 8px;">🔍</div>\n                <div>Nenhum ${a} encontrado para "<strong style="color: ${s};">${e}</strong>"</div>\n                <div style="margin-top: 8px; font-size: 12px;">Tente um termo diferente ou limpe o filtro</div>\n            `,r}function be(){try{const e=new(window.AudioContext||window.webkitAudioContext),a=e.createOscillator(),o=e.createGain();a.connect(o),o.connect(e.destination),a.frequency.setValueAtTime(800,e.currentTime),a.type="sine",o.gain.setValueAtTime(.3,e.currentTime),o.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),a.start(e.currentTime),a.stop(e.currentTime+.5)}catch(e){g.log("Erro ao tocar som de fallback:",e)}}function he(e){Z("/fx splatter-blood @{target|token_id}"),setTimeout(()=>{Z(e),setTimeout(()=>{!function(){try{const e=new Audio("https://wow.zamimg.com/sound-ids/live/enus/107/567915/m2hSwordHitFlesh1c.ogg");e.volume=.6,e.preload="auto",e.play()}catch(e){g.log("Erro ao criar áudio de ataque:",e),be()}}()},100)},200)}const xe={Acrobacia:{descricao:"Você consegue fazer proezas acrobáticas.",usos:[{titulo:"Amortecer Queda",descricao:"Reduz o dano de queda (reação). Reduz 1d6 + 1d6 por 5 pontos acima da CD. Se reduzir a 0, cai de pé.",cd:"CD 15, Apenas Treinado"},{titulo:"Equilíbrio",descricao:"Andar sobre superfícies precárias (CD 10 a 20). Pode avançar total com –5. Se sofrer dano, deve fazer novo teste ou cai.",cd:"CD 10 para piso escorregadio, CD 15 para superfície estreita, CD 20 para superfície muito estreita"},{titulo:"Escapar",descricao:"Fugir de amarras (corda, rede, algemas; CD 20 a 30). Ação completa.",cd:"CD 20 para redes, CD 30 para algemas"},{titulo:"Levantar-se Rapidamente",descricao:"Levanta como ação livre com sucesso. Se falhar, gasta a ação e continua caído.",cd:"CD 20, Apenas Treinado"},{titulo:"Passar por Espaço Apertado",descricao:"Ação completa. Move-se por espaços para criaturas uma categoria menor.",cd:"CD 25, Apenas Treinado"},{titulo:"Passar por Inimigo",descricao:"Teste oposto (Acrobacia/Iniciativa/Luta). Se vencer, atravessa espaço ocupado (terreno difícil).",cd:"Teste oposto"}]},Adestramento:{descricao:"Você sabe lidar com animais.",usos:[{titulo:"Acalmar Animal",descricao:"Ação completa. Acalma um animal nervoso/agressivo.",cd:"CD 25"},{titulo:"Manejar Animal",descricao:"Faz um animal executar tarefa treinada. Também usado como Pilotagem para veículos de tração animal. Ação de movimento.",cd:"CD 15"}]},Atletismo:{descricao:"Você pode realizar façanhas atléticas.",usos:[{titulo:"Corrida",descricao:"Ação completa. Move 1,5m por ponto no teste. Modificador ±2 por cada 1,5m de deslocamento acima/abaixo de 9m. Pode correr por (1 + Constituição) rodadas. Depois, teste de Fortitude por rodada (CD crescente) ou fica fatigado.",cd:"CD baseada na distância"},{titulo:"Escalar",descricao:"Ação de movimento. CD 10 (apoios), 15 (árvore), 20 (ruína), 25 (muro liso). Falha por 5+ = queda. Pode sofrer –5 para avançar total. Se sofrer dano ou aliado cair próximo, novo teste.",cd:"CD 10 para superfícies com apoios, CD 15 para árvore, CD 20 para muro com reentrâncias, CD 25 para muro liso"},{titulo:"Natação",descricao:"Ação de movimento. CD 10 (calma), 15 (agitada), 20+ (tempestuosa). Falha por 5+ = afunda. Pode fazer segundo teste com nova ação de movimento.",cd:"CD 10 para água calma, CD 15 para agitada, CD 20 ou mais para tempestuosa"},{titulo:"Saltar",descricao:"Longo (CD 5 por 1,5m) ou altura (CD 15 por 1,5m). Sem impulso (6m), +10 na CD. Parte do movimento.",cd:"CD 5 por 1,5m para salto longo, CD 15 por 1,5m para salto em altura"}]},"Atuação":{descricao:"Você sabe fazer apresentações artísticas, como música, dança ou teatro.",usos:[{titulo:"Apresentação",descricao:"Teste para ganhar dinheiro (T$ 1d6 + 1d6 por 5 pontos acima). Leva um dia. Lugar propício (festival) dobra valor; inadequado (rua) reduz pela metade.",cd:"CD 20"},{titulo:"Impressão",descricao:"Teste oposto contra Vontade. Sucesso = +2 em Carisma contra o alvo. Falha = –2. Não pode repetir no mesmo dia. Se múltiplos alvos, o mestre faz teste único.",cd:"Teste oposto contra Vontade"}]},Cavalgar:{descricao:"Você sabe conduzir animais de montaria (como cavalos, trobos e grifos).",usos:[{titulo:"Conduzir",descricao:"Teste para obstáculos. CD 15 (ruins), 25 (perigosos). Falha = queda e 1d6 dano.",cd:"CD 15 para obstáculos ruins, CD 25 para perigosos"},{titulo:"Galopar",descricao:"Ação completa. Move 1,5m por ponto no teste. Modificador ±2 por cada 1,5m além/aquém de 9m.",cd:"CD baseada na distância"},{titulo:"Montar Rapidamente",descricao:"Monta ou desmonta como ação livre. Falha por 5+ = cai. Nota: sem sela = –5 no teste.",cd:"CD 20"}]},Conhecimento:{descricao:"Você estudou diversos campos do saber, como aritmética, astronomia, dialética, geografia, história.",usos:[{titulo:"Idiomas",descricao:"Você pode entender idiomas desconhecidos. Se falhar por 5 ou mais, você tira uma conclusão falsa. Idiomas exóticos ou muito antigos têm CD 30.",cd:"CD 20, idiomas exóticos CD 30"},{titulo:"Informação",descricao:"Você responde dúvidas gerais. Questões simples, como o ano de fundação de um reino, não exigem testes. Questões complexas, como saber o antídoto de um veneno, tem CD 20. Por fim, mistérios e enigmas, como a origem de uma antiga maldição, tem CD 30.",cd:"CD 20 para questões complexas, CD 30 para mistérios"}]},Cura:{descricao:"Você sabe tratar ferimentos, doenças e venenos.",usos:[{titulo:"Cuidados Prolongados",descricao:"Você trata uma pessoa para que ela se recupere mais rapidamente. Se passar, ela aumenta sua recuperação de PV em +1 por nível nesse dia. Este uso leva uma hora e o número máximo de pessoas que você pode cuidar é igual ao seu nível.",cd:"CD 15, Apenas Treinado"},{titulo:"Necropsia",descricao:"Você examina um cadáver para determinar a causa e o momento aproximado da morte. Causas raras ou extraordinárias, como um veneno ou maldição, possuem CD 30. Este uso leva dez minutos.",cd:"CD 20, Apenas Treinado. Causas raras CD 30"},{titulo:"Primeiros Socorros",descricao:"Você estabiliza um personagem adjacente que esteja sangrando. Este uso gasta uma ação padrão.",cd:"CD 15"},{titulo:"Tratamento",descricao:"Você ajuda a vítima de uma doença ou veneno com efeito contínuo. Gaste uma ação completa e faça um teste de Cura contra a CD da doença ou veneno. Se você passar, o paciente recebe +5 em seu próximo teste de Fortitude contra esse efeito. Esta perícia exige uma maleta de medicamentos. Sem ela, você sofre –5 no teste. Você pode usar a perícia Cura em si mesmo, mas sofre –5 no teste.",cd:"CD da doença ou veneno, Apenas Treinado"}]},Diplomacia:{descricao:"Você convence pessoas com lábia e argumentação. Usos de Diplomacia são efeitos mentais.",usos:[{titulo:"Barganha",descricao:"Comprando ou vendendo algo, você pode barganhar. Seu teste de Diplomacia é oposto pelo teste de Vontade do negociante. Se passar, você muda o preço em 10% a seu favor. Se passar por 10 ou mais, muda em 20%. Se falhar por 5 ou mais, você ofende o negociante — ele não voltará a tratar com você durante pelo menos uma semana.",cd:"Teste oposto contra Vontade"},{titulo:"Mudar Atitude",descricao:"Você muda a categoria de atitude de um NPC em relação a você ou a outra pessoa. Faça um teste de Diplomacia oposto pelo teste de Vontade do alvo. Se você passar, muda a atitude dele em uma categoria para cima ou para baixo, à sua escolha (ou, se passar por 10 ou mais, em duas categorias). Se falhar por 5 ou mais, a atitude do alvo muda uma categoria na direção oposta.",cd:"Teste oposto contra Vontade"},{titulo:"Persuasão",descricao:"Você convence uma pessoa a fazer algo, como responder uma pergunta ou prestar um favor. Se essa coisa for custosa você sofre –5 em seu teste. Se for perigosa você sofre –10 ou falha automaticamente.",cd:"CD 20"}]},"Enganação":{descricao:"Você manipula pessoas com blefes e trapaças.",usos:[{titulo:"Disfarce",descricao:"Você muda sua aparência ou a de outra pessoa. Faça um teste de Enganação oposto pelo teste de Percepção de quem prestar atenção no disfarçado. Se você passar, a pessoa acredita no disfarce; caso contrário, percebe que há algo errado. Disfarces muito complexos (como uma raça diferente) impõem –5 no seu teste.",cd:"Teste oposto contra Percepção"},{titulo:"Falsificação",descricao:"Você falsifica um documento. Faça um teste de Enganação oposto pelo teste de Percepção de quem examinar o documento. Se você passar, a pessoa acredita na falsificação; caso contrário, percebe que é falso. Se o documento é muito complexo, ou inclui uma assinatura ou carimbo específico, você sofre –10 no teste.",cd:"Teste oposto contra Percepção"},{titulo:"Fintar",descricao:"Você pode gastar uma ação padrão e fazer um teste de Enganação oposto a um teste de Reflexos de um ser em alcance curto. Se você passar, ele fica desprevenido contra seu próximo ataque, se realizado até o fim de seu próximo turno.",cd:"Teste oposto contra Reflexos"},{titulo:"Insinuação",descricao:"Você fala algo para alguém sem que outras pessoas entendam do que você está falando. Se você passar, o receptor entende sua mensagem. Se você falhar por 5 ou mais, ele entende algo diferente do que você queria.",cd:"CD 20"},{titulo:"Intriga",descricao:"Você espalha uma fofoca. Por exemplo, pode dizer que o dono da taverna está aguando a cerveja, para enfurecer o povo contra ele. Intrigas muito improváveis têm CD 30.",cd:"CD 20, intrigas improváveis CD 30"},{titulo:"Mentir",descricao:"Você faz uma pessoa acreditar em algo que não é verdade. Seu teste é oposto pelo teste de Intuição da vítima. Mentiras muito implausíveis impõem uma penalidade de –10 em seu teste.",cd:"Teste oposto contra Intuição"}]},Fortitude:{descricao:"Você usa esta perícia para resistir a efeitos que exigem vitalidade, como doenças e venenos. A CD é determinada pelo efeito. Você também usa Fortitude para manter seu fôlego quando está correndo ou sem respirar. A CD é 15 +1 por teste anterior.",usos:[{titulo:"Resistir Veneno",descricao:"Para resistir aos efeitos de venenos.",cd:"CD igual ao veneno"},{titulo:"Resistir Doença",descricao:"Para resistir aos efeitos de doenças.",cd:"CD 15 para doenças leves, CD 20+ para doenças graves"},{titulo:"Resistir Fadiga",descricao:"Para resistir à fadiga extrema ou condições adversas.",cd:"CD 15 para condições normais, CD 20+ para condições extremas"}]},Furtividade:{descricao:"Você sabe ser discreto e sorrateiro.",usos:[{titulo:"Esconder-se",descricao:"Faça um teste de Furtividade oposto pelos testes de Percepção de qualquer um que possa notá-lo. Todos que falharem não conseguem percebê-lo (você tem camuflagem total contra eles). Esconder-se é uma ação livre que você só pode fazer no final do seu turno.",cd:"Teste oposto contra Percepção"},{titulo:"Seguir",descricao:"Faça um teste de Furtividade oposto ao teste de Percepção da pessoa sendo seguida. Você sofre –5 se estiver em um lugar sem esconderijos ou sem movimento, como uma descampado ou rua deserta.",cd:"Teste oposto contra Percepção"}]},Guerra:{descricao:"Você foi educado em tática, estratégia e logística.",usos:[{titulo:"Analisar Terreno",descricao:"Como uma ação de movimento, você pode observar o campo de batalha. Se passar, descobre uma vantagem, como cobertura, camuflagem ou terreno elevado, se houver.",cd:"CD 20"},{titulo:"Plano de Ação",descricao:"Como uma ação padrão, você orienta um aliado em alcance médio. Se passar, fornece +5 na Iniciativa dele. Se ele ficar com uma Iniciativa maior do que a sua e ainda não tiver agido nesta rodada, age imediatamente após seu turno.",cd:"CD 20"}]},Iniciativa:{descricao:"Esta perícia determina sua velocidade de reação em situações de perigo. Quando uma cena de ação começa, cada personagem envolvido faz um teste de Iniciativa. Eles então agem em ordem decrescente dos resultados.",usos:[{titulo:"Ordem de Combate",descricao:"Para determinar quem age primeiro em combate.",cd:"Teste oposto contra outros combatentes"}]},"Intimidação":{descricao:"Você pode assustar ou coagir outras pessoas. Usos de Intimidação são efeitos de medo.",usos:[{titulo:"Assustar",descricao:"Gaste uma ação padrão e faça um teste de Intimidação oposto pelo teste de Vontade de uma criatura em alcance curto. Se você passar, ela fica abalada pelo resto da cena. Se você passar por 10 ou mais, ela fica apavorada por uma rodada e então abalada pelo resto da cena.",cd:"Teste oposto contra Vontade"},{titulo:"Coagir",descricao:"Faça um teste de Intimidação oposto pelo teste de Vontade de uma criatura inteligente (Int –3 ou maior) adjacente. Se você passar, ela obedece uma ordem sua (como fazer uma pequena tarefa, deixar que você passe por um lugar que ela estava protegendo...). Se você mandá-la fazer algo perigoso ou que vá contra a natureza dela, ela recebe +5 no teste ou passa automaticamente.",cd:"Teste oposto contra Vontade"}]},"Intuição":{descricao:'Esta perícia mede sua empatia e "sexto sentido".',usos:[{titulo:"Perceber Mentira",descricao:"Você descobre se alguém está mentindo (veja a perícia Enganação).",cd:"Teste oposto contra Enganação"},{titulo:"Pressentimento",descricao:"Você analisa uma pessoa, para ter uma noção de sua índole ou caráter, ou uma situação, para saber se há algo anormal (por exemplo, se os habitantes de uma vila estão agindo de forma estranha). Este uso apenas indica se há algo anormal, mas não revela a causa.",cd:"CD 20, Apenas Treinado"}]},"Investigação":{descricao:"Você sabe encontrar pistas e informações.",usos:[{titulo:"Interrogar",descricao:'Você descobre informações perguntando ou indo para um lugar movimentado e mantendo os ouvidos atentos. Informações gerais ("Quem é o guerreiro mais forte da aldeia?") não exigem teste. Informações restritas, que poucas pessoas conhecem ("Quem é o ancião que está sempre ao lado do rei?"), têm CD 20. Informações confidenciais ou que podem colocar em risco quem falar sobre elas ("Quem é o líder da guilda dos ladrões?"), têm CD 30. Este uso gasta uma hora e T$ 3d6 (para comprar bebidas, subornar oficiais etc.), mas esses valores podem variar de acordo com o mestre.',cd:"CD 20 para informações restritas, CD 30 para informações confidenciais"},{titulo:"Procurar",descricao:"Você examina um local em busca de algo. A CD varia: 15 para um item ou no meio de uma bagunça, mas não necessariamente escondido; 20 para um item escondido (cofre atrás de um quadro, documento no fundo falso de uma gaveta); 30 para um item muito bem escondido (passagem secreta ativada por um botão, documento escrito com tinta invisível). Este uso gasta desde uma ação completa (examinar uma escrivaninha) até um dia (pesquisar uma biblioteca).",cd:"CD 15 para item em bagunça, CD 20 para item escondido, CD 30 para item muito bem escondido"}]},Jogatina:{descricao:"Você sabe jogar jogos de azar.",usos:[{titulo:"Apostar",descricao:"Para resolver uma noite de jogatina, pague T$ 1d10, faça um teste de perícia e consulte a tabela para determinar quanto você ganha. O mestre pode variar o valor da aposta básica. De T$ 1d3, para uma taverna no porto frequentada por marujos e estivadores, a 1d10 x T$ 1.000, para um cassino de luxo em Valkaria.",cd:"CD variável conforme o jogo",tabela:{titulo:"Tabela de Lucros da Jogatina",linhas:[{teste:"9 ou menos",ganho:"Nenhum."},{teste:"10 a 14",ganho:"Metade da aposta."},{teste:"15 a 19",ganho:'Valor da aposta (você "empata").'},{teste:"20 a 29",ganho:"Dobro da aposta."},{teste:"30 a 39",ganho:"Triplo da aposta."},{teste:"40 ou mais",ganho:"Quíntuplo da aposta."}]}}]},Ladinagem:{descricao:"Você sabe exercer atividades ilícitas.",usos:[{titulo:"Abrir Fechadura",descricao:"Você abre uma fechadura trancada. A CD é 20 para fechaduras simples (porta de loja), 25 para fechaduras médias (prisão, baú) e 30 para fechaduras superiores (cofre, câmara do tesouro). Este uso exige uma ação completa e uma gazua. Sem ela, você sofre –5 em seu teste.",cd:"CD 20 para fechaduras simples, CD 25 para médias, CD 30 para superiores"},{titulo:"Ocultar",descricao:"Você esconde um objeto em você mesmo. Gaste uma ação padrão e faça um teste de Ladinagem oposto pelo teste de Percepção de qualquer um que possa vê-lo. Objetos discretos ou pequenos fornecem +5 no teste; objetos desajeitados ou grandes impõem –5.",cd:"Teste oposto contra Percepção"},{titulo:"Punga",descricao:"Você pega um objeto de outra pessoa (ou planta um objeto nas posses dela). Gaste uma ação padrão e faça um teste de Ladinagem. Se passar, você pega (ou coloca) o que queria. A vítima tem direito a um teste de Percepção (CD igual ao resultado de seu teste de Ladinagem).",cd:"CD 20"},{titulo:"Sabotar",descricao:"Você desabilita um dispositivo mecânico. Uma ação simples (emperrar uma fechadura, desativar uma armadilha básica, sabotar uma roda de carroça para que quebre 1d4 rodadas após o uso) tem CD 20. Uma ação complexa (desativar uma armadilha avançada, sabotar um canhão para explodir quando utilizado) tem CD 30.",cd:"CD 20 para ações simples, CD 30 para ações complexas"}]},Luta:{descricao:"Você usa Luta para fazer ataques corpo a corpo. A CD é a Defesa do alvo. Se você acertar, causa dano de acordo com a arma utilizada. Veja o Capítulo 5: Jogando para as regras completas de combate.",usos:[{titulo:"Ataque Corpo a Corpo",descricao:"Para atacar com armas brancas ou desarmado.",cd:"CD igual à Defesa do oponente"}]},Misticismo:{descricao:"Esta perícia envolve o conhecimento de magias, itens mágicos e fenômenos sobrenaturais.",usos:[{titulo:"Detectar Magia",descricao:"Como uma ação completa, você detecta a presença e intensidade de auras mágicas em alcance curto (mas não suas localizações exatas). A intensidade de uma aura depende do círculo da magia ou categoria do item mágico que a gerou.",cd:"CD 15"},{titulo:"Identificar Criatura",descricao:"Você analisa uma criatura mágica (construto, dragão, fada, morto-vivo etc.) que possa ver. Se passar, lembra uma característica da criatura, como um poder ou vulnerabilidade. Para cada 5 pontos pelos quais o resultado do teste superar a CD, você lembra outra característica.",cd:"CD 15 + ND da Criatura"},{titulo:"Identificar Item Mágico",descricao:"Você estuda um item mágico para identificar seus poderes. A CD é 20 para itens mágicos menores, 25 para médios e 30 para itens mágicos maiores. Este uso gasta uma hora.",cd:"CD 20 para itens menores, CD 25 para médios, CD 30 para maiores"},{titulo:"Identificar Magia",descricao:"Quando alguém lança uma magia, você pode adivinhar qual é através de seus gestos e palavras. Este uso é uma reação.",cd:"CD 15 + Custo em PM da Magia"},{titulo:"Informação",descricao:"Você responde dúvidas relativas a magias, itens mágicos, fenômenos sobrenaturais, runas, profecias, planos de existência etc. Questões simples não exigem teste. Questões complexas tem CD 20. Por fim, mistérios e enigmas tem CD 30.",cd:"CD 20 para questões complexas, CD 30 para mistérios"},{titulo:"Lançar Magia de Armadura",descricao:"Lançar uma magia arcana usando armadura exige um teste. Esse teste sofre penalidade de armadura. Se falhar, a magia não funciona, mas gasta pontos de mana mesmo assim.",cd:"CD 20 + Custo em PM da Magia"}]},Nobreza:{descricao:"Você recebeu a educação de um nobre.",usos:[{titulo:"Etiqueta",descricao:"Você sabe se portar em ambientes aristocráticos, como bailes e audiências.",cd:"CD 15"},{titulo:"Informação",descricao:"Você responde dúvidas relativas a leis, tradições, linhagens e heráldica. Questões simples não exigem teste. Questões complexas tem CD 20. Por fim, mistérios e enigmas tem CD 30.",cd:"CD 20 para questões complexas, CD 30 para mistérios"}]},"Ofício":{descricao:"Ofício na verdade são várias perícias diferentes. Cada uma permite fabricar itens de certas categorias: Armeiro (armas e armaduras), Artesão (equipamento de aventura, ferramentas, esotéricos e veículos), Alquimista (alquímicos), Cozinheiro (alimentação), Alfaiate (vestuário).",usos:[{titulo:"Consertar",descricao:"Reparar um item destruído tem a mesma CD para fabricá-lo. Cada tentativa consome uma hora de trabalho e um décimo do preço original do item. Em caso de falha, o tempo e o dinheiro são perdidos (mas você pode tentar novamente).",cd:"CD igual à fabricação"},{titulo:"Fabricar",descricao:"Você produz um item gastando matéria-prima e tempo de trabalho. A matéria-prima custa um terço do preço do item. O tempo de trabalho depende do tipo de item: um dia para consumíveis, uma semana para não consumíveis comuns e um mês para não consumíveis superiores e/ou mágicos.",cd:"CD 15 para itens simples, CD 20 para itens complexos"},{titulo:"Identificar",descricao:"Você pode identificar itens raros e exóticos ligados ao seu Ofício. Se passar, descobre as propriedades do item e seu preço. Este uso gasta uma ação completa.",cd:"CD 20"},{titulo:"Sustento",descricao:"Com uma semana de trabalho e um teste de Ofício, você ganha T$ 1, mais T$ 1 por ponto que seu teste exceder a CD. Por exemplo, com um resultado 20, ganha T$ 6 pela semana de trabalho.",cd:"CD 15"}]},"Percepção":{descricao:"Você nota coisas usando seus sentidos.",usos:[{titulo:"Observar",descricao:"Você vê coisas discretas ou escondidas. A CD varia de 15, para algo difícil de ser visto (um livro específico em uma estante) a 30, para algo quase invisível (uma gota de sangue em uma folha no meio de uma floresta à noite). Para pessoas ou itens escondidos, a CD é o resultado do teste de Furtividade ou Ladinagem feito para esconder a pessoa ou o item. Você também pode ler lábios (CD 20).",cd:"CD 15 para algo difícil de ver, CD 20 para item escondido, CD 30 para algo quase invisível"},{titulo:"Ouvir",descricao:"Você escuta barulhos sutis. Uma conversa casual próxima tem CD 0 — ou seja, a menos que exista alguma penalidade, você passa automaticamente. Ouvir pessoas sussurrando tem CD 15. Ouvir do outro lado de uma porta aumenta a CD em +10. Você pode fazer testes de Percepção para ouvir mesmo que esteja dormindo, mas sofre –10 no teste; um sucesso faz você acordar.",cd:"CD 0 para conversa casual, CD 15 para sussurros, CD 20 para criaturas invisíveis"}]},Pilotagem:{descricao:"Você sabe operar veículos como carroças, barcos e balões. Ações simples não exigem testes — você pode atrelhar seus trobos a sua carroça e conduzi-la pela estrada, ou levantar âncora e velejar seu navio em águas tranquilas, automaticamente.",usos:[{titulo:"Conduzir em Situações Difíceis",descricao:"Conduzir um veículo em situações ruins (terreno acidentado para veículos terrestres, chuva ou ventania para veículos aquáticos ou aéreos, ou aéreos) exige uma ação de movimento e um teste de Pilotagem contra CD 15 por turno ou cena, de acordo com o mestre. Se falhar, você avança metade do deslocamento. Se falhar por 5 ou mais, se acidenta de alguma forma. Situações extremas (terreno com obstáculos, tempestade...) aumentam a CD para 25.",cd:"CD 15 para situações ruins, CD 25 para situações extremas"}]},Pontaria:{descricao:"Você usa Pontaria para fazer ataques à distância. A CD é a Defesa do alvo. Se você acertar, causa dano de acordo com a arma utilizada. Veja o Capítulo 5: Jogando para as regras completas de ataque.",usos:[{titulo:"Ataque à Distância",descricao:"Para atacar com armas de longo alcance.",cd:"CD igual à Defesa do oponente"}]},Reflexos:{descricao:"Você usa esta perícia para resistir a efeitos que exigem reação rápida, como armadilhas e explosões. A CD é determinada pelo efeito. Você também usa Reflexos para evitar fintas.",usos:[{titulo:"Esquivar",descricao:"Para se esquivar de ataques ou perigos.",cd:"CD igual ao ataque ou perigo"},{titulo:"Reação Rápida",descricao:"Para reagir rapidamente a situações inesperadas.",cd:"CD 15 para reações normais, CD 20+ para reações complexas"},{titulo:"Agarrar",descricao:"Para agarrar objetos em queda ou em movimento.",cd:"CD 15 para objetos lentos, CD 20+ para objetos rápidos"}]},"Religião":{descricao:"Você possui conhecimento sobre os deuses e as religiões de Arton.",usos:[{titulo:"Identificar Criatura",descricao:"Você pode identificar uma criatura com origem divina (anjos, demônios, alguns mortos-vivos e construtos etc.). Veja a perícia Misticismo.",cd:"CD 15 + ND da Criatura"},{titulo:"Identificar Item Mágico",descricao:"Você pode identificar um item mágico de origem divina. Veja a perícia Misticismo.",cd:"CD 20 para itens menores, CD 25 para médios, CD 30 para maiores"},{titulo:"Informação",descricao:"Você responde dúvidas relativas a deuses, profecias, planos de existência etc. Questões simples não exigem teste. Questões complexas tem CD 20. Por fim, mistérios e enigmas tem CD 30.",cd:"CD 20 para questões complexas, CD 30 para mistérios"},{titulo:"Rito",descricao:"Você realiza uma cerimônia religiosa, como um batizado, casamento ou funeral. Isso inclui a cerimônia de penitência para redimir um devoto que tenha descumprido as Obrigações & Restrições de sua divindade. Uma cerimônia de penitência exige um sacrifício de T$ 100 por nível de personagem do devoto ou a realização de uma missão sagrada, de acordo com o mestre.",cd:"CD 20"}]},"Sobrevivência":{descricao:"Você está em casa nos ermos.",usos:[{titulo:"Acampamento",descricao:"Você consegue abrigo e alimento para você e seu grupo por um dia (caçando, pescando, colhendo frutos...). A CD depende do terreno: 15 para planícies e colinas, 20 para florestas e pântanos, 25 para desertos ou montanhas e 30 para regiões planares perigosas ou áreas de Tormenta. Regiões muito áridas ou estéreis e clima ruim (neve, tempestade etc.) impõem penalidade cumulativa de –5. Dormir ao relento sem um acampamento e um saco de dormir diminui sua recuperação de PV e PM. Este uso exige equipamento de viagem. Sem ele, você sofre –5 em seu teste.",cd:"CD 15 para planícies e colinas, CD 20 para florestas e pântanos, CD 25 para desertos ou montanhas, CD 30 para regiões planares perigosas"},{titulo:"Identificar Criatura",descricao:"Você pode identificar um animal ou monstro. Veja a perícia Misticismo.",cd:"CD 15 + ND da Criatura"},{titulo:"Orientar-se",descricao:'Um personagem viajando pelos ermos precisa fazer um teste de Sobrevivência por dia para avançar. A CD depende do tipo de terreno (veja em "Acampamento"). Se passar, você avança seu deslocamento normal. Se falhar, avança apenas metade. Se falhar por 5 ou mais, se perde e não avança pelo dia. Num grupo, um personagem deve ser escolhido como guia. Personagens treinados em Sobrevivência podem ajudá-lo. Entretanto, se mais de um personagem quiser fazer o teste por si só, todos deverão rolar em segredo. Os jogadores devem decidir qual guia seguir antes de verem o resultado! Este teste é exigido apenas em jornadas perigosas (de acordo com o mestre).',cd:"CD 15 para planícies e colinas, CD 20 para florestas e pântanos, CD 25 para desertos ou montanhas, CD 30 para regiões planares perigosas"},{titulo:"Rastrear",descricao:"Você pode identificar e seguir rastros. A CD é 15 para solo macio (neve, lama), 20 para solo comum (grama, terra) e 25 para solo duro (rocha ou piso de interiores). A CD diminui em –5 se você estiver rastreando um grupo grande (dez ou mais indivíduos) ou criaturas Enormes ou Colossais, mas aumenta em +5 em visibilidade precária (noite, chuva, neblina...). Enquanto rastreia, seu deslocamento é reduzido à metade. Se falhar, pode tentar novamente gastando mais um dia. Porém, a cada dia desde a criação dos rastros, a CD aumenta em +1.",cd:"CD 15 para solo macio, CD 20 para solo comum, CD 25 para solo duro, Apenas Treinado"}]},Vontade:{descricao:"Você usa esta perícia para resistir a efeitos que exigem determinação, como intimidação e encantamentos. A CD é determinada pelo efeito. Testes de Vontade são testes de resistência.",usos:[{titulo:"Resistir Encantamento",descricao:"Para resistir a magias de encantamento.",cd:"CD igual à magia"},{titulo:"Resistir Ilusão",descricao:"Para resistir a magias de ilusão.",cd:"CD igual à magia"},{titulo:"Resistir Medo",descricao:"Para resistir a efeitos de medo ou terror.",cd:"CD 15 para medo simples, CD 20+ para terror extremo"}]}};function Ce(){["conditions-popup","conditions-overlay","condition-details-popup","condition-details-overlay","avatar-popup","avatar-overlay","skills-popup","skills-overlay","skill-detail-modal","skill-detail-overlay","misc-popup","misc-overlay","grimorio-popup","grimorio-overlay","spells-popup","spells-overlay","spell-cast-popup","spell-cast-overlay","pratos-popup","pratos-overlay","prato-detail-modal","prato-detail-overlay","bebidas-popup","bebidas-overlay","bebida-detail-modal","bebida-detail-overlay","pocoes-popup","pocoes-overlay","pocao-detail-modal","pocao-detail-overlay","config-modal","config-overlay","maneuvers-popup","maneuvers-overlay","attack-effects-popup","attack-effects-overlay","hunter-class-overlay","race-detail-overlay","divinity-detail-overlay","animal-companion-overlay","abilities-popup","abilities-overlay","power-cast-popup","power-cast-overlay"].forEach(e=>{const a=document.getElementById(e);a&&a.remove()}),document.querySelectorAll('[style*="z-index: 1000"], [style*="z-index: 10000"], [style*="z-index: 10001"], [style*="z-index: 10002"], [style*="z-index: 10003"]').forEach(e=>{"fixed"!==e.style.position||"rgba(0,0,0,0.5)"!==e.style.background&&"rgba(0,0,0,0.7)"!==e.style.background&&!e.style.background.includes("rgba(30,30,40")||e.remove()})}function we(e){const a=xe[e];if(!a)return void g.log("Dados da skill não encontrados:",e);const o=document.getElementById("skill-detail-modal");o&&o.remove();const t=document.getElementById("skill-detail-overlay");t&&t.remove();const s=document.createElement("div");s.id="skill-detail-overlay",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.background="rgba(0,0,0,0.5)",s.style.zIndex="10002",s.onclick=()=>{s.remove(),r.remove()},document.body.appendChild(s);const r=document.createElement("div");r.id="skill-detail-modal",r.className="roll20-modal",r.style.position="fixed",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.background="rgba(30,30,40,0.98)",r.style.border="2px solid #6ec6ff",r.style.borderRadius="12px",r.style.padding="20px",r.style.zIndex="10003",r.style.maxWidth="600px",r.style.maxHeight="80vh",r.style.overflowY="auto",r.style.overflowX="hidden",r.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="stretch",r.style.wordWrap="break-word",r.style.wordBreak="break-word";const n=document.createElement("div");n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.marginBottom="15px",n.style.width="100%";const i=document.createElement("h2");i.textContent=e,i.style.color="#6ec6ff",i.style.margin="0",i.style.fontSize="20px",i.style.fontWeight="bold";const c=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{r.remove();const e=document.getElementById("skill-detail-overlay");e&&e.remove()}});n.appendChild(i),n.appendChild(c.render()),r.appendChild(n);const d=document.createElement("div");d.style.marginBottom="20px",d.style.padding="15px",d.style.background="rgba(110, 198, 255, 0.1)",d.style.borderRadius="8px",d.style.border="1px solid rgba(110, 198, 255, 0.3)",d.style.color="#ecf0f1",d.style.fontSize="14px",d.style.lineHeight="1.5",d.style.wordWrap="break-word",d.style.wordBreak="break-word",d.style.overflowWrap="break-word",d.textContent=a.descricao,r.appendChild(d);const l=document.createElement("div");l.style.marginBottom="20px";const m=document.createElement("h3");m.textContent="Usos da Perícia: Selecione uma especialização",m.style.color="#6ec6ff",m.style.margin="0 0 15px 0",m.style.fontSize="16px",m.style.fontWeight="bold",l.appendChild(m),a.usos.forEach(e=>{const a=document.createElement("div");a.style.marginBottom="15px",a.style.padding="12px",a.style.background="rgba(26,26,46,0.8)",a.style.borderRadius="8px",a.style.border="1px solid rgba(110,198,255,0.2)",a.style.cursor="pointer",a.style.transition="all 0.2s",a.style.position="relative",a.style.wordWrap="break-word",a.style.wordBreak="break-word",a.style.overflowWrap="break-word";const o=document.createElement("h4");o.textContent=e.titulo,o.style.color="#6ec6ff",o.style.margin="0 0 8px 0",o.style.fontSize="14px",o.style.fontWeight="bold",a.appendChild(o);const t=document.createElement("p");t.textContent=e.descricao,t.style.color="#ecf0f1",t.style.margin="0 0 8px 0",t.style.fontSize="13px",t.style.lineHeight="1.4",t.style.wordWrap="break-word",t.style.wordBreak="break-word",t.style.overflowWrap="break-word",a.appendChild(t);const s=document.createElement("p");if(s.textContent=`Dificuldade: ${e.cd}`,s.style.color="#ffd700",s.style.margin="0",s.style.fontSize="12px",s.style.fontWeight="bold",a.appendChild(s),e.tabela){const o=document.createElement("div");o.style.marginTop="10px",o.style.padding="8px",o.style.background="rgba(255, 215, 0, 0.1)",o.style.borderRadius="6px",o.style.border="1px solid rgba(255, 215, 0, 0.3)";const t=document.createElement("h5");t.textContent=e.tabela.titulo,t.style.color="#ffd700",t.style.margin="0 0 8px 0",t.style.fontSize="12px",t.style.fontWeight="bold",o.appendChild(t);const s=document.createElement("table");s.style.width="100%",s.style.borderCollapse="collapse",s.style.fontSize="11px";const r=document.createElement("thead"),n=document.createElement("tr"),i=document.createElement("th");i.textContent="Teste",i.style.padding="4px 6px",i.style.border="1px solid rgba(255, 215, 0, 0.3)",i.style.backgroundColor="rgba(255, 215, 0, 0.2)",i.style.color="#ffd700",i.style.fontWeight="bold",i.style.textAlign="left";const c=document.createElement("th");c.textContent="Ganho",c.style.padding="4px 6px",c.style.border="1px solid rgba(255, 215, 0, 0.3)",c.style.backgroundColor="rgba(255, 215, 0, 0.2)",c.style.color="#ffd700",c.style.fontWeight="bold",c.style.textAlign="left",n.appendChild(i),n.appendChild(c),r.appendChild(n),s.appendChild(r);const d=document.createElement("tbody");e.tabela.linhas.forEach(e=>{const a=document.createElement("tr"),o=document.createElement("td");o.textContent=e.teste,o.style.padding="4px 6px",o.style.border="1px solid rgba(255, 215, 0, 0.2)",o.style.color="#ecf0f1";const t=document.createElement("td");t.textContent=e.ganho,t.style.padding="4px 6px",t.style.border="1px solid rgba(255, 215, 0, 0.2)",t.style.color="#ecf0f1",a.appendChild(o),a.appendChild(t),d.appendChild(a)}),s.appendChild(d),o.appendChild(s),a.appendChild(o)}a.onmouseover=()=>{a.style.background="rgba(110,198,255,0.1)",a.style.border="1px solid #6ec6ff"},a.onmouseout=()=>{u!==e.titulo&&(a.style.background="rgba(26,26,46,0.8)",a.style.border="1px solid rgba(110,198,255,0.2)")},a.onclick=()=>{l.querySelectorAll('div[style*="cursor: pointer"]').forEach(e=>{e.style.background="rgba(26,26,46,0.8)",e.style.border="1px solid rgba(110,198,255,0.2)"}),D(),u=e.titulo,a.style.background="rgba(110,198,255,0.2)",a.style.border="2px solid #6ec6ff",D()},l.appendChild(a)});let u=null;const p=document.createElement("div");p.style.marginBottom="20px";const f=document.createElement("button");f.textContent="Fazer Rolagem",f.style.background="#6ec6ff",f.style.color="#23243a",f.style.border="none",f.style.borderRadius="8px",f.style.padding="12px 20px",f.style.fontSize="14px",f.style.fontWeight="bold",f.style.cursor="pointer",f.style.transition="all 0.2s",f.style.marginTop="10px",f.style.width="100%",f.disabled=!0,f.style.opacity="0.5",f.style.cursor="not-allowed",f.onmouseover=()=>{f.disabled||(f.style.background="#5bb5e6")},f.onmouseout=()=>{f.disabled||(f.style.background="#6ec6ff")};const v=document.createElement("div");v.style.marginBottom="20px",v.style.padding="15px",v.style.background="rgba(255, 184, 108, 0.1)",v.style.borderRadius="8px",v.style.border="1px solid rgba(255, 184, 108, 0.3)";const y=document.createElement("h3");y.textContent="Bônus Disponíveis para esta Rolagem",y.style.color="#ffb86c",y.style.margin="0 0 15px 0",y.style.fontSize="16px",y.style.fontWeight="bold",v.appendChild(y);const b=Qe("prato_batata_valkariana"),h=Qe("prato_bolo_de_cenoura"),x=Qe("prato_estrogonofe"),C=Qe("prato_futomaki"),w=Qe("prato_pao_de_queijo"),q=Qe("prato_porco_assado"),E=Qe("prato_salada_elfica"),z=Qe("prato_salada_imperial"),k=Qe("prato_sopa_de_cogumelo"),j=Qe("prato_pizza"),P=Qe("prato_cozido_de_pimenta"),_=Qe("bebida_baba_de_troll"),$=Qe("bebida_cerveja_deheoni"),T=Qe("bebida_sidra_ahleniense");function D(){const e=null!==u,a=Array.from(v.querySelectorAll('input[type="checkbox"]')).some(e=>e.checked);e||a?(f.disabled=!1,f.style.opacity="1",f.style.cursor="pointer"):(f.disabled=!0,f.style.opacity="0.5",f.style.cursor="not-allowed")}function M(e,a,o,t){if(!t)return null;const s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.gap="10px",s.style.marginBottom="10px";const r=document.createElement("input");r.type="checkbox",r.id=e,r.style.width="16px",r.style.height="16px",r.addEventListener("change",D);const n=document.createElement("label");n.htmlFor=e,n.textContent=a,n.style.color="#ecf0f1",n.style.fontSize="14px",n.style.fontWeight="bold",n.style.cursor="pointer";const i=document.createElement("span");return i.textContent=` - ${o}`,i.style.color="#ffb86c",i.style.fontSize="12px",i.style.fontStyle="italic",n.appendChild(i),s.appendChild(r),s.appendChild(n),s}let R=!1;if(b){const e=M("batata-valkariana-bonus","Batata Valkariana (+1d6 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(h&&"Percepção"===e){const e=M("bolo-cenoura-bonus","Bolo de Cenoura (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(x&&"Vontade"===e){const e=M("estrogonofe-bonus","Estrogonofe (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(C&&"Diplomacia"===e){const e=M("futomaki-bonus","Futomaki (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(w&&"Fortitude"===e){const e=M("pao-queijo-bonus","Pão de Queijo (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(q&&"Luta"===e){const e=M("porco-assado-bonus","Porco Assado (+1 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(E&&"Pontaria"===e){const e=M("salada-elfica-bonus","Salada Elfica (+1 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(z&&"Iniciativa"===e){const e=M("salada-imperial-bonus","Salada Imperial (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(k&&"Misticismo"===e){const e=M("sopa-cogumelo-bonus","Sopa de Cogumelo (+2 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(j&&("Vontade"===e||"Reflexos"===e||"Fortitude"===e)){const e=M("pizza-bonus","Pizza (+1 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(P&&"Fortitude"===e){const e=M("cozido-de-pimenta-bonus","Cozido de Pimenta (+1 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if(_){const e=M("baba-de-troll-bonus","Baba de Troll (+1d4 no teste)","Consome o efeito após a rolagem",!0);v.appendChild(e),R=!0}if($&&("Fortitude"===e||"Vontade"===e||"Reflexos"===e)){const e=M("cerveja-deheoni-bonus","Cerveja Deheoni (+1 no teste de resistência)","Efeito ativo por 24 horas",!0);e&&(v.appendChild(e),R=!0)}if(T&&("Adestramento"===e||"Atuação"===e||"Diplomacia"===e||"Enganação"===e||"Intimidação"===e||"Jogatina"===e)){const e=M("sidra-ahleniense-bonus","Sidra Ahleniense (+2 no teste de Carisma)","Efeito ativo por 24 horas",!0);e&&(v.appendChild(e),R=!0)}if(!R){const e=document.createElement("div");e.textContent="Nenhum bônus disponível para esta rolagem.",e.style.color="#999",e.style.fontSize="14px",e.style.fontStyle="italic",e.style.textAlign="center",e.style.padding="10px",v.appendChild(e)}r.appendChild(l),r.appendChild(v),r.appendChild(p),r.appendChild(f),f.onclick=()=>{const a=null!==u,o=Array.from(v.querySelectorAll('input[type="checkbox"]')).some(e=>e.checked);if(!a&&!o)return;const t=document.getElementById("batata-valkariana-bonus")&&document.getElementById("batata-valkariana-bonus").checked,s=document.getElementById("bolo-cenoura-bonus")&&document.getElementById("bolo-cenoura-bonus").checked,r=document.getElementById("estrogonofe-bonus")&&document.getElementById("estrogonofe-bonus").checked,n=document.getElementById("futomaki-bonus")&&document.getElementById("futomaki-bonus").checked,i=document.getElementById("pao-queijo-bonus")&&document.getElementById("pao-queijo-bonus").checked,c=document.getElementById("porco-assado-bonus")&&document.getElementById("porco-assado-bonus").checked,d=document.getElementById("salada-elfica-bonus")&&document.getElementById("salada-elfica-bonus").checked,l=document.getElementById("salada-imperial-bonus")&&document.getElementById("salada-imperial-bonus").checked,m=document.getElementById("sopa-cogumelo-bonus")&&document.getElementById("sopa-cogumelo-bonus").checked,p=document.getElementById("pizza-bonus")&&document.getElementById("pizza-bonus").checked,g=document.getElementById("cozido-de-pimenta-bonus")&&document.getElementById("cozido-de-pimenta-bonus").checked,f=a?`${e} - ${u}`:`${e} (Teste Puro)`,y=[{nome:"Acrobacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|acrobaciatotal}]]]]}}`},{nome:"Adestramento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|adestramentototal}]]]]}}`},{nome:"Atletismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|atletismototal}]]]]}}`},{nome:"Atuação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|atuacaototal}]]]]}}`},{nome:"Cavalgar",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|cavalgartotal}]]]]}}`},{nome:"Conhecimento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|conhecimentototal}]]]]}}`},{nome:"Cura",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|curatotal}]]]]}}`},{nome:"Diplomacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|diplomaciatotal}]]]]}}`},{nome:"Enganação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|enganacaototal}]]]]}}`},{nome:"Fortitude",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|fortitudetotal}]]]]}}`},{nome:"Furtividade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|furtividadetotal}]]]]}}`},{nome:"Guerra",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|guerratotal}]]]]}}`},{nome:"Iniciativa",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|iniciativatotal}]] &{tracker}]]}}`},{nome:"Intimidação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|intimidacaototal}]]]]}}`},{nome:"Intuição",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|intuicaototal}]]]]}}`},{nome:"Investigação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|investigacaototal}]]]]}}`},{nome:"Jogatina",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|jogatinatotal}]]]]}}`},{nome:"Ladinagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|ladinagemtotal}]]]]}}`},{nome:"Luta",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`},{nome:"Misticismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|misticismototal}]]]]}}`},{nome:"Nobreza",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|nobrezatotal}]]]]}}`},{nome:"Ofício",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|oficiototal}]]]]}}`},{nome:"Percepção",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|percepcaototal}]]]]}}`},{nome:"Pilotagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|pilotagemtotal}]]]]}}`},{nome:"Pontaria",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|pontariatotal}]]]]}}`},{nome:"Reflexos",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|reflexostotal}]]]]}}`},{nome:"Religião",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|religiaototal}]]]]}}`},{nome:"Sobrevivência",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|sobrevivenciatotal}]]]]}}`},{nome:"Vontade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=${f}}}{{theroll=[[1d20+[[@{${I()}|vontadetotal}]]]]}}`}].find(a=>a.nome===e);if(y){let e=y.comando,a=0,o="",u="";t&&(o+="+1d6",u+="%NEWLINE% *+ Batata Valkariana (+1d6)*"),s&&(a+=2,u+="%NEWLINE% *+ Bolo de Cenoura (+2)*"),r&&(a+=2,u+="%NEWLINE% *+ Estrogonofe (+2)*"),n&&(a+=2,u+="%NEWLINE% *+ Futomaki (+2)*"),i&&(a+=2,u+="%NEWLINE% *+ Pão de Queijo (+2)*"),c&&(a+=1,u+="%NEWLINE% *+ Porco Assado (+1)*"),d&&(a+=1,u+="%NEWLINE% *+ Salada Elfica (+1)*"),l&&(a+=2,u+="%NEWLINE% *+ Salada Imperial (+2)*"),m&&(a+=2,u+="%NEWLINE% *+ Sopa de Cogumelo (+2)*"),p&&(a+=1,u+="%NEWLINE% *+ Pizza (+1)*"),g&&(a+=1,u+="%NEWLINE% *+ Cozido de Pimenta (+1)*");const f=document.getElementById("baba-de-troll-bonus")&&document.getElementById("baba-de-troll-bonus").checked,v=document.getElementById("cerveja-deheoni-bonus")&&document.getElementById("cerveja-deheoni-bonus").checked,b=document.getElementById("sidra-ahleniense-bonus")&&document.getElementById("sidra-ahleniense-bonus").checked;f&&(o+="+1d4",u+="%NEWLINE% *+ Baba de Troll (+1d4)*"),v&&(a+=1,u+="%NEWLINE% *+ Cerveja Deheoni (+1)*"),b&&(a+=2,u+="%NEWLINE% *+ Sidra Ahleniense (+2)*"),0===a&&""===o||(e=""!==o?e.replace(/theroll=\[\[1d20\+\[\[(.*?)\]\]\]\]/,`theroll=[[1d20${o}+[[$1]]${0!==a?`+${a}`:""}]]`):e.replace(/theroll=\[\[(.*?)\]\]/,`theroll=[[$1+${a}]]`),e=e.replace(/(\{\{rollname=)(.*?)(\}\})/,`$1$2${u}$3`)),Z(e),setTimeout(()=>{if(t){Ke("prato_batata_valkariana");let e=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]");e=e.filter(e=>"prato_batata_valkariana"!==e.effectKey),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(e)),A("🍟 Efeito da Batata Valkariana consumido no teste!")}if(s&&A("🥕 Bônus do Bolo de Cenoura aplicado no teste!"),r&&A("🍝 Bônus do Estrogonofe aplicado no teste!"),n&&A("🍣 Bônus do Futomaki aplicado no teste!"),i&&A("🧀 Bônus do Pão de Queijo aplicado no teste!"),c&&A("🐷 Bônus do Porco Assado aplicado no teste!"),d&&A("🥗 Bônus da Salada Elfica aplicado no teste!"),l&&A("🥗 Bônus da Salada Imperial aplicado no teste!"),m&&A("🍄 Bônus da Sopa de Cogumelo aplicado no teste!"),p&&A("🍕 Bônus da Pizza aplicado no teste!"),g&&A("🌶️ Bônus do Cozido de Pimenta aplicado no teste!"),f){Ke("bebida_baba_de_troll");let e=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]");e=e.filter(e=>"bebida_baba_de_troll"!==e.effectKey),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(e)),A("🧃 Efeito da Baba de Troll consumido no teste!")}v&&A("🍻 Bônus da Cerveja Deheoni aplicado no teste!"),b&&A("🍏 Bônus da Sidra Ahleniense aplicado no teste!")},500),function(){const e=document.getElementById("skills-popup");e&&e.remove();const a=document.getElementById("skills-overlay");a&&a.remove();const o=document.getElementById("skill-detail-modal");o&&o.remove();const t=document.getElementById("skill-detail-overlay");t&&t.remove()}()}},document.body.appendChild(r),S(r,"blue")}function qe(){const e=document.createElement("div");e.id="roll20-hotbar",e.className="roll20-scrollbar-auto",e.style.position="fixed",e.style.bottom="24px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.background="rgba(30,30,40,0.92)",e.style.padding="0",e.style.borderRadius="16px",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.boxShadow="0 4px 16px rgba(0,0,0,0.5)",e.style.userSelect="none",e.style.border="2px solid #6ec6ff",e.style.minWidth="600px",e.style.alignItems="stretch";const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.padding="18px 24px 5px 24px",a.style.borderBottom="1px solid rgba(110,198,255,0.2)",a.style.cursor="grab",a.style.position="relative",a.style.width="100%",a.style.boxSizing="border-box";const o=document.createElement("div");o.style.position="absolute",o.style.left="24px",o.style.top="50%",o.style.transform="translateY(-50%)",o.style.cursor="pointer",o.style.display="flex",o.style.alignItems="center",o.style.gap="5px",o.style.fontSize="12px",o.style.color="#ecf0f1",o.style.userSelect="none";const t=document.createElement("span");t.id="ttm-toggle-label",t.textContent="TTM",t.style.fontSize="10px",t.style.fontWeight="bold";const r=document.createElement("div");r.id="ttm-toggle-switch",r.style.width="24px",r.style.height="12px",r.style.background="#444",r.style.borderRadius="6px",r.style.position="relative",r.style.transition="all 0.3s",r.style.border="1px solid #666";const n=document.createElement("div");n.id="ttm-toggle-knob",n.style.width="8px",n.style.height="8px",n.style.background="#fff",n.style.borderRadius="50%",n.style.position="absolute",n.style.top="1px",n.style.left="1px",n.style.transition="all 0.3s",r.appendChild(n),o.appendChild(t),o.appendChild(r),v(),o.onclick=e=>{e.stopPropagation(),Z("/talktomyself"),setTimeout(()=>{v()},100)},a.appendChild(o);const i=document.createElement("span");i.textContent="Hotbar",i.style.color="#ecf0f1",i.style.fontSize="14px",i.style.fontWeight="bold",i.style.cursor="grab",i.style.textAlign="center",i.style.display="flex",i.style.alignItems="center",i.style.lineHeight="1",a.appendChild(i);const c=document.createElement("div");c.style.position="absolute",c.style.right="85px",c.style.top="50%",c.style.transform="translateY(-50%)",c.style.cursor="default",c.style.display="flex",c.style.alignItems="center",c.style.gap="4px",c.style.fontSize="10px",c.style.color="#6ec6ff",c.style.userSelect="none",c.style.background="rgba(110,198,255,0.1)",c.style.padding="4px 8px",c.style.borderRadius="8px",c.style.border="1px solid rgba(110,198,255,0.3)",c.style.fontWeight="bold",c.style.transition="all 0.2s ease",c.style.cursor="pointer",c.style.marginRight="10px",c.onmouseover=()=>{c.style.background="rgba(110,198,255,0.2)",c.style.borderColor="rgba(110,198,255,0.6)",c.style.transform="translateY(-50%) scale(1.05)"},c.onmouseout=()=>{c.style.background="rgba(110,198,255,0.1)",c.style.borderColor="rgba(110,198,255,0.3)",c.style.transform="translateY(-50%) scale(1)"};const d=document.createElement("span");d.textContent="🏷️",d.style.fontSize="10px";const l=document.createElement("span");l.textContent="v0.0.1",l.style.fontSize="10px",l.id="hotbar-version-text",c.appendChild(d),c.appendChild(l),c.title="Versão atual do script: 0.3.1.8744\nClique para copiar a versão",c.onclick=e=>{e.stopPropagation();const a="0.3.1.8744";navigator.clipboard.writeText(a).then(()=>{j(`Versão ${a} copiada para a área de transferência!`,"success",2e3)}).catch(()=>{j("Erro ao copiar versão","error",2e3)})};const m=document.createElement("div");m.style.position="absolute",m.style.right="24px",m.style.top="50%",m.style.transform="translateY(-50%)",m.style.cursor="pointer",m.style.display="flex",m.style.alignItems="center",m.style.gap="4px",m.style.fontSize="10px",m.style.color="#ffb86c",m.style.userSelect="none",m.style.background="rgba(255,184,108,0.1)",m.style.padding="4px 8px",m.style.borderRadius="8px",m.style.border="1px solid rgba(255,184,108,0.3)",m.style.fontWeight="bold",m.style.transition="all 0.2s ease",m.onmouseover=()=>{m.style.background="rgba(255,184,108,0.2)",m.style.borderColor="rgba(255,184,108,0.6)",m.style.transform="translateY(-50%) scale(1.05)"},m.onmouseout=()=>{m.style.background="rgba(255,184,108,0.1)",m.style.borderColor="rgba(255,184,108,0.3)",m.style.transform="translateY(-50%) scale(1)"};const u=document.createElement("span");u.textContent="⚙️",u.style.fontSize="10px";const p=document.createElement("span");p.textContent="Config",p.style.fontSize="10px",m.appendChild(u),m.appendChild(p),m.title="Configurações do script\nClique para abrir as configurações",m.onclick=e=>{e.stopPropagation(),function(){const e=document.getElementById("config-modal");e&&e.remove();const a=document.getElementById("config-overlay");a&&a.remove();const o=document.createElement("div");o.id="config-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.7)",o.style.zIndex="10002",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="config-modal",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ffb86c",t.style.borderRadius="12px",t.style.padding="20px",t.style.zIndex="10003",t.style.minWidth="500px",t.style.maxWidth="700px",t.style.width="auto",t.style.maxHeight="80vh",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.8)",t.style.boxSizing="border-box";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px",r.style.paddingBottom="15px",r.style.borderBottom="1px solid rgba(255,184,108,0.3)";const n=document.createElement("h2");n.textContent="⚙️ Configurações",n.style.color="#ffb86c",n.style.margin="0",n.style.fontSize="20px",n.style.fontWeight="bold";const i=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ffb86c",onClick:()=>{o.remove(),t.remove()}});r.appendChild(n),r.appendChild(i.render());const c=document.createElement("div");c.style.color="#ecf0f1";const d=document.createElement("div");d.style.marginBottom="25px",d.style.padding="15px",d.style.background="rgba(255,184,108,0.05)",d.style.borderRadius="8px",d.style.border="1px solid rgba(255,184,108,0.2)",d.style.boxSizing="border-box",d.style.width="100%";const l=document.createElement("h3");l.textContent="📋 Informações do Script",l.style.color="#ffb86c",l.style.margin="0 0 15px 0",l.style.fontSize="16px",l.style.fontWeight="bold",d.appendChild(l),d.innerHTML+=`\n            <p style="margin: 8px 0;"><strong>Versão:</strong> 0.3.1.8744</p>\n            <p style="margin: 8px 0;"><strong>Autor:</strong> Daniel Marinho Goncalves</p>\n            <p style="margin: 8px 0;"><strong>Última atualização:</strong> ${(new Date).toLocaleDateString("pt-BR")}</p>\n        `;const m=document.createElement("div");m.style.marginBottom="25px",m.style.padding="15px",m.style.background="rgba(110,198,255,0.05)",m.style.borderRadius="8px",m.style.border="1px solid rgba(110,198,255,0.2)",m.style.boxSizing="border-box",m.style.width="100%";const u=document.createElement("h3");u.textContent="🔄 Sincronização de Dados da Ficha",u.style.color="#6ec6ff",u.style.margin="0 0 15px 0",u.style.fontSize="16px",u.style.fontWeight="bold",m.appendChild(u);const p=document.createElement("div");p.style.marginBottom="20px",p.style.padding="12px",p.style.background="rgba(255, 193, 7, 0.1)",p.style.border="1px solid rgba(255, 193, 7, 0.3)",p.style.borderRadius="6px";const g=document.createElement("h4");g.textContent="🔑 Chave de Identificação do Personagem",g.style.color="#FFC107",g.style.margin="0 0 8px 0",g.style.fontSize="14px",g.style.fontWeight="bold";const y=document.createElement("p");y.textContent="Nome do personagem como aparece na ficha do Roll20. Esta chave é essencial para que as macros @{nome_do_personagem|atributo} funcionem corretamente.",y.style.color="#ecf0f1",y.style.fontSize="12px",y.style.margin="0 0 10px 0",y.style.lineHeight="1.4";const b=document.createElement("input");b.type="text",b.id="char_identification_key",b.value=localStorage.getItem("tormenta-20-hotbars-char-identification-key")||I(),b.placeholder="Ex: Aragorn, Gandalf, etc.",b.style.width="100%",b.style.padding="10px 12px",b.style.border="2px solid rgba(255, 193, 7, 0.4)",b.style.borderRadius="6px",b.style.background="rgba(30,30,40,0.9)",b.style.color="#ecf0f1",b.style.fontSize="13px",b.style.boxSizing="border-box",b.style.fontWeight="bold",b.addEventListener("change",()=>{localStorage.setItem("tormenta-20-hotbars-char-identification-key",b.value),localStorage.setItem(s,b.value)}),p.appendChild(g),p.appendChild(y),p.appendChild(b),m.appendChild(p);const h=document.createElement("div");h.style.marginBottom="15px",h.style.padding="10px",h.style.background="rgba(110, 198, 255, 0.05)",h.style.border="1px solid rgba(110, 198, 255, 0.2)",h.style.borderRadius="6px";const x=document.createElement("p");x.textContent="Os campos abaixo são as chaves de atributo da ficha que devem ser usadas para preencher os valores das propriedades na hotbar (vida, mana, nível, etc.). Configure cada campo com o nome exato do atributo como aparece na sua ficha do Roll20.",x.style.color="#ecf0f1",x.style.fontSize="12px",x.style.margin="0",x.style.lineHeight="1.4",h.appendChild(x),m.appendChild(h);const C=[{key:"tormenta-20-hotbars-char-name-attr",label:"Nome do Personagem",defaultValue:"menace_name"},{key:"tormenta-20-hotbars-char-race-attr",label:"Raça",defaultValue:"trace"},{key:"tormenta-20-hotbars-char-class-attr",label:"Classe",defaultValue:"tlevel"},{key:"tormenta-20-hotbars-char-level-attr",label:"Nível",defaultValue:"charnivel"},{key:"tormenta-20-hotbars-char-hp-total-attr",label:"Vida Total",defaultValue:"vidatotal"},{key:"tormenta-20-hotbars-char-hp-current-attr",label:"Vida Atual",defaultValue:"vida"},{key:"tormenta-20-hotbars-char-mp-total-attr",label:"Mana Total",defaultValue:"manatotal"},{key:"tormenta-20-hotbars-char-mp-current-attr",label:"Mana Atual",defaultValue:"mana"},{key:"tormenta-20-hotbars-char-ac-attr",label:"Armadura",defaultValue:"defesatotal"}],w=document.createElement("div");w.style.marginBottom="15px",w.style.width="100%",w.style.boxSizing="border-box",C.forEach(e=>{const a=document.createElement("div");a.style.marginBottom="12px",a.style.width="100%",a.style.boxSizing="border-box";const o=document.createElement("label");o.textContent=e.label,o.style.display="block",o.style.marginBottom="5px",o.style.fontSize="14px",o.style.fontWeight="bold",o.style.color="#ecf0f1";const t=document.createElement("input");t.type="text",t.id=e.key,t.value=localStorage.getItem(e.key)||e.defaultValue,t.style.width="100%",t.style.padding="8px 12px",t.style.border="1px solid rgba(110,198,255,0.3)",t.style.borderRadius="6px",t.style.background="rgba(30,30,40,0.8)",t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.boxSizing="border-box",t.addEventListener("change",()=>{localStorage.setItem(e.key,t.value)});const s=document.createElement("div");s.id=`${e.key}_current`,s.style.fontSize="11px",s.style.color="#888",s.style.marginTop="3px",s.style.fontStyle="italic";const r=e.key.replace("tormenta-20-hotbars-char-","").replace("-attr",""),n=localStorage.getItem(`tormenta-20-hotbars-sync-${r}`);s.textContent=n?`Valor atual: ${n}`:"Nenhum valor salvo",a.appendChild(o),a.appendChild(t),a.appendChild(s),w.appendChild(a)}),m.appendChild(w);const q=document.createElement("button");q.id="sync-data-btn",q.textContent="🔄 Sincronizar Dados",q.style.width="100%",q.style.padding="12px 20px",q.style.border="1px solid #6ec6ff",q.style.borderRadius="6px",q.style.background="transparent",q.style.color="#6ec6ff",q.style.cursor="pointer",q.style.fontSize="14px",q.style.fontWeight="bold",q.style.transition="all 0.2s ease",q.style.position="relative",q.style.boxSizing="border-box",q.style.whiteSpace="nowrap",q.style.overflow="hidden",q.style.textOverflow="ellipsis",q.disabled=!1,q.style.opacity="1",q.style.cursor="pointer",q.title="Sincroniza os dados da ficha com base nos atributos configurados acima",m.appendChild(q);const E=document.createElement("div");E.style.marginBottom="15px",E.style.padding="15px",E.style.background="rgba(255,110,110,0.05)",E.style.borderRadius="8px",E.style.border="1px solid rgba(255,110,110,0.2)",E.style.boxSizing="border-box",E.style.width="100%";const z=document.createElement("h3");z.textContent="🗑️ Limpar Cache da Hotbar",z.style.color="#ff6e6e",z.style.margin="0 0 15px 0",z.style.fontSize="16px",z.style.fontWeight="bold",E.appendChild(z);const k=document.createElement("button");k.id="clear-all-data-btn",k.textContent="Limpar Dados do Hotbar",k.style.width="100%",k.style.padding="12px 20px",k.style.border="1px solid #ff6e6e",k.style.borderRadius="6px",k.style.background="transparent",k.style.color="#ff6e6e",k.style.cursor="pointer",k.style.fontSize="14px",k.style.fontWeight="bold",k.style.transition="all 0.2s ease",k.style.boxSizing="border-box",k.style.whiteSpace="nowrap",k.style.overflow="hidden",k.style.textOverflow="ellipsis",k.title="Remove apenas os dados do hotbar (cache de imagens, efeitos ativos, configurações, etc.) e recarrega a página",E.appendChild(k),c.appendChild(d),c.appendChild(m),c.appendChild(E),q.onmouseover=()=>{q.disabled||(q.style.background="rgba(110,198,255,0.1)",q.style.borderColor="#8ed4ff",q.style.color="#8ed4ff",q.style.transform="scale(1.02)")},q.onmouseout=()=>{q.disabled||(q.style.background="transparent",q.style.borderColor="#6ec6ff",q.style.color="#6ec6ff",q.style.transform="scale(1)")},k.onmouseover=()=>{k.style.background="rgba(255, 110, 110, 0.1)",k.style.borderColor="#ff8e8e",k.style.color="#ff8e8e",k.style.transform="scale(1.02)"},k.onmouseout=()=>{k.style.background="transparent",k.style.borderColor="#ff6e6e",k.style.color="#ff6e6e",k.style.transform="scale(1)"},q.onclick=async()=>{if(q.disabled)return;q.disabled=!0,q.style.opacity="0.7",q.style.cursor="not-allowed";const e=q.textContent;q.textContent="⏳ Sincronizando...";try{f()||(Z("/talktomyself"),setTimeout(()=>v(),500));const e={};C.forEach(a=>{const o=document.getElementById(a.key),t=a.key.replace("tormenta-20-hotbars-char-","").replace("-attr","");e[t]=o.value}),await ee(e),C.forEach(e=>{const a=e.key.replace("tormenta-20-hotbars-char-","").replace("-attr",""),o=localStorage.getItem(`tormenta-20-hotbars-sync-${a}`),t=document.getElementById(`${e.key}_current`);o?(t.textContent=`Valor atual: ${o}`,t.style.color="#4caf50"):(t.textContent="Nenhum valor salvo",t.style.color="#888")}),j("Sincronização concluída com sucesso!","success",3e3),M()}catch(e){console.error("Erro na sincronização:",e),j(`Erro na sincronização: ${e.message}`,"error",5e3)}finally{f()&&(Z("/talktomyself"),setTimeout(()=>v(),500)),q.disabled=!1,q.style.opacity="1",q.style.cursor="pointer",q.textContent=e}},k.onclick=()=>{confirm("Tem certeza que deseja limpar todos os dados do hotbar? Esta ação irá remover o cache de imagens, efeitos ativos, configurações e outros dados do hotbar. Esta ação não pode ser desfeita.")&&(function(){const e=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);o&&(o.startsWith("tormenta-20-hotbars-")||"char_identification_key"===o||"tormenta-20-hotbars-char-identification-key"===o||o.startsWith("char_")&&o.endsWith("_attr"))&&e.push(o)}e.forEach(e=>{localStorage.removeItem(e)}),la()}(),j("Dados do hotbar foram limpos com sucesso!","success",3e3),setTimeout(()=>{location.reload()},1e3))},t.appendChild(r),t.appendChild(c),document.body.appendChild(t),S(t,"orange")}()},a.appendChild(m),a.appendChild(c),e.appendChild(a);const y=document.createElement("div");y.style.display="flex",y.style.flexDirection="row",y.style.gap="20px",y.style.padding="14px 24px 14px 24px",y.style.alignItems="center";const b=document.createElement("div");b.textContent="CAÇADOR",b.style.color="#8B4513",b.style.fontSize="10px",b.style.fontWeight="bold",b.style.fontStyle="italic",b.style.textTransform="uppercase",b.style.letterSpacing="1px",b.style.cursor="pointer",b.style.padding="0px 4px",b.style.background="rgba(139, 69, 19, 0.2)",b.style.borderRadius="8px",b.style.border="1px solid rgba(139, 69, 19, 0.4)",b.style.transition="all 0.2s",b.style.display="flex",b.style.alignItems="center",b.style.justifyContent="center",b.style.width="20px",b.style.height="80px",b.style.position="relative",b.style.title="Clique para ver informações da classe",b.style.writingMode="vertical-rl",b.style.textOrientation="mixed",b.style.transform="rotate(180deg)",b.onmouseover=()=>{b.style.background="rgba(139, 69, 19, 0.3)",b.style.borderColor="rgba(139, 69, 19, 0.6)",b.style.transform="rotate(180deg) scale(1.05)"},b.onmouseout=()=>{b.style.background="rgba(139, 69, 19, 0.2)",b.style.borderColor="rgba(139, 69, 19, 0.4)",b.style.transform="rotate(180deg) scale(1)"},b.onclick=()=>{ze()};const x=document.createElement("div");x.style.display="flex",x.style.alignItems="center",x.style.gap="12px",x.style.padding="8px 12px",x.style.background="rgba(26,26,46)",x.style.borderRadius="12px",x.style.border="1px solid rgba(110,198,255,0.3)",x.style.minWidth="200px",x.style.height="64px";const C=document.createElement("div");C.style.position="relative",C.style.cursor="pointer",C.style.transition="all 0.2s";const w=document.createElement("div");w.id="character-avatar",w.style.width="64px",w.style.height="64px",w.style.borderRadius="50%",w.style.border="2px solid #6ec6ff",w.style.display="flex",w.style.alignItems="center",w.style.justifyContent="center",w.style.fontSize="20px",w.style.fontWeight="bold",w.style.color="#ecf0f1",w.style.background="#23243a",w.style.overflow="hidden",w.style.transition="all 0.2s";const q=F();q?(w.style.background=`url(${q}) center/cover`,w.textContent=""):w.textContent="IM";const E=document.createElement("div");E.innerHTML="✏️",E.style.position="absolute",E.style.bottom="-3px",E.style.right="-3px",E.style.background="#6ec6ff",E.style.borderRadius="50%",E.style.width="22px",E.style.height="22px",E.style.display="flex",E.style.alignItems="center",E.style.justifyContent="center",E.style.fontSize="12px",E.style.border="2px solid rgba(30,30,40,0.92)",E.style.opacity="0",E.style.transition="all 0.2s";const z=document.createElement("div");z.textContent=D(),z.style.position="absolute",z.style.top="-3px",z.style.left="-3px",z.style.background="rgba(26,26,46)",z.style.borderRadius="50%",z.style.width="22px",z.style.height="22px",z.style.display="flex",z.style.alignItems="center",z.style.justifyContent="center",z.style.fontSize="12px",z.style.fontWeight="bold",z.style.color="#fff",z.style.border="2px solid #6ec6ff",z.style.transition="all 0.2s",z.title="Nível do herói";const k=document.createElement("div");k.textContent=localStorage.getItem("tormenta-20-hotbars-char-ac-attr")||"0",k.style.position="absolute",k.style.bottom="-3px",k.style.right="-3px",k.style.background="rgba(26,26,46)",k.style.borderRadius="50%",k.style.width="24px",k.style.height="26px",k.style.display="flex",k.style.alignItems="center",k.style.justifyContent="center",k.style.fontSize="12px",k.style.fontWeight="bold",k.style.color="#fff",k.style.border="2px solid #6ec6ff",k.style.transition="all 0.2s",k.title="Defesa",C.appendChild(w),C.appendChild(E),C.appendChild(z),C.appendChild(k),C.onmouseover=()=>{w.style.transform="scale(1.05)",E.style.opacity="1",z.style.transform="scale(1.1)",k.style.transform="scale(1.05)"},C.onmouseout=()=>{w.style.transform="scale(1)",E.style.opacity="0",z.style.transform="scale(1)",k.style.transform="scale(1)"},C.onclick=Y;const P=document.createElement("div");P.style.display="flex",P.style.flexDirection="column",P.style.gap="1px",P.style.justifyContent="center",P.style.height="80px";const _=document.createElement("div");_.id="character-name";const R=localStorage.getItem(s)||$();_.textContent=R,_.style.color="#ecf0f1",_.style.fontSize="14px",_.style.fontWeight="bold",_.style.whiteSpace="nowrap",_.style.cursor="default",_.title="Nome do personagem (sincronizado da ficha)",P.appendChild(_);const V=document.createElement("div");V.style.display="flex",V.style.alignItems="center",V.style.gap="8px",V.style.marginTop="2px";const B=document.createElement("div");B.style.width="80px",B.style.height="8px",B.style.background="rgba(255, 0, 0, 0.3)",B.style.borderRadius="4px",B.style.overflow="hidden",B.style.position="relative";const N=document.createElement("div");N.style.height="100%",N.style.background="#ff4444",N.style.transition="width 0.3s ease",N.style.borderRadius="4px";const O=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-hp-current")||"0"),U=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-hp-total")||"1"),L=U>0?Math.max(0,Math.min(100,O/U*100)):0;N.style.width=`${L}%`,N.style.background=L>50?"#4caf50":L>25?"#ff9800":"#f44336";const W=document.createElement("div");W.textContent=`${O}/${U}`,W.style.fontSize="10px",W.style.color="#ecf0f1",W.style.fontWeight="bold",W.style.minWidth="35px",B.appendChild(N),V.appendChild(B),V.appendChild(W);const H=document.createElement("div");H.style.display="flex",H.style.alignItems="center",H.style.gap="8px",H.style.marginTop="1px";const J=document.createElement("div");J.style.width="80px",J.style.height="8px",J.style.background="rgba(0, 0, 255, 0.3)",J.style.borderRadius="4px",J.style.overflow="hidden",J.style.position="relative";const G=document.createElement("div");G.style.height="100%",G.style.background="#2196f3",G.style.transition="width 0.3s ease",G.style.borderRadius="4px";const Q=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-mp-current")||"0"),K=parseInt(localStorage.getItem("tormenta-20-hotbars-sync-mp-total")||"1"),X=K>0?Math.max(0,Math.min(100,Q/K*100)):0;G.style.width=`${X}%`;const oe=document.createElement("div");oe.textContent=`${Q}/${K}`,oe.style.fontSize="10px",oe.style.color="#6ec6ff",oe.style.fontWeight="bold",oe.style.minWidth="35px",J.appendChild(G),H.appendChild(J),H.appendChild(oe),P.appendChild(V),P.appendChild(H),x.appendChild(C),x.appendChild(P);const se=document.createElement("div");se.style.width="1px",se.style.height="60px",se.style.background="rgba(110,198,255,0.3)",se.style.margin="0 10px";const re=document.createElement("div");re.style.display="flex",re.style.alignItems="center",re.style.gap="12px",re.style.padding="8px 12px",re.style.background="rgba(46,26,26,0.8)",re.style.borderRadius="12px",re.style.border="1px solid rgba(255,110,110,0.3)",re.style.minWidth="160px",re.style.justifyContent="center";const ne=document.createElement("div");ne.style.width="1px",ne.style.height="60px",ne.style.background="rgba(110,198,255,0.3)",ne.style.margin="0 10px";const ce=document.createElement("div");ce.style.display="flex",ce.style.alignItems="center",ce.style.gap="8px",ce.style.padding="8px 12px",ce.style.background="rgba(26,26,46,0.8)",ce.style.borderRadius="12px",ce.style.border="1px solid rgba(110,198,255,0.3)",ce.style.minWidth="340px",ce.style.justifyContent="center";const de={label:"Atacar",icon:"⚔️",onClick:e=>{if(e&&e.ctrlKey)!function(){const e=document.getElementById("attack-effects-popup");e&&e.remove();const a=document.getElementById("attack-effects-overlay");a&&a.remove();const o=document.createElement("div");o.id="attack-effects-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="attack-effects-popup",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="340px",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="10px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("attack-effects-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Efeitos no Ataque",n.style.color="#ecf0f1",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=Ue(parseInt(localStorage.getItem(T)||"1",10)||1),c={},d="tormenta-20-hotbars-attack-effects";let l=[];try{const e=localStorage.getItem(d);e&&(l=JSON.parse(e))}catch(e){console.error("Erro ao carregar seleção:",e),l=[]}i.forEach(e=>{const a=document.createElement("label");a.style.display="flex",a.style.alignItems="center",a.style.gap="8px",a.style.marginBottom="8px";const o=document.createElement("input");o.type="checkbox",o.value=e.value,c[e.value]=o,l.includes(e.value)&&(o.checked=!0);const s=document.createElement("span");s.textContent=e.label,s.style.color="#ecf0f1",s.style.fontSize="15px";const r=document.createElement("span");r.textContent=e.origin?` [${e.origin}]`:"",r.style.color="#6ec6ff",r.style.fontSize="12px",r.style.marginLeft="4px",s.appendChild(r),a.appendChild(o),a.appendChild(s),t.appendChild(a)});const m=document.createElement("button");m.textContent="Salvar",m.style.width="100%",m.style.padding="12px 0",m.style.background="#6ec6ff",m.style.color="#23243a",m.style.border="none",m.style.borderRadius="8px",m.style.fontSize="16px",m.style.fontWeight="bold",m.style.cursor="pointer",m.style.transition="all 0.2s",m.style.marginTop="10px",m.onmouseover=()=>{m.style.background="#5bb8ff"},m.onmouseout=()=>{m.style.background="#6ec6ff"},m.onclick=()=>{const e=Object.keys(c).filter(e=>c[e].checked);try{localStorage.setItem(d,JSON.stringify(e))}catch(e){console.error("Erro ao salvar seleção:",e)}const a=e.includes("assado_carnes"),o=e.includes("batata_valkariana"),s=e.includes("bolo_cenoura"),r=e.includes("estrogonofe"),n=e.includes("futomaki"),i=e.includes("pao_queijo"),l=e.includes("porco_assado"),m=e.includes("salada_elfica"),u=e.includes("salada_imperial"),p=e.includes("sopa_cogumelo"),g=e.includes("pizza"),f=e.includes("baba_de_troll"),v=e.includes("hidromel_uivante");t.remove();const y=document.getElementById("attack-effects-overlay");if(y&&y.remove(),a||o||s||r||n||i||l||m||u||p||g||f||v){const t=Ue(parseInt(localStorage.getItem(T)||"1",10)||1);let c="",d="",y=18,b=0,h=!1,x=!1;t.forEach(a=>{e.includes(a.value)&&(a.dice&&(c+=`+${a.dice}`),a.critMod&&(y+=a.critMod),a.attackMod&&("string"==typeof a.attackMod&&a.attackMod.includes("d")?b+=`+${a.attackMod}`:b+=a.attackMod),d+="%NEWLINE% "+a.desc,"marca_presa"===a.value&&(h=!0),"inimigo"===a.value&&(x=!0))}),x&&h&&16===y&&(y=14),he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Espada Longa}}{{attackroll=[[1d20cs>${y}+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+${b}+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}${c}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Ataque c/ Espada Longa**${d}}}`),setTimeout(()=>{if(o){Ke("prato_batata_valkariana");let e=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]");e=e.filter(e=>"prato_batata_valkariana"!==e.effectKey),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(e)),A("🍟 Efeito da Batata Valkariana consumido no ataque!")}if(a&&A("🥩 Bônus do Assado de Carnes aplicado no ataque!"),s&&A("🥕 Bônus do Bolo de Cenoura aplicado no ataque!"),r&&A("🍝 Bônus do Estrogonofe aplicado no ataque!"),n&&A("🍣 Bônus do Futomaki aplicado no ataque!"),i&&A("🧀 Bônus do Pão de Queijo aplicado no ataque!"),l&&A("🐷 Bônus do Porco Assado aplicado no ataque!"),m&&A("🥗 Bônus da Salada Elfica aplicado no ataque!"),u&&A("🥗 Bônus da Salada Imperial aplicado no ataque!"),p&&A("🍄 Bônus da Sopa de Cogumelo aplicado no ataque!"),g&&A("🍕 Bônus da Pizza aplicado no ataque!"),f){Ke("bebida_baba_de_troll");let e=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]");e=e.filter(e=>"bebida_baba_de_troll"!==e.effectKey),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(e)),A("🧃 Efeito da Baba de Troll consumido no ataque!")}v&&A("🔥 Bônus do Hidromel Uivante aplicado no ataque!")},1e3)}},t.appendChild(m),document.body.appendChild(t),S(t,"blue")}();else{const e="tormenta-20-hotbars-attack-effects";let a=[];try{const o=localStorage.getItem(e);o&&(a=JSON.parse(o))}catch(e){console.error("Erro ao carregar seleção:",e),a=[]}const o=Ue(parseInt(localStorage.getItem(T)||"1",10)||1);let t="",s="",r=18,n=0,i=!1,c=!1;o.forEach(e=>{a.includes(e.value)&&(e.dice&&(t+=`+${e.dice}`),e.critMod&&(r+=e.critMod),e.attackMod&&(n+=e.attackMod),s+="%NEWLINE% "+e.desc,"marca_presa"===e.value&&(i=!0),"inimigo"===e.value&&(c=!0))}),c&&i&&16===r&&(r=14),he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Espada Longa}}{{attackroll=[[1d20cs>${r}+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+${n}+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}${t}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Ataque c/ Espada Longa**${s}}}`)}}},le={label:"Manobras",icon:"⚡",onClick:function(){const e=document.getElementById("maneuvers-popup");e&&e.remove();const a=document.getElementById("maneuvers-overlay");a&&a.remove();const o=document.createElement("div");o.id="maneuvers-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="maneuvers-popup",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #ff6e6e",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="340px",t.style.maxHeight="480px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("maneuvers-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Manobras de Combate",n.style.color="#ecf0f1",n.style.margin="0",n.style.fontSize="18px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.position="relative",i.style.marginBottom="10px";const c=document.createElement("div");c.innerHTML="💡 <strong>Dica:</strong> Clique segurando CTRL para ver detalhes completos da manobra",c.style.color="#ff6e6e",c.style.fontSize="12px",c.style.marginBottom="8px",c.style.textAlign="center",c.style.fontStyle="italic",t.appendChild(c);const d=document.createElement("input");d.type="text",d.placeholder="Filtrar manobras...",d.style.width="100%",d.style.padding="10px 28px 10px 12px",d.style.borderRadius="8px",d.style.border="1px solid #ff6e6e",d.style.background="#23243a",d.style.color="#fff",d.style.fontSize="14px",d.style.outline="none",d.style.boxSizing="border-box",d.style.fontSize="15px";const l=document.createElement("span");l.textContent="×",l.style.position="absolute",l.style.right="8px",l.style.top="50%",l.style.transform="translateY(-50%)",l.style.cursor="pointer",l.style.color="#ff6e6e",l.style.fontSize="18px",l.style.display="none",l.onclick=()=>{d.value="",d.dispatchEvent(new Event("input")),d.focus()},d.oninput=()=>{d.value.length>0?l.style.display="block":l.style.display="none",p()},d.onfocus=()=>{d.style.borderColor="#ff8e8e"},d.style.borderColor="#ff6e6e",i.appendChild(d),i.appendChild(l),t.appendChild(i);const m=document.createElement("div");m.style.display="flex",m.style.flexDirection="column",m.style.gap="6px",m.style.marginTop="2px";const u=[{name:"Investida",description:"Você avança até o dobro de seu deslocamento (e no mínimo 3m) em linha reta e, no fim do movimento, faz um ataque corpo a corpo. Você recebe +2 no teste de ataque, mas sofre –2 na Defesa até o seu próximo turno, porque sua guarda fica aberta. Você não pode fazer uma investida em terreno difícil. Durante uma investida, você pode fazer a manobra atropelar como uma ação livre (mas não pode atropelar e atacar o mesmo alvo).",icon:"⚡",shortDesc:"Ação completa: Ataque corpo a corpo com +2 no teste de ataque, mas sofra –2 na Defesa até o próximo turno.",actionType:"Ação Completa",testType:"Ataque corpo a corpo",difficulty:"Teste de Pontaria +2",effects:["+2 no teste de ataque","-2 na Defesa até próximo turno","Pode fazer Atropelar como ação livre"],restrictions:["Não pode ser feita em terreno difícil","Mínimo 3m de movimento"]},{name:"Atropelar",description:"Você pode tentar atropelar um oponente como uma ação de movimento. Faça um teste de Força (Atletismo) oposto ao teste de Força (Atletismo) do oponente. Se você vencer, empurra o oponente 1,5m para trás e pode continuar seu movimento. Se você perder, para no espaço do oponente.",icon:"💨",shortDesc:"Ação de movimento: Teste de Atletismo para empurrar oponente 1,5m para trás.",actionType:"Ação de Movimento",testType:"Teste de Força (Atletismo)",difficulty:"Oposto ao teste de Força (Atletismo) do oponente",effects:["Empurra oponente 1,5m para trás","Pode continuar movimento"],restrictions:["Se perder, para no espaço do oponente"]},{name:"Agarrar",description:"Você pode tentar agarrar um oponente como uma ação padrão. Faça um teste de Força (Luta) oposto ao teste de Força (Luta) ou Destreza (Acrobacia) do oponente. Se você vencer, o oponente fica agarrado.",icon:"🤝",shortDesc:"Ação padrão: Teste de Luta para agarrar oponente.",actionType:"Ação Padrão",testType:"Teste de Força (Luta)",difficulty:"Oposto ao teste de Força (Luta) ou Destreza (Acrobacia) do oponente",effects:["Oponente fica agarrado"],restrictions:["Oponente pode usar Luta ou Acrobacia para resistir"]},{name:"Desarmar",description:"Você pode tentar desarmar um oponente como uma ação padrão. Faça um teste de Força (Luta) oposto ao teste de Força (Luta) do oponente. Se você vencer, o oponente solta a arma.",icon:"🗡️",shortDesc:"Ação padrão: Teste de Luta para fazer oponente soltar arma.",actionType:"Ação Padrão",testType:"Teste de Força (Luta)",difficulty:"Oposto ao teste de Força (Luta) do oponente",effects:["Oponente solta a arma"],restrictions:["Só funciona contra oponentes empunhando armas"]},{name:"Derrubar",description:"Você deixa o alvo caído. Esta queda normalmente não causa dano. Se você vencer o teste oposto por 5 pontos ou mais, derruba o oponente com tanta força que também o empurra um quadrado em uma direção a sua escolha. Se isso o jogar além de um parapeito ou precipício, ele pode fazer um teste de Reflexos (CD 20) para se agarrar numa beirada.",icon:"🔻",shortDesc:"Ação padrão: Deixe o alvo caído. Se vencer por 5+, empurre o alvo 1 quadrado.",actionType:"Ação Padrão",testType:"Teste de Força (Luta)",difficulty:"Oposto ao teste de Força (Luta) do oponente",effects:["Alvo fica caído","Se vencer por 5+, empurra 1 quadrado"],restrictions:["Queda não causa dano","Teste de Reflexos CD 20 se cair de altura"]},{name:"Empurrar",description:"Você empurra a criatura 1,5m. Para cada 5 pontos de diferença entre os testes, você empurra o alvo mais 1,5m. Você pode gastar uma ação de movimento para avançar junto com a criatura (até o limite do seu deslocamento).",icon:"➡️",shortDesc:"Ação padrão: Empurre o alvo 1,5m. Para cada 5 pontos de diferença, empurre mais 1,5m.",actionType:"Ação Padrão",testType:"Teste de Força (Luta)",difficulty:"Oposto ao teste de Força (Luta) do oponente",effects:["Empurra 1,5m","Cada 5 pontos de diferença = +1,5m","Pode avançar junto usando ação de movimento"],restrictions:["Limitado pelo deslocamento do personagem"]},{name:"Bloquear",description:"Você pode tentar bloquear um ataque como uma reação. Faça um teste de Força (Luta) oposto ao teste de ataque do oponente. Se você vencer, o ataque é bloqueado e não causa dano.",icon:"🛡️",shortDesc:"Reação: Teste de Luta para bloquear ataque.",actionType:"Reação",testType:"Teste de Força (Luta)",difficulty:"Oposto ao teste de ataque do oponente",effects:["Bloqueia o ataque","Não causa dano"],restrictions:["Só pode ser usada como reação","Precisa estar empunhando escudo ou arma"]},{name:"Esquivar",description:"Você pode tentar esquivar de um ataque como uma reação. Faça um teste de Destreza (Acrobacia) oposto ao teste de ataque do oponente. Se você vencer, o ataque erra completamente.",icon:"🔄",shortDesc:"Reação: Teste de Acrobacia para esquivar de ataque.",actionType:"Reação",testType:"Teste de Destreza (Acrobacia)",difficulty:"Oposto ao teste de ataque do oponente",effects:["Ataque erra completamente"],restrictions:["Só pode ser usada como reação","Precisa estar livre de movimento"]},{name:"Contra-ataque",description:"Quando um oponente erra um ataque corpo a corpo contra você, você pode fazer um contra-ataque como uma reação. Faça um teste de ataque normal. Se acertar, causa dano normal.",icon:"⚔️",shortDesc:"Reação: Ataque quando oponente erra ataque corpo a corpo.",actionType:"Reação",testType:"Teste de ataque normal",difficulty:"Teste de Pontaria normal",effects:["Ataque normal se acertar"],restrictions:["Só quando oponente erra ataque corpo a corpo","Precisa estar empunhando arma corpo a corpo"]}];u.forEach((e,a)=>{const o=document.createElement("button");o.id=`maneuver-btn-${a}`,o.textContent=`${e.icon} ${e.name}`,o.style.width="100%",o.style.background="#23243a",o.style.color="#fff",o.style.border="1px solid #ff6e6e",o.style.borderRadius="6px",o.style.padding="8px 0",o.style.fontSize="15px",o.style.fontWeight="bold",o.style.cursor="pointer",o.style.transition="all 0.2s",o.style.position="relative",o.style.display="block";let s=null,r=null;o.onmouseover=()=>{o.style.background="#ff6e6e",o.style.color="#23243a",r=setTimeout(()=>{s&&s.remove(),s=document.createElement("div"),s.style.position="fixed",s.style.background="rgba(20,20,30,0.98)",s.style.border="2px solid #ff6e6e",s.style.borderRadius="8px",s.style.padding="12px",s.style.minWidth="280px",s.style.maxWidth="320px",s.style.zIndex="10004",s.style.boxShadow="0 4px 16px rgba(0,0,0,0.8)",s.style.pointerEvents="none";const a=o.getBoundingClientRect();s.style.left=a.right+10+"px",s.style.top=a.top+"px";const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="8px";const r=document.createElement("div");r.textContent=e.name,r.style.color="#ff6e6e",r.style.fontSize="16px",r.style.fontWeight="bold",r.style.marginBottom="4px",t.appendChild(r);const n=document.createElement("div");n.textContent="Manobra de Combate",n.style.background="#ff6e6e",n.style.color="#23243a",n.style.fontSize="11px",n.style.fontWeight="bold",n.style.borderRadius="4px",n.style.padding="2px 8px",n.style.display="inline-block",n.style.width="fit-content",t.appendChild(n);const i=document.createElement("div");i.textContent="Ação Completa",i.style.background="#8B4513",i.style.color="#fff",i.style.fontSize="11px",i.style.fontWeight="bold",i.style.borderRadius="4px",i.style.padding="2px 8px",i.style.display="inline-block",i.style.width="fit-content",i.style.marginTop="2px",t.appendChild(i);const c=document.createElement("div");c.textContent=e.shortDesc,c.style.color="#ecf0f1",c.style.fontSize="13px",c.style.lineHeight="1.4",c.style.marginTop="6px",t.appendChild(c),s.appendChild(t),document.body.appendChild(s)},300)},o.onmouseout=()=>{o.style.background="#23243a",o.style.color="#fff",r&&(clearTimeout(r),r=null),s&&(s.remove(),s=null)},o.onclick=a=>{if(a.ctrlKey)return a.preventDefault(),void function(e){const a=document.getElementById("maneuver-details-popup");a&&a.remove();const o=document.getElementById("maneuver-details-overlay");o&&o.remove();const t=document.createElement("div");t.id="maneuver-details-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.7)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="maneuver-details-popup",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(20,20,30,0.98)",s.style.border="2px solid #ff6e6e",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="500px",s.style.maxHeight="80vh",s.style.overflowY="auto",s.style.boxShadow="0 12px 40px rgba(0,0,0,0.8)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px",r.style.width="100%";const n=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove();const e=document.getElementById("maneuver-details-overlay");e&&e.remove()}}),i=document.createElement("h2");i.innerHTML=`${e.icon} ${e.name}`,i.style.color="#ff6e6e",i.style.margin="0",i.style.fontSize="22px",i.style.fontWeight="bold",r.appendChild(i),r.appendChild(n.render()),s.appendChild(r);const c=document.createElement("div");c.style.display="flex",c.style.flexDirection="column",c.style.gap="16px";const d=document.createElement("div");d.style.display="flex",d.style.gap="8px",d.style.flexWrap="wrap";const l=document.createElement("span");l.textContent=e.actionType,l.style.background="#8B4513",l.style.color="#fff",l.style.fontSize="12px",l.style.fontWeight="bold",l.style.borderRadius="6px",l.style.padding="4px 10px",l.style.display="inline-block",d.appendChild(l);const m=document.createElement("span");m.textContent=e.testType,m.style.background="#4a90e2",m.style.color="#fff",m.style.fontSize="12px",m.style.fontWeight="bold",m.style.borderRadius="6px",m.style.padding="4px 10px",m.style.display="inline-block",d.appendChild(m),c.appendChild(d);const u=document.createElement("div");u.style.background="rgba(255,110,110,0.1)",u.style.border="1px solid #ff6e6e",u.style.borderRadius="8px",u.style.padding="12px";const p=document.createElement("h3");p.textContent="🎯 Dificuldade",p.style.color="#ff6e6e",p.style.margin="0 0 8px 0",p.style.fontSize="16px",p.style.fontWeight="bold",u.appendChild(p);const g=document.createElement("p");g.textContent=e.difficulty,g.style.color="#ecf0f1",g.style.margin="0",g.style.fontSize="14px",g.style.lineHeight="1.4",u.appendChild(g),c.appendChild(u);const f=document.createElement("div");f.style.background="rgba(76,175,80,0.1)",f.style.border="1px solid #4CAF50",f.style.borderRadius="8px",f.style.padding="12px";const v=document.createElement("h3");v.textContent="✨ Efeitos",v.style.color="#4CAF50",v.style.margin="0 0 8px 0",v.style.fontSize="16px",v.style.fontWeight="bold",f.appendChild(v);const y=document.createElement("ul");if(y.style.margin="0",y.style.paddingLeft="20px",y.style.color="#ecf0f1",y.style.fontSize="14px",y.style.lineHeight="1.4",e.effects.forEach(e=>{const a=document.createElement("li");a.textContent=e,a.style.marginBottom="4px",y.appendChild(a)}),f.appendChild(y),c.appendChild(f),e.restrictions&&e.restrictions.length>0){const a=document.createElement("div");a.style.background="rgba(255,152,0,0.1)",a.style.border="1px solid #FF9800",a.style.borderRadius="8px",a.style.padding="12px";const o=document.createElement("h3");o.textContent="⚠️ Restrições",o.style.color="#FF9800",o.style.margin="0 0 8px 0",o.style.fontSize="16px",o.style.fontWeight="bold",a.appendChild(o);const t=document.createElement("ul");t.style.margin="0",t.style.paddingLeft="20px",t.style.color="#ecf0f1",t.style.fontSize="14px",t.style.lineHeight="1.4",e.restrictions.forEach(e=>{const a=document.createElement("li");a.textContent=e,a.style.marginBottom="4px",t.appendChild(a)}),a.appendChild(t),c.appendChild(a)}const b=document.createElement("div");b.style.background="rgba(156,39,176,0.1)",b.style.border="1px solid #9C27B0",b.style.borderRadius="8px",b.style.padding="12px";const h=document.createElement("h3");h.textContent="📖 Descrição Completa",h.style.color="#9C27B0",h.style.margin="0 0 8px 0",h.style.fontSize="16px",h.style.fontWeight="bold",b.appendChild(h);const x=document.createElement("p");x.textContent=e.description,x.style.color="#ecf0f1",x.style.margin="0",x.style.fontSize="14px",x.style.lineHeight="1.5",b.appendChild(x),c.appendChild(b);const C=document.createElement("button");C.textContent=`⚡ Executar ${e.name}`,C.style.width="100%",C.style.padding="12px 0",C.style.background="#ff6e6e",C.style.color="#23243a",C.style.border="none",C.style.borderRadius="8px",C.style.fontSize="16px",C.style.fontWeight="bold",C.style.cursor="pointer",C.style.transition="all 0.2s",C.style.marginTop="16px",C.onmouseover=()=>{C.style.background="#ff8e8e"},C.onmouseout=()=>{C.style.background="#ff6e6e"},C.onclick=()=>{if("Investida"===e.name){const e="tormenta-20-hotbars-attack-effects";let a=[];try{const o=localStorage.getItem(e);o&&(a=JSON.parse(o))}catch(e){console.error("Erro ao carregar seleção:",e),a=[]}const o=Ue(parseInt(localStorage.getItem(T)||"1",10)||1);let t="",s="",r=18,n=2,i=!1,c=!1;o.forEach(e=>{a.includes(e.value)&&(e.dice&&(t+=`+${e.dice}`),e.critMod&&(r+=e.critMod),e.attackMod&&(n+=e.attackMod),s+="%NEWLINE% "+e.desc,"marca_presa"===e.value&&(i=!0),"inimigo"===e.value&&(c=!0))}),c&&i&&16===r&&(r=14),he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Investida}}{{attackroll=[[1d20cs>${r}+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+${n}+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}${t}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Investida c/ Espada Longa** ${s}}}`)}else"Atropelar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Atropelar}}{{theroll=[[1d20+[[@{${I()}|atletismototal}]]]]}}`):"Agarrar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Agarrar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Desarmar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Desarmar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Derrubar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Derrubar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Empurrar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Empurrar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Bloquear"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Bloquear}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Esquivar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Esquivar}}{{theroll=[[1d20+[[@{${I()}|acrobaciatotal}]]]]}}`):"Contra-ataque"===e.name&&he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Contra-ataque}}{{attackroll=[[1d20+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Contra-ataque**}}`);s.remove();const a=document.getElementById("maneuver-details-overlay");a&&a.remove()},c.appendChild(C),s.appendChild(c),document.body.appendChild(s),S(s,"red")}(e);if(r&&(clearTimeout(r),r=null),s&&(s.remove(),s=null),"Investida"===e.name){const e="tormenta-20-hotbars-attack-effects";let a=[];try{const o=localStorage.getItem(e);o&&(a=JSON.parse(o))}catch(e){console.error("Erro ao carregar seleção:",e),a=[]}const o=Ue(parseInt(localStorage.getItem(T)||"1",10)||1);let t="",s="",r=18,n=2,i=!1,c=!1;o.forEach(e=>{a.includes(e.value)&&(e.dice&&(t+=`+${e.dice}`),e.critMod&&(r+=e.critMod),e.attackMod&&(n+=e.attackMod),s+="%NEWLINE% "+e.desc,"marca_presa"===e.value&&(i=!0),"inimigo"===e.value&&(c=!0))}),c&&i&&16===r&&(r=14),he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Investida}}{{attackroll=[[1d20cs>${r}+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+${n}+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}${t}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Investida c/ Espada Longa** ${s}}}`)}else"Atropelar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Atropelar}}{{theroll=[[1d20+[[@{${I()}|atletismototal}]]]]}}`):"Agarrar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Agarrar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Desarmar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Desarmar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Derrubar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Derrubar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Empurrar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Empurrar}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Bloquear"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Bloquear}}{{theroll=[[1d20+[[@{${I()}|lutatotal}]]]]}}`):"Esquivar"===e.name?Z(`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Manobra Esquivar}}{{theroll=[[1d20+[[@{${I()}|acrobaciatotal}]]]]}}`):"Contra-ataque"===e.name&&he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Contra-ataque}}{{attackroll=[[1d20+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Contra-ataque**}}`);t.remove();const o=document.getElementById("maneuvers-overlay");o&&o.remove()},m.appendChild(o)});const p=()=>{const e=d.value.toLowerCase();m.querySelectorAll("button").forEach((a,o)=>{const t=u[o],s=t.name.toLowerCase().includes(e)||t.shortDesc.toLowerCase().includes(e);a.style.display=s?"block":"none"})};d.addEventListener("input",p),t.appendChild(m),document.body.appendChild(t),S(t,"red")}},me=[{label:"Perícias",icon:"🧠",onClick:ae},{label:"Magias",icon:"🔮",onClick:ie},{label:"Poderes",icon:"✨",onClick:We},{label:"Efeitos",icon:"🌀",onClick:va},{label:"Misc.",icon:"📦",onClick:te}],ue=h({icon:de.icon,label:de.label,onClick:de.onClick,theme:"red"}),pe=h({icon:le.icon,label:le.label,onClick:le.onClick,theme:"red"});re.appendChild(ue),re.appendChild(pe),me.forEach(e=>{const a=h({icon:e.icon,label:e.label,onClick:e.onClick,theme:"blue",dataLabel:e.label});ce.appendChild(a)}),y.appendChild(b),y.appendChild(x),y.appendChild(se),y.appendChild(re),y.appendChild(ne),y.appendChild(ce),e.appendChild(y);const ge=document.createElement("div");ge.id="effects-indicators-section",ge.style.display="none",ge.style.padding="8px 24px 12px 24px",ge.style.borderTop="1px solid rgba(255,255,255,0.1)",ge.style.width="100%",ge.style.boxSizing="border-box";const fe=document.createElement("div");fe.id="effects-icons-container",fe.style.display="flex",fe.style.gap="6px",fe.style.justifyContent="flex-start",fe.style.alignItems="center",fe.style.flexWrap="wrap",fe.style.position="relative",ge.appendChild(fe),e.appendChild(ge),document.body.appendChild(e),function(e,a){let o,t,s,r,n=!1,i=0,c=0;a.addEventListener("mousedown",function(e){e.preventDefault(),s=e.clientX-i,r=e.clientY-c,n=!0,a.style.cursor="grabbing"}),document.addEventListener("mousemove",function(a){var d,l;n&&(a.preventDefault(),o=a.clientX-s,t=a.clientY-r,i=o,c=t,d=o,l=t,e.style.transform=`translate3d(${d}px, ${l}px, 0)`)}),document.addEventListener("mouseup",function(){s=o,r=t,n=!1,a.style.cursor="grab"})}(e,a),function(){const e=document.getElementById("hotbar-version-text");if(e){const a="0.3.1.8744";e.textContent=a}}(),Ye(),pa(),setTimeout(()=>{(async function(){g.log("Iniciando pré-carregamento de imagens...");const e=["https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_60.jpg","https://wow.zamimg.com/images/wow/icons/large/achievement_halloween_candy_01.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_cauldron_frost.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_103_potatobread.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_fishcake.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_144_cakeslice.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_sauteedcarrots.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_06.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_161_fish_white.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_meat_cooked_08.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_cask_04.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_cooking_90_cinnamonbonefishstew.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_orchardfruit01.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_deliciouspizza.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_123_roast.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_18.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindsteal.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_charm.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_poisoncleansingtotem.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_sleep.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_eyeofthestorm.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathscream.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_blackplague.jpg","https://wow.zamimg.com/images/wow/icons/large/ability_stealth.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbindtotem.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antishadow.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soulleech.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathpact.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofmannoroth.jpg","https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unholyfrenzy.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_braisedturtle.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_valleystirfry.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_slime_02.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_63.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_10.jpg","https://wow.zamimg.com/images/wow/icons/large/inv_misc_fork-knife.jpg"],a=Xe();let o=0,t=0;for(let s=0;s<e.length;s+=5){const r=e.slice(s,s+5);await Promise.all(r.map(async e=>{if(a.images[e])t++;else try{await ma(e),o++}catch(a){console.warn(`Erro ao pré-carregar ${e}:`,a)}})),s+5<e.length&&await new Promise(e=>setTimeout(e,100))}g.log(`Pré-carregamento concluído: ${o} novas imagens carregadas, ${t} já estavam no cache`)})().catch(e=>{console.warn("Erro no pré-carregamento de imagens:",e)})},1e3)}var Ee;function ze(){const e=document.getElementById("hunter-class-modal");e&&e.remove();const a=document.getElementById("hunter-class-overlay");a&&a.remove();const o=[{name:"Acuidade com Arma",description:"Quando usa uma arma corpo a corpo leve ou uma arma de arremesso, você pode usar sua Destreza em vez de Força nos testes de ataque e rolagens de dano.",prereq:"Des 1"},{name:"Arma Secundária Grande",description:"Você pode empunhar duas armas de uma mão com o poder Estilo de Duas Armas.",prereq:"Estilo de Duas Armas"},{name:"Arremesso Potente",description:"Quando usa uma arma de arremesso, você pode usar sua Força em vez de Destreza nos testes de ataque. Se você possuir o poder Ataque Poderoso, poderá usá-lo com armas de arremesso.",prereq:"For 1, Estilo de Arremesso"},{name:"Arremesso Múltiplo",description:"Uma vez por rodada, quando faz um ataque com uma arma de arremesso, você pode gastar 1 PM para fazer um ataque adicional contra o mesmo alvo, arremessando outra arma de arremesso.",prereq:"Des 1, Estilo de Arremesso"},{name:"Ataque com Escudo",description:"Uma vez por rodada, se estiver empunhando um escudo e fizer a ação agredir, você pode gastar 1 PM para fazer um ataque corpo a corpo extra com o escudo. Este ataque não faz você perder o bônus do escudo na Defesa.",prereq:"Estilo de Arma e Escudo"},{name:"Ataque Pesado",description:"Quando faz um ataque corpo a corpo com uma arma de duas mãos, você pode pagar 1 PM. Se fizer isso e acertar o ataque, além do dano você faz uma manobra derrubar ou empurrar contra o alvo como uma ação livre (use o resultado do ataque como o teste de manobra).",prereq:"Estilo de Duas Mãos"},{name:"Ataque Poderoso",description:"Sempre que faz um ataque corpo a corpo, você pode sofrer –2 no teste de ataque para receber +5 na rolagem de dano.",prereq:"For 1"},{name:"Ataque Preciso",description:"Se estiver empunhando uma arma corpo a corpo em uma das mãos e nada na outra, você recebe +2 na margem de ameaça e +1 no multiplicador de crítico com ela.",prereq:"Estilo de Uma Arma"},{name:"Bloqueio com Escudo",description:"Quando sofre dano, você pode gastar 1 PM para receber redução de dano igual ao bônus na Defesa que seu escudo fornece contra este dano. Você só pode usar este poder se estiver usando um escudo.",prereq:"Estilo de Arma e Escudo"},{name:"Carga de Cavalaria",description:"Quando faz uma investida montada, você causa +2d8 pontos de dano. Além disso, pode continuar se movendo depois do ataque. Você deve se mover em linha reta e seu movimento máximo ainda é o dobro do seu deslocamento.",prereq:"Ginete"},{name:"Combate Defensivo",description:"Quando usa a ação agredir, você pode usar este poder. Se fizer isso, até seu próximo turno, sofre –2 em todos os testes de ataque, mas recebe +5 na Defesa.",prereq:"Int 1"},{name:"Derrubar Aprimorado",description:"Você recebe +2 em testes de ataque para derrubar. Quando derruba uma criatura com essa manobra, pode gastar 1 PM para fazer um ataque extra contra ela.",prereq:"Combate Defensivo"},{name:"Desarmar Aprimorado",description:'Você recebe +2 em testes de ataque para desarmar. Quando desarma uma criatura, pode gastar 1 PM para arremessar a arma dela para longe. Para definir onde a arma cai, role 1d8 para a direção (sendo "1" diretamente à sua frente, "2" à frente e à direita e assim por diante) e 1d6 para a distância (medida em quadrados de 1,5m a partir da criatura desarmada).',prereq:"Combate Defensivo"},{name:"Disparo Preciso",description:"Você pode fazer ataques à distância contra oponentes envolvidos em combate corpo a corpo sem sofrer a penalidade de –5 no teste de ataque.",prereq:"Estilo de Disparo ou Estilo de Arremesso"},{name:"Disparo Rápido",description:"Se estiver empunhando uma arma de disparo que possa recarregar como ação livre e gastar uma ação completa para agredir, pode fazer um ataque adicional com ela. Se fizer isso, sofre –2 em todos os testes de ataque até o seu próximo turno.",prereq:"Des 1, Estilo de Disparo"},{name:"Empunhadura Poderosa",description:"Ao usar uma arma feita para uma categoria de tamanho maior que a sua, a penalidade que você sofre nos testes de ataque diminui para –2 (normalmente, usar uma arma de uma categoria de tamanho maior impõe –5 nos testes de ataque).",prereq:"For 3"},{name:"Encouraçado",description:"Se estiver usando uma armadura pesada, você recebe +2 na Defesa. Esse bônus aumenta em +2 para cada outro poder que você possua que tenha Encouraçado como pré-requisito.",prereq:"proficiência com armaduras pesadas"},{name:"Esquiva",description:"Você recebe +2 na Defesa e Reflexos.",prereq:"Des 1"},{name:"Estilo de Arma e Escudo",description:"Se você estiver usando um escudo, o bônus na Defesa que ele fornece aumenta em +2.",prereq:"treinado em Luta, proficiência com escudos"},{name:"Estilo de Arma Longa",description:"Você recebe +2 em testes de ataque com armas alongadas e pode atacar alvos adjacentes com essas armas.",prereq:"For 1, treinado em Luta"},{name:"Estilo de Arremesso",description:"Você pode sacar armas de arremesso como uma ação livre e recebe +2 nas rolagens de dano com elas. Se também possuir o poder Saque Rápido, também recebe +2 nos testes de ataque com essas armas.",prereq:"treinado em Pontaria"},{name:"Estilo de Disparo",description:"Se estiver usando uma arma de disparo, você soma sua Destreza nas rolagens de dano.",prereq:"treinado em Pontaria"},{name:"Estilo de Duas Armas",description:"Se estiver empunhando duas armas (e pelo menos uma delas for leve) e fizer a ação agredir, você pode fazer dois ataques, um com cada arma. Se fizer isso, sofre –2 em todos os testes de ataque até o seu próximo turno. Se possuir Ambidestria, em vez disso não sofre penalidade para usá-lo.",prereq:"Des 2, treinado em Luta"},{name:"Estilo de Duas Mãos",description:"Se estiver usando uma arma corpo a corpo com as duas mãos, você recebe +5 nas rolagens de dano. Este poder não pode ser usado com armas leves.",prereq:"For 2, Treinado em Luta"},{name:"Estilo de Uma Arma",description:"Se estiver usando uma arma corpo a corpo em uma das mãos e nada na outra, você recebe +2 na Defesa e nos testes de ataque com essa arma (exceto ataques desarmados).",prereq:"treinado em Luta"},{name:"Estilo Desarmado",description:"Seus ataques desarmados causam 1d6 pontos de dano e podem causar dano letal ou não letal (sem penalidades).",prereq:"treinado em Luta"},{name:"Fanático",description:"Seu deslocamento não é reduzido por usar armaduras pesadas.",prereq:"12º nível de personagem, Encouraçado"},{name:"Finta Aprimorada",description:"Você recebe +2 em testes de Enganação para fintar e pode fintar como uma ação de movimento.",prereq:"treinado em Enganação"},{name:"Foco em Arma",description:"Escolha uma arma. Você recebe +2 em testes de ataque com essa arma. Você pode escolher este poder outras vezes para armas diferentes.",prereq:"proficiência com a arma"},{name:"Ginete",description:"Você passa automaticamente em testes de Cavalgar para não cair da montaria quando sofre dano. Além disso, não sofre penalidades para atacar à distância ou lançar magias quando montado.",prereq:"treinado em Cavalgar"},{name:"Inexpugnável",description:"Se estiver usando uma armadura pesada, você recebe +2 em todos os testes de resistência.",prereq:"Encouraçado, 6º nível de personagem"},{name:"Mira Apurada",description:"Quando usa a ação mirar, você recebe +2 em testes de ataque e na margem de ameaça com ataques à distância até o fim do turno.",prereq:"Sab 1, Disparo Preciso"},{name:"Piqueiro",description:"Uma vez por rodada, se estiver empunhando uma arma alongada e um inimigo entrar voluntariamente em seu alcance corpo a corpo, você pode gastar 1 PM para fazer um ataque corpo a corpo contra este oponente com esta arma. Se o oponente tiver se aproximado fazendo uma investida, seu ataque causa dois dados de dano extra do mesmo tipo.",prereq:"Estilo de Arma Longa"},{name:"Presença Aterradora",description:"Você pode gastar uma ação padrão e 1 PM para assustar todas as criaturas a sua escolha em alcance curto. Veja a perícia Intimidação para as regras de assustar.",prereq:"treinado em Intimidação"},{name:"Proficiência",description:"Escolha uma proficiência: armas marciais, armas de fogo, armaduras pesadas ou escudos (se for proficiente em armas marciais, você também pode escolher armas exóticas). Você recebe essa proficiência. Você pode escolher este poder outras vezes para proficiências diferentes."},{name:"Quebrar Aprimorado",description:"Você recebe +2 em testes de ataque para quebrar. Quando reduz os PV de uma arma para 0 ou menos, você pode gastar 1 PM para realizar um ataque extra contra o usuário dela. O ataque adicional usa os mesmos valores de ataque e dano, mas os dados devem ser rolados novamente.",prereq:"Ataque Poderoso"},{name:"Reflexos de Combate",description:"Você ganha uma ação de movimento extra no seu primeiro turno de cada combate.",prereq:"Des 1"},{name:"Saque Rápido",description:"Você recebe +2 em Iniciativa e pode sacar ou guardar itens como uma ação livre (em vez de ação de movimento). Além disso, a ação que você gasta para recarregar armas de disparo diminui em uma categoria (ação completa para padrão, padrão para movimento, movimento para livre).",prereq:"treinado em Iniciativa"},{name:"Trespassar",description:"Quando você faz um ataque corpo a corpo e reduz os pontos de vida do alvo para 0 ou menos, pode gastar 1 PM para fazer um ataque adicional contra outra criatura dentro do seu alcance.",prereq:"Ataque Poderoso"},{name:"Vitalidade",description:"Você recebe +1 PV por nível de personagem e +2 em Fortitude.",prereq:"Con 1"}],t=document.createElement("div");t.id="hunter-class-modal",t.className="roll20-modal roll20-popup-green",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #8B4513",t.style.borderRadius="12px",t.style.zIndex="10001",t.style.maxWidth="900px",t.style.maxHeight="85vh",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch",t.style.overflow="hidden";const s=document.createElement("div");s.id="hunter-class-overlay",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.background="rgba(0,0,0,0.5)",s.style.zIndex="10000",document.body.appendChild(s),document.addEventListener("race-selection-changed",()=>{const e=document.getElementById("spells-popup");if(e){e.remove();const a=document.getElementById("spells-overlay");a&&a.remove(),ie()}});const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.width="100%",r.style.borderBottom="1px solid rgba(139, 69, 19, 0.3)",r.style.padding="15px 20px",r.style.background="rgba(30,30,40,0.98)",r.style.borderRadius="12px 12px 0 0",r.style.flexShrink="0",r.style.minHeight="60px",r.style.boxSizing="border-box";const i=document.createElement("h2");i.innerHTML="🏹 Caçador",i.style.color="#8B4513",i.style.margin="0",i.style.fontSize="22px",i.style.fontWeight="bold",i.style.flex="1",i.style.minWidth="0";const c=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("hunter-class-overlay");e&&e.remove()}});r.appendChild(i),r.appendChild(c.render()),t.appendChild(r);const d=document.createElement("div");d.style.padding="15px 20px 0 20px",d.style.background="rgba(30,30,40,0.98)",d.style.borderBottom="1px solid rgba(139, 69, 19, 0.3)",d.style.flexShrink="0";const l=document.createElement("div");l.style.display="flex",l.style.gap="5px",l.style.marginBottom="15px";const m=document.createElement("div");m.style.minHeight="400px",m.style.overflowY="auto",m.style.padding="20px",m.style.flex="1",m.style.maxHeight="calc(85vh - 180px)",m.style.boxSizing="border-box";const u=document.createElement("button");u.textContent="Características da Classe",u.style.padding="10px 15px",u.style.background="#8B4513",u.style.color="#fff",u.style.border="none",u.style.borderRadius="8px 8px 0 0",u.style.fontSize="14px",u.style.fontWeight="bold",u.style.cursor="pointer",u.style.transition="all 0.2s";const p=document.createElement("div");p.id="tab1-content",p.style.display="block",[{label:"Pontos de Vida",value:"Um caçador começa com 16 pontos de vida + Constituição e ganha 4 PV + Constituição por nível."},{label:"Pontos de Mana",value:"4 PM por nível."},{label:"Perícias",value:"Luta (For) ou Pontaria (Des), Sobrevivência (Sab), mais 6 a sua escolha entre Adestramento (Car), Atletismo (For), Cavalgar (Des), Cura (Sab), Fortitude (Con), Furtividade (Des), Iniciativa (Des), Investigação (Int), Luta (For), Ofício (Int), Percepção (Sab), Pontaria (Des) e Reflexos (Des)."},{label:"Proficiências",value:"Armas marciais e escudos."}].forEach(e=>{const a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="10px",a.style.background="rgba(139, 69, 19, 0.1)",a.style.borderRadius="8px",a.style.border="1px solid rgba(139, 69, 19, 0.2)";const o=document.createElement("div");o.textContent=e.label,o.style.color="#8B4513",o.style.fontSize="14px",o.style.fontWeight="bold",o.style.marginBottom="5px";const t=document.createElement("div");t.textContent=e.value,t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.lineHeight="1.4",a.appendChild(o),a.appendChild(t),p.appendChild(a)});const f=document.createElement("button");f.textContent="Habilidades da Classe",f.style.padding="10px 15px",f.style.background="rgba(139, 69, 19, 0.3)",f.style.color="#ecf0f1",f.style.border="none",f.style.borderRadius="8px 8px 0 0",f.style.fontSize="14px",f.style.fontWeight="bold",f.style.cursor="pointer",f.style.transition="all 0.2s";const v=document.createElement("div");v.id="tab2-content",v.style.display="none";const y=document.createElement("button");y.textContent="Poderes de Combate",y.style.padding="10px 15px",y.style.background="rgba(139, 69, 19, 0.3)",y.style.color="#ecf0f1",y.style.border="none",y.style.borderRadius="8px 8px 0 0",y.style.fontSize="14px",y.style.fontWeight="bold",y.style.cursor="pointer",y.style.transition="all 0.2s",y.style.cursor="pointer";const b=document.createElement("div");b.id="tab3-content",b.style.display="none";const h=document.createElement("button");h.textContent="Divindade",h.style.padding="10px 15px",h.style.background="rgba(139, 69, 19, 0.3)",h.style.color="#ecf0f1",h.style.border="none",h.style.borderRadius="8px 8px 0 0",h.style.fontSize="14px",h.style.fontWeight="bold",h.style.cursor="pointer",h.style.transition="all 0.2s";const x=document.createElement("div");x.id="tab4-content",x.style.display="none";const C=document.createElement("button");C.textContent="Raça",C.style.padding="10px 15px",C.style.background="rgba(139, 69, 19, 0.3)",C.style.color="#ecf0f1",C.style.border="none",C.style.borderRadius="8px 8px 0 0",C.style.fontSize="14px",C.style.fontWeight="bold",C.style.cursor="pointer",C.style.transition="all 0.2s";const w=document.createElement("div");w.id="tab5-content",w.style.display="none";const q=document.createElement("div");q.style.marginBottom="15px",q.style.padding="12px",q.style.background="rgba(139, 69, 19, 0.1)",q.style.borderRadius="8px",q.style.border="1px solid rgba(139, 69, 19, 0.2)";const E=document.createElement("div");E.style.position="relative",E.style.marginBottom="10px";const z=document.createElement("input");z.type="text",z.placeholder="Filtrar pratos...",z.style.width="100%",z.style.padding="10px 12px",z.style.borderRadius="8px",z.style.border="1px solid #ffb86c",z.style.background="#23243a",z.style.color="#fff",z.style.fontSize="14px",z.style.outline="none",z.style.boxSizing="border-box",z.style.fontSize="15px";const k=document.createElement("span");k.textContent="×",k.style.position="absolute",k.style.right="8px",k.style.top="50%",k.style.transform="translateY(-50%)",k.style.cursor="pointer",k.style.color="#ffb86c",k.style.fontSize="18px",k.style.display="none",k.onclick=()=>{z.value="",z.dispatchEvent(new Event("input")),z.focus()},z.oninput=()=>{z.value.length>0?k.style.display="block":k.style.display="none",R()},E.appendChild(z),E.appendChild(k);const j=document.createElement("div");j.style.display="flex",j.style.gap="10px",j.style.flexWrap="wrap";const P=document.createElement("button");P.textContent="Todas",P.style.padding="6px 12px",P.style.background="#8B4513",P.style.color="#fff",P.style.border="none",P.style.borderRadius="6px",P.style.fontSize="12px",P.style.fontWeight="bold",P.style.cursor="pointer",P.style.transition="all 0.2s";const $=document.createElement("button");$.textContent="Aprendidos",$.style.padding="6px 12px",$.style.background="rgba(139, 69, 19, 0.3)",$.style.color="#ecf0f1",$.style.border="none",$.style.borderRadius="6px",$.style.fontSize="12px",$.style.fontWeight="bold",$.style.cursor="pointer",$.style.transition="all 0.2s";const I=document.createElement("button");I.textContent="Disponíveis",I.style.padding="6px 12px",I.style.background="rgba(139, 69, 19, 0.3)",I.style.color="#ecf0f1",I.style.border="none",I.style.borderRadius="6px",I.style.fontSize="12px",I.style.fontWeight="bold",I.style.cursor="pointer",I.style.transition="all 0.2s",j.appendChild(P),j.appendChild($),j.appendChild(I),q.appendChild(E),q.appendChild(j),b.appendChild(q);const D=document.createElement("div");D.id="combat-powers-list-container",b.appendChild(D);let M="all";function R(){D.innerHTML="";const e=o.filter(e=>{const a=e.name.toLowerCase().includes(z.value.toLowerCase())||e.description.toLowerCase().includes(z.value.toLowerCase());let o=!0;return"learned"===M?o=ke(e.name):"available"===M&&(o=!ke(e.name)),a&&o});if(0===e.length){const e=document.createElement("div");e.style.textAlign="center",e.style.padding="20px",e.style.color="#8B4513",e.style.fontSize="14px",e.style.fontStyle="italic",e.style.background="rgba(139, 69, 19, 0.1)",e.style.border="1px solid rgba(139, 69, 19, 0.3)",e.style.borderRadius="8px",e.style.marginTop="10px";const a=z.value.trim();return e.innerHTML=a?`\n                            <div style="margin-bottom: 8px;">🔍</div>\n                            <div>Nenhum poder encontrado para "<strong style="color: #8B4513;">${a}</strong>"</div>\n                            <div style="margin-top: 8px; font-size: 12px;">Tente um termo diferente ou limpe o filtro</div>\n                        `:'\n                            <div style="margin-bottom: 8px;">⚔️</div>\n                            <div>Nenhum poder disponível</div>\n                            <div style="margin-top: 8px; font-size: 12px;">Selecione uma classe para obter poderes de combate</div>\n                        ',void D.appendChild(e)}e.forEach(e=>{const a=ke(e.name);let o,t,s;a?(o="rgba(76, 175, 80, 0.1)",t="rgba(76, 175, 80, 0.3)",s="#4CAF50"):(o="rgba(139, 69, 19, 0.1)",t="rgba(139, 69, 19, 0.2)",s="#8B4513");const r=document.createElement("div");r.style.marginBottom="15px",r.style.padding="12px",r.style.background=o,r.style.borderRadius="8px",r.style.border=`1px solid ${t}`,r.style.transition="all 0.2s";const i=document.createElement("div");i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="flex-start",i.style.marginBottom="8px",i.style.flexWrap="wrap",i.style.gap="10px";const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="8px",c.style.flex="1";const d=document.createElement("input");d.type="checkbox",d.checked=a,d.style.width="16px",d.style.height="16px",d.style.accentColor="#8B4513",d.style.cursor="pointer",d.onchange=()=>{!function(e){const a=Se(),o=a.indexOf(e);o>-1?(a.splice(o,1),_(`Poder de Destino "${e}" removido da lista de aprendidos.`)):(a.push(e),A(`Poder de Destino "${e}" adicionado à lista de aprendidos!`)),function(e){try{localStorage.setItem(n,JSON.stringify(e))}catch(e){g.log("Erro ao salvar poderes de destino aprendidos:",e)}}(a)}(e.name),R()},c.appendChild(d);const l=document.createElement("div");l.textContent=e.name,l.style.color=s,l.style.fontSize="15px",l.style.fontWeight="bold",c.appendChild(l),i.appendChild(c);const m=document.createElement("div");if(m.textContent=e.description,m.style.color="#ecf0f1",m.style.fontSize="13px",m.style.lineHeight="1.4",m.style.marginBottom="5px",r.appendChild(i),r.appendChild(m),e.prereq){const a=document.createElement("div");a.textContent=`Pré-requisito: ${e.prereq}`,a.style.color="#ffa726",a.style.fontSize="11px",a.style.fontStyle="italic",a.style.fontWeight="bold",r.appendChild(a)}const u=document.createElement("div");if(u.style.marginTop="5px",u.style.display="flex",u.style.gap="8px",u.style.flexWrap="wrap",a){const e=document.createElement("div");e.innerHTML="✓ Aprendido",e.style.color="#4CAF50",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",u.appendChild(e)}else{const e=document.createElement("div");e.innerHTML="📋 Disponível",e.style.color="#8B4513",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",u.appendChild(e)}u.children.length>0&&r.appendChild(u),D.appendChild(r)});const a=document.createElement("div");a.style.marginTop="15px",a.style.padding="10px",a.style.background="rgba(26,26,46,0.8)",a.style.borderRadius="8px",a.style.border="1px solid rgba(139, 69, 19, 0.3)",a.style.textAlign="center";const t=Se().length,s=o.length,r=Math.round(t/s*100),i=document.createElement("div");i.innerHTML=`<strong>Poderes Aprendidos:</strong> ${t}/${s} (${r}%)`,i.style.color="#8B4513",i.style.fontSize="14px",i.style.fontWeight="bold",a.appendChild(i),D.appendChild(a)}P.onclick=()=>{M="all",P.style.background="#8B4513",P.style.color="#fff",$.style.background="rgba(139, 69, 19, 0.3)",$.style.color="#ecf0f1",I.style.background="rgba(139, 69, 19, 0.3)",I.style.color="#ecf0f1",R()},$.onclick=()=>{M="learned",P.style.background="rgba(139, 69, 19, 0.3)",P.style.color="#ecf0f1",$.style.background="#8B4513",$.style.color="#fff",I.style.background="rgba(139, 69, 19, 0.3)",I.style.color="#ecf0f1",R()},I.onclick=()=>{M="available",P.style.background="rgba(139, 69, 19, 0.3)",P.style.color="#ecf0f1",$.style.background="rgba(139, 69, 19, 0.3)",$.style.color="#ecf0f1",I.style.background="#8B4513",I.style.color="#fff",R()},R(),b.appendChild(D);const V=document.createElement("div");V.style.display="flex",V.style.flexDirection="column",V.style.gap="15px",[{name:"Azgher",title:"Deus-Sol",shortDescription:"Deus da luz e do calor, venerado por viajantes e combatentes das trevas.",description:"Venerado pelos povos do Deserto da Perdição, o Deus-Sol é também cultuado por viajantes, mercadores honestos e todos aqueles que combatem as trevas. É um deus generoso; sua jornada diária derrama calor e conforto sobre Arton. Azgher é como um pai severo: responsável, provedor, mas que também exige respeito de seus filhos. Como um olho sempre vigilante nos céus, nada acontece à luz do dia sem que Azgher perceba.",beliefs:"Praticar a gratidão pela proteção e generosidade do sol. Promover a honestidade, expor embustes e mentiras. Praticar a caridade e o altruísmo. Proteger os necessitados. Oferecer clemência, perdão e redenção. Combater o mal.",symbol:"Um sol dourado",energy:"Positiva",weapon:"Cimitarra",devotees:"Aggelus, qareen, arcanistas, bárbaros, caçadores, cavaleiros, guerreiros, nobres, paladinos",powers:[{name:"Espada Solar",description:"Você pode gastar 1 PM para fazer uma arma corpo a corpo de corte que esteja empunhada causar +1d6 de dano por fogo até o fim da cena."},{name:"Fulgor Solar",description:"Você recebe redução de frio e trevas 5. Além disso, quando é alvo de um ataque você pode gastar 1 PM para emitir um clarão solar que deixa o atacante ofuscado por uma rodada."},{name:"Habitante do Deserto",description:"Você recebe redução de fogo 10 e pode pagar 1 PM para criar água pura e potável suficiente para um odre (ou outro recipiente pequeno)."},{name:"Inimigo de Tenebra",description:"Seus ataques e habilidades causam +1d6 pontos de dano contra mortos-vivos. Quando você usa um efeito que gera luz, o alcance da iluminação dobra."}],obligations:"O devoto de Azgher deve manter o rosto sempre coberto (com uma máscara, capuz ou trapos). Sua face pode ser revelada apenas ao sumo-sacerdote ou em seu funeral. Devotos do Sol também devem doar para a igreja de Azgher 20% de qualquer tesouro obtido. Essa doação deve ser feita em ouro, seja na forma de moedas ou itens."}].forEach(e=>{const a=Ie()===e.name,o=document.createElement("div");o.style.background=a?"#2d4a3e":"#23243a",o.style.border="2px solid "+(a?"#4caf50":"#6ec6ff"),o.style.borderRadius="8px",o.style.padding="10px",o.style.cursor="pointer",o.style.transition="all 0.3s",o.style.width="100%",o.style.boxSizing="border-box",o.onmouseover=()=>{a||(o.style.background="#2a2b4a")},o.onmouseout=()=>{a||(o.style.background="#23243a")},o.onclick=()=>{!function(e){const a=document.getElementById("divinity-detail-modal");a&&a.remove();const o=document.getElementById("divinity-detail-overlay");o&&o.remove();const t=document.createElement("div");t.id="divinity-detail-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="divinity-detail-modal",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #8B4513",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="800px",s.style.maxHeight="85vh",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px",r.style.borderBottom="1px solid rgba(139, 69, 19, 0.3)",r.style.paddingBottom="15px";const n=document.createElement("h2");n.innerHTML=`☀️ ${e.name} - ${e.title}`,n.style.color="#8B4513",n.style.margin="0",n.style.fontSize="24px",n.style.fontWeight="bold";const i=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove(),t.remove()}});r.appendChild(n),r.appendChild(i.render()),s.appendChild(r);const c=document.createElement("div");c.style.marginBottom="20px",c.style.padding="15px",c.style.background="rgba(139, 69, 19, 0.1)",c.style.borderRadius="8px",c.style.border="1px solid rgba(139, 69, 19, 0.2)";const d=document.createElement("h3");d.textContent="Descrição",d.style.color="#8B4513",d.style.fontSize="16px",d.style.fontWeight="bold",d.style.marginBottom="10px";const l=document.createElement("div");l.textContent=e.description,l.style.color="#ecf0f1",l.style.fontSize="14px",l.style.lineHeight="1.6",c.appendChild(d),c.appendChild(l),s.appendChild(c);const m=document.createElement("div");m.style.marginBottom="20px";const u=document.createElement("h3");u.textContent="Informações da Divindade",u.style.color="#8B4513",u.style.fontSize="16px",u.style.fontWeight="bold",u.style.marginBottom="15px",u.style.borderBottom="2px solid rgba(139, 69, 19, 0.3)",u.style.paddingBottom="8px",m.appendChild(u);const p=document.createElement("div");p.style.display="grid",p.style.gridTemplateColumns="1fr 1fr",p.style.gap="12px";[{label:"Crenças e Objetivos",value:e.beliefs},{label:"Símbolo Sagrado",value:e.symbol},{label:"Canalizar Energia",value:e.energy},{label:"Arma Preferida",value:e.weapon},{label:"Devotos",value:e.devotees}].forEach(e=>{const a=document.createElement("div");a.style.background="rgba(139, 69, 19, 0.1)",a.style.padding="12px",a.style.borderRadius="8px",a.style.border="1px solid rgba(139, 69, 19, 0.2)";const o=document.createElement("div");o.textContent=e.label,o.style.color="#8B4513",o.style.fontSize="12px",o.style.fontWeight="bold",o.style.marginBottom="5px";const t=document.createElement("div");t.textContent=e.value,t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.lineHeight="1.4",a.appendChild(o),a.appendChild(t),p.appendChild(a)}),m.appendChild(p),s.appendChild(m);const g=document.createElement("div");g.style.marginBottom="20px",g.style.padding="15px",g.style.background="rgba(255, 167, 38, 0.1)",g.style.borderRadius="8px",g.style.border="1px solid rgba(255, 167, 38, 0.3)";const f=document.createElement("h3");f.textContent="Obrigações & Restrições",f.style.color="#ffa726",f.style.fontSize="16px",f.style.fontWeight="bold",f.style.marginBottom="10px";const v=document.createElement("div");v.textContent=e.obligations,v.style.color="#ecf0f1",v.style.fontSize="14px",v.style.lineHeight="1.6",g.appendChild(f),g.appendChild(v),s.appendChild(g);const y=document.createElement("div");y.style.marginBottom="20px";const b=document.createElement("h3");b.textContent="Poderes Concedidos",b.style.color="#8B4513",b.style.fontSize="16px",b.style.fontWeight="bold",b.style.marginBottom="15px",b.style.borderBottom="2px solid rgba(139, 69, 19, 0.3)",b.style.paddingBottom="8px",y.appendChild(b);const h=document.createElement("div");h.style.display="flex",h.style.flexDirection="column",h.style.gap="10px";let x=De();if(e.powers&&0!==e.powers.length)e.powers.forEach(e=>{const a=x===e.name,o=document.createElement("div");o.style.background=a?"#2d4a3e":"#23243a",o.style.border="1px solid "+(a?"#4caf50":"#6ec6ff"),o.style.borderRadius="8px",o.style.padding="12px",o.style.cursor="pointer",o.style.transition="all 0.2s",o.onmouseover=()=>{a||(o.style.background="#2a2b4a")},o.onmouseout=()=>{a||(o.style.background="#23243a")},o.onclick=()=>{const a=h.querySelector(".selected-power");a&&(a.classList.remove("selected-power"),a.style.background="#23243a",a.style.border="1px solid #6ec6ff"),o.classList.add("selected-power"),o.style.background="#2d4a3e",o.style.border="1px solid #4caf50",x=e.name};const t=document.createElement("div");t.style.display="flex",t.style.justifyContent="flex-start",t.style.alignItems="center",t.style.marginBottom="6px";const s=document.createElement("div");s.textContent=e.name,s.style.color=a?"#4caf50":"#6ec6ff",s.style.fontSize="14px",s.style.fontWeight="bold",t.appendChild(s),o.appendChild(t);const r=document.createElement("div");r.textContent=e.description,r.style.color="#ecf0f1",r.style.fontSize="12px",r.style.lineHeight="1.4",o.appendChild(r),h.appendChild(o)});else{const e=document.createElement("div");e.style.textAlign="center",e.style.padding="20px",e.style.color="#8B4513",e.style.fontSize="14px",e.style.fontStyle="italic",e.style.background="rgba(139, 69, 19, 0.1)",e.style.border="1px solid rgba(139, 69, 19, 0.3)",e.style.borderRadius="8px",e.style.marginTop="10px",e.innerHTML='\n                    <div style="margin-bottom: 8px;">🙏</div>\n                    <div>Nenhum poder concedido disponível</div>\n                    <div style="margin-top: 8px; font-size: 12px;">Esta divindade não possui poderes especiais</div>\n                ',h.appendChild(e)}y.appendChild(h),s.appendChild(y);const C=document.createElement("div");C.style.display="flex",C.style.gap="12px",C.style.justifyContent="center",C.style.marginTop="20px";const w=Ie()===e.name,q=w?"Remover Divindade":"Definir como Divindade Atual",E=w?"#f44336":"#4caf50",z=document.createElement("button");z.textContent=q,z.style.padding="12px 24px",z.style.background=E,z.style.color="#fff",z.style.border="none",z.style.borderRadius="8px",z.style.fontSize="14px",z.style.fontWeight="bold",z.style.cursor="pointer",z.style.transition="all 0.2s",z.onmouseover=()=>{z.style.opacity="0.8"},z.onmouseout=()=>{z.style.opacity="1"},z.onclick=()=>{w?(Te(null),Me(null)):(Te(e.name),x&&Me(x)),s.remove(),t.remove(),ze()},C.appendChild(z),s.appendChild(C),document.body.appendChild(s),S(s,"brown")}(e)};const t=document.createElement("div");t.style.display="flex",t.style.justifyContent="space-between",t.style.alignItems="center",t.style.marginBottom="8px";const s=document.createElement("div");s.innerHTML=`<strong style="color: ${a?"#4caf50":"#6ec6ff"}; font-size: 15px;">${e.name}</strong><br><em style="color: #ecf0f1; font-size: 12px;">${e.title}</em>`;const r=document.createElement("div");r.textContent=a?"✓ Selecionada":"Clique para ver detalhes",r.style.color=a?"#4caf50":"#6ec6ff",r.style.fontSize="11px",r.style.fontWeight="bold",r.style.fontStyle="italic",t.appendChild(s),t.appendChild(r),o.appendChild(t);const n=document.createElement("div");n.textContent=e.shortDescription,n.style.color="#ecf0f1",n.style.fontSize="11px",n.style.lineHeight="1.4",o.appendChild(n),V.appendChild(o)}),x.appendChild(V);const B=document.createElement("div");function N(e){const a=document.getElementById("race-detail-modal");a&&a.remove();const o=document.getElementById("race-detail-overlay");o&&o.remove();const t=document.createElement("div");t.id="race-detail-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="race-detail-modal",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #8B4513",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="800px",s.style.maxHeight="85vh",s.style.overflowY="auto",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="20px",r.style.borderBottom="1px solid rgba(139, 69, 19, 0.3)",r.style.paddingBottom="15px";const n=document.createElement("h2");n.innerHTML=`👥 ${e.name} - ${e.title}`,n.style.color="#8B4513",n.style.margin="0",n.style.fontSize="24px",n.style.fontWeight="bold";const i=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove(),t.remove()}});r.appendChild(n),r.appendChild(i.render()),s.appendChild(r);const c=document.createElement("div");c.style.marginBottom="20px",c.style.padding="15px",c.style.background="rgba(139, 69, 19, 0.1)",c.style.borderRadius="8px",c.style.border="1px solid rgba(139, 69, 19, 0.2)";const d=document.createElement("h3");d.textContent="Descrição",d.style.color="#8B4513",d.style.fontSize="16px",d.style.fontWeight="bold",d.style.marginBottom="10px";const l=document.createElement("div");l.textContent=e.description,l.style.color="#ecf0f1",l.style.fontSize="14px",l.style.lineHeight="1.6",c.appendChild(d),c.appendChild(l),s.appendChild(c);const m=document.createElement("div");m.style.marginBottom="20px";const u=document.createElement("h3");u.textContent="Características da Raça",u.style.color="#8B4513",u.style.fontSize="16px",u.style.fontWeight="bold",u.style.marginBottom="15px",u.style.borderBottom="2px solid rgba(139, 69, 19, 0.3)",u.style.paddingBottom="8px",m.appendChild(u);const p=document.createElement("div");p.style.display="grid",p.style.gridTemplateColumns="1fr 1fr",p.style.gap="12px",[{label:"Atributos",value:e.attributes},{label:"Herança",value:e.heritage}].forEach(e=>{const a=document.createElement("div");a.style.background="rgba(139, 69, 19, 0.1)",a.style.padding="12px",a.style.borderRadius="8px",a.style.border="1px solid rgba(139, 69, 19, 0.2)";const o=document.createElement("div");o.textContent=e.label,o.style.color="#8B4513",o.style.fontSize="12px",o.style.fontWeight="bold",o.style.marginBottom="5px";const t=document.createElement("div");t.textContent=e.value,t.style.color="#ecf0f1",t.style.fontSize="13px",t.style.lineHeight="1.4",a.appendChild(o),a.appendChild(t),p.appendChild(a)}),m.appendChild(p),s.appendChild(m);const g=document.createElement("div");g.style.marginBottom="20px";const f=document.createElement("h3");f.textContent="Tipos de Raça",f.style.color="#8B4513",f.style.fontSize="16px",f.style.fontWeight="bold",f.style.marginBottom="15px",f.style.borderBottom="2px solid rgba(139, 69, 19, 0.3)",f.style.paddingBottom="8px",g.appendChild(f);const v=document.createElement("div");if(v.style.display="flex",v.style.flexDirection="column",v.style.gap="15px",e.types&&0!==e.types.length)e.types.forEach(a=>{const o=Ve()===e.name&&Ne()===a.name,r=document.createElement("div");r.style.background=o?"rgba(76, 175, 80, 0.1)":"rgba(139, 69, 19, 0.1)",r.style.border=o?"2px solid #4caf50":"1px solid rgba(139, 69, 19, 0.3)",r.style.borderRadius="10px",r.style.padding="15px",r.style.cursor="pointer",r.style.transition="all 0.2s",r.onclick=()=>{Be(e.name),Oe(a.name),s.remove(),t.remove(),setTimeout(()=>{N(e)},100)},r.onmouseover=()=>{o||(r.style.background="rgba(139, 69, 19, 0.2)",r.style.border="1px solid rgba(139, 69, 19, 0.5)")},r.onmouseout=()=>{o||(r.style.background="rgba(139, 69, 19, 0.1)",r.style.border="1px solid rgba(139, 69, 19, 0.3)")};const n=document.createElement("div");n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.marginBottom="10px";const i=document.createElement("div");i.innerHTML=`<strong style="color: ${o?"#4caf50":"#6ec6ff"}; font-size: 16px;">${a.name}</strong><br><em style="color: #ecf0f1; font-size: 12px;">${a.title}</em>`;const c=document.createElement("div");o?(c.innerHTML="✓ Selecionado",c.style.color="#4caf50"):(c.innerHTML="Clique para selecionar",c.style.color="#6ec6ff"),c.style.fontSize="12px",c.style.fontWeight="bold",c.style.fontStyle="italic",n.appendChild(i),n.appendChild(c),r.appendChild(n);const d=document.createElement("div");d.textContent=a.description,d.style.color="#ecf0f1",d.style.fontSize="13px",d.style.lineHeight="1.4",r.appendChild(d),v.appendChild(r)});else{const e=document.createElement("div");e.style.textAlign="center",e.style.padding="20px",e.style.color="#8B4513",e.style.fontSize="14px",e.style.fontStyle="italic",e.style.background="rgba(139, 69, 19, 0.1)",e.style.border="1px solid rgba(139, 69, 19, 0.3)",e.style.borderRadius="8px",e.style.marginTop="10px",e.innerHTML='\n                    <div style="margin-bottom: 8px;">👥</div>\n                    <div>Nenhum tipo de raça disponível</div>\n                    <div style="margin-top: 8px; font-size: 12px;">Esta raça não possui subtipos especiais</div>\n                ',v.appendChild(e)}g.appendChild(v),s.appendChild(g);const y=document.createElement("div");y.style.display="flex",y.style.gap="12px",y.style.justifyContent="center",y.style.marginTop="20px";const b=Ve()===e.name,h=b?"Remover Raça":"Definir como Raça Atual",x=b?"#f44336":"#4caf50",C=document.createElement("button");C.textContent=h,C.style.padding="12px 24px",C.style.background=x,C.style.color="#fff",C.style.border="none",C.style.borderRadius="8px",C.style.fontSize="14px",C.style.fontWeight="bold",C.style.cursor="pointer",C.style.transition="all 0.2s",C.onmouseover=()=>{C.style.opacity="0.8"},C.onmouseout=()=>{C.style.opacity="1"},C.onclick=()=>{b?(Be(null),Oe(null)):Be(e.name),s.remove(),t.remove(),ze()},y.appendChild(C),s.appendChild(y),document.body.appendChild(s),S(s,"brown")}B.style.display="flex",B.style.flexDirection="column",B.style.gap="15px",[{name:"Suraggel",title:"Descendentes de Extraplanares Divinos",shortDescription:"Seres com traços angelicais ou demoníacos, ligados às forças opostas da luz e trevas.",description:"Descendentes de extraplanares divinos, esta raça é formada por seres com traços angelicais ou demoníacos — ou ambos. Por serem ligados às forças opostas da luz e trevas, suraggel têm traços diferentes quando orientados para seu lado celestial, sendo então conhecidos como aggelus; ou para o lado abissal, assim sendo chamados sulfure. Sua natureza em geral combina com a ascendência, lembrando habitantes dos Mundos dos Deuses, mas eles também podem ser surpreendentes e contraditórios: não se espante muito ao conhecer um aggelus ladino ou um sulfure paladino.",attributes:"Sabedoria +2, Carisma +1 (Aggelus); Destreza +2, Inteligência +1 (Sulfure)",heritage:"Herança Divina. Você é uma criatura do tipo espírito e recebe visão no escuro.",types:[{name:"Aggelus",title:"Lado Celestial",description:"Você recebe +2 em Diplomacia e Intuição. Além disso, pode lançar Luz (como uma magia divina; atributo-chave Carisma). Caso aprenda novamente essa magia, seu custo diminui em –1 PM.",power:"Luz Sagrada"},{name:"Sulfure",title:"Lado Abissal",description:"Você recebe +2 em Enganação e Furtividade. Além disso, pode lançar Escuridão (como uma magia divina; atributo-chave Inteligência). Caso aprenda novamente essa magia, seu custo diminui em –1 PM.",power:"Sombras Profanas"}]}].forEach(e=>{const a=Ve()===e.name,o=Ne(),t=document.createElement("div");t.style.background=a?"rgba(76, 175, 80, 0.1)":"rgba(139, 69, 19, 0.1)",t.style.border=a?"2px solid #4caf50":"1px solid rgba(139, 69, 19, 0.3)",t.style.borderRadius="8px",t.style.padding="10px",t.style.cursor="pointer",t.style.transition="all 0.2s",t.style.width="100%",t.style.boxSizing="border-box",t.onclick=()=>{a?N(e):(Be(e.name),N(e),setTimeout(()=>{const e=new Event("race-selection-changed");document.dispatchEvent(e)},100))},t.onmouseover=()=>{a||(t.style.background="rgba(139, 69, 19, 0.2)",t.style.border="1px solid rgba(139, 69, 19, 0.5)")},t.onmouseout=()=>{a||(t.style.background="rgba(139, 69, 19, 0.1)",t.style.border="1px solid rgba(139, 69, 19, 0.3)")};const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="flex-start",s.style.marginBottom="8px";const r=document.createElement("div");r.innerHTML=`<strong style="color: ${a?"#4caf50":"#6ec6ff"}; font-size: 15px;">${e.name}</strong><br><em style="color: #ecf0f1; font-size: 12px;">${e.title}</em>`;const n=document.createElement("div");a?n.innerHTML=o?`✓ Selecionada<br><small style="color: #4caf50;">${o}</small>`:'✓ Selecionada<br><small style="color: #ffa726;">Tipo não definido</small>':n.textContent="Clique para ver detalhes",n.style.color=a?"#4caf50":"#6ec6ff",n.style.fontSize="11px",n.style.fontWeight="bold",n.style.fontStyle="italic",n.style.textAlign="right",s.appendChild(r),s.appendChild(n),t.appendChild(s);const i=document.createElement("div");i.textContent=e.shortDescription,i.style.color="#ecf0f1",i.style.fontSize="11px",i.style.lineHeight="1.4",t.appendChild(i),B.appendChild(t)}),w.appendChild(B);const O=[{name:"Marca da Presa",description:"Você pode gastar uma ação de movimento e 1 PM para analisar uma criatura em alcance curto. Até o fim da cena, você recebe +1d4 nas rolagens de dano contra essa criatura. A cada quatro níveis, você pode gastar +1 PM para aumentar o bônus de dano (veja a tabela da classe).",level:"1º nível"},{name:"Rastreador",description:"Você recebe +2 em Sobrevivência. Além disso, pode se mover com seu deslocamento normal enquanto rastreia sem sofrer penalidades no teste de Sobrevivência.",level:"1º nível"},{name:"Ambidestria",description:"Se estiver empunhando duas armas (e pelo menos uma delas for leve) e fizer a ação agredir, você pode fazer dois ataques, um com cada arma. Se fizer isso, sofre –2 em todos os testes de ataque até o seu próximo turno.",level:"Poder de Caçador",prereq:"Des 2"},{name:"Armadilha: Arataca",description:"A vítima sofre 2d6 pontos de dano de perfuração e fica agarrada. Uma criatura agarrada pode escapar com uma ação padrão e um teste de Força ou Acrobacia (CD Sab).",level:"Poder de Caçador"},{name:"Armadilha: Espinhos",description:"A vítima sofre 6d6 pontos de dano de perfuração. Um teste de Reflexos (CD Sab) reduz o dano à metade.",level:"Poder de Caçador"},{name:"Armadilha: Laço",description:"A vítima deve fazer um teste de Reflexos (CD Sab). Se passar, fica caída. Se falhar, fica agarrada. Uma criatura agarrada pode se soltar com uma ação padrão e um teste de Força ou Acrobacia (CD Sab).",level:"Poder de Caçador"},{name:"Armadilha: Rede",description:"Todas as criaturas na área ficam enredadas e não podem sair da área. Uma vítima pode se libertar com uma ação padrão e um teste de Força ou Acrobacia (CD 25). Além disso, a área ocupada pela rede é considerada terreno difícil. Nesta armadilha você escolhe quantas criaturas precisam estar na área para ativá-la.",level:"Poder de Caçador"},{name:"Armadilheiro",description:"Você soma sua Sabedoria no dano e na CD de suas armadilhas (cumulativo).",level:"Poder de Caçador",prereq:"um poder de armadilha, 5º nível de caçador"},{name:"Arqueiro",description:"Se estiver usando uma arma de ataque à distância, você soma sua Sabedoria nas rolagens de dano (limitado pelo seu nível).",level:"Poder de Caçador",prereq:"Sab 1"},{name:"Aumento de Atributo",description:"Você recebe +1 em um atributo. Você pode escolher este poder várias vezes, mas apenas uma vez por patamar para um mesmo atributo.",level:"Poder de Caçador"},{name:"Bote",description:"Se estiver empunhando duas armas e fizer uma investida, você pode pagar 1 PM para fazer um ataque adicional com sua arma secundária.",level:"Poder de Caçador",prereq:"Ambidestria, 6º nível de caçador"},{name:"Camuflagem",description:"Você pode gastar 2 PM para se esconder mesmo sem camuflagem ou cobertura disponível.",level:"Poder de Caçador",prereq:"6º nível de caçador"},{name:"Chuva de Lâminas",description:"Uma vez por rodada, quando usa Ambidestria, você pode pagar 2 PM para fazer um ataque adicional com sua arma primária.",level:"Poder de Caçador",prereq:"Des 4, Ambidestria, 12º nível de caçador"},{name:"Companheiro Animal",description:"Você recebe um companheiro animal. Veja o quadro na página 62.",level:"Poder de Caçador",prereq:"Car 1, treinado em Adestramento"},{name:"Elo com a Natureza",description:"Você soma sua Sabedoria em seu total de pontos de mana e aprende e pode lançar Caminhos da Natureza (atributo-chave Sabedoria).",level:"Poder de Caçador",prereq:"Sab 1, 3º nível de caçador"},{name:"Emboscar",description:"Você pode gastar 2 PM para realizar uma ação padrão adicional em seu turno. Você só pode usar este poder na primeira rodada de um combate.",level:"Poder de Caçador",prereq:"treinado em Furtividade"},{name:"Empatia Selvagem",description:"Você pode se comunicar com animais por meio de linguagem corporal e vocalizações. Você pode usar Adestramento com animais para mudar atitude e persuasão (veja Diplomacia, na página 118).",level:"Poder de Caçador"},{name:"Escaramuça",description:"Quando se move 6m ou mais, você recebe +2 na Defesa e Reflexos e +1d8 nas rolagens de dano de ataques corpo a corpo e à distância em alcance curto até o início de seu próximo turno. Você não pode usar esta habilidade se estiver vestindo armadura pesada.",level:"Poder de Caçador",prereq:"Des 2, 6º nível de caçador"},{name:"Escaramuça Superior",description:"Quando usa Escaramuça, seus bônus aumentam para +5 na Defesa e Reflexos e +1d12 em rolagens de dano.",level:"Poder de Caçador",prereq:"Escaramuça, 12º nível de caçador"},{name:"Espreitar",description:"Quando usa a habilidade Marca da Presa, você recebe um bônus de +1 em testes de perícia contra a criatura marcada. Esse bônus aumenta em +1 para cada PM adicional gasto na habilidade e também dobra com a habilidade Inimigo.",level:"Poder de Caçador"},{name:"Ervas Curativas",description:"Você pode gastar uma ação completa e uma quantidade de PM a sua escolha (limitado por sua Sabedoria) para aplicar ervas que curam ou desintoxicam em você ou num aliado adjacente. Para cada PM que gastar, cura 2d6 PV ou remove uma condição envenenado afetando o alvo.",level:"Poder de Caçador"},{name:"Ímpeto",description:"Você pode gastar 1 PM para aumentar seu deslocamento em +6m por uma rodada.",level:"Poder de Caçador"},{name:"Inimigo de (Criatura)",description:"Escolha um tipo de criatura entre animal, construto, espírito, monstro ou morto-vivo, ou duas raças humanoides (por exemplo, orcs e gnolls, ou elfos e qareen). Quando você usa a habilidade Marca da Presa contra uma criatura do tipo ou da raça escolhida, dobra os dados de bônus no dano. O nome desta habilidade varia de acordo com o tipo de criatura escolhida (Inimigo de Monstros, Inimigo de Mortos-Vivos etc.). Você pode escolher este poder outras vezes para inimigos diferentes.",level:"Poder de Caçador"},{name:"Olho do Falcão",description:"Você pode usar a habilidade Marca da Presa em criaturas em alcance longo.",level:"Poder de Caçador"},{name:"Ponto Fraco",description:"Quando usa a habilidade Marca da Presa, seus ataques contra a criatura marcada recebem +2 na margem de ameaça. Esse bônus dobra com a habilidade Inimigo.",level:"Poder de Caçador"},{name:"Explorador",description:"No 3º nível, escolha um tipo de terreno entre aquático, ártico, colina, deserto, floresta, montanha, pântano, planície, subterrâneo ou urbano. A partir do 11º nível, você também pode escolher área de Tormenta. Quando estiver no tipo de terreno escolhido, você soma sua Sabedoria (mínimo +1) na Defesa e nos testes de Acrobacia, Atletismo, Furtividade, Percepção e Sobrevivência. A cada quatro níveis, escolha outro tipo de terreno para receber o bônus ou aumente o bônus em um tipo de terreno já escolhido em +2.",level:"3º nível"},{name:"Caminho do Explorador",description:"No 5º nível, você pode atravessar terrenos difíceis sem sofrer redução em seu deslocamento e a CD para rastrear você aumenta em +10. Esta habilidade só funciona em terrenos nos quais você tenha a habilidade Explorador.",level:"5º nível"},{name:"Mestre Caçador",description:"No 20º nível, você pode usar a habilidade Marca da Presa como uma ação livre. Além disso, quando usa a habilidade, pode pagar 5 PM para aumentar sua margem de ameaça contra a criatura em +2. Se você reduz uma criatura contra a qual usou Marca da Presa a 0 pontos de vida, recupera 5 PM.",level:"20º nível"}],F=document.createElement("div");F.style.marginBottom="15px",F.style.padding="12px",F.style.background="rgba(139, 69, 19, 0.1)",F.style.borderRadius="8px",F.style.border="1px solid rgba(139, 69, 19, 0.2)";const U=document.createElement("div");U.style.position="relative",U.style.marginBottom="10px";const W=document.createElement("input");W.type="text",W.placeholder="Filtrar poderes...",W.style.width="100%",W.style.padding="10px 28px 10px 12px",W.style.borderRadius="8px",W.style.border="1px solid #6ec6ff",W.style.background="#23243a",W.style.color="#fff",W.style.fontSize="14px",W.style.outline="none",W.style.boxSizing="border-box";const Q=document.createElement("span");Q.textContent="×",Q.style.position="absolute",Q.style.right="8px",Q.style.top="50%",Q.style.transform="translateY(-50%)",Q.style.cursor="pointer",Q.style.color="#6ec6ff",Q.style.fontSize="18px",Q.style.display="none",Q.onclick=()=>{W.value="",W.dispatchEvent(new Event("input")),W.focus()},W.oninput=()=>{oe=W.value,W.value.length>0?Q.style.display="block":Q.style.display="none",se()},U.appendChild(W),U.appendChild(Q);const Y=document.createElement("div");Y.style.display="flex",Y.style.gap="10px",Y.style.flexWrap="wrap";const X=document.createElement("button");X.textContent="Todas",X.style.padding="6px 12px",X.style.background="#8B4513",X.style.color="#fff",X.style.border="none",X.style.borderRadius="6px",X.style.fontSize="12px",X.style.fontWeight="bold",X.style.cursor="pointer",X.style.transition="all 0.2s";const Z=document.createElement("button");Z.textContent="Aprendidas",Z.style.padding="6px 12px",Z.style.background="rgba(139, 69, 19, 0.3)",Z.style.color="#ecf0f1",Z.style.border="none",Z.style.borderRadius="6px",Z.style.fontSize="12px",Z.style.fontWeight="bold",Z.style.cursor="pointer",Z.style.transition="all 0.2s";const ee=document.createElement("button");ee.textContent="Disponíveis",ee.style.padding="6px 12px",ee.style.background="rgba(139, 69, 19, 0.3)",ee.style.color="#ecf0f1",ee.style.border="none",ee.style.borderRadius="6px",ee.style.fontSize="12px",ee.style.fontWeight="bold",ee.style.cursor="pointer",ee.style.transition="all 0.2s",Y.appendChild(X),Y.appendChild(Z),Y.appendChild(ee),F.appendChild(U),F.appendChild(Y),v.appendChild(F);const ae=document.createElement("div");ae.id="abilities-list-container",v.appendChild(ae);let oe="",te="all";function se(){const e=L(),a=["Marca da Presa","Rastreador"],o=parseInt(localStorage.getItem(T)||"1",10)||1,t=J(o);ae.innerHTML="";const s=O.filter(e=>{const a=e.name.toLowerCase().includes(oe.toLowerCase())||e.description.toLowerCase().includes(oe.toLowerCase());let t=!0;return"learned"===te?t=K(e.name):"available"===te&&(t=!K(e.name)&&G(e.name,o)),a&&t});if(0===s.length){const e=document.createElement("div");if(e.style.textAlign="center",e.style.padding="20px",e.style.color="#8B4513",e.style.fontSize="14px",e.style.fontStyle="italic",e.style.background="rgba(139, 69, 19, 0.1)",e.style.border="1px solid rgba(139, 69, 19, 0.3)",e.style.borderRadius="8px",e.style.marginTop="10px",oe){const e=ye(oe,"habilidade","brown");return void ae.appendChild(e)}return e.innerHTML='\n                            <div style="margin-bottom: 8px;">🏹</div>\n                            <div>Nenhuma habilidade disponível</div>\n                            <div style="margin-top: 8px; font-size: 12px;">Selecione uma classe para obter habilidades especiais</div>\n                        ',void ae.appendChild(e)}if(s.forEach(e=>{const s=document.createElement("div"),r=a.includes(e.name),n=t.includes(e.name),i=K(e.name),c=G(e.name,o);let d,l,m;r?(d="rgba(76, 175, 80, 0.15)",l="rgba(76, 175, 80, 0.4)",m="#4CAF50"):n?(d="rgba(156, 39, 176, 0.15)",l="rgba(156, 39, 176, 0.4)",m="#9C27B0"):i?(d="rgba(76, 175, 80, 0.1)",l="rgba(76, 175, 80, 0.3)",m="#4CAF50"):(d="rgba(139, 69, 19, 0.1)",l="rgba(139, 69, 19, 0.2)",m="#8B4513"),s.style.marginBottom="15px",s.style.padding="12px",s.style.background=d,s.style.borderRadius="8px",s.style.border=`1px solid ${l}`,s.style.transition="all 0.2s";const u=document.createElement("div");u.style.display="flex",u.style.justifyContent="space-between",u.style.alignItems="flex-start",u.style.marginBottom="8px",u.style.flexWrap="wrap",u.style.gap="10px";const p=document.createElement("div");if(p.style.display="flex",p.style.alignItems="center",p.style.gap="8px",p.style.flex="1",!r&&!n){const a=document.createElement("input");a.type="checkbox",a.checked=i,a.style.width="16px",a.style.height="16px",a.style.accentColor="#8B4513",a.style.cursor="pointer","Companheiro Animal"===e.name?a.onchange=()=>{if(H(e.name),a.checked){const e=document.getElementById("animal-companion-modal");e&&e.remove();const a=document.getElementById("animal-companion-overlay");a&&a.remove();const o=document.createElement("div");o.id="animal-companion-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="animal-companion-modal",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="24px 28px",t.style.zIndex="10001",t.style.maxWidth="340px",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("h3");s.textContent="Tipo de Companheiro Animal",s.style.color="#ecf0f1",s.style.margin="0 0 18px 0",s.style.fontSize="17px",s.style.fontWeight="bold",t.appendChild(s);const r=document.createElement("button");r.textContent="Assassino",r.style.background="#6ec6ff",r.style.color="#23243a",r.style.border="none",r.style.borderRadius="8px",r.style.fontSize="15px",r.style.fontWeight="bold",r.style.padding="12px 0",r.style.cursor="pointer",r.style.marginBottom="10px",r.onmouseover=()=>{r.style.background="#5bb8ff"},r.onmouseout=()=>{r.style.background="#6ec6ff"},r.onclick=()=>{Ae("assassino"),o.remove(),t.remove(),se()},t.appendChild(r);const n=window.Roll20Components.createCloseButton({customStyles:"position: absolute; top: 8px; right: 12px;",onClick:()=>{o.remove(),t.remove()}});t.appendChild(n.render()),document.body.appendChild(t)}else Ae("");se()}:a.onchange=()=>{H(e.name),se()},p.appendChild(a)}const g=document.createElement("div");if(g.textContent=e.name,g.style.color=m,g.style.fontSize="15px",g.style.fontWeight="bold","Companheiro Animal"===e.name&&i&&"assassino"===Pe()){const e=document.createElement("span");e.textContent="Assassino",e.style.background="#6ec6ff",e.style.color="#23243a",e.style.borderRadius="8px",e.style.padding="2px 10px",e.style.fontSize="12px",e.style.fontWeight="bold",e.style.marginLeft="8px",e.style.display="inline-block",e.style.letterSpacing="0.5px",e.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)",g.appendChild(e)}p.appendChild(g);const f=document.createElement("div");f.textContent=e.level,f.style.color="#6ec6ff",f.style.fontSize="12px",f.style.fontWeight="bold",f.style.fontStyle="italic",u.appendChild(p),u.appendChild(f);const v=document.createElement("div");if(v.textContent=e.description,v.style.color="#ecf0f1",v.style.fontSize="13px",v.style.lineHeight="1.4",v.style.marginBottom="5px",s.appendChild(u),s.appendChild(v),e.prereq){const a=document.createElement("div");a.textContent=`Pré-requisito: ${e.prereq}`,a.style.color="#ffa726",a.style.fontSize="11px",a.style.fontStyle="italic",a.style.fontWeight="bold",s.appendChild(a)}const y=document.createElement("div");if(y.style.marginTop="5px",y.style.display="flex",y.style.gap="8px",y.style.flexWrap="wrap",r){const e=document.createElement("div");e.innerHTML="🔄 Automática",e.style.color="#4CAF50",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",y.appendChild(e)}else if(n){const e=document.createElement("div");e.innerHTML="⭐ Especial",e.style.color="#9C27B0",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",y.appendChild(e)}else if(i){const e=document.createElement("div");e.innerHTML="✓ Aprendida",e.style.color="#4CAF50",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",y.appendChild(e)}else if(c){const e=document.createElement("div");e.innerHTML="📋 Disponível",e.style.color="#8B4513",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.fontStyle="italic",y.appendChild(e)}y.children.length>0&&s.appendChild(y),ae.appendChild(s)}),0===s.length&&oe.length>0){const e=ye(oe,"habilidade","blue");ae.appendChild(e)}const r=document.createElement("div");r.style.marginTop="15px",r.style.padding="10px",r.style.background="rgba(26,26,46,0.8)",r.style.borderRadius="8px",r.style.border="1px solid rgba(139, 69, 19, 0.3)",r.style.textAlign="center";const n=e.length,i=O.length,c=Math.round(n/i*100),d=document.createElement("div");d.innerHTML=`<strong>Habilidades Aprendidas:</strong> ${n}/${i} (${c}%)`,d.style.color="#8B4513",d.style.fontSize="14px",d.style.fontWeight="bold",r.appendChild(d),ae.appendChild(r)}function re(e){p.style.display="none",v.style.display="none",b.style.display="none",x.style.display="none",w.style.display="none",u.style.background="rgba(139, 69, 19, 0.3)",u.style.color="#ecf0f1",f.style.background="rgba(139, 69, 19, 0.3)",f.style.color="#ecf0f1",y.style.background="rgba(139, 69, 19, 0.3)",y.style.color="#ecf0f1",h.style.background="rgba(139, 69, 19, 0.3)",h.style.color="#ecf0f1",C.style.background="rgba(139, 69, 19, 0.3)",C.style.color="#ecf0f1",1===e?(p.style.display="block",u.style.background="#8B4513",u.style.color="#fff"):2===e?(v.style.display="block",f.style.background="#8B4513",f.style.color="#fff"):3===e?(b.style.display="block",y.style.background="#8B4513",y.style.color="#fff"):4===e?(x.style.display="block",h.style.background="#8B4513",h.style.color="#fff"):5===e&&(w.style.display="block",C.style.background="#8B4513",C.style.color="#fff")}X.onclick=()=>{te="all",X.style.background="#8B4513",X.style.color="#fff",Z.style.background="rgba(139, 69, 19, 0.3)",Z.style.color="#ecf0f1",ee.style.background="rgba(139, 69, 19, 0.3)",ee.style.color="#ecf0f1",se()},Z.onclick=()=>{te="learned",X.style.background="rgba(139, 69, 19, 0.3)",X.style.color="#ecf0f1",Z.style.background="#8B4513",Z.style.color="#fff",ee.style.background="rgba(139, 69, 19, 0.3)",ee.style.color="#ecf0f1",se()},ee.onclick=()=>{te="available",X.style.background="rgba(139, 69, 19, 0.3)",X.style.color="#ecf0f1",Z.style.background="rgba(139, 69, 19, 0.3)",Z.style.color="#ecf0f1",ee.style.background="#8B4513",ee.style.color="#fff",se()},se(),u.onclick=()=>re(1),f.onclick=()=>re(2),y.onclick=()=>re(3),h.onclick=()=>re(4),C.onclick=()=>re(5),u.onmouseover=()=>{"none"===p.style.display&&(u.style.background="rgba(139, 69, 19, 0.5)")},u.onmouseout=()=>{"none"===p.style.display&&(u.style.background="rgba(139, 69, 19, 0.3)")},f.onmouseover=()=>{"none"===v.style.display&&(f.style.background="rgba(139, 69, 19, 0.5)")},f.onmouseout=()=>{"none"===v.style.display&&(f.style.background="rgba(139, 69, 19, 0.3)")},y.onmouseover=()=>{"none"===b.style.display&&(y.style.background="rgba(139, 69, 19, 0.5)")},y.onmouseout=()=>{"none"===b.style.display&&(y.style.background="rgba(139, 69, 19, 0.3)")},h.onmouseover=()=>{"none"===x.style.display&&(h.style.background="rgba(139, 69, 19, 0.5)")},h.onmouseout=()=>{"none"===x.style.display&&(h.style.background="rgba(139, 69, 19, 0.3)")},C.onmouseover=()=>{"none"===w.style.display&&(C.style.background="rgba(139, 69, 19, 0.5)")},C.onmouseout=()=>{"none"===w.style.display&&(C.style.background="rgba(139, 69, 19, 0.3)")},l.appendChild(u),l.appendChild(f),l.appendChild(y),l.appendChild(h),l.appendChild(C),m.appendChild(p),m.appendChild(v),m.appendChild(b),m.appendChild(x),m.appendChild(w),d.appendChild(l),t.appendChild(d);const ne=document.createElement("div");ne.style.flex="1",ne.style.overflow="hidden",ne.appendChild(m),t.appendChild(ne);const ce=document.createElement("div");ce.style.marginBottom="20px";const de=document.createElement("h3");de.textContent="Tabela de Progressão",de.style.color="#8B4513",de.style.fontSize="18px",de.style.fontWeight="bold",de.style.marginBottom="15px",de.style.borderBottom="2px solid rgba(139, 69, 19, 0.3)",de.style.paddingBottom="8px",ce.appendChild(de);const le=document.createElement("div");le.style.background="rgba(26,26,46,0.8)",le.style.border="1px solid rgba(139, 69, 19, 0.3)",le.style.borderRadius="8px",le.style.overflow="hidden";const me=document.createElement("div");me.style.display="grid",me.style.gridTemplateColumns="80px 1fr",me.style.background="rgba(139, 69, 19, 0.2)",me.style.padding="12px 15px",me.style.borderBottom="1px solid rgba(139, 69, 19, 0.3)";const ue=document.createElement("div");ue.textContent="Nível",ue.style.color="#8B4513",ue.style.fontWeight="bold",ue.style.fontSize="14px";const pe=document.createElement("div");pe.textContent="Habilidades de Classe",pe.style.color="#8B4513",pe.style.fontWeight="bold",pe.style.fontSize="14px",me.appendChild(ue),me.appendChild(pe),le.appendChild(me);const ge=[{level:"1º",abilities:"Marca da presa +1d4, rastreador"},{level:"2º",abilities:"Poder de caçador"},{level:"3º",abilities:"Explorador, poder de caçador"},{level:"4º",abilities:"Poder de caçador"},{level:"5º",abilities:"Caminho do explorador, marca da presa +1d8, poder de caçador"},{level:"6º",abilities:"Poder de caçador"},{level:"7º",abilities:"Explorador, poder de caçador"},{level:"8º",abilities:"Poder de caçador"},{level:"9º",abilities:"Marca da presa +1d12, poder de caçador"},{level:"10º",abilities:"Poder de caçador"},{level:"11º",abilities:"Explorador, poder de caçador"},{level:"12º",abilities:"Poder de caçador"},{level:"13º",abilities:"Marca da presa +2d8, poder de caçador"},{level:"14º",abilities:"Poder de caçador"},{level:"15º",abilities:"Explorador, poder de caçador"},{level:"16º",abilities:"Poder de caçador"},{level:"17º",abilities:"Marca da presa +2d10, poder de caçador"},{level:"18º",abilities:"Poder de caçador"},{level:"19º",abilities:"Explorador, poder de caçador"},{level:"20º",abilities:"Mestre caçador, poder de caçador"}];ge.forEach((e,a)=>{const o=document.createElement("div");o.style.display="grid",o.style.gridTemplateColumns="80px 1fr",o.style.padding="10px 15px",o.style.borderBottom=a<ge.length-1?"1px solid rgba(139, 69, 19, 0.1)":"none",o.style.transition="background 0.2s",o.onmouseover=()=>{o.style.background="rgba(139, 69, 19, 0.1)"},o.onmouseout=()=>{o.style.background="transparent"};const t=document.createElement("div");t.textContent=e.level,t.style.color="#8B4513",t.style.fontWeight="bold",t.style.fontSize="13px";const s=document.createElement("div");s.textContent=e.abilities,s.style.color="#ecf0f1",s.style.fontSize="13px",s.style.lineHeight="1.3",o.appendChild(t),o.appendChild(s),le.appendChild(o)}),ce.appendChild(le),p.appendChild(ce);const fe=document.createElement("div");fe.style.textAlign="center",fe.style.padding="15px",fe.style.background="rgba(139, 69, 19, 0.1)",fe.style.borderRadius="8px",fe.style.border="1px solid rgba(139, 69, 19, 0.2)",fe.style.marginTop="15px";const ve=document.createElement("div");ve.textContent="📖 Informações baseadas no Livro do Jogador - Tormenta 20",ve.style.color="#8B4513",ve.style.fontSize="12px",ve.style.fontStyle="italic",ve.style.fontWeight="bold",fe.appendChild(ve),p.appendChild(fe),document.body.appendChild(t),S(t,"brown"),s.onclick=()=>{s.remove(),t.remove()}}function Se(){try{const e=localStorage.getItem(n);return e?JSON.parse(e):[]}catch(e){return g.log("Erro ao carregar poderes de destino aprendidos:",e),[]}}function ke(e){return Se().includes(e)}(Ee="#textchat-input",new Promise(e=>{if(document.querySelector(Ee))return e(document.querySelector(Ee));const a=new MutationObserver(()=>{document.querySelector(Ee)&&(a.disconnect(),e(document.querySelector(Ee)))});a.observe(document.body,{childList:!0,subtree:!0})})).then(()=>{setTimeout(()=>{if(function(){const e=L();let a=!1;["Marca da Presa","Rastreador"].forEach(o=>{e.includes(o)||(e.push(o),a=!0)}),a&&W(e)}(),function(){const e=document.createElement("style");e.id="roll20-custom-scrollbar-styles",e.textContent="\n                /* Scrollbars customizadas para todos os elementos do script */\n                #roll20-hotbar *::-webkit-scrollbar,\n                .roll20-popup *::-webkit-scrollbar,\n                .roll20-modal *::-webkit-scrollbar,\n                #roll20-notification-container *::-webkit-scrollbar,\n                #skills-popup *::-webkit-scrollbar,\n                #spells-popup *::-webkit-scrollbar,\n                #misc-popup *::-webkit-scrollbar,\n                #avatar-popup *::-webkit-scrollbar,\n                #spell-cast-popup *::-webkit-scrollbar,\n                #pratos-popup *::-webkit-scrollbar,\n                #bebidas-popup *::-webkit-scrollbar,\n                #pocoes-popup *::-webkit-scrollbar,\n                #conditions-popup *::-webkit-scrollbar,\n                #hunter-class-modal *::-webkit-scrollbar,\n                #skill-detail-modal *::-webkit-scrollbar {\n                    width: 8px !important;\n                    height: 8px !important;\n                }\n\n                #roll20-hotbar *::-webkit-scrollbar-track,\n                .roll20-popup *::-webkit-scrollbar-track,\n                .roll20-modal *::-webkit-scrollbar-track,\n                #roll20-notification-container *::-webkit-scrollbar-track,\n                #skills-popup *::-webkit-scrollbar-track,\n                #spells-popup *::-webkit-scrollbar-track,\n                #misc-popup *::-webkit-scrollbar-track,\n                #avatar-popup *::-webkit-scrollbar-track,\n                #spell-cast-popup *::-webkit-scrollbar-track,\n                #pratos-popup *::-webkit-scrollbar-track,\n                #bebidas-popup *::-webkit-scrollbar-track,\n                #pocoes-popup *::-webkit-scrollbar-track,\n                #conditions-popup *::-webkit-scrollbar-track,\n                #hunter-class-modal *::-webkit-scrollbar-track,\n                #skill-detail-modal *::-webkit-scrollbar-track {\n                    background: rgba(35, 36, 58, 0.3) !important;\n                    border-radius: 4px !important;\n                    margin: 2px !important;\n                }\n\n                #roll20-hotbar *::-webkit-scrollbar-thumb,\n                .roll20-popup *::-webkit-scrollbar-thumb,\n                .roll20-modal *::-webkit-scrollbar-thumb,\n                #roll20-notification-container *::-webkit-scrollbar-thumb,\n                #skills-popup *::-webkit-scrollbar-thumb,\n                #spells-popup *::-webkit-scrollbar-thumb,\n                #misc-popup *::-webkit-scrollbar-thumb,\n                #avatar-popup *::-webkit-scrollbar-thumb,\n                #spell-cast-popup *::-webkit-scrollbar-thumb,\n                #pratos-popup *::-webkit-scrollbar-thumb,\n                #bebidas-popup *::-webkit-scrollbar-thumb,\n                #pocoes-popup *::-webkit-scrollbar-thumb,\n                #conditions-popup *::-webkit-scrollbar-thumb,\n                #hunter-class-modal *::-webkit-scrollbar-thumb,\n                #skill-detail-modal *::-webkit-scrollbar-thumb {\n                    background: rgba(110, 198, 255, 0.6) !important;\n                    border-radius: 4px !important;\n                    border: 1px solid rgba(110, 198, 255, 0.2) !important;\n                    transition: all 0.2s ease !important;\n                }\n\n                #roll20-hotbar *::-webkit-scrollbar-thumb:hover,\n                .roll20-popup *::-webkit-scrollbar-thumb:hover,\n                .roll20-modal *::-webkit-scrollbar-thumb:hover,\n                #roll20-notification-container *::-webkit-scrollbar-thumb:hover,\n                #skills-popup *::-webkit-scrollbar-thumb:hover,\n                #spells-popup *::-webkit-scrollbar-thumb:hover,\n                #misc-popup *::-webkit-scrollbar-thumb:hover,\n                #avatar-popup *::-webkit-scrollbar-thumb:hover,\n                #spell-cast-popup *::-webkit-scrollbar-thumb:hover,\n                #pratos-popup *::-webkit-scrollbar-thumb:hover,\n                #bebidas-popup *::-webkit-scrollbar-thumb:hover,\n                #pocoes-popup *::-webkit-scrollbar-thumb:hover,\n                #conditions-popup *::-webkit-scrollbar-thumb:hover,\n                #hunter-class-modal *::-webkit-scrollbar-thumb:hover,\n                #skill-detail-modal *::-webkit-scrollbar-thumb:hover {\n                    background: rgba(110, 198, 255, 0.8) !important;\n                    border-color: rgba(110, 198, 255, 0.4) !important;\n                }\n\n                #roll20-hotbar *::-webkit-scrollbar-thumb:active,\n                .roll20-popup *::-webkit-scrollbar-thumb:active,\n                .roll20-modal *::-webkit-scrollbar-thumb:active,\n                #roll20-notification-container *::-webkit-scrollbar-thumb:active,\n                #skills-popup *::-webkit-scrollbar-thumb:active,\n                #spells-popup *::-webkit-scrollbar-thumb:active,\n                #misc-popup *::-webkit-scrollbar-thumb:active,\n                #avatar-popup *::-webkit-scrollbar-thumb:active,\n                #spell-cast-popup *::-webkit-scrollbar-thumb:active,\n                #pratos-popup *::-webkit-scrollbar-thumb:active,\n                #bebidas-popup *::-webkit-scrollbar-thumb:active,\n                #pocoes-popup *::-webkit-scrollbar-thumb:active,\n                #conditions-popup *::-webkit-scrollbar-thumb:active,\n                #hunter-class-modal *::-webkit-scrollbar-thumb:active,\n                #skill-detail-modal *::-webkit-scrollbar-thumb:active {\n                    background: rgba(110, 198, 255, 1) !important;\n                    border-color: rgba(110, 198, 255, 0.6) !important;\n                }\n\n                #roll20-hotbar *::-webkit-scrollbar-corner,\n                .roll20-popup *::-webkit-scrollbar-corner,\n                .roll20-modal *::-webkit-scrollbar-corner,\n                #roll20-notification-container *::-webkit-scrollbar-corner,\n                #skills-popup *::-webkit-scrollbar-corner,\n                #spells-popup *::-webkit-scrollbar-corner,\n                #misc-popup *::-webkit-scrollbar-corner,\n                #avatar-popup *::-webkit-scrollbar-corner,\n                #spell-cast-popup *::-webkit-scrollbar-corner,\n                #pratos-popup *::-webkit-scrollbar-corner,\n                #bebidas-popup *::-webkit-scrollbar-corner,\n                #pocoes-popup *::-webkit-scrollbar-corner,\n                #conditions-popup *::-webkit-scrollbar-corner,\n                #hunter-class-modal *::-webkit-scrollbar-corner,\n                #skill-detail-modal *::-webkit-scrollbar-corner {\n                    background: rgba(35, 36, 58, 0.3) !important;\n                    border-radius: 4px !important;\n                }\n\n                /* Scrollbars para Firefox */\n                #roll20-hotbar *,\n                .roll20-popup *,\n                .roll20-modal *,\n                #roll20-notification-container *,\n                #skills-popup *,\n                #spells-popup *,\n                #misc-popup *,\n                #avatar-popup *,\n                #spell-cast-popup *,\n                #pratos-popup *,\n                #bebidas-popup *,\n                #conditions-popup *,\n                #hunter-class-modal *,\n                #skill-detail-modal * {\n                    scrollbar-width: thin !important;\n                    scrollbar-color: rgba(110, 198, 255, 0.6) rgba(35, 36, 58, 0.3) !important;\n                }\n\n                /* Scrollbars para elementos específicos com cores diferentes */\n                .roll20-popup-orange *::-webkit-scrollbar-thumb,\n                #misc-popup *::-webkit-scrollbar-thumb,\n                #pratos-popup *::-webkit-scrollbar-thumb,\n                #bebidas-popup *::-webkit-scrollbar-thumb {\n                    background: rgba(255, 184, 108, 0.6) !important;\n                    border-color: rgba(255, 184, 108, 0.2) !important;\n                }\n\n                .roll20-popup-orange *::-webkit-scrollbar-thumb:hover,\n                #misc-popup *::-webkit-scrollbar-thumb:hover,\n                #pratos-popup *::-webkit-scrollbar-thumb:hover,\n                #bebidas-popup *::-webkit-scrollbar-thumb:hover {\n                    background: rgba(255, 184, 108, 0.8) !important;\n                    border-color: rgba(255, 184, 108, 0.4) !important;\n                }\n\n                .roll20-popup-orange *::-webkit-scrollbar-thumb:active,\n                #misc-popup *::-webkit-scrollbar-thumb:active,\n                #pratos-popup *::-webkit-scrollbar-thumb:active,\n                #bebidas-popup *::-webkit-scrollbar-thumb:active {\n                    background: rgba(255, 184, 108, 1) !important;\n                    border-color: rgba(255, 184, 108, 0.6) !important;\n                }\n\n                .roll20-popup-orange *,\n                #misc-popup *,\n                #pratos-popup *,\n                #bebidas-popup * {\n                    scrollbar-color: rgba(255, 184, 108, 0.6) rgba(35, 36, 58, 0.3) !important;\n                }\n\n                /* Scrollbars para elementos com tema verde */\n                .roll20-popup-green *::-webkit-scrollbar-thumb,\n                #hunter-class-modal *::-webkit-scrollbar-thumb {\n                    background: rgba(76, 175, 80, 0.6) !important;\n                    border-color: rgba(76, 175, 80, 0.2) !important;\n                }\n\n                .roll20-popup-green *::-webkit-scrollbar-thumb:hover,\n                #hunter-class-modal *::-webkit-scrollbar-thumb:hover {\n                    background: rgba(76, 175, 80, 0.8) !important;\n                    border-color: rgba(76, 175, 80, 0.4) !important;\n                }\n\n                .roll20-popup-green *::-webkit-scrollbar-thumb:active,\n                #hunter-class-modal *::-webkit-scrollbar-thumb:active {\n                    background: rgba(76, 175, 80, 1) !important;\n                    border-color: rgba(76, 175, 80, 0.6) !important;\n                }\n\n                .roll20-popup-green *,\n                #hunter-class-modal * {\n                    scrollbar-color: rgba(76, 175, 80, 0.6) rgba(35, 36, 58, 0.3) !important;\n                }\n\n                /* Scrollbars para elementos com tema roxo */\n                .roll20-popup-purple *::-webkit-scrollbar-thumb,\n                #spells-popup *::-webkit-scrollbar-thumb,\n                #spell-cast-popup *::-webkit-scrollbar-thumb {\n                    background: rgba(156, 39, 176, 0.6) !important;\n                    border-color: rgba(156, 39, 176, 0.2) !important;\n                }\n\n                .roll20-popup-purple *::-webkit-scrollbar-thumb:hover,\n                #spells-popup *::-webkit-scrollbar-thumb:hover,\n                #spell-cast-popup *::-webkit-scrollbar-thumb:hover {\n                    background: rgba(156, 39, 176, 0.8) !important;\n                    border-color: rgba(156, 39, 176, 0.4) !important;\n                }\n\n                .roll20-popup-purple *::-webkit-scrollbar-thumb:active,\n                #spells-popup *::-webkit-scrollbar-thumb:active,\n                #spell-cast-popup *::-webkit-scrollbar-thumb:active {\n                    background: rgba(156, 39, 176, 1) !important;\n                    border-color: rgba(156, 39, 176, 0.6) !important;\n                }\n\n                .roll20-popup-purple *,\n                #spells-popup *,\n                #spell-cast-popup * {\n                    scrollbar-color: rgba(156, 39, 176, 0.6) rgba(35, 36, 58, 0.3) !important;\n                }\n\n                /* Scrollbars para elementos com tema vermelho */\n                .roll20-popup-red *::-webkit-scrollbar-thumb,\n                #conditions-popup *::-webkit-scrollbar-thumb {\n                    background: rgba(244, 67, 54, 0.6) !important;\n                    border-color: rgba(244, 67, 54, 0.2) !important;\n                }\n\n                .roll20-popup-red *::-webkit-scrollbar-thumb:hover,\n                #conditions-popup *::-webkit-scrollbar-thumb:hover {\n                    background: rgba(244, 67, 54, 0.8) !important;\n                    border-color: rgba(244, 67, 54, 0.4) !important;\n                }\n\n                .roll20-popup-red *::-webkit-scrollbar-thumb:active,\n                #conditions-popup *::-webkit-scrollbar-thumb:active {\n                    background: rgba(244, 67, 54, 1) !important;\n                    border-color: rgba(244, 67, 54, 0.6) !important;\n                }\n\n                .roll20-popup-red *,\n                #conditions-popup * {\n                    scrollbar-color: rgba(244, 67, 54, 0.6) rgba(35, 36, 58, 0.3) !important;\n                }\n\n                /* Animações suaves para scrollbars */\n                #roll20-hotbar *::-webkit-scrollbar-thumb,\n                .roll20-popup *::-webkit-scrollbar-thumb,\n                .roll20-modal *::-webkit-scrollbar-thumb,\n                #roll20-notification-container *::-webkit-scrollbar-thumb {\n                    transition: background 0.2s ease, border-color 0.2s ease, opacity 0.2s ease !important;\n                }\n\n                /* Scrollbars mais finas para elementos pequenos */\n                .roll20-scrollbar-thin *::-webkit-scrollbar {\n                    width: 6px !important;\n                    height: 6px !important;\n                }\n\n                .roll20-scrollbar-thin *::-webkit-scrollbar-thumb {\n                    border-radius: 3px !important;\n                }\n\n                .roll20-scrollbar-thin *::-webkit-scrollbar-track {\n                    border-radius: 3px !important;\n                    margin: 1px !important;\n                }\n\n                /* Scrollbars mais grossas para elementos grandes */\n                .roll20-scrollbar-thick *::-webkit-scrollbar {\n                    width: 12px !important;\n                    height: 12px !important;\n                }\n                .roll20-scrollbar-thick *::-webkit-scrollbar-thumb {\n                    border-radius: 6px !important;\n                }\n                .roll20-scrollbar-thick *::-webkit-scrollbar-track {\n                    border-radius: 6px !important;\n                    margin: 3px !important;\n                }\n\n                /* Esconder scrollbars quando não necessário */\n                .roll20-scrollbar-auto *::-webkit-scrollbar {\n                    width: 8px !important;\n                    height: 8px !important;\n                }\n\n                .roll20-scrollbar-auto *::-webkit-scrollbar-thumb {\n                    background: rgba(110, 198, 255, 0.3) !important;\n                }\n\n                .roll20-scrollbar-auto *:hover::-webkit-scrollbar-thumb {\n                    background: rgba(110, 198, 255, 0.6) !important;\n                }\n            ",document.head.appendChild(e)}(),!document.getElementById("skeleton-loader-style")){const e=document.createElement("style");e.id="skeleton-loader-style",e.textContent="\n                            @keyframes skeleton-loading { \n                                0% { background-position: -200px 0; } \n                                100% { background-position: calc(200px + 100%) 0; } \n                            }\n                        ",document.head.appendChild(e)}qe(),document.addEventListener("keydown",function(e){if(e.ctrlKey&&("'"===e.key||'"'===e.key)){v();const a=document.getElementById("roll20-hotbar");a&&("none"===a.style.display?a.style.display="":a.style.display="none"),e.preventDefault(),e.stopPropagation()}e.ctrlKey&&"Space"===e.code&&(e.preventDefault(),e.stopPropagation(),function(){const e=document.getElementById("quick-search-modal");e&&e.remove();const a=document.getElementById("quick-search-overlay");a&&a.remove();const o=document.createElement("div");o.id="quick-search-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.7)",o.style.zIndex="10000",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="flex-start",o.style.paddingTop="10vh";const t=document.createElement("div");t.id="quick-search-modal",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="20px",t.style.width="600px",t.style.maxWidth="90vw",t.style.maxHeight="70vh",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.gap="15px";const s=document.createElement("h2");s.textContent="🔍 Busca Rápida",s.style.color="#6ec6ff",s.style.margin="0",s.style.textAlign="center",s.style.fontSize="18px";const r=document.createElement("input");r.type="text",r.placeholder="Digite para buscar... (dishes, drinks, potions, conditions, skills, spells, powers, divinity)",r.style.padding="12px 16px",r.style.border="2px solid #6ec6ff",r.style.borderRadius="8px",r.style.background="rgba(20,20,30,0.9)",r.style.color="#ecf0f1",r.style.fontSize="14px",r.style.width="100%",r.style.boxSizing="border-box";const n=document.createElement("div");n.style.flex="1",n.style.overflowY="auto",n.style.maxHeight="400px",n.style.border="1px solid rgba(110,198,255,0.3)",n.style.borderRadius="8px",n.style.padding="10px",n.style.background="rgba(20,20,30,0.5)",S(n,"blue"),t.appendChild(s),t.appendChild(r),t.appendChild(n),o.appendChild(t),document.body.appendChild(o),r.focus(),r.addEventListener("input",async e=>{const a=e.target.value.trim();if(a.length>=1)await async function(e){if(!window.grimorioSpellsCache)try{window.grimorioSpellsCache=await se()}catch(e){console.warn("Erro ao carregar magias para busca:",e),window.grimorioSpellsCache=[]}const a=function(){const e=[];[{nome:"Assado de Carnes",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_60.jpg",raridade:"Comum",descricao:"Um prato muito apreciado no Reinado, mas mal visto no Império de Tauron. Pura proteína, deixa qualquer um mais forte.",bonus:"+2 em rolagens de dano corpo a corpo.",preco:"T$ 30",ingredientes:"Carne, carne de caça, porco",custoIngredientes:"T$ 56",cdTeste:"20",icone:"🥩"},{nome:"Balinhas",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_halloween_candy_01.jpg",raridade:"Comum",descricao:"Balas coloridas e doces. Arcanistas gostam — dizem que o açúcar feérico usado nas balinhas potencializa suas magias.",bonus:"+2 em rolagens de dano de magias.",preco:"T$ 30",ingredientes:"Açúcar das fadas, fruta",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍬"},{nome:"Banquete dos Heróis",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_cauldron_frost.jpg",raridade:"Comum",descricao:"Uma mesa repleta das melhores comidas que o dinheiro pode pagar.",bonus:"+1 em um atributo a sua escolha. Esse aumento não oferece PV, PM e perícias adicionais.",preco:"T$ 150",ingredientes:"Carne de caça, ovo de monstro, avelã de Norba",custoIngredientes:"T$ 82",cdTeste:"25",icone:"🍽️"},{nome:"Batata Valkariana",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_103_potatobread.jpg",raridade:"Comum",descricao:"Batatas cortadas em tiras e mergulhadas em óleo fervente. Gordurentas e pouco nutritivas, são o tipo de prato que só é servido numa metrópole como Valkaria. Apesar disso, são saborosas e deixam qualquer um empolgado.",bonus:"+1d6 em um teste a sua escolha realizado até o fim do dia.",preco:"T$ 2",ingredientes:"Óleo, legume",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍟"},{nome:"Bolo de Cenoura",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_fishcake.jpg",raridade:"Comum",descricao:'Uma sobremesa simples, que "faz bem para a vista", segundo anciões de todo o Reinado. Aparentemente, os anciões estão certos, pois o bolo de cenoura fornece +2 em testes de Percepção.',bonus:"+2 em testes de Percepção.",preco:"T$ 4",ingredientes:"Farinha, fruta, óleo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍰"},{nome:"Bolo do Panteão",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_144_cakeslice.jpg",raridade:"Comum",descricao:"Uma sobremesa divina! Este bolo de gorad é preparado com os melhores ingredientes, por isso é caríssimo, servido apenas em banquetes reais — ou em tavernas que atendem aventureiros famosos. Dizem que o gorad usado no bolo é uma das fontes de energia do Panteão.",bonus:"Seu custo para ativar habilidades e lançar magias diminui em -1 PM (mínimo 1).",preco:"T$ 150",ingredientes:"Açúcar das fadas, avelã de Norba, farinha, gorad",custoIngredientes:"T$ 121",cdTeste:"25",icone:"🍰"},{nome:"Ensopado Reforçado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Um prato nutritivo, mas pesado.",bonus:"+20 PV temporários, mas seu deslocamento diminui em –1,5m.",preco:"T$ 6",ingredientes:"Cereal, porco, verdura",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍲"},{nome:"Estrogonofe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_sauteedcarrots.jpg",raridade:"Comum",descricao:"Essa iguaria deliciosa foi inventada nas cortes do antigo Reino de Yudennach — dizem que é uma das poucas coisas boas a sair daquele lugar. Comer estrogonofe deixa você firme em suas convicções.",bonus:"+2 em testes de Vontade.",preco:"T$ 12",ingredientes:"Carne, cogumelo, leite",custoIngredientes:"T$ 22",cdTeste:"15",icone:"🍲"},{nome:"Fritada Monstruosa",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_06.jpg",raridade:"Comum",descricao:"A receita é simples — o segredo está nos ingredientes. Feita com ovos de monstros, esta omelete é extremamente nutritiva.",bonus:"+10 PV temporários.",preco:"T$ 30",ingredientes:"Ovo de monstro, óleo",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍳"},{nome:"Futomaki",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_161_fish_white.jpg",raridade:"Comum",descricao:"Criado no Império de Jade, este prato consiste em um rolo de arroz recheado com peixes, folhas e raízes. Uma refeição elegante, que deixa todos dispostos a dialogar.",bonus:"+2 em testes de Diplomacia.",preco:"T$ 12",ingredientes:"Cereal, peixe",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🍣"},{nome:"Gorad Quente",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_meat_cooked_08.jpg",raridade:"Comum",descricao:"Gorad e leite, servidos fumegando. Não tem erro. O gorad ativa o cérebro.",bonus:"+2 PM temporários.",preco:"T$ 18",ingredientes:"Gorad, leite",custoIngredientes:"T$ 31",cdTeste:"20",icone:"🥛"},{nome:"Gorvelã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cask_04.jpg",raridade:"Comum",descricao:"Gorad com avelã de Norba. É uma sobremesa cara, mas deliciosa.",bonus:"+5 PM temporários.",preco:"T$ 42",ingredientes:"Gorad, avelã de Norba",custoIngredientes:"T$ 70",cdTeste:"25",icone:"🍰"},{nome:"Macarrão de Yuvalin",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_90_cinnamonbonefishstew.jpg",raridade:"Comum",descricao:"Yuvalin é uma cidade mineradora em Zakharov, na fronteira com as Montanhas Uivantes. Seus habitantes criaram este prato reforçado (macarrão, bacon e creme de leite) para encarar suas árduas jornadas de trabalho nas minas. Deliciosa, a receita se espalhou por outras cidades e reinos.",bonus:"+5 PV temporários.",preco:"T$ 6",ingredientes:"Farinha, leite, porco",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍝"},{nome:"Pão de Queijo",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_orchardfruit01.jpg",raridade:"Comum",descricao:"Um bom pão de queijo deixa qualquer aventureiro bem nutrido e saudável.",bonus:"+2 em testes de Fortitude.",preco:"T$ 10",ingredientes:"Farinha, queijo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🥨"},{nome:"Pizza",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_deliciouspizza.jpg",raridade:"Comum",descricao:"Um disco de massa coberto com molho de tomate e queijo, este prato foi criado por Guido Venusto, um nobre de Ahlen que queria ascender socialmente. Inepto nas artes da intriga, Venusto resolveu manipular a corte pela barriga. Funcionou — o prato foi um sucesso e o nobre cozinheiro teve muita influência por anos. Certa noite, um espião conseguiu roubar a receita. O segredo da pizza se espalhou e, sem seu trunfo, Venusto foi assassinado logo depois. Comer uma pizza deixa-o pronto para encarar qualquer perigo.",bonus:"+1 em todos os testes de resistência.",preco:"T$ 6",ingredientes:"Farinha, fruta, queijo",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍕"},{nome:"Porco Assado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_123_roast.jpg",raridade:"Comum",descricao:"Um prato típico e popular em Deheon, que já se alastrou pelo Reinado. Comer um porco assado o deixa valente e brigão.",bonus:"+1 em testes de Luta.",preco:"T$ 36",ingredientes:"Porco, frutas, legume",custoIngredientes:"T$ 12",cdTeste:"15",icone:"🍖"},{nome:"Prato do Aventureiro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_fish_18.jpg",raridade:"Comum",descricao:"Um cozido de frango com legumes, esta é uma refeição simples, mas mantém qualquer um bem alimentado.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de vida em +1 por nível.",preco:"T$ 2",ingredientes:"Ave, legume",custoIngredientes:"T$ 5",cdTeste:"10",icone:"🍲"},{nome:"Salada de Salistick",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Com folhas e carne de frango, esta salada foi criada no Reino dos Médicos, onde a saúde é uma grande preocupação. Uma alimentação leve, mas nutritiva.",bonus:"Aumenta seu deslocamento em +1,5m (1 quadrado).",preco:"T$ 4",ingredientes:"Ave, fruta, legume",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🥗"},{nome:"Salada Élfica",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Esta salada vegetariana leva uma mistura de folhas, frutas e legumes. Segundo os relatos, a receita foi inventada em Lenórienn e passada aos reinos humanos de Lamnor, antes do isolamento dos povos. Felizmente, a salada se espalhou por Arton antes da queda do continente. Um prato leve e equilibrado, inspira disparos precisos.",bonus:"+1 em testes de Pontaria.",preco:"T$ 4",ingredientes:"Fruta, legume, verdura",custoIngredientes:"T$ 5",cdTeste:"15",icone:"🥗"},{nome:"Salada Imperial",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_braisedturtle.jpg",raridade:"Comum",descricao:"Uma mistura de folhas com bacon e queijo, esta salada é leve, mas empolgante.",bonus:"+2 em testes de Iniciativa.",preco:"T$ 6",ingredientes:"Porco, queijo, verdura",custoIngredientes:"T$ 15",cdTeste:"15",icone:"🥗"},{nome:"Sashimi",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_valleystirfry.jpg",raridade:"Comum",descricao:"Uma iguaria da culinária tamuraniana, este prato consiste de peixes e frutos do mar fatiados em pequenos pedaços e servidos com um molho típico do Império de Jade. Uma refeição refinada, leve e equilibrada.",bonus:"+2 em rolagens de dano à distância.",preco:"T$ 22",ingredientes:"Peixe, molho tamuraniano",custoIngredientes:"T$ 37",cdTeste:"20",icone:"🍣"},{nome:"Sopa de Cogumelos",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_slime_02.jpg",raridade:"Comum",descricao:"Esta sopa expande sua percepção mística.",bonus:"+2 em testes de Misticismo.",preco:"T$ 6",ingredientes:"Cogumelo, legume, verdura",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍲"},{nome:"Sopa de Peixe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_63.jpg",raridade:"Comum",descricao:"Um cozido de peixe com verduras, é um prato simples e humilde, mas garante descanso relaxante.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de mana em +1 por nível.",preco:"T$ 3",ingredientes:"Verdura, peixe",custoIngredientes:"T$ 8",cdTeste:"10",icone:"🍲"},{nome:"Torta de Maçã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_10.jpg",raridade:"Comum",descricao:"Dizem que, após uma bruxa usar uma maçã envenenada para matar uma princesa, Thantalla-Dhaedelin, a Rainha das Fadas, decretou que maçãs nunca mais fariam mal a ninguém. Se a lenda é verdade, ou se maçãs são simplesmente saudáveis, ninguém sabe dizer, mas comer este prato fornece resistência a veneno +5.",bonus:"Resistência a veneno +5.",preco:"T$ 2",ingredientes:"Farinha, fruta",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍰"},{nome:"Baga Celeste Cozida",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Encontradas originalmente nas encostas invertidas de Vectora, estas bagas se espalharam por toda Arton. Quando preparadas adequadamente, fornecem qualidades místicas de flutuação.",bonus:"Todo dano de queda que você sofre é reduzido em −1d6.",preco:"T$ 25",ingredientes:"Fruta, especiaria",custoIngredientes:"T$ 35",cdTeste:"20",icone:"🌟"},{nome:"Cozido de Pimenta",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_159_fish_82.jpg",raridade:"Comum",descricao:"Um prato forte, capaz de trazer lágrimas aos olhos do mais resistente dos comensais.",bonus:"+1 em Fortitude (cumulativo com outros itens) e +1 na rolagem do D20 para testes da perícia Fortitude.",preco:"T$ 15",ingredientes:"Legume, especiaria",custoIngredientes:"T$ 12",cdTeste:"18",icone:"🌶️"},{nome:"Manjar de Sombras",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_80_ravenberrytart.jpg",raridade:"Comum",descricao:"A origem da receita original deste prato se perdeu, mas sua essência se manteve inalterada. Consiste de um manjar com ingredientes cultivados em terras próximas de cemitérios, que protege o corpo contra energias sombrias.",bonus:"Você ignora os próximos 10 pontos de dano de trevas que sofrer.",preco:"T$ 40",ingredientes:"Cereal, especiaria, verdura",custoIngredientes:"T$ 28",cdTeste:"22",icone:"🌑"}].forEach(a=>{e.push({name:a.nome,category:"Prato",description:a.descricao,effects:a.bonus,icon:a.icone||"🍽️",type:"prato",data:a})}),[{nome:"Baba de Troll",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_136.jpg",tipo:"Não alcoólica",descricao:"Uma bebida sem álcool, à base de leite, castanhas, nozes e mel.",efeito:"+1d4 em um teste à sua escolha até o fim do dia.",cd:"—",icone:"🧃"},{nome:"Barba Queimada",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_05.jpg",tipo:"Alcoólica",descricao:"Forte e amarga, esta cerveja anã fortalece o corpo e o espírito.",efeito:"Redução de Dano 2.",cd:"20",icone:"🍺"},{nome:"Cerveja Deheoni",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_08.jpg",tipo:"Alcoólica",descricao:"A bebida mais comum nas tavernas do Reinado.",efeito:"+1 em testes de resistência.",cd:"15",icone:"🍻"},{nome:"Dilínio",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_11.jpg",tipo:"Alcoólica",descricao:"Destilado tradicional de Mortenstenn, feito com um cereal que só cresce no continente sul. A receita se perdeu após as invasões duyshidakk, e poucos barris chegaram ao Reinado.",efeito:"O limite de gasto de PM aumenta em +1.",cd:"20",observacao:"Não pode ser fabricado",icone:"🥃"},{nome:"Grogue Negro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_12.jpg",tipo:"Alcoólica",descricao:"Rum misturado com especiarias. Seu nome vem de sua origem — piratas do Conclave, que atuam no Mar Negro — e não da cor da bebida, que é dourada clara.",efeito:"Quando você usa Audácia, o bônus fornecido pelo poder aumenta em +1.",cd:"15",icone:"🏴‍☠️"},{nome:"Grogue Rubro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_13.jpg",tipo:"Alcoólica",descricao:"Variação do grogue negro, com especiarias picantes que fazem a bebida adquirir uma coloração avermelhada — e quem a bebe, certa inclinação para a violência.",efeito:"Você pode usar Audácia para testes de ataque.",cd:"20",icone:"🔥"},{nome:"Hidromel Uivante",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_14.jpg",tipo:"Alcoólica",descricao:"Fabricada nas montanhas geladas, esta bebida aquece e incita.",efeito:"+2 em rolagens de dano corpo a corpo.",cd:"20",icone:"❄️"},{nome:"Licor Feérico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_15.jpg",tipo:"Alcoólica",descricao:"De aparência enevoada e gosto adocicado, dizem que é feito na Pondsmânia e trazido com dificuldade ao Reinado. Alguns acham que é invenção dos taverneiros, até provarem uma dose.",efeito:"Escolha uma habilidade. O custo para ativá-la diminui em –1 PM.",cd:"25",icone:"✨"},{nome:"Sidra Ahleniense",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_16.jpg",tipo:"Alcoólica",descricao:"Esta bebida doce deixa qualquer um mais falante.",efeito:"+2 em testes de perícias originalmente baseadas em Carisma.",cd:"15",icone:"🍏"},{nome:"Vinho Pruss",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_17.jpg",tipo:"Alcoólica",descricao:"Batizado em homenagem ao antigo Rei-Imperador Thormy — dizem que era o favorito do monarca.",efeito:"Concede 3 pontos de mana temporários.",cd:"15",icone:"🍷"},{nome:"Vinho Élfico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_18.jpg",tipo:"Alcoólica",descricao:"De sabor complexo, aguça a mente.",efeito:"+1 na CD para resistir às suas habilidades.",cd:"20",icone:"🌿"}].forEach(a=>{e.push({name:a.nome,category:"Bebida",description:a.descricao,effects:a.efeito,icon:a.icone||"🥤",type:"bebida",data:a})}),me().forEach(a=>{e.push({name:a.nome,category:"Poção",description:a.descricao,effects:a.efeito,icon:a.icone||"🧪",type:"pocao",data:a})}),da().forEach(a=>{e.push({name:a.nome,category:"Condição",description:a.descricao,effects:a.efeitos,icon:a.icone||"⚡",type:"condition",data:a})}),Object.keys(xe).forEach(a=>{const o=xe[a];e.push({name:a,category:"Perícia",description:o.descricao,effects:o.usos?o.usos.map(e=>e.titulo).join(", "):"",icon:"🎯",type:"skill",data:o})});const a=window.grimorioSpellsCache||[];a&&a.length>0?a.forEach(a=>{const o="arcana"===a.tradition?"Arcana":"divina"===a.tradition?"Divina":"universal"===a.tradition?"Universal":a.tradition,t=a.system?.description?.value||"";e.push({name:a.name,category:"Magia",description:`${o} - ${a.circuloDisplay} - ${a.escola}`,effects:t,icon:"✨",type:"spell",data:{...a,tradition:o,circle:a.circulo,school:a.escola}})}):[{name:"Luz Sagrada",tradition:"Divina",circle:1,school:"Evocação"},{name:"Bola de Fogo",tradition:"Arcana",circle:3,school:"Evocação"},{name:"Cura Ferimentos Leves",tradition:"Divina",circle:1,school:"Necromancia"},{name:"Detectar Magia",tradition:"Universal",circle:1,school:"Adivinhação"}].forEach(a=>{e.push({name:a.name,category:"Magia",description:`${a.tradition} - ${a.circle}º Círculo - ${a.school}`,effects:"",icon:"✨",type:"spell",data:a})}),[{name:"Acuidade com Arma",description:"Quando usa uma arma corpo a corpo leve ou uma arma de arremesso, você pode usar sua Destreza em vez de Força nos testes de ataque e rolagens de dano."},{name:"Arma Secundária Grande",description:"Você pode empunhar duas armas de uma mão com o poder Estilo de Duas Armas."},{name:"Arremesso Potente",description:"Quando usa uma arma de arremesso, você pode usar sua Força em vez de Destreza nos testes de ataque."},{name:"Ataque Poderoso",description:"Sempre que faz um ataque corpo a corpo, você pode sofrer –2 no teste de ataque para receber +5 na rolagem de dano."},{name:"Bloqueio com Escudo",description:"Quando sofre dano, você pode gastar 1 PM para receber redução de dano igual ao bônus na Defesa que seu escudo fornece contra este dano."}].forEach(a=>{e.push({name:a.name,category:"Poder de Combate",description:a.description,effects:"",icon:"⚔️",type:"combat_power",data:a})}),[{name:"Azgher",title:"Deus-Sol",description:"Deus da luz e do calor, venerado por viajantes e combatentes das trevas."},{name:"Kallyadranoch",title:"Deus-Dragão",description:"Deus da sabedoria e conhecimento, venerado por magos e sábios."},{name:"Megalokk",title:"Deus da Guerra",description:"Deus da guerra e da força, venerado por guerreiros e bárbaros."}].forEach(a=>{e.push({name:`${a.name} - ${a.title}`,category:"Divindade",description:a.description,effects:"",icon:"🙏",type:"divinity",data:a})});const o=L(),t=["Marca da Presa","Rastreador"],s=parseInt(localStorage.getItem(T)||"1",10)||1,r=J(s);return t.forEach(a=>{e.push({name:a,category:"Habilidade",description:"Habilidade automática do Caçador",effects:"Sempre disponível",icon:"🎯",type:"ability",data:{nome:a,tipo:"automática"}})}),r.forEach(a=>{e.push({name:a,category:"Habilidade",description:`Habilidade especial disponível no nível ${s}`,effects:"Habilidade de classe",icon:"🌟",type:"ability",data:{nome:a,tipo:"especial"}})}),o.forEach(a=>{t.includes(a)||r.includes(a)||e.push({name:a,category:"Habilidade",description:"Habilidade aprendida pelo Caçador",effects:"Habilidade escolhida",icon:"🎯",type:"ability",data:{nome:a,tipo:"aprendida"}})}),Se().forEach(a=>{e.push({name:a,category:"Poder de Destino",description:"Poder de destino aprendido pelo personagem",effects:"Poder de destino",icon:"⭐",type:"destiny_power",data:{nome:a,tipo:"destino"}})}),e}().filter(a=>`${a.name} ${a.category} ${a.description||""} ${a.effects||""}`.toLowerCase().includes(e.toLowerCase()));if(n.innerHTML="",0===a.length){const e=document.createElement("div");return e.textContent="Nenhum resultado encontrado.",e.style.color="#888",e.style.textAlign="center",e.style.padding="20px",void n.appendChild(e)}const o=a.slice(0,50);o.forEach((e,a)=>{const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.padding="10px",a<o.length-1&&(t.style.borderBottom="1px solid rgba(110,198,255,0.2)"),t.style.cursor="pointer",t.style.transition="background 0.2s";const s=document.createElement("div");if(s.style.width="32px",s.style.height="32px",s.style.marginRight="10px",s.style.flexShrink="0",s.style.borderRadius="6px",s.style.border="2px solid rgba(110,198,255,0.3)",s.style.background="#23243a",s.style.overflow="hidden",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center",e.data&&e.data.iconeUrl){const a=ua(e.data.iconeUrl,e.name,e.icon||"📄",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!0});s.appendChild(a)}else{const a=document.createElement("div");a.textContent=e.icon||"📄",a.style.fontSize="16px",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.width="100%",a.style.height="100%",s.appendChild(a)}const r=document.createElement("div");r.style.flex="1";const i=document.createElement("div");i.textContent=e.name,i.style.color="#6ec6ff",i.style.fontWeight="bold",i.style.fontSize="14px";const c=document.createElement("div");c.textContent=e.category,c.style.color="#888",c.style.fontSize="12px",c.style.marginTop="2px";const d=document.createElement("div");d.textContent=e.description||e.effects||"",d.style.color="#ecf0f1",d.style.fontSize="12px",d.style.marginTop="4px",d.style.lineHeight="1.3",r.appendChild(i),r.appendChild(c),r.appendChild(d),t.appendChild(s),t.appendChild(r),t.onmouseover=()=>{t.style.background="rgba(110,198,255,0.1)"},t.onmouseout=()=>{t.style.background="transparent"},t.onclick=()=>{!function(e){const a=document.getElementById("quick-search-modal"),o=document.getElementById("quick-search-overlay");switch(a&&a.remove(),o&&o.remove(),e.type){case"prato":ue(e.data);break;case"bebida":pe(e.data);break;case"pocao":ge(e.data);break;case"condition":w(e.data);break;case"skill":{const a=e.name,o=[{nome:"Acrobacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Acrobacia}}{{theroll=[[1d20+[[@{${I()}|acrobaciatotal}]]]]}}`},{nome:"Adestramento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Adestramento}}{{theroll=[[1d20+[[@{${I()}|adestramentototal}]]]]}}`},{nome:"Atletismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Atletismo}}{{theroll=[[1d20+[[@{${I()}|atletismototal}]]]]}}`},{nome:"Atuação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Atuação}}{{theroll=[[1d20+[[@{${I()}|atuacaototal}]]]]}}`},{nome:"Cavalgar",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Cavalgar}}{{theroll=[[1d20+[[@{${I()}|cavalgartotal}]]]]}}`},{nome:"Conhecimento",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Conhecimento}}{{theroll=[[1d20+[[@{${I()}|conhecimentototal}]]]]}}`},{nome:"Cura",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Cura}}{{theroll=[[1d20+[[@{${I()}|curatotal}]]]]}}`},{nome:"Diplomacia",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Diplomacia}}{{theroll=[[1d20+[[@{${I()}|diplomaciatotal}]]]]}}`},{nome:"Enganação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Enganação}}{{theroll=[[1d20+[[@{${I()}|enganacaototal}]]]]}}`},{nome:"Fortitude",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Fortitude}}{{theroll=[[1d20+[[@{${I()}|fortitudetotal}]]]]}}`},{nome:"Furtividade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Furtividade}}{{theroll=[[1d20+[[@{${I()}|furtividadetotal}]]]]}}`},{nome:"Guerra",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Guerra}}{{theroll=[[1d20+[[@{${I()}|guerratotal}]]]]}}`},{nome:"Iniciativa",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Iniciativa}}{{theroll=[[1d20+[[@{${I()}|iniciativatotal}]] &{tracker}]]}}`},{nome:"Intimidação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Intimidação}}{{theroll=[[1d20+[[@{${I()}|intimidacaototal}]]]]}}`},{nome:"Intuição",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Intuição}}{{theroll=[[1d20+[[@{${I()}|intuicaototal}]]]]}}`},{nome:"Investigação",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Investigação}}{{theroll=[[1d20+[[@{${I()}|investigacaototal}]]]]}}`},{nome:"Jogatina",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Jogatina}}{{theroll=[[1d20+[[@{${I()}|jogatinatotal}]]]]}}`},{nome:"Ladinagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Ladinagem}}{{theroll=[[1d20+[[@{${I()}|ladinagemtotal}]]]]}}`},{nome:"Misticismo",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Misticismo}}{{theroll=[[1d20+[[@{${I()}|misticismototal}]]]]}}`},{nome:"Nobreza",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Nobreza}}{{theroll=[[1d20+[[@{${I()}|nobrezatotal}]]]]}}`},{nome:"Ofício",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Ofício}}{{theroll=[[1d20+[[@{${I()}|oficiototal}]]]]}}`},{nome:"Percepção",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Percepção}}{{theroll=[[1d20+[[@{${I()}|percepcaototal}]]]]}}`},{nome:"Pilotagem",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Pilotagem}}{{theroll=[[1d20+[[@{${I()}|pilotagemtotal}]]]]}}`},{nome:"Pontaria",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Pontaria}}{{theroll=[[1d20+[[@{${I()}|pontariatotal}]]]]}}`},{nome:"Reflexos",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Reflexos}}{{theroll=[[1d20+[[@{${I()}|reflexostotal}]]]]}}`},{nome:"Religião",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Religião}}{{theroll=[[1d20+[[@{${I()}|religiaototal}]]]]}}`},{nome:"Sobrevivência",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Sobrevivência}}{{theroll=[[1d20+[[@{${I()}|sobrevivenciatotal}]]]]}}`},{nome:"Vontade",comando:`&{template:t20}{{character=@{${I()}|character_name}}}{{rollname=Vontade}}{{theroll=[[1d20+[[@{${I()}|vontadetotal}]]]]}}`}].find(e=>e.nome===a);o?(Z(o.comando),A(`Teste de ${a} executado!`)):we(a);break}case"spell":if(e.data&&e.data.name){re((window.grimorioSpellsCache||[]).find(a=>a.name===e.data.name)||{name:e.data.name,tradition:e.data.tradition?.toLowerCase()||"universal",circulo:e.data.circle||1,circuloDisplay:`${e.data.circle||1}º Círculo`,escola:e.data.school||"Universal",execucao:"Ação Padrão",system:{description:{value:e.effects||"Descrição não disponível"},alcance:"Curto",duracao:"Cena",alvo:"1 Alvo",resistencia:"Nenhuma",custo:"1 PM"}})}break;case"combat_power":Z(`&{template:t20-info}{{infoname=${e.data.name||"Poder de Combate"}}}{{description=${e.data.description||""}}}`),A(`Poder "${e.name}" compartilhado no chat!`),Ce();break;case"divinity":Z(`&{template:t20-info}{{infoname=${e.name}}}{{description=${e.description||""}}}`),A(`Divindade "${e.name}" compartilhada no chat!`),Ce();break;case"ability":He(e.data.nome,e.data.nome);break;case"destiny_power":Z(`&{template:t20-info}{{infoname=${e.name}}}{{description=${e.description||""}}}`),A(`Poder de Destino "${e.name}" compartilhado no chat!`),Ce();break;default:Z(`&{template:t20-info}{{infoname=${e.name}}}{{description=${e.description||e.effects||""}}}`),Ce()}}(e)},n.appendChild(t)})}(a);else{n.innerHTML="";const e=document.createElement("div");e.textContent="Digite para começar a buscar...",e.style.color="#888",e.style.textAlign="center",e.style.padding="20px",n.appendChild(e)}}),r.addEventListener("keydown",e=>{"Escape"===e.key&&o.remove()}),o.addEventListener("click",e=>{e.target===o&&o.remove()});const i=document.createElement("div");i.textContent="Digite para começar a buscar...",i.style.color="#888",i.style.textAlign="center",i.style.padding="20px",n.appendChild(i)}()),e.ctrlKey&&"g"===e.key&&(e.preventDefault(),e.stopPropagation(),ne())})},1e3)});const je="tormenta-20-hotbars-animal-companion-type";function Pe(){return localStorage.getItem(je)||""}function Ae(e){localStorage.setItem(je,e)}const _e="tormenta-20-hotbars-selected-divinity",$e="tormenta-20-hotbars-selected-divinity-power";function Ie(){return localStorage.getItem(_e)||null}function Te(e){localStorage.setItem(_e,e)}function De(){return localStorage.getItem($e)||null}function Me(e){localStorage.setItem($e,e)}function Re(e){return De()===e}function Ve(){try{return localStorage.getItem(i)||null}catch(e){return g.log("Erro ao carregar raça selecionada:",e),null}}function Be(e){try{localStorage.setItem(i,e)}catch(e){g.log("Erro ao salvar raça selecionada:",e)}}function Ne(){try{return localStorage.getItem(c)||null}catch(e){return g.log("Erro ao carregar tipo de raça selecionado:",e),null}}function Oe(e){try{localStorage.setItem(c,e)}catch(e){g.log("Erro ao salvar tipo de raça selecionado:",e)}}function Fe(e){const a=Ve(),o=Ne();if("Suraggel"===a){if("Aggelus"===o&&"Luz Sagrada"===e)return!0;if("Sulfure"===o&&"Sombras Profanas"===e)return!0}return!1}function Ue(e){const a=[];if(Qe("prato_assado_de_carnes")&&a.push({label:"Assado de Carnes (+2 dano)",value:"assado_carnes",dice:"2",desc:"*+ Assado de Carnes (+2 dano)*",origin:"Prato Especial",priority:1}),Qe("prato_batata_valkariana")&&a.push({label:"Batata Valkariana (+1d6 acerto)",value:"batata_valkariana",attackMod:"1d6",desc:"*+ Batata Valkariana (+1d6 acerto)*",origin:"Prato Especial",priority:1}),Qe("prato_bolo_de_cenoura")&&a.push({label:"Bolo de Cenoura (+2 Percepção)",value:"bolo_cenoura",attackMod:2,desc:"*+ Bolo de Cenoura (+2 Percepção)*",origin:"Prato Especial",priority:2}),Qe("prato_estrogonofe")&&a.push({label:"Estrogonofe (+2 Vontade)",value:"estrogonofe",attackMod:2,desc:"*+ Estrogonofe (+2 Vontade)*",origin:"Prato Especial",priority:2}),Qe("prato_futomaki")&&a.push({label:"Futomaki (+2 Diplomacia)",value:"futomaki",attackMod:2,desc:"*+ Futomaki (+2 Diplomacia)*",origin:"Prato Especial",priority:2}),Qe("prato_pao_de_queijo")&&a.push({label:"Pão de Queijo (+2 Fortitude)",value:"pao_queijo",attackMod:2,desc:"*+ Pão de Queijo (+2 Fortitude)*",origin:"Prato Especial",priority:2}),Qe("prato_porco_assado")&&a.push({label:"Porco Assado (+1 Luta)",value:"porco_assado",attackMod:1,desc:"*+ Porco Assado (+1 Luta)*",origin:"Prato Especial",priority:2}),Qe("prato_salada_elfica")&&a.push({label:"Salada Elfica (+1 Pontaria)",value:"salada_elfica",attackMod:1,desc:"*+ Salada Elfica (+1 Pontaria)*",origin:"Prato Especial",priority:2}),Qe("prato_salada_imperial")&&a.push({label:"Salada Imperial (+2 Iniciativa)",value:"salada_imperial",attackMod:2,desc:"*+ Salada Imperial (+2 Iniciativa)*",origin:"Prato Especial",priority:2}),Qe("prato_sopa_de_cogumelo")&&a.push({label:"Sopa de Cogumelo (+2 Misticismo)",value:"sopa_cogumelo",attackMod:2,desc:"*+ Sopa de Cogumelo (+2 Misticismo)*",origin:"Prato Especial",priority:2}),Qe("prato_pizza")&&a.push({label:"Pizza (+1 Vontade/Reflexos/Fortitude)",value:"pizza",attackMod:1,desc:"*+ Pizza (+1 Vontade/Reflexos/Fortitude)*",origin:"Prato Especial",priority:2}),Qe("prato_baga_celeste_cozida")&&a.push({label:"Baga Celeste Cozida (Reduz dano de queda)",value:"baga_celeste_cozida",desc:"*+ Baga Celeste Cozida (Dano de queda reduzido em −1d6)*",origin:"Prato Especial",priority:2}),Qe("prato_cozido_de_pimenta")&&a.push({label:"Cozido de Pimenta (+1 Fortitude)",value:"cozido_de_pimenta",attackMod:1,desc:"*+ Cozido de Pimenta (+1 Fortitude)*",origin:"Prato Especial",priority:2}),Qe("prato_manjar_de_sombras")&&a.push({label:"Manjar de Sombras (Proteção contra trevas)",value:"manjar_de_sombras",desc:"*+ Manjar de Sombras (Ignora próximos 10 pontos de dano de trevas)*",origin:"Prato Especial",priority:2}),Qe("bebida_baba_de_troll")&&a.push({label:"Baba de Troll (+1d4 acerto)",value:"baba_de_troll",attackMod:"1d4",desc:"*+ Baba de Troll (+1d4 acerto)*",origin:"Bebida Artoniana",priority:1}),Qe("bebida_hidromel_uivante")&&a.push({label:"Hidromel Uivante (+2 dano corpo a corpo)",value:"hidromel_uivante",dice:"2",desc:"*+ Hidromel Uivante (+2 dano corpo a corpo)*",origin:"Bebida Artoniana",priority:2}),a.push({label:"Flanqueado (+2 acerto)",value:"flanqueado",attackMod:2,desc:"*+ Flanqueado*",origin:"Condição de Combate"}),Re("Espada Solar")&&a.push({label:"Espada Solar (+1d6 dano)",value:"espada_solar",dice:"1d6",desc:"*+ Espada Solar*",origin:"Divindade: Azgher"}),Re("Inimigo de Tenebra")&&a.push({label:"Inimigo de Tenebra (+1d6 vs mortos-vivos)",value:"inimigo_tenebra",dice:"1d6",desc:"*+ Inimigo de Tenebra*",origin:"Divindade: Azgher"}),K("Escaramuça")&&a.push({label:"Escaramuça (+1d8 dano)",value:"escaramurca",dice:"1d8",desc:"*+ Escaramuça*",origin:"Habilidade de Caçador"}),K("Marca da Presa")){let o=0,t="",s="";e>=17?(o=3,t="+2d10",s="+3 acerto, +2d10 dano, crit 16+"):e>=13?(o=3,t="+2d8",s="+3 acerto, +2d8 dano, crit 16+"):e>=9?(o=3,t="+1d12",s="+3 acerto, +1d12 dano, crit 16+"):e>=5?(o=2,t="+1d8",s="+2 acerto, +1d8 dano, crit 16+"):(o=1,t="+1d4",s="+1 acerto, +1d4 dano, crit 16+"),a.push({label:`Marca da Presa (${s})`,value:"marca_presa",dice:t.replace("+",""),attackMod:o,critMod:-2,desc:"*+ Marca da Presa*",origin:"Habilidade de Caçador"})}if(K("Inimigo de (Criatura)")&&a.push({label:"Inimigo (dobra margem de crítico)",value:"inimigo",desc:"*+ Inimigo*",origin:"Habilidade de Caçador"}),K("Companheiro Animal")&&"assassino"===Pe()){let o="1d6",t="*+ Ataque Furtivo*";(parseInt(e,10)||1)>=15&&(o="2d6"),a.push({label:`Ataque Furtivo (+${o} dano)`,value:"ataque_furtivo",dice:o,desc:t,origin:"Companheiro Animal: Assassino"})}return Qe("cachecol_sombrio")&&a.push({label:"Ataque Sombrio (+1d6 dano furtivo)",value:"ataque_sombrio",dice:"1d6",desc:"*+ Ataque Sombrio*",origin:"Item: Cachecol Sombrio"}),a.sort((e,a)=>{const o=e.priority||0;return(a.priority||0)-o}),a}const Le={createAbility:e=>({nome:e.nome,descricao:e.descricao,onClick:()=>He(e.nome,e.nome)})};function We(){const e=document.getElementById("abilities-popup");e&&e.remove();const a=document.getElementById("abilities-overlay");a&&a.remove();const o=document.createElement("div");o.id="abilities-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove()},document.body.appendChild(o);const t=document.createElement("div");t.id="abilities-popup",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="400px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("abilities-overlay");e&&e.remove()}}),n=document.createElement("h3");n.textContent="Poderes",n.style.color="#ecf0f1",n.style.margin="0",n.style.fontSize="17px",n.style.fontWeight="bold",s.appendChild(n),s.appendChild(r.render()),t.appendChild(s);const i=document.createElement("div");i.style.position="relative",i.style.marginBottom="10px";const c=document.createElement("input");c.type="text",c.placeholder="Filtrar poderes...",c.style.width="100%",c.style.padding="10px 28px 10px 12px",c.style.borderRadius="8px",c.style.border="1px solid #6ec6ff",c.style.background="#23243a",c.style.color="#fff",c.style.fontSize="14px",c.style.outline="none",c.style.boxSizing="border-box",c.style.fontSize="15px";const d=document.createElement("span");d.textContent="×",d.style.position="absolute",d.style.right="8px",d.style.top="50%",d.style.transform="translateY(-50%)",d.style.cursor="pointer",d.style.color="#6ec6ff",d.style.fontSize="18px",d.style.display="none",d.onclick=()=>{c.value="",c.dispatchEvent(new Event("input")),c.focus()},c.oninput=()=>{c.value.length>0?d.style.display="block":d.style.display="none",u()},i.appendChild(c),t.appendChild(i);const l=z("power");t.appendChild(l);const m=document.createElement("div");function u(){const e=c.value.trim().toLowerCase();m.innerHTML="";const a=[];K("Ervas Curativas")&&a.push(Le.createAbility({nome:"Ervas Curativas",descricao:"Você pode gastar uma ação completa e uma quantidade de PM a sua escolha (limitado por sua Sabedoria) para aplicar ervas que curam ou desintoxicam em você ou num aliado adjacente. Para cada PM que gastar, cura 2d6 PV ou remove uma condição envenenado afetando o alvo. (JdA:51)"})),K("Bote")&&a.push(Le.createAbility({nome:"Bote",descricao:"Se estiver empunhando duas armas e fizer uma investida, você pode pagar 1 PM para fazer um ataque adicional com sua arma secundária. Pré-requisito: Ambidestria, 6º nível de caçador."})),K("Emboscar")&&a.push(Le.createAbility({nome:"Emboscar",descricao:"Você pode gastar 2 PM para realizar uma ação padrão adicional em seu turno. Você só pode usar este poder na primeira rodada de um combate. Pré-requisito: treinado em Furtividade."}));const o=a.filter(a=>a.nome.toLowerCase().includes(e));if(0===o.length){const a=document.createElement("div");if(a.style.textAlign="center",a.style.padding="20px",a.style.color="#999",a.style.fontSize="14px",a.style.fontStyle="italic",e.length>0){const a=ye(e,"habilidade","blue");return void m.appendChild(a)}a.innerHTML='\n                            <div style="margin-bottom: 8px;">✨</div>\n                            <div>Nenhuma habilidade disponível</div>\n                            <div style="margin-top: 8px; font-size: 12px;">Aprenda habilidades no modal da classe para vê-las aqui</div>\n                        ',m.appendChild(a)}else o.forEach(e=>{const a=document.createElement("button");a.textContent=e.nome,a.style.width="100%",a.style.background="#23243a",a.style.color="#fff",a.style.border="1px solid #6ec6ff",a.style.borderRadius="6px",a.style.padding="10px 0",a.style.fontSize="15px",a.style.fontWeight="bold",a.style.cursor="pointer",a.style.transition="all 0.2s",a.style.position="relative";let o=null,t=null;a.onmouseover=()=>{a.style.background="#6ec6ff",a.style.color="#23243a",t=setTimeout(()=>{o&&o.remove(),o=document.createElement("div"),o.style.position="fixed",o.style.background="rgba(20,20,30,0.98)",o.style.border="2px solid #6ec6ff",o.style.borderRadius="8px",o.style.padding="12px",o.style.minWidth="280px",o.style.maxWidth="320px",o.style.zIndex="10004",o.style.boxShadow="0 4px 16px rgba(0,0,0,0.8)",o.style.pointerEvents="none";const t=a.getBoundingClientRect();o.style.left=t.right+10+"px",o.style.top=t.top+"px";const s=document.createElement("div");s.style.display="flex",s.style.flexDirection="column",s.style.gap="8px";const r=document.createElement("div");r.textContent=e.nome,r.style.color="#6ec6ff",r.style.fontSize="16px",r.style.fontWeight="bold",r.style.marginBottom="4px",s.appendChild(r);const n=document.createElement("div");n.textContent="Habilidade de Classe",n.style.background="#6ec6ff",n.style.color="#23243a",n.style.fontSize="11px",n.style.fontWeight="bold",n.style.borderRadius="4px",n.style.padding="2px 8px",n.style.display="inline-block",n.style.width="fit-content",s.appendChild(n);const i=document.createElement("div");"Bote"===e.nome||"Emboscar"===e.nome?(i.textContent="Ação Livre",i.style.background="#ff6e6e"):(i.textContent="Poder de Caçador",i.style.background="#4a90e2"),i.style.color="#fff",i.style.fontSize="11px",i.style.fontWeight="bold",i.style.borderRadius="4px",i.style.padding="2px 8px",i.style.display="inline-block",i.style.width="fit-content",i.style.marginTop="2px",s.appendChild(i);const c=document.createElement("div");"Ervas Curativas"===e.nome?c.textContent="Ação completa: Gaste PM para curar 2d6 PV por PM ou remover condição envenenado de você ou aliado adjacente.":"Bote"===e.nome?c.textContent="Ação livre: Pague 1 PM para fazer um ataque adicional com arma secundária durante uma investida.":"Emboscar"===e.nome&&(c.textContent="Ação livre: Pague 2 PM para realizar uma ação padrão adicional na primeira rodada de combate."),c.style.color="#ecf0f1",c.style.fontSize="13px",c.style.lineHeight="1.4",c.style.marginTop="6px",s.appendChild(c),o.appendChild(s),document.body.appendChild(o)},300)},a.onmouseout=()=>{a.style.background="#23243a",a.style.color="#fff",t&&(clearTimeout(t),t=null),o&&(o.remove(),o=null)},a.onclick=e.onClick,m.appendChild(a)})}m.style.display="flex",m.style.flexDirection="column",m.style.gap="8px",m.style.marginTop="2px",t.appendChild(m),u(),document.body.appendChild(t),S(t,"blue")}function He(e,a){if("Bote"===e){const e=document.getElementById("power-cast-popup");e&&e.remove();const o=document.getElementById("power-cast-overlay");o&&o.remove();const t=document.createElement("div");t.id="power-cast-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="power-cast-popup",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ff6e6e",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="400px",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="10px",r.style.width="100%";const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="flex-start",n.style.gap="2px";const i=document.createElement("h3");i.textContent=a,i.style.color="#ecf0f1",i.style.margin="0",i.style.fontSize="18px",i.style.fontWeight="bold",n.appendChild(i);const c=document.createElement("span");c.textContent="Habilidade de Combate",c.style.background="#ff6e6e",c.style.color="#23243a",c.style.fontSize="12px",c.style.fontWeight="bold",c.style.borderRadius="8px",c.style.padding="2px 10px",c.style.marginTop="2px",c.style.display="inline-block",c.style.letterSpacing="0.5px",c.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)",n.appendChild(c),r.appendChild(n);const d=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove();const e=document.getElementById("power-cast-overlay");e&&e.remove()}});r.appendChild(d.render()),s.appendChild(r);const l=document.createElement("div");l.style.background="#1a1a2e",l.style.border="1px solid #ff6e6e",l.style.borderRadius="8px",l.style.padding="12px",l.style.marginBottom="15px",l.style.display="flex",l.style.flexDirection="column",l.style.gap="6px";const m=document.createElement("div");m.textContent="Descrição",m.style.color="#ff6e6e",m.style.fontSize="13px",m.style.fontWeight="bold",m.style.marginBottom="2px",l.appendChild(m);const u=document.createElement("div");u.style.color="#ecf0f1",u.style.fontSize="14px",u.style.lineHeight="1.4",u.textContent="Se estiver empunhando duas armas e fizer uma investida, você pode pagar 1 PM para fazer um ataque adicional com sua arma secundária. Pré-requisito: Ambidestria, 6º nível de caçador.",l.appendChild(u);const p=document.createElement("button");p.textContent="Compartilhar",p.style.background="none",p.style.border="1px solid #ff6e6e",p.style.color="#ff6e6e",p.style.fontSize="14px",p.style.fontWeight="bold",p.style.borderRadius="6px",p.style.padding="8px 0",p.style.marginTop="10px",p.style.width="100%",p.style.cursor="pointer",p.style.transition="all 0.2s",p.onmouseover=()=>{p.style.background="#ff6e6e",p.style.color="#23243a"},p.onmouseout=()=>{p.style.background="none",p.style.color="#ff6e6e"},p.onclick=()=>{Z(`&{template:t20-info}{{infoname=Bote}}{{description=${u.textContent}}}`)},l.appendChild(p),s.appendChild(l);const g=document.createElement("button");g.textContent="Executar Ataque com Bote",g.style.background="#ff6e6e",g.style.color="#23243a",g.style.border="none",g.style.borderRadius="8px",g.style.padding="12px 0",g.style.fontSize="16px",g.style.fontWeight="bold",g.style.cursor="pointer",g.style.transition="all 0.2s",g.style.marginBottom="10px",g.onmouseover=()=>{g.style.background="#ff8e8e"},g.onmouseout=()=>{g.style.background="#ff6e6e"},g.onclick=()=>{let e=[];try{const a=localStorage.getItem("tormenta-20-hotbars-attack-effects");a&&(e=JSON.parse(a))}catch(a){console.error("Erro ao carregar seleção:",a),e=[]}const a=Ue(parseInt(localStorage.getItem(T)||"1",10)||1);let o="",t="",s=18,r=2,n=!1,i=!1;a.forEach(a=>{e.includes(a.value)&&(a.dice&&(o+=`+${a.dice}`),a.critMod&&(s+=a.critMod),a.attackMod&&(r+=a.attackMod),t+="%NEWLINE% "+a.desc,"marca_presa"===a.value&&(n=!0),"inimigo"===a.value&&(i=!0))}),i&&n&&16===s&&(s=14),Z(`/em ${$()} usa **Bote** (1 PM) para fazer um ataque adicional com sua arma secundária!`),he(`&{template:t20-attack}{{character=@{${I()}|character_name}}}{{attackname=Ataque Adicional}}{{attackroll=[[1d20cs>${s}+[[@{${I()}|pontariatotal}+@{${I()}|condicaomodataquedis}+@{${I()}|condicaomodataque}]]+${r}+@{${I()}|ataquetemp}]]}} {{damageroll=[[2d8+@{${I()}|des_mod}+0+0+@{${I()}|danotemp}+@{${I()}|rolltemp}${o}]]}} {{criticaldamageroll=[[2d8 + 2d8 + 2d8 + 0 + 0+0+@{${I()}|des_mod}+0]]}}{{typeofdamage=Cortante}}{{description=**Bote c/ Espada Longa (1PM)** ${t}}}`),["power-cast-popup","power-cast-overlay","abilities-popup","abilities-overlay","skills-popup","skills-overlay","spells-popup","spells-overlay","maneuvers-popup","maneuvers-overlay","attack-effects-popup","attack-effects-overlay","effects-popup","effects-overlay","avatar-popup","avatar-overlay"].forEach(e=>{const a=document.getElementById(e);a&&a.remove()})},s.appendChild(g),document.body.appendChild(s)}else if("Emboscar"===e){const e=document.getElementById("power-cast-popup");e&&e.remove();const o=document.getElementById("power-cast-overlay");o&&o.remove();const t=document.createElement("div");t.id="power-cast-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="power-cast-popup",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #ff6e6e",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="400px",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="10px",r.style.width="100%";const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="flex-start",n.style.gap="2px";const i=document.createElement("h3");i.textContent=a,i.style.color="#ecf0f1",i.style.margin="0",i.style.fontSize="18px",i.style.fontWeight="bold",n.appendChild(i);const c=document.createElement("span");c.textContent="Habilidade de Combate",c.style.background="#ff6e6e",c.style.color="#23243a",c.style.fontSize="12px",c.style.fontWeight="bold",c.style.borderRadius="8px",c.style.padding="2px 10px",c.style.marginTop="2px",c.style.display="inline-block",c.style.letterSpacing="0.5px",c.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)",n.appendChild(c),r.appendChild(n);const d=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove();const e=document.getElementById("power-cast-overlay");e&&e.remove()}});r.appendChild(d.render()),s.appendChild(r);const l=document.createElement("div");l.style.background="#1a1a2e",l.style.border="1px solid #ff6e6e",l.style.borderRadius="8px",l.style.padding="12px",l.style.marginBottom="15px",l.style.display="flex",l.style.flexDirection="column",l.style.gap="6px";const m=document.createElement("div");m.textContent="Descrição",m.style.color="#ff6e6e",m.style.fontSize="13px",m.style.fontWeight="bold",m.style.marginBottom="2px",l.appendChild(m);const u=document.createElement("div");u.style.color="#ecf0f1",u.style.fontSize="14px",u.style.lineHeight="1.4",u.textContent="Você pode gastar 2 PM para realizar uma ação padrão adicional em seu turno. Você só pode usar este poder na primeira rodada de um combate. Pré-requisito: treinado em Furtividade.",l.appendChild(u);const p=document.createElement("button");p.textContent="Compartilhar",p.style.background="none",p.style.border="1px solid #ff6e6e",p.style.color="#ff6e6e",p.style.fontSize="14px",p.style.fontWeight="bold",p.style.borderRadius="6px",p.style.padding="8px 0",p.style.marginTop="10px",p.style.width="100%",p.style.cursor="pointer",p.style.transition="all 0.2s",p.onmouseover=()=>{p.style.background="#ff6e6e",p.style.color="#23243a"},p.onmouseout=()=>{p.style.background="none",p.style.color="#ff6e6e"},p.onclick=()=>{Z(`&{template:t20-info}{{infoname=Emboscar}}{{description=${u.textContent}}}`)},l.appendChild(p),s.appendChild(l);const g=document.createElement("button");g.textContent="Executar Ação Adicional",g.style.background="#ff6e6e",g.style.color="#23243a",g.style.border="none",g.style.borderRadius="8px",g.style.padding="12px 0",g.style.fontSize="16px",g.style.fontWeight="bold",g.style.cursor="pointer",g.style.transition="all 0.2s",g.style.marginBottom="10px",g.onmouseover=()=>{g.style.background="#ff8e8e"},g.onmouseout=()=>{g.style.background="#ff6e6e"},g.onclick=()=>{Z(`/em ${$()} usa **Emboscar** (2 PM) para realizar uma ação padrão adicional!`),["power-cast-popup","power-cast-overlay","abilities-popup","abilities-overlay","skills-popup","skills-overlay","spells-popup","spells-overlay","maneuvers-popup","maneuvers-overlay","attack-effects-popup","attack-effects-overlay","effects-popup","effects-overlay","avatar-popup","avatar-overlay"].forEach(e=>{const a=document.getElementById(e);a&&a.remove()})},s.appendChild(g),document.body.appendChild(s)}else if("Ervas Curativas"===e){const e=document.getElementById("power-cast-popup");e&&e.remove();const o=document.getElementById("power-cast-overlay");o&&o.remove();const t=document.createElement("div");t.id="power-cast-overlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.zIndex="10002",t.onclick=()=>{t.remove(),s.remove()},document.body.appendChild(t);const s=document.createElement("div");s.id="power-cast-popup",s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.background="rgba(30,30,40,0.98)",s.style.border="2px solid #6ec6ff",s.style.borderRadius="12px",s.style.padding="20px",s.style.zIndex="10003",s.style.maxWidth="400px",s.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="stretch";const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.style.marginBottom="10px",r.style.width="100%";const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="flex-start",n.style.gap="2px";const i=document.createElement("h3");i.textContent=a,i.style.color="#ecf0f1",i.style.margin="0",i.style.fontSize="18px",i.style.fontWeight="bold",n.appendChild(i);const c=document.createElement("span");c.textContent="Habilidade de Classe",c.style.background="#6ec6ff",c.style.color="#23243a",c.style.fontSize="12px",c.style.fontWeight="bold",c.style.borderRadius="8px",c.style.padding="2px 10px",c.style.marginTop="2px",c.style.display="inline-block",c.style.letterSpacing="0.5px",c.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)",n.appendChild(c),r.appendChild(n);const d=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{s.remove();const e=document.getElementById("power-cast-overlay");e&&e.remove()}});r.appendChild(d.render()),s.appendChild(r);const l=document.createElement("div");l.style.background="#1a1a2e",l.style.border="1px solid #6ec6ff",l.style.borderRadius="8px",l.style.padding="12px",l.style.marginBottom="15px",l.style.display="flex",l.style.flexDirection="column",l.style.gap="6px";const m=document.createElement("div");m.textContent="Descrição",m.style.color="#6ec6ff",m.style.fontSize="13px",m.style.fontWeight="bold",m.style.marginBottom="2px",l.appendChild(m);const u=document.createElement("div");u.style.color="#ecf0f1",u.style.fontSize="14px",u.style.lineHeight="1.4",u.textContent="Você pode gastar uma ação completa e uma quantidade de PM a sua escolha (limitado por sua Sabedoria) para aplicar ervas que curam ou desintoxicam em você ou num aliado adjacente. Para cada PM que gastar, cura 2d6 PV ou remove uma condição envenenado afetando o alvo. (JdA:51)",l.appendChild(u);const p=document.createElement("button");p.textContent="Compartilhar",p.style.background="none",p.style.border="1px solid #6ec6ff",p.style.color="#6ec6ff",p.style.fontSize="14px",p.style.fontWeight="bold",p.style.borderRadius="6px",p.style.padding="8px 0",p.style.marginTop="10px",p.style.width="100%",p.style.cursor="pointer",p.style.transition="all 0.2s",p.onmouseover=()=>{p.style.background="#6ec6ff",p.style.color="#23243a"},p.onmouseout=()=>{p.style.background="none",p.style.color="#6ec6ff"},p.onclick=()=>{Z(`&{template:t20-info}{{infoname=Ervas Curativas}}{{description=${u.textContent}}}`)},l.appendChild(p),s.appendChild(l);const f=document.createElement("div");f.style.marginBottom="20px";const v=document.createElement("div");v.textContent="Custo em PM:",v.style.color="#ecf0f1",v.style.fontSize="14px",v.style.fontWeight="bold",v.style.marginBottom="10px",f.appendChild(v);const y=document.createElement("div");y.style.display="flex",y.style.gap="8px",y.style.justifyContent="center",y.style.background="#1a1a2e",y.style.border="1px solid #6ec6ff",y.style.borderRadius="12px",y.style.padding="15px",y.style.marginTop="5px";let b=0;const h=[];for(let e=1;e<=5;e++){const a=document.createElement("button");a.textContent=e,a.style.width="40px",a.style.height="40px",a.style.borderRadius="50%",a.style.border="2px solid #6ec6ff",a.style.background="#23243a",a.style.color="#6ec6ff",a.style.fontSize="16px",a.style.fontWeight="bold",a.style.cursor="pointer",a.style.transition="all 0.2s",h.push(a),a.onclick=()=>{b=e,h.forEach((a,o)=>{o<e?(a.style.background="#6ec6ff",a.style.color="#23243a"):(a.style.background="#23243a",a.style.color="#6ec6ff")})},y.appendChild(a)}f.appendChild(y),s.appendChild(f);const x=document.createElement("button");return x.textContent="Usar",x.style.width="100%",x.style.padding="12px 0",x.style.background="#6ec6ff",x.style.color="#23243a",x.style.border="none",x.style.borderRadius="8px",x.style.fontSize="16px",x.style.fontWeight="bold",x.style.cursor="pointer",x.style.transition="all 0.2s",x.style.marginTop="10px",x.onmouseover=()=>{x.style.background="#5bb8ff"},x.onmouseout=()=>{x.style.background="#6ec6ff"},x.onclick=()=>{if(0===b)return void alert("Selecione pelo menos 1 PM para usar!");const e=document.getElementById("power-cast-popup");e&&e.remove();const o=document.getElementById("power-cast-overlay");o&&o.remove();const t=document.getElementById("abilities-popup");t&&t.remove();const s=document.getElementById("abilities-overlay");var r,n;s&&s.remove(),r=`/roll ${2*b}d6`,n=`/em usou o poder "${a}" (${b} PM)`,Z("/fx nova-holy @{target|token_id}"),setTimeout(()=>{Z(r),Z(n),setTimeout(()=>{!function(){const e=document.getElementById("healing-effect");e&&e.remove(),function(){try{const e=new Audio;e.src="https://wow.zamimg.com/sound-ids/live/enus/80/1687888/Spell_DR_Revamp_Nature_Cast_Small06.ogg",e.volume=.6,e.preload="auto",e.play()}catch(e){g.log("Erro ao criar áudio de cura:",e),be()}}();const a=document.createElement("div");a.id="healing-effect",a.style.position="fixed",a.style.bottom="0",a.style.left="0",a.style.width="100%",a.style.height="15vh",a.style.background="linear-gradient(to top, rgba(76, 255, 80, 0.45), transparent 80%)",a.style.zIndex="9998",a.style.pointerEvents="none",a.style.overflow="hidden";for(let e=0;e<15;e++){const e=document.createElement("div");e.style.position="absolute",e.style.bottom="10px",e.left="-50px",e.style.width="20px",e.style.height="20px",e.style.background="radial-gradient(circle, #4CAF50 0%, #388E3C 70%, #2E7D32 100%)",e.style.borderRadius="50% 0 50% 0",e.style.transform="rotate(45deg)",e.style.opacity="0.8",e.style.animation="leafFloat 1.5s linear",e.style.animationDelay=`${Math.random()}s`;const o=10+20*Math.random();e.style.setProperty("--leaf-amplitude",`${o}px`),a.appendChild(e)}if(!document.getElementById("healing-effect-styles")){const e=document.createElement("style");e.id="healing-effect-styles",e.textContent="\n                    @keyframes leafFloat {\n                        0% {\n                            transform: translateX(-50px) translateY(0px) rotate(45deg);\n                            opacity: 0;\n                        }\n                        10% {\n                            opacity: 0.8;\n                        }\n                        20% {\n                            transform: translateX(20vw) translateY(calc(var(--leaf-amplitude) * -1)) rotate(45deg);\n                        }\n                        40% {\n                            transform: translateX(40vw) translateY(calc(var(--leaf-amplitude) * 1)) rotate(45deg);\n                        }\n                        60% {\n                            transform: translateX(60vw) translateY(calc(var(--leaf-amplitude) * -1)) rotate(45deg);\n                        }\n                        80% {\n                            transform: translateX(80vw) translateY(calc(var(--leaf-amplitude) * 1)) rotate(45deg);\n                        }\n                        100% {\n                            transform: translateX(calc(100vw + 50px)) translateY(0px) rotate(45deg);\n                            opacity: 0;\n                        }\n                    }\n                ",document.head.appendChild(e)}document.body.appendChild(a),setTimeout(()=>{a.parentNode&&a.remove()},2e3)}()},100)},200)},s.appendChild(x),void document.body.appendChild(s)}}function Je(){const e=localStorage.getItem("tormenta-20-hotbars-active-effects");return e?JSON.parse(e):[]}function Ge(e){localStorage.setItem("tormenta-20-hotbars-active-effects",JSON.stringify(e))}function Qe(e){const a=Je(),o=fa();return a.includes(e)||o.includes(e)}function Ke(e,a=!1){const o=Je(),t=o.indexOf(e);return t>-1?(o.splice(t,1),ca(e,ta(e)?"item":"food"),a||_(`Efeito "${e}" desativado.`)):(o.push(e),ia(e,ta(e)?"item":"food"),a||A(`Efeito "${e}" ativado!`)),Ge(o),Ye(),pa(),o}function Ye(){const e=document.querySelector('#roll20-hotbar button[data-label="Efeitos"]');if(!e)return void g.log("Botão de efeitos não encontrado");const a=e.querySelector(".hotbar-button-badge");a&&a.remove();const o=Je(),t=fa(),s=o.length+t.length;if(g.log("Efeitos ativos:",o),g.log("Selectable cards ativos:",t),s>0){const a=document.createElement("div");a.className="hotbar-button-badge",a.style.position="absolute",a.style.top="-2px",a.style.right="-2px",a.style.background="#4caf50",a.style.color="#fff",a.style.borderRadius="50%",a.style.width="16px",a.style.height="16px",a.style.fontSize="10px",a.style.fontWeight="bold",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.border="2px solid #23243a",a.style.zIndex="1000",a.textContent=s,e.appendChild(a),g.log("Badge criado com valor:",s)}else g.log("Nenhum efeito ativo, badge não criado")}function Xe(){try{const e=localStorage.getItem(l);if(!e)return{version:m,images:{}};const a=JSON.parse(e);return a.version!==m?(g.log("Versão do cache de imagens desatualizada, limpando..."),la(),{version:m,images:{}}):{version:a.version||m,images:a.images||{}}}catch(e){return console.error("Erro ao carregar cache de imagens:",e),{version:m,images:{}}}}function Ze(){const e=localStorage.getItem("tormenta-20-hotbars-active-conditions");return e?JSON.parse(e):[]}function ea(e){const a=Ze(),o=a.indexOf(e);var t;return o>-1?(a.splice(o,1),Ke(e,!0),ca(e,"condition"),_(`Condição "${e}" removida.`)):(a.push(e),Ke(e,!0),ia(e,"condition"),A(`Condição "${e}" aplicada!`),oa(e)),t=a,localStorage.setItem("tormenta-20-hotbars-active-conditions",JSON.stringify(t)),pa(),Ye(),Je()}function aa(e){return da().find(a=>a.nome===e)}function oa(e){const a=aa(e);a&&Z(`&{template:t20-info}{{infoname=${e} ${a.icone||"⚡"}}}{{description=Categoria: ${a.categoria||"Status"}\n${a.efeitos||a.descricao}}}`)}function ta(e){return[{name:"Cachecol Sombrio",description:"Efeito de Dano: Todos os ataques melee recebem +1d6 de dano furtivo. Efeito acumulativo com outros ataques furtivos.",type:"Item",effectKey:"cachecol_sombrio",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_ambush.jpg",icone:"⚔️"}].find(a=>a.effectKey===e)}const sa="tormenta-20-hotbars-effects-order";function ra(){try{return JSON.parse(localStorage.getItem(sa)||"[]")}catch(e){return console.error("Erro ao carregar ordem dos efeitos:",e),[]}}function na(e){try{localStorage.setItem(sa,JSON.stringify(e))}catch(e){console.error("Erro ao salvar ordem dos efeitos:",e)}}function ia(e,a){const o=ra(),t=`${a}:${e}`,s=o.findIndex(e=>e.id===t);-1!==s&&o.splice(s,1),o.unshift({id:t,effectKey:e,effectType:a,timestamp:Date.now()}),na(o)}function ca(e,a){const o=ra(),t=`${a}:${e}`,s=o.findIndex(e=>e.id===t);-1!==s&&(o.splice(s,1),na(o))}function da(){try{return[{nome:"Abalado",descricao:"O personagem sofre -2 em testes de perícia. Se ficar abalado novamente, em vez...",descricaoCompleta:"O personagem sofre -2 em testes de perícia. Se ficar abalado novamente, em vez disso fica Apavorado.",efeitos:"-2 em testes",categoria:"Medo",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg",icone:"😰"},{nome:"Agarrado",descricao:"O personagem fica Desprevenido e Imóvel, sofre -2 em testes de ataque e só pode...",descricaoCompleta:"O personagem fica Desprevenido e Imóvel, sofre -2 em testes de ataque e só pode atacar com armas leves. Um personagem fazendo um ataque à distância contra um alvo envolvido na manobra agarrar tem 50% de chance de acertar o alvo errado.\n\nDesprevenido: -5 defesa e -5 Reflexos.\n\nImóvel: Todas as formas de deslocamento são reduzidas a 0m.",efeitos:"-2 em testes • -5 em testes",categoria:"Paralisia",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg",icone:"🤝"},{nome:"Alquebrado",descricao:"Condição Mental\n\nO custo em pontos de mana das habilidades e magias do...",descricaoCompleta:"Condição Mental\n\nO custo em pontos de mana das habilidades e magias do personagem aumenta em +1.",efeitos:"+1 PM no custo de habilidades",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"🧠"},{nome:"Apavorado",descricao:"O personagem sofre –5 em testes de perícia e não pode se aproximar...",descricaoCompleta:"O personagem sofre –5 em testes de perícia e não pode se aproximar voluntariamente da fonte do medo.",efeitos:"Efeitos variam conforme a condição",categoria:"Medo",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathscream.jpg",icone:"😱"},{nome:"Atordoado",descricao:"Condição Mental\n\nO personagem fica Desprevenido e não pode fazer...",descricaoCompleta:"Condição Mental\n\nO personagem fica Desprevenido e não pode fazer ações.\n\nDesprevenido:  Defesa -5 e Reflexos -5.",efeitos:"-5 em testes • Não pode fazer ações",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindsteal.jpg",icone:"💫"},{nome:"Caído",descricao:"Condição Física\n\nDeitado no chão. O personagem sofre -5 em ataques corpo a...",descricaoCompleta:"Condição Física\n\nDeitado no chão. O personagem sofre -5 em ataques corpo a corpo e seu deslocamento é reduzido a 1,5m. Além disso, sofre -5 de Defesa contra ataques corpo a corpo, mas recebe +5 de Defesa contra ataques à distância.",efeitos:"-5 em testes",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbindtotem.jpg",icone:"🛐"},{nome:"Cego",descricao:"Condição Física\n\nO personagem fica Desprevenido e Lento, não pode fazer testes...",descricaoCompleta:"Condição Física\n\nO personagem fica Desprevenido e Lento, não pode fazer testes de Percepção para observar e sofre -5 em testes de perícias baseadas em Força ou Destreza. Todos os alvos de seus ataques recebem camuflagem total. Condição de sentidos.\n\n• Desprevenido: defesa -5 e reflexos -5.\n\n• Lento: movimento reduzido a metade e não pode correr ou fazer investidas.",efeitos:"-5 em testes",categoria:"sentidos.",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg",icone:"👁️"},{nome:"Confuso",descricao:"Condição Mental\n\nO personagem comporta-se de modo aleatório. Role 1d6 no início...",descricaoCompleta:"Condição Mental\n\nO personagem comporta-se de modo aleatório. Role 1d6 no início de seus turnos:\n\n• 1) Movimenta-se em uma direção escolhida por uma rolagem de 1d8;\n\n• 2-3) Não pode fazer ações, exceto reações, e fica balbuciando incoerentemente;\n\n• 4-5) Usa a arma que estiver empunhando para atacar a criatura mais próxima, ou a si mesmo se estiver sozinho (nesse caso, apenas role o dano);\n\n• 6) A condição termina e pode agir normalmente.",efeitos:"-5 em testes • Sofre dano • 1d6 dano por turno • Ação aleatória (1d6)",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindsteal.jpg",icone:"🤪"},{nome:"Debilitado",descricao:"Condição Física\n\nO personagem sofre -5 em testes de atributos físicos (Força,...",descricaoCompleta:"Condição Física\n\nO personagem sofre -5 em testes de atributos físicos (Força, Destreza e Constituição) e de perícias baseadas nesses atributos. Se o personagem ficar debilitado novamente, em vez disso fica Inconsciente.",efeitos:"-5 em testes",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"😵"},{nome:"Desprevenido",descricao:"Condição Física\n\nDespreparado para reagir. O personagem sofre -5 na Defesa e em...",descricaoCompleta:"Condição Física\n\nDespreparado para reagir. O personagem sofre -5 na Defesa e em Reflexos. Você fica desprevenido contra inimigos que não possa ver.",efeitos:"-5 em testes • Fica desprevenido",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofmannoroth.jpg",icone:"😳"},{nome:"Doente",descricao:"Condição Física\n\nSob efeito de uma doença.",descricaoCompleta:"Condição Física\n\nSob efeito de uma doença.",efeitos:"Efeitos variam conforme a condição",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_poisoncleansingtotem.jpg",icone:"🤒"},{nome:"Em Chamas",descricao:"Em Chamas\n\nCondição Física\n\nO personagem está pegando fogo. No início de seus...",descricaoCompleta:"Em Chamas\n\nCondição Física\n\nO personagem está pegando fogo. No início de seus turnos, sofre [[/r 1d6]] pontos de dano de fogo. O personagem pode gastar uma ação padrão para apagar o fogo com as mãos. Imersão em água também apaga as chamas.",efeitos:"Sofre dano • 1d6 dano por turno",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_immolation.jpg",icone:"🔥"},{nome:"Enjoado",descricao:"Condição Física\n\nO personagem só pode realizar uma ação padrão ou de movimento...",descricaoCompleta:"Condição Física\n\nO personagem só pode realizar uma ação padrão ou de movimento (não ambas) por rodada. Ele ainda pode fazer ações livres ou extras, como o normal. Ele pode gastar uma ação padrão para fazer uma investida, mas pode avançar no máximo seu deslocamento (e não o dobro).",efeitos:"Efeitos variam conforme a condição",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_poisoncleansingtotem.jpg",icone:"🤢"},{nome:"Enredado",descricao:"O personagem fica Lento e Vulnerável e sofre -2 em testes de ataque.\n\n• Lento:...",descricaoCompleta:"O personagem fica Lento e Vulnerável e sofre -2 em testes de ataque.\n\n• Lento: Movimento reduzido a metade e não pode correr ou fazer investidas.\n\n• Vúlnerável: Defesa -2.",efeitos:"-2 em testes",categoria:"Paralisia",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg",icone:"🕸️"},{nome:"Envenenado",descricao:"Condição Física\n\nO efeito desta condição varia de acordo com o veneno. Pode ser...",descricaoCompleta:"Condição Física\n\nO efeito desta condição varia de acordo com o veneno. Pode ser outra condição (por exemplo, fraco ou enjoado) ou dano recorrente (por exemplo, 1d12 pontos de dano por rodada). A descrição do veneno determina a duração dele (caso nada seja dito, a condição dura pela cena).",efeitos:"Sofre dano",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_poisoncleansingtotem.jpg",icone:"☠️"},{nome:"Esmorecido",descricao:"Condição Mental\n\nO personagem sofre -5 em testes de atributos mentais...",descricaoCompleta:"Condição Mental\n\nO personagem sofre -5 em testes de atributos mentais (Inteligência, Sabedoria e Carisma) e de perícias baseadas nesses atributos.",efeitos:"-5 em testes",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"😞"},{nome:"Exausto",descricao:"O personagem fica Debilitado, Lento e Vulnerável. Se ficar exausto novamente,...",descricaoCompleta:"O personagem fica Debilitado, Lento e Vulnerável. Se ficar exausto novamente, em vez disso fica Inconsciente.\n\n• Debilitado: -5 em testes de atributos físicos e de perícias baseadas nestes atributos.\n\n• Lento: Movimento reduzido a metade e não pode correr ou fazer investidas.\n\n• Vulnerável: Sofre Defesa -2.",efeitos:"-2 em testes • -5 em testes",categoria:"Fadiga",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"😴"},{nome:"Fascinado",descricao:"Condição Mental\n\nCom a atenção presa em alguma coisa. O personagem sofre -5 em...",descricaoCompleta:"Condição Mental\n\nCom a atenção presa em alguma coisa. O personagem sofre -5 em Percepção e não pode fazer ações, exceto observar aquilo que o fascinou. Qualquer ação hostil contra o personagem anula esta condição. Balançar uma criatura fascinada para tirá-la desse estado gasta uma ação padrão.",efeitos:"-5 em testes • Não pode fazer ações",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_eyeofthestorm.jpg",icone:"😵"},{nome:"Fatigado",descricao:"O personagem fica Fraco e Vulnerável. Se o personagem ficar fatigado novamente,...",descricaoCompleta:"O personagem fica Fraco e Vulnerável. Se o personagem ficar fatigado novamente, em vez disso fica Exausto.\n\n• Fraco: Sofre -2 em testes de atributos físicos (Força, Destreza e Constituição) e de perícias baseadas nestes atributos.\n\n• Vulnerável: Sofre Defesa -2.",efeitos:"-2 em testes",categoria:"Fadiga",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_sleep.jpg",icone:"😪"},{nome:"Fraco",descricao:"Condição Física\n\nO personagem sofre -2 em testes de atributos físicos (Força,...",descricaoCompleta:"Condição Física\n\nO personagem sofre -2 em testes de atributos físicos (Força, Destreza e Constituição) e de perícias baseadas nesses atributos. Se ficar fraco novamente, em vez disso fica Debilitado.",efeitos:"-2 em testes",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"😣"},{nome:"Frustrado",descricao:"Condição Mental\n\nO personagem sofre -2 em testes de atributos mentais...",descricaoCompleta:"Condição Mental\n\nO personagem sofre -2 em testes de atributos mentais (Inteligência, Sabedoria e Carisma) e de perícias baseadas nesses atributos. Se ficar frustrado novamente, em vez disso fica Esmorecido.",efeitos:"-2 em testes",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg",icone:"😤"},{nome:"Imóvel",descricao:"Todas as formas de deslocamento do personagem são reduzidas a 0m.",descricaoCompleta:"Todas as formas de deslocamento do personagem são reduzidas a 0m.",efeitos:"Efeitos variam conforme a condição",categoria:"Paralisia",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg",icone:"🛑"},{nome:"Inconsciente",descricao:"Condição Física\n\nO personagem fica Indefeso e não pode fazer ações. Balançar...",descricaoCompleta:"Condição Física\n\nO personagem fica Indefeso e não pode fazer ações. Balançar uma criatura para acordá-la gasta uma ação padrão.\n\n• Indefeso: É considerado Desprevenido, sofre -10 na Defesa, falha automaticamente em testes de Reflexos e pode sofrer golpes de misericórdia.",efeitos:"-10 na Defesa • Não pode fazer ações",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_blackplague.jpg",icone:"😵"},{nome:"Indefeso",descricao:"O personagem é considerado Desprevenido, mas sofre -10 na Defesa, falha...",descricaoCompleta:"O personagem é considerado Desprevenido, mas sofre -10 na Defesa, falha automaticamente em testes de Reflexos e pode sofrer golpes de misericórdia.",efeitos:"-10 na Defesa",categoria:"Status",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofmannoroth.jpg",icone:"💀"},{nome:"Lento",descricao:"Todas as formas de deslocamento do personagem são reduzidas à metade (arredonde...",descricaoCompleta:"Todas as formas de deslocamento do personagem são reduzidas à metade (arredonde para baixo para o primeiro incremento de 1,5m) e ele não pode correr ou fazer investidas.",efeitos:"Efeitos variam conforme a condição",categoria:"Paralisia",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg",icone:"🐌"},{nome:"Ofuscado",descricao:"O personagem sofre -2 em testes de ataque e de Percepção.",descricaoCompleta:"O personagem sofre -2 em testes de ataque e de Percepção.",efeitos:"-2 em testes",categoria:"Sentidos",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg",icone:"😵‍💫"},{nome:"Paralisado",descricao:"O personagem fica Imóvel e Indefeso e só pode realizar ações puramente...",descricaoCompleta:"O personagem fica Imóvel e Indefeso e só pode realizar ações puramente mentais.\n\n• Imóvel: todas as formas de deslocamento são reduzidas a 0m.\n\n• Indefeso: É considerado desprevinido, sofre -10 na Defesa, falha automaticamente em testes de Reflexos e pode sofrer golpes de miseridórdia.",efeitos:"-10 na Defesa",categoria:"Paralisia",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbindtotem.jpg",icone:"🧊"},{nome:"Pasmo",descricao:"Condição Mental\n\nO personagem não pode fazer ações, exceto reações.",descricaoCompleta:"Condição Mental\n\nO personagem não pode fazer ações, exceto reações.",efeitos:"Não pode fazer ações",categoria:"Mental",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindsteal.jpg",icone:"😶"},{nome:"Petrificado",descricao:"O personagem fica inconsciente e recebe resistência a dano 8.\n\n• Incosciente: O...",descricaoCompleta:"O personagem fica inconsciente e recebe resistência a dano 8.\n\n• Incosciente: O personagem fica Indefeso e não pode fazer ações.\n\n• Indefeso: É considerado Desprevenido, sofre -10 na Defesa, falha automaticamente em testes de Reflexos e pode sofrer golpes de misericórdia.",efeitos:"-10 na Defesa • Não pode fazer ações • Sofre dano",categoria:"Status",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antishadow.jpg",icone:"🗿"},{nome:"Sangrando",descricao:"Com um ferimento aberto. No início de seus turnos, o personagem deve fazer um...",descricaoCompleta:"Com um ferimento aberto. No início de seus turnos, o personagem deve fazer um teste de Constituição (CD 15). Se passar, estabiliza e remove essa condição. Se falhar, perde [[/r 1d6]] pontos de vida e continua sangrando.",efeitos:"Teste de Constituição • 1d6 dano por turno",categoria:"Status",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_blackplague.jpg",icone:"🩸"},{nome:"Surdo",descricao:"O personagem não pode fazer testes de Percepção para ouvir e sofre -5 em testes...",descricaoCompleta:"O personagem não pode fazer testes de Percepção para ouvir e sofre -5 em testes de Iniciativa. Além disso, é considerado em condição ruim para lançar magias.",efeitos:"-5 em testes",categoria:"Sentidos",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soulleech.jpg",icone:"🔇"},{nome:"Surpreendido",descricao:"Condição Física\n\nNão ciente de seus inimigos. O personagem fica Desprevenido e...",descricaoCompleta:"Condição Física\n\nNão ciente de seus inimigos. O personagem fica Desprevenido e não pode fazer ações, exceto reações.\n\n• Desprevenido: Sofre -5 na Defesa e em Reflexos.",efeitos:"-5 em testes • Não pode fazer ações",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofmannoroth.jpg",icone:"😲"},{nome:"Vulnerável",descricao:"Condição Física\n\nO personagem sofre -2 na Defesa.",descricaoCompleta:"Condição Física\n\nO personagem sofre -2 na Defesa.",efeitos:"-2 em testes",categoria:"Física",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofmannoroth.jpg",icone:"💔"}]}catch{return console.warn("Generated conditions data not available, using hardcoded data"),[]}}function la(){try{localStorage.removeItem(l),g.log("Cache de imagens limpo")}catch(e){console.error("Erro ao limpar cache de imagens:",e)}}function ma(e){return new Promise(a=>{const o=Xe();if(o.images&&o.images[e])return g.log(`Imagem carregada do cache: ${e}`),void a(o.images[e]);g.log(`Carregando e cacheando imagem: ${e}`);const t=new Image;t.crossOrigin="anonymous",t.onload=()=>{try{const s=document.createElement("canvas"),r=s.getContext("2d");s.width=t.naturalWidth,s.height=t.naturalHeight,r.drawImage(t,0,0);const n=s.toDataURL("image/png");o.images||(o.images={}),o.images[e]=n,function(e){try{localStorage.setItem(l,JSON.stringify(e))}catch(e){console.error("Erro ao salvar cache de imagens:",e)}}(o),g.log(`Imagem cacheada com sucesso: ${e}`),a(n)}catch(o){console.error(`Erro ao cachear imagem ${e}:`,o),a(null)}},t.onerror=()=>{console.warn(`Erro ao carregar imagem ${e}, usando fallback`),a(null)},t.src=e})}function ua(e,a,o="🍽️",t={}){const{width:s="100%",height:r="100%",borderRadius:n="4px",objectFit:i="cover",showSkeleton:c=!0,onLoad:d=null,onError:l=null}=t,m=document.createElement("div");m.style.position="relative",m.style.width="100%",m.style.height="100%";let u=null;c&&(u=document.createElement("div"),u.style.width="100%",u.style.height="100%",u.style.background="linear-gradient(90deg, #23243a 25%, #2c2d4a 50%, #23243a 75%)",u.style.backgroundSize="200px 100%",u.style.animation="skeleton-loading 1.2s infinite linear",u.style.borderRadius=n,m.appendChild(u));const p=document.createElement("div");p.textContent=o,p.style.fontSize="20px",p.style.display="none",p.style.position="absolute",p.style.top="0",p.style.left="0",p.style.width="100%",p.style.height="100%",p.style.display="flex",p.style.alignItems="center",p.style.justifyContent="center",p.style.zIndex="2",m.appendChild(p);const g=document.createElement("img");return g.alt=a,g.style.width=s,g.style.height=r,g.style.objectFit=i,g.style.borderRadius=n,g.style.position="absolute",g.style.top="0",g.style.left="0",g.style.zIndex="3",ma(e).then(a=>{g.src=a||e}),g.onload=()=>{u&&(u.style.display="none"),d&&d(g)},g.onerror=()=>{u&&(u.style.display="none"),g.style.display="none",p.style.display="flex",l&&l()},m.appendChild(g),m}function pa(){const e=document.getElementById("effects-indicators-section"),a=document.getElementById("effects-icons-container");if(!e||!a)return void g.log("Seção de indicadores de efeitos não encontrada");a.innerHTML="";const o=function(){const e=ra(),a=Je(),o=Ze();return e.filter(e=>"condition"===e.effectType?o.includes(e.effectKey):("food"===e.effectType||"drink"===e.effectType||"potion"===e.effectType||"item"===e.effectType)&&a.includes(e.effectKey))}();0!==o.length?(e.style.display="block",o.forEach(e=>{if("food"===e.effectType){let a=[];try{a=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de comida:",e),a=[]}const o=a.find(a=>a.effectKey===e.effectKey);if(o){const e=(t=o.name,[{nome:"Assado de Carnes",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_60.jpg",raridade:"Comum",descricao:"Um prato muito apreciado no Reinado, mas mal visto no Império de Tauron. Pura proteína, deixa qualquer um mais forte.",bonus:"+2 em rolagens de dano corpo a corpo.",preco:"T$ 30",ingredientes:"Carne, carne de caça, porco",custoIngredientes:"T$ 56",cdTeste:"20",icone:"🥩"},{nome:"Balinhas",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_halloween_candy_01.jpg",raridade:"Comum",descricao:"Balas coloridas e doces. Arcanistas gostam — dizem que o açúcar feérico usado nas balinhas potencializa suas magias.",bonus:"+2 em rolagens de dano de magias.",preco:"T$ 30",ingredientes:"Açúcar das fadas, fruta",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍬"},{nome:"Banquete dos Heróis",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_cauldron_frost.jpg",raridade:"Comum",descricao:"Uma mesa repleta das melhores comidas que o dinheiro pode pagar.",bonus:"+1 em um atributo a sua escolha. Esse aumento não oferece PV, PM e perícias adicionais.",preco:"T$ 150",ingredientes:"Carne de caça, ovo de monstro, avelã de Norba",custoIngredientes:"T$ 82",cdTeste:"25",icone:"🍽️"},{nome:"Batata Valkariana",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_103_potatobread.jpg",raridade:"Comum",descricao:"Batatas cortadas em tiras e mergulhadas em óleo fervente. Gordurentas e pouco nutritivas, são o tipo de prato que só é servido numa metrópole como Valkaria. Apesar disso, são saborosas e deixam qualquer um empolgado.",bonus:"+1d6 em um teste a sua escolha realizado até o fim do dia.",preco:"T$ 2",ingredientes:"Óleo, legume",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍟"},{nome:"Bolo de Cenoura",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_fishcake.jpg",raridade:"Comum",descricao:'Uma sobremesa simples, que "faz bem para a vista", segundo anciões de todo o Reinado. Aparentemente, os anciões estão certos, pois o bolo de cenoura fornece +2 em testes de Percepção.',bonus:"+2 em testes de Percepção.",preco:"T$ 4",ingredientes:"Farinha, fruta, óleo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍰"},{nome:"Bolo do Panteão",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_144_cakeslice.jpg",raridade:"Comum",descricao:"Uma sobremesa divina! Este bolo de gorad é preparado com os melhores ingredientes, por isso é caríssimo, servido apenas em banquetes reais — ou em tavernas que atendem aventureiros famosos. Dizem que o gorad usado no bolo é uma das fontes de energia do Panteão.",bonus:"Seu custo para ativar habilidades e lançar magias diminui em -1 PM (mínimo 1).",preco:"T$ 150",ingredientes:"Açúcar das fadas, avelã de Norba, farinha, gorad",custoIngredientes:"T$ 121",cdTeste:"25",icone:"🍰"},{nome:"Ensopado Reforçado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Um prato nutritivo, mas pesado.",bonus:"+20 PV temporários, mas seu deslocamento diminui em –1,5m.",preco:"T$ 6",ingredientes:"Cereal, porco, verdura",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍲"},{nome:"Estrogonofe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_sauteedcarrots.jpg",raridade:"Comum",descricao:"Essa iguaria deliciosa foi inventada nas cortes do antigo Reino de Yudennach — dizem que é uma das poucas coisas boas a sair daquele lugar. Comer estrogonofe deixa você firme em suas convicções.",bonus:"+2 em testes de Vontade.",preco:"T$ 12",ingredientes:"Carne, cogumelo, leite",custoIngredientes:"T$ 22",cdTeste:"15",icone:"🍲"},{nome:"Fritada Monstruosa",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_06.jpg",raridade:"Comum",descricao:"A receita é simples — o segredo está nos ingredientes. Feita com ovos de monstros, esta omelete é extremamente nutritiva.",bonus:"+10 PV temporários.",preco:"T$ 30",ingredientes:"Ovo de monstro, óleo",custoIngredientes:"T$ 53",cdTeste:"20",icone:"🍳"},{nome:"Futomaki",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_161_fish_white.jpg",raridade:"Comum",descricao:"Criado no Império de Jade, este prato consiste em um rolo de arroz recheado com peixes, folhas e raízes. Uma refeição elegante, que deixa todos dispostos a dialogar.",bonus:"+2 em testes de Diplomacia.",preco:"T$ 12",ingredientes:"Cereal, peixe",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🍣"},{nome:"Gorad Quente",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_meat_cooked_08.jpg",raridade:"Comum",descricao:"Gorad e leite, servidos fumegando. Não tem erro. O gorad ativa o cérebro.",bonus:"+2 PM temporários.",preco:"T$ 18",ingredientes:"Gorad, leite",custoIngredientes:"T$ 31",cdTeste:"20",icone:"🥛"},{nome:"Gorvelã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cask_04.jpg",raridade:"Comum",descricao:"Gorad com avelã de Norba. É uma sobremesa cara, mas deliciosa.",bonus:"+5 PM temporários.",preco:"T$ 42",ingredientes:"Gorad, avelã de Norba",custoIngredientes:"T$ 70",cdTeste:"25",icone:"🍰"},{nome:"Macarrão de Yuvalin",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_90_cinnamonbonefishstew.jpg",raridade:"Comum",descricao:"Yuvalin é uma cidade mineradora em Zakharov, na fronteira com as Montanhas Uivantes. Seus habitantes criaram este prato reforçado (macarrão, bacon e creme de leite) para encarar suas árduas jornadas de trabalho nas minas. Deliciosa, a receita se espalhou por outras cidades e reinos.",bonus:"+5 PV temporários.",preco:"T$ 6",ingredientes:"Farinha, leite, porco",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍝"},{nome:"Pão de Queijo",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_orchardfruit01.jpg",raridade:"Comum",descricao:"Um bom pão de queijo deixa qualquer aventureiro bem nutrido e saudável.",bonus:"+2 em testes de Fortitude.",preco:"T$ 10",ingredientes:"Farinha, queijo",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🥨"},{nome:"Pizza",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_deliciouspizza.jpg",raridade:"Comum",descricao:"Um disco de massa coberto com molho de tomate e queijo, este prato foi criado por Guido Venusto, um nobre de Ahlen que queria ascender socialmente. Inepto nas artes da intriga, Venusto resolveu manipular a corte pela barriga. Funcionou — o prato foi um sucesso e o nobre cozinheiro teve muita influência por anos. Certa noite, um espião conseguiu roubar a receita. O segredo da pizza se espalhou e, sem seu trunfo, Venusto foi assassinado logo depois. Comer uma pizza deixa-o pronto para encarar qualquer perigo.",bonus:"+1 em todos os testes de resistência.",preco:"T$ 6",ingredientes:"Farinha, fruta, queijo",custoIngredientes:"T$ 10",cdTeste:"15",icone:"🍕"},{nome:"Porco Assado",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_123_roast.jpg",raridade:"Comum",descricao:"Um prato típico e popular em Deheon, que já se alastrou pelo Reinado. Comer um porco assado o deixa valente e brigão.",bonus:"+1 em testes de Luta.",preco:"T$ 36",ingredientes:"Porco, frutas, legume",custoIngredientes:"T$ 12",cdTeste:"15",icone:"🍖"},{nome:"Prato do Aventureiro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_fish_18.jpg",raridade:"Comum",descricao:"Um cozido de frango com legumes, esta é uma refeição simples, mas mantém qualquer um bem alimentado.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de vida em +1 por nível.",preco:"T$ 2",ingredientes:"Ave, legume",custoIngredientes:"T$ 5",cdTeste:"10",icone:"🍲"},{nome:"Salada de Salistick",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Com folhas e carne de frango, esta salada foi criada no Reino dos Médicos, onde a saúde é uma grande preocupação. Uma alimentação leve, mas nutritiva.",bonus:"Aumenta seu deslocamento em +1,5m (1 quadrado).",preco:"T$ 4",ingredientes:"Ave, fruta, legume",custoIngredientes:"T$ 8",cdTeste:"15",icone:"🥗"},{nome:"Salada Élfica",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_swirlingmistsoup.jpg",raridade:"Comum",descricao:"Esta salada vegetariana leva uma mistura de folhas, frutas e legumes. Segundo os relatos, a receita foi inventada em Lenórienn e passada aos reinos humanos de Lamnor, antes do isolamento dos povos. Felizmente, a salada se espalhou por Arton antes da queda do continente. Um prato leve e equilibrado, inspira disparos precisos.",bonus:"+1 em testes de Pontaria.",preco:"T$ 4",ingredientes:"Fruta, legume, verdura",custoIngredientes:"T$ 5",cdTeste:"15",icone:"🥗"},{nome:"Salada Imperial",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_braisedturtle.jpg",raridade:"Comum",descricao:"Uma mistura de folhas com bacon e queijo, esta salada é leve, mas empolgante.",bonus:"+2 em testes de Iniciativa.",preco:"T$ 6",ingredientes:"Porco, queijo, verdura",custoIngredientes:"T$ 15",cdTeste:"15",icone:"🥗"},{nome:"Sashimi",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_valleystirfry.jpg",raridade:"Comum",descricao:"Uma iguaria da culinária tamuraniana, este prato consiste de peixes e frutos do mar fatiados em pequenos pedaços e servidos com um molho típico do Império de Jade. Uma refeição refinada, leve e equilibrada.",bonus:"+2 em rolagens de dano à distância.",preco:"T$ 22",ingredientes:"Peixe, molho tamuraniano",custoIngredientes:"T$ 37",cdTeste:"20",icone:"🍣"},{nome:"Sopa de Cogumelos",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_slime_02.jpg",raridade:"Comum",descricao:"Esta sopa expande sua percepção mística.",bonus:"+2 em testes de Misticismo.",preco:"T$ 6",ingredientes:"Cogumelo, legume, verdura",custoIngredientes:"T$ 7",cdTeste:"15",icone:"🍲"},{nome:"Sopa de Peixe",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_63.jpg",raridade:"Comum",descricao:"Um cozido de peixe com verduras, é um prato simples e humilde, mas garante descanso relaxante.",bonus:"Em sua próxima noite de sono, você aumenta a sua recuperação de pontos de mana em +1 por nível.",preco:"T$ 3",ingredientes:"Verdura, peixe",custoIngredientes:"T$ 8",cdTeste:"10",icone:"🍲"},{nome:"Torta de Maçã",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_10.jpg",raridade:"Comum",descricao:"Dizem que, após uma bruxa usar uma maçã envenenada para matar uma princesa, Thantalla-Dhaedelin, a Rainha das Fadas, decretou que maçãs nunca mais fariam mal a ninguém. Se a lenda é verdade, ou se maçãs são simplesmente saudáveis, ninguém sabe dizer, mas comer este prato fornece resistência a veneno +5.",bonus:"Resistência a veneno +5.",preco:"T$ 2",ingredientes:"Farinha, fruta",custoIngredientes:"T$ 4",cdTeste:"15",icone:"🍰"},{nome:"Baga Celeste Cozida",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_cooked_goldcarpconsomme.jpg",raridade:"Comum",descricao:"Encontradas originalmente nas encostas invertidas de Vectora, estas bagas se espalharam por toda Arton. Quando preparadas adequadamente, fornecem qualidades místicas de flutuação.",bonus:"Todo dano de queda que você sofre é reduzido em −1d6.",preco:"T$ 25",ingredientes:"Fruta, especiaria",custoIngredientes:"T$ 35",cdTeste:"20",icone:"🌟"},{nome:"Cozido de Pimenta",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_food_159_fish_82.jpg",raridade:"Comum",descricao:"Um prato forte, capaz de trazer lágrimas aos olhos do mais resistente dos comensais.",bonus:"+1 em Fortitude (cumulativo com outros itens) e +1 na rolagem do D20 para testes da perícia Fortitude.",preco:"T$ 15",ingredientes:"Legume, especiaria",custoIngredientes:"T$ 12",cdTeste:"18",icone:"🌶️"},{nome:"Manjar de Sombras",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_cooking_80_ravenberrytart.jpg",raridade:"Comum",descricao:"A origem da receita original deste prato se perdeu, mas sua essência se manteve inalterada. Consiste de um manjar com ingredientes cultivados em terras próximas de cemitérios, que protege o corpo contra energias sombrias.",bonus:"Você ignora os próximos 10 pontos de dano de trevas que sofrer.",preco:"T$ 40",ingredientes:"Cereal, especiaria, verdura",custoIngredientes:"T$ 28",cdTeste:"22",icone:"🌑"}].find(e=>e.nome===t));e&&function(e,a){const o=document.getElementById("effects-icons-container");if(!o)return;const t=document.createElement("div");t.className="food-indicator",t.style.position="relative",t.style.width="32px",t.style.height="32px",t.style.borderRadius="6px",t.style.border="2px solid #4caf50",t.style.background="#23243a",t.style.cursor="pointer",t.style.transition="all 0.2s",t.style.overflow="hidden",t.onmouseover=()=>{t.style.transform="scale(1.1)",t.style.borderColor="#66bb6a",q(t,e,"food")},t.onmouseout=()=>{t.style.transform="scale(1)",t.style.borderColor="#4caf50",E()},t.onclick=()=>{E(),function(e){let a=[];try{a=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]"),a=a.filter(a=>a.effectKey!==e),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(a))}catch(e){console.error("Erro ao remover efeito de comida:",e)}Ke(e),ca(e,"food"),pa()}(a.effectKey)};const s=ua(e.iconeUrl||"https://wow.zamimg.com/images/wow/icons/large/inv_misc_fork-knife.jpg",e.nome,e.icone||"🍽️",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!0});t.appendChild(s);const r=document.createElement("div");r.style.position="absolute",r.style.bottom="0",r.style.right="0",r.style.background="rgba(0, 0, 0, 0.7)",r.style.color="#ffffff",r.style.fontSize="8px",r.style.fontWeight="bold",r.style.padding="1px 3px",r.style.borderRadius="3px 0 4px 0",r.style.lineHeight="1",r.style.minWidth="12px",r.style.textAlign="center",r.style.border="1px solid #000000",r.style.zIndex="10",r.style.pointerEvents="none","Batata Valkariana"===e.nome?r.textContent="1x":r.textContent="24h",t.appendChild(r),o.appendChild(t)}(e,o)}}else if("condition"===e.effectType){const a=aa(e.effectKey);a&&function(e){const a=document.getElementById("effects-icons-container");if(!a)return;const o=document.createElement("div");o.className="condition-indicator",o.style.position="relative",o.style.width="32px",o.style.height="32px",o.style.borderRadius="6px",o.style.border="2px solid #ff6e6e",o.style.background="#23243a",o.style.cursor="pointer",o.style.transition="all 0.2s",o.style.overflow="hidden",o.onmouseover=()=>{o.style.transform="scale(1.1)",o.style.borderColor="#ff8a8a",q(o,e,"condition")},o.onmouseout=()=>{o.style.transform="scale(1)",o.style.borderColor="#ff6e6e",E()},o.onclick=()=>{E(),ea(e.nome)};const t=ua(e.iconeUrl||"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseoftounges.jpg",e.nome,e.icone||"⚠️",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!0});o.appendChild(t),a.appendChild(o)}(a)}else if("item"===e.effectType){const a=ta(e.effectKey);a&&function(e){const a=document.getElementById("effects-icons-container");if(!a)return;const o=document.createElement("div");o.className="item-effect-indicator",o.style.position="relative",o.style.width="32px",o.style.height="32px",o.style.borderRadius="6px",o.style.border="2px solid #9c27b0",o.style.background="#23243a",o.style.cursor="pointer",o.style.transition="all 0.2s",o.style.overflow="hidden",o.onmouseover=()=>{o.style.transform="scale(1.1)",o.style.borderColor="#ba68c8",q(o,e,"item")},o.onmouseout=()=>{o.style.transform="scale(1)",o.style.borderColor="#9c27b0",E()},o.onclick=()=>{E(),Ke(e.effectKey,!0),ca(e.effectKey,"item")};const t=ua(e.iconeUrl||"https://wow.zamimg.com/images/wow/icons/large/inv_misc_questionmark.jpg",e.name,e.icone||"⚔️",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!0});o.appendChild(t),a.appendChild(o)}(a)}else if("drink"===e.effectType){let a=[];try{a=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de bebida:",e),a=[]}const t=a.find(a=>a.effectKey===e.effectKey);if(t){const e=(o=t.name,[{nome:"Baba de Troll",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_potion_136.jpg",tipo:"Não alcoólica",descricao:"Uma bebida sem álcool, à base de leite, castanhas, nozes e mel.",efeito:"+1d4 em um teste à sua escolha até o fim do dia.",cd:"—",icone:"🧃"},{nome:"Barba Queimada",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_05.jpg",tipo:"Alcoólica",descricao:"Forte e amarga, esta cerveja anã fortalece o corpo e o espírito.",efeito:"Redução de Dano 2.",cd:"20",icone:"🍺"},{nome:"Cerveja Deheoni",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_08.jpg",tipo:"Alcoólica",descricao:"A bebida mais comum nas tavernas do Reinado.",efeito:"+1 em testes de resistência.",cd:"15",icone:"🍻"},{nome:"Dilínio",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_11.jpg",tipo:"Alcoólica",descricao:"Destilado tradicional de Mortenstenn, feito com um cereal que só cresce no continente sul. A receita se perdeu após as invasões duyshidakk, e poucos barris chegaram ao Reinado.",efeito:"O limite de gasto de PM aumenta em +1.",cd:"20",observacao:"Não pode ser fabricado",icone:"🥃"},{nome:"Grogue Negro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_12.jpg",tipo:"Alcoólica",descricao:"Rum misturado com especiarias. Seu nome vem de sua origem — piratas do Conclave, que atuam no Mar Negro — e não da cor da bebida, que é dourada clara.",efeito:"Quando você usa Audácia, o bônus fornecido pelo poder aumenta em +1.",cd:"15",icone:"🏴‍☠️"},{nome:"Grogue Rubro",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_13.jpg",tipo:"Alcoólica",descricao:"Variação do grogue negro, com especiarias picantes que fazem a bebida adquirir uma coloração avermelhada — e quem a bebe, certa inclinação para a violência.",efeito:"Você pode usar Audácia para testes de ataque.",cd:"20",icone:"🔥"},{nome:"Hidromel Uivante",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_14.jpg",tipo:"Alcoólica",descricao:"Fabricada nas montanhas geladas, esta bebida aquece e incita.",efeito:"+2 em rolagens de dano corpo a corpo.",cd:"20",icone:"❄️"},{nome:"Licor Feérico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_15.jpg",tipo:"Alcoólica",descricao:"De aparência enevoada e gosto adocicado, dizem que é feito na Pondsmânia e trazido com dificuldade ao Reinado. Alguns acham que é invenção dos taverneiros, até provarem uma dose.",efeito:"Escolha uma habilidade. O custo para ativá-la diminui em –1 PM.",cd:"25",icone:"✨"},{nome:"Sidra Ahleniense",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_16.jpg",tipo:"Alcoólica",descricao:"Esta bebida doce deixa qualquer um mais falante.",efeito:"+2 em testes de perícias originalmente baseadas em Carisma.",cd:"15",icone:"🍏"},{nome:"Vinho Pruss",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_17.jpg",tipo:"Alcoólica",descricao:"Batizado em homenagem ao antigo Rei-Imperador Thormy — dizem que era o favorito do monarca.",efeito:"Concede 3 pontos de mana temporários.",cd:"15",icone:"🍷"},{nome:"Vinho Élfico",iconeUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_drink_18.jpg",tipo:"Alcoólica",descricao:"De sabor complexo, aguça a mente.",efeito:"+1 na CD para resistir às suas habilidades.",cd:"20",icone:"🌿"}].find(e=>e.nome===o));e&&function(e,a){const o=document.getElementById("effects-icons-container");if(!o)return;const t=document.createElement("div");if(t.className="bebida-indicator",t.style.position="relative",t.style.width="32px",t.style.height="32px",t.style.borderRadius="6px",t.style.border="2px solid #4caf50",t.style.background="#23243a",t.style.cursor="pointer",t.style.transition="all 0.2s",t.style.overflow="hidden",t.onmouseover=()=>{t.style.transform="scale(1.1)",t.style.borderColor="#66bb6a",q(t,e,"drink")},t.onmouseout=()=>{t.style.transform="scale(1)",t.style.borderColor="#4caf50",E()},t.onclick=()=>{E(),function(e){let a=[];try{a=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]"),a=a.filter(a=>a.effectKey!==e),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(a))}catch(e){console.error("Erro ao remover efeito de bebida:",e)}Ke(e),ca(e,"drink"),pa()}(a.effectKey)},e.iconeUrl){const a=ua(e.iconeUrl,e.nome,e.icone||"🍺",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!1});t.appendChild(a)}else{const a=document.createElement("div");a.textContent=e.icone||"🍺",a.style.width="100%",a.style.height="100%",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.fontSize="16px",t.appendChild(a)}const s=document.createElement("div");s.style.position="absolute",s.style.bottom="0",s.style.right="0",s.style.background="rgba(0, 0, 0, 0.7)",s.style.color="#ffffff",s.style.fontSize="8px",s.style.fontWeight="bold",s.style.padding="1px 3px",s.style.borderRadius="3px 0 4px 0",s.style.lineHeight="1",s.style.minWidth="12px",s.style.textAlign="center",s.style.border="1px solid #000000",s.style.zIndex="10",s.style.pointerEvents="none","Baba de Troll"===e.nome?s.textContent="1x":s.textContent="24h",t.appendChild(s),o.appendChild(t)}(e,t)}}else if("potion"===e.effectType){let o=[];try{o=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de poção:",e),o=[]}const t=o.find(a=>a.effectKey===e.effectKey);if(t){const e=(a=t.name,me().find(e=>e.nome===a));e&&function(e,a){const o=document.getElementById("effects-icons-container");if(!o)return;const t=document.createElement("div");if(t.className="pocao-indicator",t.style.position="relative",t.style.width="32px",t.style.height="32px",t.style.borderRadius="6px",t.style.border="2px solid #9c27b0",t.style.background="#23243a",t.style.cursor="pointer",t.style.transition="all 0.2s",t.style.overflow="hidden",t.onmouseover=()=>{t.style.transform="scale(1.1)",t.style.borderColor="#ba68c8",q(t,e,"potion")},t.onmouseout=()=>{t.style.transform="scale(1)",t.style.borderColor="#9c27b0",E()},t.onclick=()=>{E(),function(e){let a=[];try{a=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]"),a=a.filter(a=>a.effectKey!==e),localStorage.setItem("tormenta-20-hotbars-pocao-effects",JSON.stringify(a))}catch(e){console.error("Erro ao remover efeito de poção:",e)}Ke(e),ca(e,"potion"),pa()}(a.effectKey)},e.iconeUrl){const a=ua(e.iconeUrl,e.nome,e.icone||"🧪",{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",showSkeleton:!1});t.appendChild(a)}else{const a=document.createElement("div");a.textContent=e.icone||"🧪",a.style.width="100%",a.style.height="100%",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.fontSize="16px",t.appendChild(a)}const s=document.createElement("div");s.style.position="absolute",s.style.bottom="0",s.style.right="0",s.style.background="rgba(0, 0, 0, 0.7)",s.style.color="#ffffff",s.style.fontSize="8px",s.style.fontWeight="bold",s.style.padding="1px 3px",s.style.borderRadius="3px 0 4px 0",s.style.lineHeight="1",s.style.minWidth="12px",s.style.textAlign="center",s.style.border="1px solid #000000",s.style.zIndex="10",s.style.pointerEvents="none",s.textContent="Cena",t.appendChild(s),o.appendChild(t)}(e,t)}}var a,o,t})):e.style.display="none"}const ga="tormenta-20-hotbars-selectable-cards";function fa(){try{return JSON.parse(localStorage.getItem(ga)||"[]")}catch(e){return console.error("Erro ao carregar selectable-cards:",e),[]}}function va(){const e=document.getElementById("effects-popup");e&&e.remove();const a=document.getElementById("effects-overlay");a&&a.remove();const o=document.createElement("div");o.id="effects-overlay",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.background="rgba(0,0,0,0.5)",o.style.zIndex="10000",o.onclick=()=>{o.remove(),t.remove(),setTimeout(()=>{Ye()},100)},document.body.appendChild(o);const t=document.createElement("div");t.id="effects-popup",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(30,30,40,0.98)",t.style.border="2px solid #6ec6ff",t.style.borderRadius="12px",t.style.padding="18px 20px 16px 20px",t.style.zIndex="10001",t.style.maxWidth="400px",t.style.maxHeight="600px",t.style.overflowY="auto",t.style.boxShadow="0 8px 32px rgba(0,0,0,0.7)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="stretch";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="15px",s.style.width="100%";const r=document.createElement("h3");r.textContent="Efeitos",r.style.color="#ecf0f1",r.style.margin="0",r.style.fontSize="17px",r.style.fontWeight="bold";const n=window.Roll20Components.createCloseButton({text:"×",fontSize:"24px",width:"32px",height:"32px",padding:"0",color:"#ecf0f1",onClick:()=>{t.remove();const e=document.getElementById("effects-overlay");e&&e.remove(),setTimeout(()=>{Ye()},100)}});s.appendChild(r),s.appendChild(n.render()),t.appendChild(s);let i=[];try{i=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de comida:",e),i=[]}const c=Je(),d=i.filter(e=>c.includes(e.effectKey)).map(e=>{let a="",o=e.description;const t=[/\+[^.]*$/i,/\+[^,]*$/i,/\+[^!]*$/i];for(const e of t){const t=o.match(e);if(t){a=t[0].trim(),o=o.substring(0,o.lastIndexOf(t[0])).trim();break}}if(!a){const e=o.lastIndexOf(".");if(-1!==e&&e<o.length-1){const t=o.substring(e+1).trim();t&&t.length>0&&(a=t,o=o.substring(0,e+1).trim())}}return{title:e.name,description:o,chips:a?[a,"Comida","24h"]:["Comida","24h"],type:"Comida",effectKey:e.effectKey}});let l=[];try{l=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de bebida:",e),l=[]}const m=l.filter(e=>c.includes(e.effectKey)).map(e=>({title:e.name,description:e.description,chips:["Bebida","24h"],type:"Bebida",effectKey:e.effectKey}));let u=[];try{u=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]")}catch(e){console.error("Erro ao carregar efeitos de poção:",e),u=[]}const p=[{title:"Cachecol Sombrio",description:"Efeito de Dano: Todos os ataques melee recebem +1d6 de dano furtivo. Efeito acumulativo com outros ataques furtivos.",chips:["+1d6","Furtivo","Melee"],type:"Item",effectKey:"cachecol_sombrio"},...d,...m,...u.filter(e=>c.includes(e.effectKey)).map(e=>({title:e.name,description:e.description,chips:["Poção","Cena"],type:"Poção",effectKey:e.effectKey})),...Ze().map(e=>{const a=aa(e);return{title:a?a.nome:e,description:a?a.descricao:"",chips:a&&a.efeitos?[a.efeitos.split("•")[0].trim(),"Condição"]:["Condição"],type:"Condição",effectKey:e}})],g=document.createElement("div");g.style.display="flex",g.style.flexDirection="column",g.style.gap="8px",g.style.marginTop="2px",t.appendChild(g),function e(){g.innerHTML="",p.forEach(a=>{const o=Qe(a.effectKey),t=document.createElement("div");t.style.background=o?"#2d4a3e":"#23243a",t.style.border="1px solid "+(o?"#4caf50":"#6ec6ff"),t.style.borderRadius="8px",t.style.padding="12px",t.style.cursor="pointer",t.style.transition="all 0.2s",t.onmouseover=()=>{t.style.background=o?"#3d5a4e":"#2a2b4a"},t.onmouseout=()=>{t.style.background=o?"#2d4a3e":"#23243a"},t.onclick=()=>{if("Condição"===a.type){ea(a.effectKey);const e=document.getElementById("conditions-popup");e&&e.remove();const o=document.getElementById("conditions-overlay");o&&o.remove();const t=document.getElementById("condition-details-popup");t&&t.remove();const s=document.getElementById("condition-details-overlay");s&&s.remove();const r=document.getElementById("effects-popup");r&&r.remove();const n=document.getElementById("effects-overlay");n&&n.remove()}else if("Selectable"===a.type)!function(e){const a=fa(),o=a.indexOf(e);o>-1?(a.splice(o,1),_("Efeito removido.")):(a.push(e),A("Efeito ativado!")),function(e){try{localStorage.setItem(ga,JSON.stringify(e))}catch(e){console.error("Erro ao salvar selectable-cards:",e)}}(a),Ye(),pa()}(a.effectKey);else if("Comida"===a.type){const e=Je(),o=e.indexOf(a.effectKey);if(o>-1){e.splice(o,1);let t=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]");t=t.filter(e=>e.effectKey!==a.effectKey),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(t)),Ge(e),_(`Efeito "${a.title}" removido.`)}else{e.push(a.effectKey);let o=JSON.parse(localStorage.getItem("tormenta-20-hotbars-comida-effects")||"[]");o=o.filter(e=>e.effectKey!==a.effectKey),o.push({name:a.title,description:a.description,type:"Comida",effectKey:a.effectKey}),localStorage.setItem("tormenta-20-hotbars-comida-effects",JSON.stringify(o)),Ge(e),A(`Efeito "${a.title}" ativado!`)}}else if("Bebida"===a.type){const e=Je(),o=e.indexOf(a.effectKey);if(o>-1){e.splice(o,1);let t=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]");t=t.filter(e=>e.effectKey!==a.effectKey),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(t)),Ge(e),_(`Efeito "${a.title}" removido.`)}else{e.push(a.effectKey);let o=JSON.parse(localStorage.getItem("tormenta-20-hotbars-bebida-effects")||"[]");o=o.filter(e=>e.effectKey!==a.effectKey),o.push({name:a.title,description:a.description,type:"Bebida",effectKey:a.effectKey}),localStorage.setItem("tormenta-20-hotbars-bebida-effects",JSON.stringify(o)),Ge(e),A(`Efeito "${a.title}" ativado!`)}}else if("Poção"===a.type){const e=Je(),o=e.indexOf(a.effectKey);if(o>-1){e.splice(o,1);let t=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]");t=t.filter(e=>e.effectKey!==a.effectKey),localStorage.setItem("tormenta-20-hotbars-pocao-effects",JSON.stringify(t)),Ge(e),_(`Efeito "${a.title}" removido.`)}else{e.push(a.effectKey);let o=JSON.parse(localStorage.getItem("tormenta-20-hotbars-pocao-effects")||"[]");o=o.filter(e=>e.effectKey!==a.effectKey),o.push({name:a.title,description:a.description,type:"Poção",effectKey:a.effectKey}),localStorage.setItem("tormenta-20-hotbars-pocao-effects",JSON.stringify(o)),Ge(e),A(`Efeito "${a.title}" ativado!`)}}else Ke(a.effectKey);e(),Ye(),pa()};const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="6px";const r=document.createElement("div");r.textContent=a.title||a.name,r.style.color=o?"#4caf50":"#6ec6ff",r.style.fontSize="15px",r.style.fontWeight="bold";const n=document.createElement("div");n.textContent=o?"●":"○",n.style.color=o?"#4caf50":"#6ec6ff",n.style.fontSize="18px",n.style.fontWeight="bold",s.appendChild(r),s.appendChild(n),t.appendChild(s);const i=document.createElement("div");i.textContent=a.type,i.style.background="#6ec6ff",i.style.color="#23243a",i.style.fontSize="11px",i.style.fontWeight="bold",i.style.borderRadius="4px",i.style.padding="2px 8px",i.style.display="inline-block",i.style.width="fit-content",i.style.marginBottom="6px",t.appendChild(i);const c=document.createElement("div");if(c.textContent=a.description,c.style.color="#ecf0f1",c.style.fontSize="13px",c.style.lineHeight="1.4",t.appendChild(c),a.chips&&a.chips.length>0){const e=document.createElement("div");e.style.display="flex",e.style.flexWrap="wrap",e.style.gap="4px",e.style.marginTop="8px",a.chips.forEach(a=>{const o=document.createElement("div");o.textContent=a,o.style.background="#ffb86c",o.style.color="#23243a",o.style.fontSize="10px",o.style.fontWeight="bold",o.style.padding="2px 6px",o.style.borderRadius="10px",o.style.border="1px solid #ffc97a",o.style.display="inline-block",e.appendChild(o)}),t.appendChild(e)}g.appendChild(t)})}(),document.body.appendChild(t),S(t,"blue")}window.Roll20Components={createCloseButton:function(e){const{text:a="×",fontSize:o="18px",width:t="32px",height:s="32px",padding:r="4px",color:n="#ecf0f1",onClick:i=null}=e,c=document.createElement("button");return c.textContent=a,c.style.background="none",c.style.border="none",c.style.color=n,c.style.fontSize=o,c.style.width=t,c.style.height=s,c.style.padding=r,c.style.cursor="pointer",c.style.borderRadius="4px",c.style.transition="all 0.2s",c.style.display="flex",c.style.alignItems="center",c.style.justifyContent="center",c.onmouseover=()=>{c.style.background="rgba(255,255,255,0.1)"},c.onmouseout=()=>{c.style.background="none"},i&&(c.onclick=i),{element:c,render:function(){return c}}},createFavoritableCardWithPreset:function(e,a){const{title:o,summary:t,description:s,chips:r=[],bonus:n,efeito:i,efeitos:c,additionalInfo:d,onFavorite:l=null,onUnfavorite:m=null,onFavoriteToggle:u=null,onClick:p=null,isFavorite:g=!1}=a,f=document.createElement("div");f.style.background="#23243a",f.style.border="1px solid #6ec6ff",f.style.borderRadius="8px",f.style.padding="12px",f.style.cursor="pointer",f.style.transition="all 0.2s",f.style.marginBottom="8px",f.style.position="relative",f.onmouseover=()=>{f.style.background="#2a2b4a",f.style.borderColor="#8ed8ff"},f.onmouseout=()=>{f.style.background="#23243a",f.style.borderColor="#6ec6ff"},p&&(f.onclick=e=>{e.target!==h&&p(e)});const v=document.createElement("div");v.textContent=o,v.style.color="#6ec6ff",v.style.fontSize="14px",v.style.fontWeight="bold",v.style.marginBottom="4px",f.appendChild(v);const y=document.createElement("div");if(y.textContent=t||s||"",y.style.color="#ecf0f1",y.style.fontSize="12px",y.style.lineHeight="1.3",y.style.marginBottom="8px",f.appendChild(y),"potion"!==e){if(n){const e=document.createElement("div");e.textContent=`Bônus: ${n}`,e.style.color="#27ae60",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.marginBottom="4px",f.appendChild(e)}if(i){const e=document.createElement("div");e.textContent=`Efeito: ${i}`,e.style.color="#e67e22",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.marginBottom="4px",f.appendChild(e)}if(c)if(Array.isArray(c))c.forEach(e=>{const a=document.createElement("div");a.textContent=`${e}`,a.style.color="#9b59b6",a.style.fontSize="11px",a.style.fontWeight="bold",a.style.marginBottom="2px",f.appendChild(a)});else if("string"==typeof c){const e=document.createElement("div");e.textContent=`${c}`,e.style.color="#9b59b6",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.marginBottom="2px",f.appendChild(e)}}const b=document.createElement("div");b.style.display="flex",b.style.gap="4px",b.style.flexWrap="wrap",r.forEach(e=>{const a=document.createElement("span");a.textContent=e,a.style.background="#6ec6ff",a.style.color="#23243a",a.style.fontSize="10px",a.style.padding="2px 6px",a.style.borderRadius="10px",a.style.fontWeight="bold",b.appendChild(a)}),d&&Array.isArray(d)&&d.forEach(e=>{const a=document.createElement("span");a.textContent=e.text,a.style.background=e.color||"#6ec6ff",a.style.color="#23243a",a.style.fontSize="10px",a.style.padding="2px 6px",a.style.borderRadius="10px",a.style.fontWeight="bold",b.appendChild(a)});const h=document.createElement("button");return h.innerHTML=g?"★":"☆",h.style.position="absolute",h.style.top="8px",h.style.right="8px",h.style.background="none",h.style.border="none",h.style.color=g?"#ffd700":"#666",h.style.fontSize="16px",h.style.cursor="pointer",h.style.padding="0",h.style.width="20px",h.style.height="20px",h.style.display="flex",h.style.alignItems="center",h.style.justifyContent="center",h.onclick=e=>{e.stopPropagation(),u?u():g?m&&m():l&&l()},f.appendChild(v),f.appendChild(y),f.appendChild(b),f.appendChild(h),{element:f,render:function(){return f}}}}}();